<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2018-04-07T22:15:58.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>R语言学习笔记2</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/"/>
    <id>http://uteric.github.io/R语言学习笔记2/</id>
    <published>2018-04-07T22:15:58.000Z</published>
    <updated>2018-04-07T22:15:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、数学运算（Arithmetic-Operators）"><a href="#1、数学运算（Arithmetic-Operators）" class="headerlink" title="1、数学运算（Arithmetic Operators）"></a>1、数学运算（Arithmetic Operators）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># BASIC ARITHMETIC OPERATORS</span></div><div class="line">&gt; 2-5+1 <span class="comment"># 加减法</span></div><div class="line">[1] -2</div><div class="line">&gt; 6/3*2 <span class="comment"># 乘除法</span></div><div class="line">[1] 4</div><div class="line">&gt; 3+2*5 <span class="comment"># 混合运算</span></div><div class="line">[1] 13</div><div class="line">&gt; 4^3 <span class="comment"># 4的3次方，^代表乘幂</span></div><div class="line">[1] 64</div><div class="line">&gt; exp(4) <span class="comment"># 自然常数e的乘幂，即e^4</span></div><div class="line">[1] 54.59815</div><div class="line">&gt; <span class="built_in">log</span>(2.742) <span class="comment"># 某数的自然对数</span></div><div class="line">[1] 1.008688</div><div class="line">&gt; log10(1000) <span class="comment"># 某数以10为底的对数</span></div><div class="line">[1] 3</div><div class="line">&gt; pi <span class="comment"># 圆周率π</span></div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="2、变量（Variables）"><a href="#2、变量（Variables）" class="headerlink" title="2、变量（Variables）"></a>2、变量（Variables）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VARIABLES</span></div><div class="line"></div><div class="line">x &lt;- 3 <span class="comment"># 将3储存到变量x</span></div><div class="line">x <span class="comment"># 输出x，也可以使用print(x)</span></div><div class="line">[1] 3</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根</span></div><div class="line">[1] 1.732051</div><div class="line">&gt; x^4 <span class="comment"># 指定次方</span></div><div class="line">[1] 81</div><div class="line">&gt; <span class="built_in">log</span>(x) <span class="comment"># 自然对数</span></div><div class="line">[1] 1.098612</div><div class="line">&gt; log10(x) <span class="comment"># 以10为底对数</span></div><div class="line">[1] 0.4771213</div><div class="line">&gt; exp(x) 自然常数的指定次方</div><div class="line">[1] 20.08554</div><div class="line">&gt; tan(x) <span class="comment"># tan</span></div><div class="line">[1] -0.1425465</div><div class="line">&gt; y &lt;- pi <span class="comment"># 将圆周率π的值储存为变量y</span></div><div class="line">&gt; y</div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="3、向量（VECTORS）"><a href="#3、向量（VECTORS）" class="headerlink" title="3、向量（VECTORS）"></a>3、向量（VECTORS）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VECTORS</span></div><div class="line">&gt; x &lt;- c(2,3,5,1,4,4) <span class="comment"># 创建向量x，值为（2,3,5,1,4,4) </span></div><div class="line">&gt; x</div><div class="line">[1] 2 3 5 1 4 4</div><div class="line">&gt; sum(x) <span class="comment"># 求和</span></div><div class="line">[1] 19</div><div class="line">&gt; mean(x) <span class="comment"># 平均值</span></div><div class="line">[1] 3.166667</div><div class="line">&gt; sd(x) <span class="comment"># 标准差</span></div><div class="line">[1] 1.47196</div><div class="line">&gt; median(x) <span class="comment"># 中位数</span></div><div class="line">[1] 3.5</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根 </span></div><div class="line">[1] 1.414214 1.732051 2.236068 1.000000 2.000000 2.000000</div><div class="line">&gt; x^2 <span class="comment"># 指定次方</span></div><div class="line">[1]  4  9 25  1 16 16</div><div class="line">&gt; seq(1,10) <span class="comment"># 创建向量，从1开始，每次增加1，至10结束；或者使用seq(1:10)</span></div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10</div><div class="line">&gt; seq(1,10,2) <span class="comment"># 创建向量，从1开始，每次增加2，至10结束；或者使用seq(1,10,by=2)</span></div><div class="line">[1] 1 3 5 7 9</div><div class="line">&gt; z &lt;- c(1:12,0,-6) <span class="comment"># 将值添加到向量中</span></div><div class="line">&gt; z</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12  0 -6</div><div class="line">------------------------------------------------------</div><div class="line">&gt; x &lt;- c(-5,0,7,-6,14,27) <span class="comment"># 创建向量</span></div><div class="line">&gt; x</div><div class="line">[1] -5  0  7 -6 14 27</div><div class="line">&gt; x[1] <span class="comment"># 输出第一个元素</span></div><div class="line">[1] -5</div><div class="line">&gt; x[7] <span class="comment"># 输出第七个元素，因为x向量一共6个元素，因此返回NA</span></div><div class="line">[1] NA</div><div class="line">&gt; length(x) <span class="comment"># x向量的元素个数</span></div><div class="line">[1] 6</div><div class="line">&gt; x[length(x)] <span class="comment"># 输出最后一个元素</span></div><div class="line">[1] 27</div><div class="line">&gt; x[-1] <span class="comment"># 输出除第一个以外的其他元素</span></div><div class="line">[1]  0  7 -6 14 27</div><div class="line">&gt; x <span class="comment"># 注意，上述操作并不改变x向量的组成</span></div><div class="line">[1] -5  0  7 -6 14 27 </div><div class="line">&gt; x[c(2,3)] <span class="comment"># 输出第二第三个元素</span></div><div class="line">[1] 0 7</div><div class="line">&gt; x[-c(2,3)] <span class="comment"># 输出除第二第三以外的其他元素</span></div><div class="line">[1] -5 -6 14 27</div><div class="line">&gt; x[2] &lt;- 5 <span class="comment"># 修改第二个元素为5</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27</div><div class="line">&gt; x[7] &lt;-3 <span class="comment"># 修改第七个元素为3，若不存在则添加</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27  3</div><div class="line">&gt; x[c(1,4)] &lt;- c(2,3) <span class="comment"># 同时修改多个元素</span></div><div class="line">&gt; x</div><div class="line">[1]  2  5  7  3 14 27  3</div><div class="line">&gt; x &lt;3 <span class="comment"># 给出逻辑判断</span></div><div class="line">[1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</div><div class="line">&gt; <span class="built_in">which</span>(x&lt;3) <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的位置</span></div><div class="line">[1] 1</div><div class="line">&gt; x[x&lt;3] <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的值</span></div><div class="line">[1] 2</div></pre></td></tr></table></figure>
<h2 id="4、矩阵（MATRIX"><a href="#4、矩阵（MATRIX" class="headerlink" title="4、矩阵（MATRIX)"></a>4、矩阵（MATRIX)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># MATRIX</span></div><div class="line">&gt; matrix(1:20,nrow=4,ncol=5) <span class="comment"># 创建矩阵，从1到20，共20个元素，4行5列，按列填充</span></div><div class="line">[,1] [,2] [,3] [,4] [,5]</div><div class="line">[1,]    1    5    9   13   17</div><div class="line">[2,]    2    6   10   14   18</div><div class="line">[3,]    3    7   11   15   19</div><div class="line">[4,]    4    8   12   16   20</div><div class="line">&gt; matrix(1:30,5,6) <span class="comment"># 简化输入方式</span></div><div class="line">[,1] [,2] [,3] [,4] [,5] [,6]</div><div class="line">[1,]    1    6   11   16   21   26</div><div class="line">[2,]    2    7   12   17   22   27</div><div class="line">[3,]    3    8   13   18   23   28</div><div class="line">[4,]    4    9   14   19   24   29</div><div class="line">[5,]    5   10   15   20   25   30</div></pre></td></tr></table></figure>
<h2 id="5、作图（GRAPHING）"><a href="#5、作图（GRAPHING）" class="headerlink" title="5、作图（GRAPHING）"></a>5、作图（GRAPHING）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRAPHING</span></div><div class="line"><span class="comment"># 创建2个长度为29的向量x，y</span></div><div class="line">&gt; x &lt;- c(2,4,4,6,6,5,5,7,3,7,3,8,9,7,9,6,4,3,4,4,6,2,2,1,2,4,6,6,8)</div><div class="line">&gt; y &lt;- c(1:29)</div><div class="line">&gt; x</div><div class="line">[1] 2 4 4 6 6 5 5 7 3 7 3 8 9 7 9 6 4 3 4 4 6 2 2 1 2 4 6 6 8</div><div class="line">&gt; y</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29</div><div class="line">&gt; hist(x) <span class="comment"># x的直方图</span></div><div class="line">&gt; hist(y) <span class="comment"># y的直方图</span></div><div class="line">&gt; plot(x) <span class="comment"># 散点图</span></div><div class="line">&gt; plot(x,<span class="built_in">type</span>=<span class="string">"b"</span>) <span class="comment"># 带连线的散点图，指示顺序</span></div><div class="line">&gt; plot(x,y) <span class="comment"># 二维散点图</span></div><div class="line">&gt; boxplot(x) <span class="comment"># 箱线图</span></div><div class="line">&gt; boxplot(x,y) <span class="comment"># 两个向量的箱线图</span></div><div class="line">&gt; pie(x) <span class="comment"># 饼图</span></div><div class="line">&gt; y &lt;- rbinom(20,12,.4) <span class="comment"># rbinom可生成随机数，语法为rbinom(n, size, prob)，即产生n个b(size,prob)的二项分布随机数</span></div><div class="line">&gt; hist(y) <span class="comment"># 可以看到，生成的直方图不是经典的二项分布</span></div><div class="line">&gt; y &lt;- rbinom(200,12,.4) <span class="comment"># 生成200个随机数，符合二项分布</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、数学运算（Arithmetic-Operators）&quot;&gt;&lt;a href=&quot;#1、数学运算（Arithmetic-Operators）&quot; class=&quot;headerlink&quot; title=&quot;1、数学运算（Arithmetic Operators）&quot;&gt;&lt;/a&gt;1、
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记8-使用DESeq2进行表达差异分析</title>
    <link href="http://uteric.github.io/RNASEQ%E4%BD%BF%E7%94%A8DESeq2%E8%BF%9B%E8%A1%8C%E8%A1%A8%E8%BE%BE%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90/"/>
    <id>http://uteric.github.io/RNASEQ使用DESeq2进行表达差异分析/</id>
    <published>2018-04-06T04:11:52.000Z</published>
    <updated>2018-04-06T04:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：</p>
<p><strong>1、在R中安装DESeq2软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div><div class="line">library(<span class="string">"DESeq2"</span>) <span class="comment"># 测试是否安装成功</span></div></pre></td></tr></table></figure>
<p>如果安装出错，请移步前文：《<a href="https://uteric.github.io/MAC%E5%AE%89%E8%A3%85DESeq2%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">MAC安装DESeq2报错及解决方案</a>》，作为一个生信小白，我花了3天时间才把安装DESeq2的问题解决，一路全是坑啊！</p>
<hr>
<p><strong>2、导入分析数据</strong></p>
<p>我们还是使用《<a href="https://uteric.github.io/RNASEQ%20HTSeq%E5%AE%9A%E9%87%8F%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/">RNASEQ分析入门笔记7-HTSeq定量基因表达水平</a>》中得到的数据进行分析，首先回顾一下：</p>
<p>上文中，我们得到了raw_count_filt2矩阵，格式如下（执行：tail (raw_count_filt2, n=5):</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ENSMUSG00000110420</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110421</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110422</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110423</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110424</td>
<td style="text-align:center">26</td>
<td style="text-align:center">20</td>
<td style="text-align:center">48</td>
<td style="text-align:center">24</td>
</tr>
</tbody>
</table>
<p>可以看到，该矩阵实际只有4列，是由整数组成的，而最前面的一列是行名，可以直接从保存的.csv文件中导入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt2 &lt;- read.csv (<span class="string">"raw_count_filt2.csv"</span>)  <span class="comment"># 从保存的.csv文件导入数据，并赋值给raw_count_filt2</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>3、加载DESeq2并设置样品信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(DESeq2) <span class="comment"># 加载DESeq2包</span></div><div class="line">countData &lt;- raw_count_filt2 <span class="comment"># 表达矩阵</span></div><div class="line">condition &lt;- factor(c(<span class="string">"control"</span>,<span class="string">"control"</span>,<span class="string">"KD"</span>,<span class="string">"KD"</span>)) <span class="comment"># 定义condition</span></div><div class="line">colData &lt;- data.frame(row.names=colnames(countData), condition) <span class="comment"># 样品信息矩阵</span></div></pre></td></tr></table></figure>
<p>condition：</p>
<blockquote>
<p>[1] control control KD      KD<br>Levels: KD control</p>
</blockquote>
<p>colData：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">condition</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">control1</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">control2</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">rep1</td>
<td style="text-align:center">KD</td>
</tr>
<tr>
<td style="text-align:center">rep2</td>
<td style="text-align:center">KD</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>4、构建dds矩阵</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData, DataFrame(condition), design= ~ condition ) <span class="comment"># 构建dds矩阵</span></div><div class="line">head(dds) <span class="comment"># 查看dds矩阵的前6行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>class: DESeqDataSet<br>dim: 6 4<br>metadata(1): version<br>assays(1): counts<br>rownames(6): ENSMUSG00000000001 ENSMUSG00000000003 …<br>ENSMUSG00000000037 ENSMUSG00000000049<br>rowData names(0):<br>colnames(4): control1 control2 rep1 rep2<br>colData names(1): condition</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dds2 &lt;- DESeq(dds) <span class="comment"># 对dds进行Normalize</span></div></pre></td></tr></table></figure>
<p>运行成功会有如下提示：</p>
<blockquote>
<p>estimating size factors<br>estimating dispersions<br>gene-wise dispersion estimates<br>mean-dispersion relationship<br>final dispersion estimates<br>fitting model and testing</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">resultsNames（dds) <span class="comment"># 查看结果的名称</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “Intercept”               “condition_control_vs_KD”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res &lt;- results(dds) <span class="comment"># 使用results()函数获取结果，并赋值给res</span></div><div class="line">head (res, n=5) <span class="comment"># 查看res矩阵的前5行</span></div></pre></td></tr></table></figure>
<p>输出的res矩阵有6列，分别是：baseMean，log2FoldChange，lfcSE，pvalue，padj：</p>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..0001</td>
<td style="text-align:center">2359.75391</td>
<td style="text-align:center">-0.08461265</td>
<td style="text-align:center">0.2081281</td>
<td style="text-align:center">-0.4065413</td>
<td style="text-align:center">0.68434494</td>
<td style="text-align:center">0.9040654</td>
</tr>
<tr>
<td style="text-align:center">E..0003</td>
<td style="text-align:center">0.00000</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
</tr>
<tr>
<td style="text-align:center">E..0028</td>
<td style="text-align:center">1027.82363</td>
<td style="text-align:center">0.03638541</td>
<td style="text-align:center">0.2036829</td>
<td style="text-align:center">0.1786375</td>
<td style="text-align:center">0.85822232</td>
<td style="text-align:center">0.9618582</td>
</tr>
<tr>
<td style="text-align:center">E..0031</td>
<td style="text-align:center">65.37333</td>
<td style="text-align:center">0.94588315</td>
<td style="text-align:center">0.4428518</td>
<td style="text-align:center">2.1358912</td>
<td style="text-align:center">0.03268828</td>
<td style="text-align:center">0.2511131</td>
</tr>
<tr>
<td style="text-align:center">E..0037</td>
<td style="text-align:center">69.75843</td>
<td style="text-align:center">0.11587980</td>
<td style="text-align:center">0.4400431</td>
<td style="text-align:center">0.2633374</td>
<td style="text-align:center">0.79229054</td>
<td style="text-align:center">0.9422796</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mcols(res,use.names= TRUE) <span class="comment"># 查看res矩阵每一列的含义</span></div></pre></td></tr></table></figure>
<blockquote>
<p>DataFrame with 6 rows and 2 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">type</th>
<th style="text-align:center">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><character></character></td>
<td style="text-align:center"><character></character></td>
</tr>
<tr>
<td style="text-align:center">baseMean</td>
<td style="text-align:center">intermediate</td>
<td style="text-align:center">mean of normalized counts for all samples</td>
</tr>
<tr>
<td style="text-align:center">log2FoldChange</td>
<td style="text-align:center">results</td>
<td style="text-align:center">log2 fold change (MLE): condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">lfcSE</td>
<td style="text-align:center">results</td>
<td style="text-align:center">standard error: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">stat</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald statistic: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">pvalue</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald test p-value: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">padj</td>
<td style="text-align:center">results</td>
<td style="text-align:center">BH adjusted p-values</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary(res) <span class="comment"># 对res矩阵进行总结</span></div></pre></td></tr></table></figure>
<blockquote>
<p>out of 28335 with nonzero total read count<br>adjusted p-value &lt; 0.1<br>LFC &gt; 0 (up)     : 445, 1.6%<br>LFC &lt; 0 (down)   : 625, 2.2%<br>outliers [1]     : 0, 0%<br>low counts [2]   : 12683, 45%<br>(mean count &lt; 18)<br>[1] see ‘cooksCutoff’ argument of ?results<br>[2] see ‘independentFiltering’ argument of ?results</p>
</blockquote>
<p>其中，445个基因表达上调，625个基因表达下降，可靠程度是：p-value &lt; 0.1</p>
<hr>
<p><strong>5、提取差异分析结果</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">table(res<span class="variable">$padj</span>&lt;0.05) <span class="comment"># 取padj小于0.05的数据，得到743行</span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">FALSE</th>
<th style="text-align:center">TRUE</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">14909</td>
<td style="text-align:center">743</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res &lt;- res[order(res<span class="variable">$padj</span>),] <span class="comment"># 按照padj的大小将res重新排列</span></div><div class="line">diff_gene_deseq2 &lt;- subset(res,padj &lt; 0.05 &amp; (log2FoldChange &gt;1 | log2FoldChange &lt; -1)) <span class="comment"># 获取padj小于0.05，表达倍数取以2为对数后绝对值大于1的差异表达基因，赋值给diff_gene_deseq2</span></div><div class="line">head (diff_gene_deseq2, n=5) <span class="comment"># 查看diff_gene_deseq2矩阵的前5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
</tr>
<tr>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
</tr>
<tr>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
</tr>
<tr>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
<tr>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">diff_gene_deseq2 &lt;- row.names(diff_gene_deseq2) <span class="comment"># 提取diff_gene_deseq2的行名</span></div><div class="line">head (diff_gene_deseq2, n=5)</div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “ENSMUSG00000003309”<br>[2] “ENSMUSG00000046323”<br>[3] “ENSMUSG00000001123”<br>[4] “ENSMUSG00000018569”<br>[5] “ENSMUSG00000023906”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">resdata &lt;- merge (as.data.frame(res),as.data.frame(counts(dds,normalize=TRUE)),by=<span class="string">"row.names"</span>,sort=FALSE)</div><div class="line">head (resdata,n=5)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Row.names</th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FC</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
<td style="text-align:center">1073.9977</td>
<td style="text-align:center">908.7239</td>
<td style="text-align:center">125.93083</td>
<td style="text-align:center">84.11803</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
<td style="text-align:center">723.4828</td>
<td style="text-align:center">721.5049</td>
<td style="text-align:center">97.10329</td>
<td style="text-align:center">74.66657</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
<td style="text-align:center">679.8243</td>
<td style="text-align:center">515.6735</td>
<td style="text-align:center">84.96538</td>
<td style="text-align:center">86.95347</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1113.9140</td>
<td style="text-align:center">630.6325</td>
<td style="text-align:center">127.44807</td>
<td style="text-align:center">69.94083</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1862.3445</td>
<td style="text-align:center">1333.5250</td>
<td style="text-align:center">351.99943</td>
<td style="text-align:center">259.91526</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.csv(resdata, file=<span class="string">"control_vs_akap95.csv"</span>) <span class="comment"># 将结果写入control_vs_akap95.csv文件</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1、在R中安装DESeq2软件包&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>MAC安装DESeq2报错及解决方案</title>
    <link href="http://uteric.github.io/MAC%E5%AE%89%E8%A3%85DESeq2%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://uteric.github.io/MAC安装DESeq2报错及解决方案/</id>
    <published>2018-04-05T01:43:45.000Z</published>
    <updated>2018-04-05T01:43:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="在R环境中安装DESeq2"><a href="#在R环境中安装DESeq2" class="headerlink" title="在R环境中安装DESeq2"></a>在R环境中安装DESeq2</h2><p><strong>1、安装DESeq2基本语法：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div><div class="line">library(<span class="string">"DESeq2"</span>) <span class="comment"># 测试是否安装成功</span></div></pre></td></tr></table></figure>
<p><strong>2、报错信息</strong></p>
<p>我的系统是MacOS 10.10.5，执行安装命令后各种报错：</p>
<hr>
<p><del>fatal error:<br><strong>‘string.h’ file not found</strong><br>include <string.h>            /<em> for memcpy, memset </em>/<br>1 error generated.<br>make: <em>*</em> [000.init.o] Error 1<br>ERROR: compilation failed for package ‘matrixStats’</string.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘math.h’ file not found</strong><br>include_next <math.h><br>1 error generated.<br>make: <em>*</em> [DbColumn.o] Error 1<br>ERROR: compilation failed for package ‘RSQLite’</math.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘ctype.h’ file not found</strong><br>include <ctype.h><br>1 error generated.<br>make: <em>*</em> [DocParse.o] Error 1<br>ERROR: compilation failed for package ‘XML’</ctype.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdlib.h’ file not found</strong><br>include <stdlib.h> /<em> Not used by R itself, but widely assumed in packages </em>/<br>1 error generated.<br>make: <em>*</em> [all_missing.o] Error 1<br>ERROR: compilation failed for package ‘checkmate’</stdlib.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘string.h’ file not found</strong><br>include <string.h><br>/<em> for memcpy, memset </em>/<br>1 error generated.<br>make: <em>*</em> [AEbufs.o] Error 1<br>ERROR: compilation failed for package ‘S4Vectors’</string.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdio.h’ file not found</strong><br>include <stdio.h><br>1 error generated.<br>make: <em>*</em> [Rinit.o] Error 1<br>ERROR: compilation failed for package ‘Biobase’</stdio.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘unistd.h’ file not found</strong><br>include <unistd.h><br>1 error generated.<br>make: <em>*</em> [ipcmutex.o] Error 1<br>ERROR: compilation failed for package ‘BiocParallel’</unistd.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdlib.h’ file not found</strong><br>include <stdlib.h><br>1 error generated.<br>make: <em>*</em> [S_enter.o] Error 1<br>ERROR: compilation failed for package ‘locfit’</stdlib.h></del></p>
<hr>
<p><del>configure: error:<br><strong>cannot run C++ compiled programs.</strong><br>If you meant to cross compile, use <code>--host&#39;.
See</code>config.log’ for more details<br>ERROR: configuration failed for package ‘RcppArmadillo’</del></p>
<hr>
<p><em>There were 22 warnings (use warnings() to see them)</em><br><strong>warnings()</strong><br>Warning messages:<br>1: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘matrixStats’ had non-zero exit status<br>2: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘RSQLite’ had non-zero exit status<br>3: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘XML’ had non-zero exit status<br>4: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘checkmate’ had non-zero exit status<br>5: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘S4Vectors’ had non-zero exit status<br>6: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘Biobase’ had non-zero exit status<br>7: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘BiocParallel’ had non-zero exit status<br>8: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘locfit’ had non-zero exit status<br>9: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘RcppArmadillo’ had non-zero exit status<br>10: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘htmlTable’ had non-zero exit status<br>11: In install.packages(pkgs = doing, lib = lib, …) :<br> installation of package ‘IRanges’ had non-zero exit status<br>12: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘GenomeInfoDb’ had non-zero exit status<br>13: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘XVector’ had non-zero exit status<br>14: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘DelayedArray’ had non-zero exit status<br>15: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘AnnotationDbi’ had non-zero exit status<br>16: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘Hmisc’ had non-zero exit status<br>17: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘annotate’ had non-zero exit status<br>18: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘GenomicRanges’ had non-zero exit status<br>19: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘SummarizedExperiment’ had non-zero exit status<br>20: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘genefilter’ had non-zero exit status<br>21: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘geneplotter’ had non-zero exit status<br>22: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘DESeq2’ had non-zero exit status</p>
<hr>
<p><strong>3、报错原因</strong></p>
<p>根据返回的报错信息，可以知道，系统中缺乏’string.h’，’math.h’，’ctype.h’，’stdlib.h’，’stdio.h’，’unistd.h’这些文件，这些文件都是C++ library中得Header files，因此，需要安装C++，或者直接安装Xcode Command Line Tools。</p>
<hr>
<h2 id="安装Xcode命令行工具"><a href="#安装Xcode命令行工具" class="headerlink" title="安装Xcode命令行工具"></a>安装Xcode命令行工具</h2><p>Xcode Command Line Tools，包含一些命令行开发工具，例如gcc/g++编译器、make、git、nasm等，安装命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select --install <span class="comment"># 安装Xcode命令行工具（Xcode Command Line Tools）</span></div></pre></td></tr></table></figure>
<p>安装完成后，检查是否成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select -p <span class="comment"># 检查是否成功安装</span></div></pre></td></tr></table></figure>
<blockquote>
<p>/Applications/Xcode.app/Contents/Developer</p>
</blockquote>
<p>若看到如下信息，则表明Xcode Command Line Tools已经安装：</p>
<blockquote>
<p>xcode-select: error: command line tools are already installed, use “Software Update” to install update</p>
</blockquote>
<hr>
<h2 id="再次安装DESeq2"><a href="#再次安装DESeq2" class="headerlink" title="再次安装DESeq2"></a>再次安装DESeq2</h2><p>此时，就可以着手安装DESeq2软件包了，执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;在R环境中安装DESeq2&quot;&gt;&lt;a href=&quot;#在R环境中安装DESeq2&quot; class=&quot;headerlink&quot; title=&quot;在R环境中安装DESeq2&quot;&gt;&lt;/a&gt;在R环境中安装DESeq2&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;1、安装DESeq2基本语法：&lt;/s
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="MAC" scheme="http://uteric.github.io/tags/MAC/"/>
    
  </entry>
  
  <entry>
    <title>Hexo常用命令</title>
    <link href="http://uteric.github.io/Hexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://uteric.github.io/Hexo常用命令/</id>
    <published>2018-03-29T04:28:28.000Z</published>
    <updated>2018-03-29T04:28:28.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo-clean"><a href="#hexo-clean" class="headerlink" title="hexo clean"></a>hexo clean</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo clean <span class="comment"># 清除缓存文件db.json 和已生成的静态文件public</span></div></pre></td></tr></table></figure>
<h2 id="hexo-g"><a href="#hexo-g" class="headerlink" title="hexo g"></a>hexo g</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo g <span class="comment"># 是hexo generate的简写形式，生成静态文件到public文件夹</span></div></pre></td></tr></table></figure>
<h2 id="hexo-d"><a href="#hexo-d" class="headerlink" title="hexo d"></a>hexo d</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo d <span class="comment"># 是hexo deploy的简写形式，部署静态文件到设定的仓库</span></div></pre></td></tr></table></figure>
<h2 id="hexo-clean-amp-amp-hexo-g-amp-amp-hexo-d"><a href="#hexo-clean-amp-amp-hexo-g-amp-amp-hexo-d" class="headerlink" title="hexo clean &amp;&amp; hexo g &amp;&amp; hexo d"></a>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d <span class="comment"># 常用的组合命令，清除缓存，生成静态文件，并部署到指定仓库</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;hexo-clean&quot;&gt;&lt;a href=&quot;#hexo-clean&quot; class=&quot;headerlink&quot; title=&quot;hexo clean&quot;&gt;&lt;/a&gt;hexo clean&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="Hexo" scheme="http://uteric.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记1</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"/>
    <id>http://uteric.github.io/R语言学习笔记1/</id>
    <published>2018-03-28T04:26:51.000Z</published>
    <updated>2018-03-28T04:26:51.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="创建一个4-5的矩阵"><a href="#创建一个4-5的矩阵" class="headerlink" title="创建一个4*5的矩阵"></a>创建一个4*5的矩阵</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x &lt;- 1:20 <span class="comment"># 创建一个包含20个值的向量x，可以输入x查看：[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></div><div class="line">y &lt;- matrix (x, 4, 5) <span class="comment"># 使用向量x的值填充一个4行5列的矩阵</span></div><div class="line">y <span class="comment"># 查看y矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    2    6   10   14   18<br>[3,]    3    7   11   15   19<br>[4,]    4    8   12   16   20</p>
</blockquote>
<h2 id="删除行"><a href="#删除行" class="headerlink" title="删除行"></a>删除行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z1 &lt;- y [-2,] <span class="comment"># 删除y矩阵第2行，并赋值给z1矩阵</span></div><div class="line">z1 <span class="comment"># 查看z1矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>  [,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    3    7   11   15   19<br>[3,]    4    8   12   16   20</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z2 &lt;- y [-c(2,3),] <span class="comment"># 删除y矩阵第2，3行，并赋值给z2矩阵</span></div><div class="line">z2 <span class="comment"># 查看z2矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    4    8   12   16   20</p>
</blockquote>
<h2 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z3 &lt;- y [, 4] <span class="comment"># 删除y矩阵第4列，并赋值给z3矩阵</span></div><div class="line">z3 <span class="comment"># 查看z3矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3] [,4]<br>[1,]    1    5    9   17<br>[2,]    2    6   10   18<br>[3,]    3    7   11   19<br>[4,]    4    8   12   20</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z4 &lt;- y [,-c(3,4)] <span class="comment"># 删除y矩阵第3,4列，并赋值给z4矩阵</span></div><div class="line">z4 <span class="comment"># 查看z4矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3]<br>[1,]    1    5   17<br>[2,]    2    6   18<br>[3,]    3    7   19<br>[4,]    4    8   20</p>
</blockquote>
<h2 id="提取行"><a href="#提取行" class="headerlink" title="提取行"></a>提取行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z5 &lt;- y [2,] <span class="comment"># 提取y矩阵第2行，并赋值给z5矩阵</span></div><div class="line">z5 <span class="comment"># 查看z5矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1]  2  6 10 14 18</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z6 &lt;- y [c(2,3),] <span class="comment"># 提取y矩阵第2,3行，并赋值给z6矩阵</span></div><div class="line">z6 <span class="comment"># 查看z6矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3] [,4] [,5]<br>[1,]    2    6   10   14   18<br>[2,]    3    7   11   15   19</p>
</blockquote>
<h2 id="提取列"><a href="#提取列" class="headerlink" title="提取列"></a>提取列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z7 &lt;- y [, 3] <span class="comment"># 提取y矩阵第3列，并赋值给z7矩阵</span></div><div class="line">z7 <span class="comment"># 查看z7矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1]  9 10 11 12</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z8 &lt;- y [, c(3,5)] <span class="comment"># 提取y矩阵第3,5列，并赋值给z8矩阵</span></div><div class="line">z8 <span class="comment"># 查看z8矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2]<br>[1,]    9   17<br>[2,]   10   18<br>[3,]   11   19<br>[4,]   12   20</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;创建一个4-5的矩阵&quot;&gt;&lt;a href=&quot;#创建一个4-5的矩阵&quot; class=&quot;headerlink&quot; title=&quot;创建一个4*5的矩阵&quot;&gt;&lt;/a&gt;创建一个4*5的矩阵&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>MAC命令行操作MacVim</title>
    <link href="http://uteric.github.io/MAC%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9CMacVim/"/>
    <id>http://uteric.github.io/MAC命令行操作MacVim/</id>
    <published>2018-03-28T03:50:22.000Z</published>
    <updated>2018-03-28T03:50:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>1. 打开MacVim</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim ./test.md <span class="comment"># 打开当前目录下的名位test.md的文件</span></div></pre></td></tr></table></figure></p>
<p><strong>2. 在Vim中修改文件</strong><br>在Vim中打开的文件不能直接修改，如要插入字符，需要按下i键，进入INSERT模式，按下ESC则可退出INSERT模式。</p>
<p><strong>3. 退出Vim</strong></p>
<p><em>在末行模式下：</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">:qw <span class="comment"># 先保存文档，退出Vim，返回到Shell</span></div><div class="line">:q! <span class="comment">#放弃修改，直接返回到Shell</span></div></pre></td></tr></table></figure></p>
<p><em>在命令行模式下：</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ZZ <span class="comment"># 保存修改，退出Vim，返回到Shell</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;1. 打开MacVim&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="MAC" scheme="http://uteric.github.io/tags/MAC/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记7- HTSeq定量基因表达水平</title>
    <link href="http://uteric.github.io/RNASEQ%20HTSeq%E5%AE%9A%E9%87%8F%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/"/>
    <id>http://uteric.github.io/RNASEQ HTSeq定量基因表达水平/</id>
    <published>2018-03-28T03:24:05.000Z</published>
    <updated>2018-03-28T03:24:05.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HTseq统计基因reads数"><a href="#HTseq统计基因reads数" class="headerlink" title="HTseq统计基因reads数"></a>HTseq统计基因reads数</h2><p><strong>HTseq</strong>是用于分析基因表达量的软件，能够根据基因结构注释GTF文件对排序过的SAM/BAM文件进行基因reads数的统计。</p>
<p><em>语法：htseq-count [options]</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir -p ncbi/matrix/ 在ncbi目录下创建matrix文件夹，用于存放HTseq生成的.count文件。-p (-parents)，加上此选项后，系统将自动建立那些尚不存在的目录。</div></pre></td></tr></table></figure>
<p>运行HTseq-count命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">htseq-count ~/ncbi/aligned/SRR3589959_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589959.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589960_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589960.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589961_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589961.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589962_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589962.count</div></pre></td></tr></table></figure>
<p>上述语法是将排序过的SAM文件（count.sam）进行reads数统计，并输出为.count文件（不用担心存储空间问题，每个文件仅1M左右）。此处，使用了绝对路径，也可以根据自己的情况选择使用相对路径。</p>
<p>为节省时间，可以将上述命令在4个终端中同时执行，大约需要2个小时左右可以完成，生成4个文件：</p>
<blockquote>
<p>SRR3589959.count<br>SRR3589960.count<br>SRR3589961.count<br>SRR3589962.count</p>
</blockquote>
<p>简单介绍一下.count文件的格式，在命令行下查看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~/ncbi/matrix <span class="comment"># 切换到.count文件所在的matrix目录</span></div><div class="line">head -n 10 SRR3589959.count <span class="comment"># 使用head命令查看SRR3589959.count文件的前10行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>ENSMUSG00000000001.4    1648<br>ENSMUSG00000000003.15    0<br>ENSMUSG00000000028.14    835<br>ENSMUSG00000000031.15    65<br>ENSMUSG00000000037.16    70<br>ENSMUSG00000000049.11    0<br>ENSMUSG00000000056.7 366<br>ENSMUSG00000000058.6    7<br>ENSMUSG00000000078.6    558<br>ENSMUSG00000000085.16    286</p>
</blockquote>
<p><strong>.count</strong>文件分为2列，第一列是基因名称（ENSMUSG00000000001.4），第二列是reads数（1648），由此可见，htseq-count命令的目的是将排序过的SAM文件（001，003，0028，0031，0037……）逐个统计reads数，但是，此时生成的.count文件只有两列。</p>
<p>因为所有的.count文件都排过序，并且共享相同的基因名称，所以下一步是将所有的.count文件合并起来，生成一个统一的文件，需要使用R语言脚本将4个.count文件合并为一个表达矩阵。</p>
<h2 id="R语言脚本合并表达矩阵"><a href="#R语言脚本合并表达矩阵" class="headerlink" title="R语言脚本合并表达矩阵"></a>R语言脚本合并表达矩阵</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">R <span class="comment"># 在命令行下输入R，进入R环境</span></div><div class="line">options(stringsAsFactors = FALSE) <span class="comment">#默认为TRUE，不要辨认为factors</span></div><div class="line"></div><div class="line"><span class="comment"># 59，61为对照组，60，62为处理组，首先将四个文件分别赋值为：control1，control2，rep1，rep2</span></div><div class="line">control1 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589959.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control1"</span>))</div><div class="line">control2 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589961.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control2"</span>))</div><div class="line">rep1 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589960.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"rep1"</span>))</div><div class="line">rep2 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589962.count"</span>, sep=<span class="string">"\t"</span>,col.names = c(<span class="string">"gene_id"</span>,<span class="string">"rep2"</span>))</div><div class="line"></div><div class="line"><span class="comment"># 将4个矩阵文件按照gene_id进行合并，首先组内合并，接着组间合并，并且赋值给raw_count</span></div><div class="line">raw_count &lt;- merge(merge(control1, control2, by=<span class="string">"gene_id"</span>), merge(rep1,rep2, by=<span class="string">"gene_id"</span>))</div></pre></td></tr></table></figure>
<p>对raw_count进行赋值后，我们可以查看生成的合并矩阵：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count <span class="comment"># 查看合并矩阵</span></div></pre></td></tr></table></figure>
<p>但是raw_count文件太长，只能输出19999行，显示达到最大输出量：</p>
<blockquote>
<p>[ reached getOption(“max.print”) – omitted 28826 rows ]</p>
</blockquote>
<p>因此，我们只显示前10行数据，来查看一下生成的矩阵的格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head (raw_count, n=10) <span class="comment">#查看raw_count的前10行</span></div></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<blockquote>
<p> gene_id control1 control2 rep1 rep2<br>1   ENSMUSG00000000001.4     1648     2306 2941 2780<br>2  ENSMUSG00000000003.15        0        0    0    0<br>3  ENSMUSG00000000028.14      835      950 1366 1051<br>4  ENSMUSG00000000031.15       65       83   52   53<br>5  ENSMUSG00000000037.16       70       53   94   66<br>6  ENSMUSG00000000049.11        0        3    4    5<br>7   ENSMUSG00000000056.7      366      386  722  301<br>8   ENSMUSG00000000058.6        7       11    7    3<br>9   ENSMUSG00000000078.6      558      896 1265 1342<br>10 ENSMUSG00000000085.16      286      313  343  348</p>
</blockquote>
<p>合并后的矩阵共有5列，第一列是基因名称，其余四列分别是control1，control2，rep1，rep2，从上表中可以很直观地看到每个基因的表达情况。</p>
<p>我们再来看看raw_count的最后5行，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (raw_count, n=5)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>gene_id control1 control2     rep1     rep2<br>48821 <strong>alignment_not_unique 11278964 14080481 18440618 14495860<br>48822            </strong>ambiguous   295498   425708   498973   381237<br>48823           <strong>no_feature 12642161 15042888 22357626 18675857<br>48824          </strong>not_aligned  1025857  1067038  1675660  1529309<br>48825        __too_low_aQual  1107674  1303141  1799176  1542845</p>
</blockquote>
<p>这5行（48821， 48822， 48823， 48824， 48825）没有匹配到相应的基因，需要删除，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt &lt;- raw_count[-48821:-48825, ] <span class="comment"># 删除5行，重新赋值给raw_count_filt</span></div></pre></td></tr></table></figure>
<p>查看新矩阵raw_count_filt的最后5行，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (raw_count_filt, n=5)</div></pre></td></tr></table></figure>
<p>可以看到，48821：48825已经被删除了，</p>
<blockquote>
<p>gene_id control1 control2 rep1 rep2<br>48816 ENSMUSG00000110420.1        0        0    0    0<br>48817 ENSMUSG00000110421.1        0        0    0    1<br>48818 ENSMUSG00000110422.1        1        0    1    2<br>48819 ENSMUSG00000110423.1        0        0    0    0<br>48820 ENSMUSG00000110424.1       26       20   48   24</p>
</blockquote>
<p>以行48820为例，第一列是基因名称ENSMUSG00000110424.1，但是这个名称在<a href="https://www.ebi.ac.uk/" target="_blank" rel="external">EBI</a>数据库上是不能直接检索到的，只能是整数形式的ENSMUSG00000110424，因此，需要进一步替换为整数的形式，并且赋值给ENSEMBL。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ENSEMBL &lt;- gsub(<span class="string">"\\.\\d*"</span>, <span class="string">""</span>, raw_count_filt<span class="variable">$gene_id</span>)</div><div class="line">tail (ENSEMBL, n=5) <span class="comment"># 查看ENSEMBL的最后5行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>[1] “ENSMUSG00000110420” “ENSMUSG00000110421” “ENSMUSG00000110422”<br>[4] “ENSMUSG00000110423” “ENSMUSG00000110424”</p>
</blockquote>
<p>ENSEMBL只有一列，即修改为整数的基因名称，下一步再将ENSEMBL添加到raw_count_filt矩阵:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">row.names(raw_count_filt) &lt;- ENSEMBL <span class="comment"># 添加ENSENBL到raw_count_filt矩阵</span></div><div class="line">tail (raw_count_filt, n=5) <span class="comment"># 查看raw_count_filt的最后5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>gene_id control1 control2 rep1 rep2<br>ENSMUSG00000110420 ENSMUSG00000110420.1        0        0    0    0<br>ENSMUSG00000110421 ENSMUSG00000110421.1        0        0    0    1<br>ENSMUSG00000110422 ENSMUSG00000110422.1        1        0    1    2<br>ENSMUSG00000110423 ENSMUSG00000110423.1        0        0    0    0<br>ENSMUSG00000110424 ENSMUSG00000110424.1       26       20   48   24</p>
</blockquote>
<p>[optional] 这一步选做，即把raw_count_filt矩阵的第二列删掉，并赋值给raw_count_filt2：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">raw_count_filt2 &lt;- raw_count_filt [ ,-1] <span class="comment"># 删除raw_count_filt的第二列</span></div><div class="line">tail (raw_count_filt2, n=5) <span class="comment"># 查看raw_count_filt2最后5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>control1 control2 rep1 rep2<br>ENSMUSG00000110420        0        0    0    0<br>ENSMUSG00000110421        0        0    0    1<br>ENSMUSG00000110422        1        0    1    2<br>ENSMUSG00000110423        0        0    0    0<br>ENSMUSG00000110424       26       20   48   24</p>
</blockquote>
<p>下面，我们就可以检查一些基因的表达情况了，比如GAPDH，首先，可以在<a href="http://www.uniprot.org/" target="_blank" rel="external">uniprot</a>或者<a href="http://useast.ensembl.org/index.html" target="_blank" rel="external">Ensembl</a>数据库中找到GAPDH对应的基因编号，即ENSMUSG00000057666，并将该基因编号赋值给GAPDH：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GAPDH &lt;- raw_count_filt2 [rownames(raw_count_filt2)==<span class="string">"ENSMUSG00000057666"</span>,] <span class="comment"># 赋值给GAPDH</span></div><div class="line">GAPDH <span class="comment"># 查看GAPDH表达情况</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>control1 control2 rep1 rep2<br>ENSMUSG00000057666     4136     4884 7200 4929</p>
</blockquote>
<p>如要查询其他基因的表达情况，以此类推！</p>
<p>另外，我们也可以看一看所有基因的表达概况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary (raw-count_filt2)</div></pre></td></tr></table></figure>
<blockquote>
<p>control1           control2             rep1               rep2<br> Min.   :     0.0   Min.   :     0.0   Min.   :     0.0   Min.   :     0.0<br> 1st Qu.:     0.0   1st Qu.:     0.0   1st Qu.:     0.0   1st Qu.:     0.0<br> Median :     0.0   Median :     0.0   Median :     1.0   Median :     1.0<br> Mean   :   237.6   Mean   :   290.6   Mean   :   417.4   Mean   :   342.2<br> 3rd Qu.:    62.0   3rd Qu.:    65.0   3rd Qu.:    93.0   3rd Qu.:    71.0<br> Max.   :108056.0   Max.   :164091.0   Max.   :171319.0   Max.   :132792.0</p>
</blockquote>
<p>如果想要把分析结果保存下来，则存储为.csv格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.csv (x=raw_count_filt2, file=<span class="string">"SRR35899.csv"</span>) <span class="comment"># 保存raw_count_filt2矩阵为SRR35899.csv文件，保存位置在当前命令行目录中</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;HTseq统计基因reads数&quot;&gt;&lt;a href=&quot;#HTseq统计基因reads数&quot; class=&quot;headerlink&quot; title=&quot;HTseq统计基因reads数&quot;&gt;&lt;/a&gt;HTseq统计基因reads数&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;HTseq&lt;/str
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记6-下载注释文件并导入IGV</title>
    <link href="http://uteric.github.io/RNASEQ%E4%B8%8B%E8%BD%BD%E6%B3%A8%E9%87%8A%E6%96%87%E4%BB%B6%E5%B9%B6%E5%AF%BC%E5%85%A5IGV/"/>
    <id>http://uteric.github.io/RNASEQ下载注释文件并导入IGV/</id>
    <published>2018-03-24T04:02:02.000Z</published>
    <updated>2018-03-24T04:02:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>注释文件下载流程</strong></p>
<p>进入Gencode网站（<a href="http://www.gencodegenes.org/%EF%BC%89" target="_blank" rel="external">http://www.gencodegenes.org/）</a>，data&gt;&gt;human&gt;&gt;GRCh37-mapped releases&gt;&gt;GENCODE release 26&gt;&gt;Comprehensive genome annotation/ GTF, GFF3</p>
<p>右键获取下载链接，使用wget命令进行下载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ncbi/hg19 <span class="comment">#切换到hg19目录下</span></div><div class="line">wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_26/GRCh37_mapping/gencode.v26lift37.annotation.gtf.gz <span class="comment"># 下载GTF文件</span></div><div class="line">wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_26/GRCh37_mapping/gencode.v26lift37.annotation.gff3.gz <span class="comment"># 下载GFF3文件</span></div></pre></td></tr></table></figure>
<p>文件下载完成后，使用gzip命令解压文件，同时删除压缩文件，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gzip -d gencode.v26lift37.annotation.gtf.gz <span class="comment"># 解压GTF文件</span></div><div class="line">gzip -d gencode.v26lift37.annotation.gff3.gz <span class="comment"># 解压GFF3文件</span></div></pre></td></tr></table></figure>
<p>使用ls命令查看当前目录下得文件，</p>
<blockquote>
<p>gencode.v26lift37.annotation.gff3<br>gencode.v26lift37.annotation.gtf<br>hg19.fa (之前下载并合并的参考基因组文件)</p>
</blockquote>
<p><strong>注释文件导入IGV流程</strong></p>
<p>IGV下载地址：<a href="http://software.broadinstitute.org/software/igv/download" target="_blank" rel="external">http://software.broadinstitute.org/software/igv/download</a></p>
<p>加载<em>hg19.fa</em>，点击Genome/load genome from files/hg19.fa<br>加载<em>gencode.v26lift37.annotation.gtf</em>与<em>gencode.v26lift37.annotation.gff3</em>，这两个文件不能直接加载，需要index文件，创建index文件流程如下：</p>
<ol>
<li>点击Tools/run igvtools/command选择sort，Input File选择GTF/GFF3文件，点击run，运行完成后会产生两个文件：gencode.v26lift37.annotation.sorted.gtf<br>gencode.v26lift37.annotation.sorted.gff3</li>
<li>点击Tools/run igvtools/command选择index，Input File选择 .sorted.gtf/ .sorted.gff3文件，点击run，运行完成后会产生另外两个文件：gencode.v26lift37.annotation.sorted.gtf.idx<br>gencode.v26lift37.annotation.sorted.gff3.idx</li>
<li>点击Genome/load genome from files/gencode.v26lift37.annotation.sorted.gtf.idx<br>点击Genome/load genome from files/gencode.v26lift37.annotation.sorted.gff3.idx<br>加载完成。</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;注释文件下载流程&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;进入Gencode网站（&lt;a href=&quot;http://www.gencodegenes.org/%EF%BC%89&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.ge
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记4-MAC安装RseQC</title>
    <link href="http://uteric.github.io/RNASEQ%E5%9C%A8MAC%E4%B8%AD%E5%AE%89%E8%A3%85RseQC/"/>
    <id>http://uteric.github.io/RNASEQ在MAC中安装RseQC/</id>
    <published>2018-03-24T03:38:56.000Z</published>
    <updated>2018-03-24T03:38:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>RseQC是对比对结果进行质控的工具，在MAC环境下，可以优先选用conda命令进行安装，不会报错。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install rseqc <span class="comment">#安装RseQC，注意都是小写</span></div></pre></td></tr></table></figure>
<p>Solving environment: /</p>
<p><em>The following packages will be downloaded:</em></p>
<table>
<thead>
<tr>
<th>package</th>
<th>build</th>
</tr>
</thead>
<tbody>
<tr>
<td>wheel-0.30.0</td>
<td>py27h677a027_1          66 KB</td>
</tr>
<tr>
<td>jedi-0.11.1</td>
<td>py27_0         297 KB</td>
</tr>
<tr>
<td>idna-2.6</td>
<td>py27hedea723_1         122 KB</td>
</tr>
<tr>
<td>python-2.7.14</td>
<td>h138c1fe_30        11.5 MB</td>
</tr>
<tr>
<td>backports.shutil_get_terminal_size-1.0.0</td>
<td>py27hc9115de_2           8 KB</td>
</tr>
<tr>
<td>pycparser-2.18</td>
<td>py27h0d28d88_1         167 KB</td>
</tr>
<tr>
<td>send2trash-1.5.0</td>
<td>py27_0          16 KB</td>
</tr>
<tr>
<td>bx-python-0.7.3</td>
<td>py27_0         863 KB  bioconda</td>
</tr>
<tr>
<td>ipython-5.4.1</td>
<td>py27_2        1014 KB</td>
</tr>
<tr>
<td>urllib3-1.22</td>
<td>py27hc3787e9_0         153 KB</td>
</tr>
<tr>
<td>configparser-3.5.0</td>
<td>py27hc7edf1b_0          35 KB</td>
</tr>
<tr>
<td>python-dateutil-2.3</td>
<td>py27_0         213 KB  bioconda</td>
</tr>
<tr>
<td>pygments-2.2.0</td>
<td>py27h1a556bb_0         1.3 MB</td>
</tr>
<tr>
<td>terminado-0.8.1</td>
<td>py27_1          20 KB</td>
</tr>
<tr>
<td>backports-1.0</td>
<td>py27hb4f9756_1           3 KB</td>
</tr>
<tr>
<td>testpath-0.3.1</td>
<td>py27h72d81a5_0          89 KB</td>
</tr>
<tr>
<td>notebook-5.4.0</td>
<td>py27_0         6.6 MB</td>
</tr>
<tr>
<td>pyopenssl-17.5.0</td>
<td>py27hfda213f_0          77 KB</td>
</tr>
<tr>
<td>decorator-4.2.1</td>
<td>py27_0          15 KB</td>
</tr>
<tr>
<td>webencodings-0.5.1</td>
<td>py27h19a9f58_1          19 KB</td>
</tr>
<tr>
<td>nbconvert-5.3.1</td>
<td>py27h6455e4c_0         394 KB</td>
</tr>
<tr>
<td>ipykernel-4.8.2</td>
<td>py27_0         143 KB</td>
</tr>
<tr>
<td>functools32-3.2.3.2</td>
<td>py27h8ceab06_1          22 KB</td>
</tr>
<tr>
<td>entrypoints-0.2.3</td>
<td>py27hd680fb1_2           9 KB</td>
</tr>
<tr>
<td>asn1crypto-0.24.0</td>
<td>py27_0         155 KB</td>
</tr>
<tr>
<td>pip-9.0.1</td>
<td>py27_5         2.2 MB</td>
</tr>
<tr>
<td>pyzmq-17.0.0</td>
<td>py27h1de35cc_0         393 KB</td>
</tr>
<tr>
<td>backports_abc-0.5</td>
<td>py27h6972548_0          12 KB</td>
</tr>
<tr>
<td>ruamel_yaml-0.15.35</td>
<td>py27h1de35cc_1         228 KB</td>
</tr>
<tr>
<td>backports.functools_lru_cache-1.5</td>
<td>py27_1           9 KB</td>
</tr>
<tr>
<td>scandir-1.7</td>
<td>py27h1de35cc_0          25 KB</td>
</tr>
<tr>
<td>setuptools-38.5.1</td>
<td>py27_0         509 KB</td>
</tr>
<tr>
<td>pyparsing-2.2.0</td>
<td>py27h5bb6aaf_0          94 KB</td>
</tr>
<tr>
<td>tornado-5.0</td>
<td>py27_0         618 KB</td>
</tr>
<tr>
<td>requests-2.18.4</td>
<td>py27h9b2b37c_1          91 KB</td>
</tr>
<tr>
<td>futures-3.2.0</td>
<td>py27h1b80678_0          24 KB</td>
</tr>
<tr>
<td>bleach-1.4.2</td>
<td>py27_0          31 KB  bioconda</td>
</tr>
<tr>
<td>kiwisolver-1.0.1</td>
<td>py27h9856860_0          57 KB</td>
</tr>
<tr>
<td>html5lib-1.0.1</td>
<td>py27h5233db4_0         188 KB</td>
</tr>
<tr>
<td>cycler-0.10.0</td>
<td>py27hfc73c78_0          13 KB</td>
</tr>
<tr>
<td>singledispatch-3.4.0.3</td>
<td>py27he22c18d_0          15 KB</td>
</tr>
<tr>
<td>jsonschema-2.6.0</td>
<td>py27hd9b497e_0          61 KB</td>
</tr>
<tr>
<td>numpy-1.14.2</td>
<td>py27ha9ae307_0         3.9 MB</td>
</tr>
<tr>
<td>nbformat-4.4.0</td>
<td>py27hddc86d0_0         136 KB</td>
</tr>
<tr>
<td>pandocfilters-1.4.2</td>
<td>py27hed78c4e_1          12 KB</td>
</tr>
<tr>
<td>pickleshare-0.7.4</td>
<td>py27h37e3d41_0          11 KB</td>
</tr>
<tr>
<td>jupyter_client-5.2.2</td>
<td>py27_0         121 KB</td>
</tr>
<tr>
<td>prompt_toolkit-1.0.15</td>
<td>py27h4a7b9c2_0         333 KB</td>
</tr>
<tr>
<td>jupyter_core-4.4.0</td>
<td>py27h5ea6ba4_0          60 KB</td>
</tr>
<tr>
<td>cython-0.27.3</td>
<td>py27h6429b90_0         2.6 MB</td>
</tr>
<tr>
<td>ipython_genutils-0.2.0</td>
<td>py27h8b9a179_0          38 KB</td>
</tr>
<tr>
<td>pytz-2018.3</td>
<td>py27_0         211 KB</td>
</tr>
<tr>
<td>markupsafe-1.0</td>
<td>py27hd3c86fa_1          23 KB</td>
</tr>
<tr>
<td>conda-4.4.11</td>
<td>py27_0         931 KB</td>
</tr>
<tr>
<td>chardet-3.0.4</td>
<td>py27h2842e91_1         180 KB</td>
</tr>
<tr>
<td>appnope-0.1.0</td>
<td>py27hb466136_0           8 KB</td>
</tr>
<tr>
<td>ptyprocess-0.5.2</td>
<td>py27h70f6364_0          22 KB</td>
</tr>
<tr>
<td>six-1.11.0</td>
<td>py27h7252ba3_1          21 KB</td>
</tr>
<tr>
<td>pathlib2-2.3.0</td>
<td>py27he09da1e_0          31 KB</td>
</tr>
<tr>
<td>pysocks-1.6.8</td>
<td>py27_0          22 KB</td>
</tr>
<tr>
<td>parso-0.1.1</td>
<td>py27he57c4c6_0         115 KB</td>
</tr>
<tr>
<td>ipaddress-1.0.19</td>
<td>py27_0          32 KB</td>
</tr>
<tr>
<td>python.app-2</td>
<td>py27hf2d5e94_7          11 KB</td>
</tr>
<tr>
<td>wcwidth-0.1.7</td>
<td>py27h817c265_0          25 KB</td>
</tr>
<tr>
<td>matplotlib-2.2.0</td>
<td>py27hfa7797c_0         6.6 MB</td>
</tr>
<tr>
<td>pycosat-0.6.3</td>
<td>py27h6c51c7e_0         106 KB</td>
</tr>
<tr>
<td>subprocess32-3.2.7</td>
<td>py27h24b2887_0          38 KB</td>
</tr>
<tr>
<td>htseq-0.9.1</td>
<td>py27_0         315 KB  bioconda</td>
</tr>
<tr>
<td>rseqc-2.6.4</td>
<td>py27_0         228 KB  bioconda</td>
</tr>
<tr>
<td>certifi-2018.1.18</td>
<td>py27_0         143 KB</td>
</tr>
<tr>
<td>simplegeneric-0.8.1</td>
<td>py27_2           9 KB</td>
</tr>
<tr>
<td>mistune-0.8.3</td>
<td>py27_0          52 KB</td>
</tr>
<tr>
<td>pexpect-4.4.0</td>
<td>py27_0          70 KB</td>
</tr>
<tr>
<td>pysam-0.14.0</td>
<td>py27_htslib1.7_2         2.0 MB  bioconda</td>
</tr>
<tr>
<td>jinja2-2.10</td>
<td>py27h70b8dc5_0         177 KB</td>
</tr>
<tr>
<td>hisat2-2.1.0</td>
<td>py27pl5.22.0_0         6.9 MB  bioconda</td>
</tr>
<tr>
<td>enum34-1.1.6</td>
<td>py27hf475452_1          57 KB</td>
</tr>
<tr>
<td>cffi-1.11.5</td>
<td>py27h342bebf_0         201 KB</td>
</tr>
<tr>
<td>traitlets-4.3.2</td>
<td>py27hcf08151_0         126 KB</td>
</tr>
<tr>
<td>cryptography-2.1.4</td>
<td>py27hdbc5e8f_0         548 KB</td>
</tr>
</tbody>
</table>
<p>——————————————————-Total:        54.1 MB</p>
<p><em>The following NEW packages will be INSTALLED:</em></p>
<p>backports:                          1.0-py27hb4f9756_1<br>backports.functools_lru_cache:      1.5-py27_1<br>backports.shutil_get_terminal_size: 1.0.0-py27hc9115de_2<br>backports_abc:                      0.5-py27h6972548_0<br>bx-python:                          0.7.3-py27_0            bioconda<br>configparser:                       3.5.0-py27hc7edf1b_0<br>cython:                             0.27.3-py27h6429b90_0<br>enum34:                             1.1.6-py27hf475452_1<br>functools32:                        3.2.3.2-py27h8ceab06_1<br>futures:                            3.2.0-py27h1b80678_0<br>ipaddress:                          1.0.19-py27_0<br>pathlib2:                           2.3.0-py27he09da1e_0<br>rseqc:                              2.6.4-py27_0            bioconda<br>scandir:                            1.7-py27h1de35cc_0<br>singledispatch:                     3.4.0.3-py27he22c18d_0<br>subprocess32:                       3.2.7-py27h24b2887_0</p>
<p><em>The following packages will be UPDATED:</em></p>
<p>appnope:                            0.1.0-py36hf537a9a_0             –&gt; 0.1.0-py27hb466136_0<br>asn1crypto:                         0.24.0-py36_0                    –&gt; 0.24.0-py27_0<br>bleach:                             1.4.2-py36_0            bioconda –&gt; 1.4.2-py27_0            bioconda<br>certifi:                            2018.1.18-py36_0                 –&gt; 2018.1.18-py27_0<br>cffi:                               1.11.4-py36h342bebf_0            –&gt; 1.11.5-py27h342bebf_0<br>chardet:                            3.0.4-py36h96c241c_1             –&gt; 3.0.4-py27h2842e91_1<br>conda:                              4.4.11-py36_0                    –&gt; 4.4.11-py27_0<br>cryptography:                       2.1.4-py36h842514c_0             –&gt; 2.1.4-py27hdbc5e8f_0<br>cycler:                             0.10.0-py36hfc81398_0            –&gt; 0.10.0-py27hfc73c78_0<br>decorator:                          4.2.1-py36_0                     –&gt; 4.2.1-py27_0<br>entrypoints:                        0.2.3-py36hd81d71f_2             –&gt; 0.2.3-py27hd680fb1_2<br>hisat2:                             2.1.0-py36pl5.22.0_0    bioconda –&gt; 2.1.0-py27pl5.22.0_0    bioconda<br>html5lib:                           1.0.1-py36h2f9c1c0_0             –&gt; 1.0.1-py27h5233db4_0<br>htseq:                              0.9.1-py36_0            bioconda –&gt; 0.9.1-py27_0            bioconda<br>idna:                               2.6-py36h8628d0a_1               –&gt; 2.6-py27hedea723_1<br>ipykernel:                          4.8.2-py36_0                     –&gt; 4.8.2-py27_0<br>ipython_genutils:                   0.2.0-py36h241746c_0             –&gt; 0.2.0-py27h8b9a179_0<br>jedi:                               0.11.1-py36_0                    –&gt; 0.11.1-py27_0<br>jinja2:                             2.10-py36hd36f9c5_0              –&gt; 2.10-py27h70b8dc5_0<br>jsonschema:                         2.6.0-py36hb385e00_0             –&gt; 2.6.0-py27hd9b497e_0<br>jupyter_client:                     5.2.2-py36_0                     –&gt; 5.2.2-py27_0<br>jupyter_core:                       4.4.0-py36h79cf704_0             –&gt; 4.4.0-py27h5ea6ba4_0<br>kiwisolver:                         1.0.1-py36h792292d_0             –&gt; 1.0.1-py27h9856860_0<br>markupsafe:                         1.0-py36h3a1e703_1               –&gt; 1.0-py27hd3c86fa_1<br>matplotlib:                         2.2.0-py36hfa7797c_0             –&gt; 2.2.0-py27hfa7797c_0<br>mistune:                            0.8.3-py36_0                     –&gt; 0.8.3-py27_0<br>nbconvert:                          5.3.1-py36h810822e_0             –&gt; 5.3.1-py27h6455e4c_0<br>nbformat:                           4.4.0-py36h827af21_0             –&gt; 4.4.0-py27hddc86d0_0<br>notebook:                           5.4.0-py36_0                     –&gt; 5.4.0-py27_0<br>numpy:                              1.14.2-py36ha9ae307_0            –&gt; 1.14.2-py27ha9ae307_0<br>pandocfilters:                      1.4.2-py36h3b0b094_1             –&gt; 1.4.2-py27hed78c4e_1<br>parso:                              0.1.1-py36hc90e01c_0             –&gt; 0.1.1-py27he57c4c6_0<br>pexpect:                            4.4.0-py36_0                     –&gt; 4.4.0-py27_0<br>pickleshare:                        0.7.4-py36hf512f8e_0             –&gt; 0.7.4-py27h37e3d41_0<br>pip:                                9.0.1-py36h1555ced_4             –&gt; 9.0.1-py27_5<br>prompt_toolkit:                     1.0.15-py36haeda067_0            –&gt; 1.0.15-py27h4a7b9c2_0<br>ptyprocess:                         0.5.2-py36he6521c3_0             –&gt; 0.5.2-py27h70f6364_0<br>pycosat:                            0.6.3-py36hee92d8f_0             –&gt; 0.6.3-py27h6c51c7e_0<br>pycparser:                          2.18-py36h724b2fc_1              –&gt; 2.18-py27h0d28d88_1<br>pygments:                           2.2.0-py36h240cd3f_0             –&gt; 2.2.0-py27h1a556bb_0<br>pyopenssl:                          17.5.0-py36h51e4350_0            –&gt; 17.5.0-py27hfda213f_0<br>pyparsing:                          2.2.0-py36hb281f35_0             –&gt; 2.2.0-py27h5bb6aaf_0<br>pysam:                              0.14.0-py36_htslib1.7_2 bioconda –&gt; 0.14.0-py27_htslib1.7_2 bioconda<br>pysocks:                            1.6.7-py36hfa33cec_1             –&gt; 1.6.8-py27_0<br>python.app:                         2-py36h54569d5_7                 –&gt; 2-py27hf2d5e94_7<br>pytz:                               2018.3-py36_0                    –&gt; 2018.3-py27_0<br>pyzmq:                              17.0.0-py36h1de35cc_0            –&gt; 17.0.0-py27h1de35cc_0<br>requests:                           2.18.4-py36h4516966_1            –&gt; 2.18.4-py27h9b2b37c_1<br>ruamel_yaml:                        0.15.35-py36h1de35cc_1           –&gt; 0.15.35-py27h1de35cc_1<br>send2trash:                         1.5.0-py36_0                     –&gt; 1.5.0-py27_0<br>setuptools:                         38.4.0-py36_0                    –&gt; 38.5.1-py27_0<br>simplegeneric:                      0.8.1-py36_2                     –&gt; 0.8.1-py27_2<br>six:                                1.11.0-py36h0e22d5e_1            –&gt; 1.11.0-py27h7252ba3_1<br>terminado:                          0.8.1-py36_1                     –&gt; 0.8.1-py27_1<br>testpath:                           0.3.1-py36h625a49b_0             –&gt; 0.3.1-py27h72d81a5_0<br>tornado:                            5.0-py36_0                       –&gt; 5.0-py27_0<br>traitlets:                          4.3.2-py36h65bd3ce_0             –&gt; 4.3.2-py27hcf08151_0<br>urllib3:                            1.22-py36h68b9469_0              –&gt; 1.22-py27hc3787e9_0<br>wcwidth:                            0.1.7-py36h8c6ec74_0             –&gt; 0.1.7-py27h817c265_0<br>webencodings:                       0.5.1-py36h3b9701d_1             –&gt; 0.5.1-py27h19a9f58_1<br>wheel:                              0.30.0-py36h5eb2c71_1            –&gt; 0.30.0-py27h677a027_1</p>
<p><em>The following packages will be DOWNGRADED:</em></p>
<p>ipython:                            6.2.1-py36h3dda519_1             –&gt; 5.4.1-py27_2<br>python:                             3.6.4-hc167b69_1                 –&gt; 2.7.14-h138c1fe_30<br>python-dateutil:                    2.7.0-py36_0                     –&gt; 2.3-py27_0              bioconda</p>
<p>询问是否继续？ Proceed ([y]/n)? y<br>输入y以完成安装。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RseQC是对比对结果进行质控的工具，在MAC环境下，可以优先选用conda命令进行安装，不会报错。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记3-HISAT2建立索引并比对序列</title>
    <link href="http://uteric.github.io/RNASEQ%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95%E5%B9%B6%E6%AF%94%E5%AF%B9%E5%BA%8F%E5%88%97/"/>
    <id>http://uteric.github.io/RNASEQ建立索引并比对序列/</id>
    <published>2018-03-24T03:28:24.000Z</published>
    <updated>2018-03-24T03:28:24.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>建立HISAT2索引</strong></p>
<pre><code>hisat2-build -p 4 hg19.fa genome
</code></pre><p>命令运行完成后，会在hg19文件夹下生成如下文件：</p>
<blockquote>
<p>genome.1.ht2<br>genome.2.ht2<br>genome.3.ht2<br>genome.4.ht2<br>genome.5.ht2<br>genome.6.ht2<br>genome.7.ht2<br>genome.8.ht2</p>
</blockquote>
<p>建立索引文件需要大约一个小时（MAC: 2.6 GHz Intel Core i5/ 8 GB 1600 MHz DDR3），记录如下：</p>
<blockquote>
<p>Total time for call to driver() for forward index: 01:01:06</p>
</blockquote>
<p>或者，也可以直接在hisat2官网下载，文件大小大约3.9GB：<a href="http://ccb.jhu.edu/software/hisat2/index.shtml" target="_blank" rel="external">http://ccb.jhu.edu/software/hisat2/index.shtml</a></p>
<pre><code>wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/hg19.tar.gz
tar -zxvf hg19.tar.gz
</code></pre><hr>
<p><strong>使用HISAT2进行序列比对</strong></p>
<p>命令行目录：~<br>hg19 index目录：ncbi/hg19<br>fastq文件目录: miniconda3/fastq<br>输出目录：ncbi/aligned</p>
<p>注释：-t 记录运行时间 -x hg19 index 文件路径 -1 -2 测序的两个fastq文件 -S 比对结果输出路径</p>
<pre><code>hisat2 -t -x ncbi/hg19/genome -1 miniconda3/fastq/SRR3589956.sra_1.fastq.gz -2 miniconda3/fastq/SRR3589956.sra_2.fastq.gz -S ncbi/aligned/SRR3589956.sam
</code></pre><p>结果如下：</p>
<blockquote>
<p>Time loading forward index: 00:00:07<br>Time loading reference: 00:00:02<br>Multiseed full-index search: 00:39:18<br>28856780 reads; of these:<br>  28856780 (100.00%) were paired; of these:<br>    1838758 (6.37%) aligned concordantly 0 times<br>    24733251 (85.71%) aligned concordantly exactly 1 time</p>
<pre><code>2284771 (7.92%) aligned concordantly &gt;1 times
----
1838758 pairs aligned concordantly 0 times; of these:
  90903 (4.94%) aligned discordantly 1 time
----
1747855 pairs aligned 0 times concordantly or discordantly; of these:
  3495710 mates make up the pairs; of these:
    2034757 (58.21%) aligned 0 times
    1221304 (34.94%) aligned exactly 1 time
    239649 (6.86%) aligned &gt;1 times
</code></pre><p>96.47% overall alignment rate<br>Time searching: 00:39:21<br>Overall time: 00:39:28</p>
</blockquote>
<p>此命令只单独比对SRR3589956，若要运行多个文件，则可以使用VIM新建srr.sh文件，内容如下：</p>
<pre><code>for i in `seq 57 58`
do
    hisat2 -t -x ncbi/hg19/genome -1 miniconda3/fastq/SRR35899${i}.sra_1.fastq.gz -2 miniconda3/fastq/SRR35899${i}.sra_2.fastq.gz -S ncbi/aligned/SRR35899${i}.sam
done
</code></pre><p>注意，新建的srr.sh文件是不能直接运行的，因为默认新建的shell文件只有读和写得权限，因此需要首先添加执行的权限，命令如下：</p>
<pre><code>chmod +x srr.sh
</code></pre><p>此时，srr.sh文件就可以执行了，在命令行目录下运行：</p>
<pre><code>./srr.sh
</code></pre><p>即可开始执行多个文件的比对。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;建立HISAT2索引&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hisat2-build -p 4 hg19.fa genome
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;命令运行完成后，会在hg19文件夹下生成如下文件：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>Mac命令行查看硬盘状态</title>
    <link href="http://uteric.github.io/Mac%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%9F%A5%E7%9C%8B%E7%A1%AC%E7%9B%98%E7%8A%B6%E6%80%81/"/>
    <id>http://uteric.github.io/Mac命令行查看硬盘状态/</id>
    <published>2018-03-23T03:29:47.000Z</published>
    <updated>2018-03-23T03:29:47.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="查看整个硬盘"><a href="#查看整个硬盘" class="headerlink" title="查看整个硬盘"></a>查看整个硬盘</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -h <span class="comment"># 查看整个硬盘的空间，h表明是人类可读的方式</span></div></pre></td></tr></table></figure>
<blockquote>
<p>Filesystem      Size   Used  Avail Capacity  iused    ifree %iused  Mounted on<br>/dev/disk1     233Gi  200Gi   33Gi    87% 52460543  8524799   86%   /<br>devfs          188Ki  188Ki    0Bi   100%      649        0  100%   /dev<br>map -hosts       0Bi    0Bi    0Bi   100%        0        0  100%   /net<br>map auto_home    0Bi    0Bi    0Bi   100%        0        0  100%   /home<br>/dev/disk2s1   931Gi  862Gi   70Gi    93%    97656 73042268    0%   /Volumes/TOSHIBA EXT</p>
</blockquote>
<h2 id="查看当前目录"><a href="#查看当前目录" class="headerlink" title="查看当前目录"></a>查看当前目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">du -d 1 -h <span class="comment"># 查看当前目录下所有文件占用的硬盘空间</span></div></pre></td></tr></table></figure>
<blockquote>
<p>2.9G    ./mothur #当前目录下有个mothur的文件夹，占用2.9GB<br>3.8G    . # 当前目录下其他文件占用3.8GB</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;查看整个硬盘&quot;&gt;&lt;a href=&quot;#查看整个硬盘&quot; class=&quot;headerlink&quot; title=&quot;查看整个硬盘&quot;&gt;&lt;/a&gt;查看整个硬盘&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="命令行" scheme="http://uteric.github.io/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>如何在命令行中运行shell文件</title>
    <link href="http://uteric.github.io/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%AD%E8%BF%90%E8%A1%8Cshell%E6%96%87%E4%BB%B6/"/>
    <id>http://uteric.github.io/如何在命令行中运行shell文件/</id>
    <published>2018-03-23T03:15:47.000Z</published>
    <updated>2018-03-23T03:15:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>使用VIM新建文本一个.sh，比如srawget.sh</p>
<p>打开终端，进入当前目录，输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./srawget.sh <span class="comment">#当前目录下执行srwaget.sh文件</span></div></pre></td></tr></table></figure>
<p>执行后返回：</p>
<blockquote>
<p>zsh: permission denied: ./srawget.sh</p>
</blockquote>
<p>发现.sh文件不能执行，为什么呢？</p>
<p>这是因为VIM新建的shell文件默认权限只有–r–w，即只能读写，不能执行，因此出现上述错误，解决办法其实非常简单，只要修改.sh文件的权限即可，在终端中输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +x srawget.sh <span class="comment">#添加执行权限</span></div></pre></td></tr></table></figure>
<p>我们使用 ls -l 命令来查看一下，发现已经成功添加了执行权限，再次执行此命令即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./srawget.sh</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用VIM新建文本一个.sh，比如srawget.sh&lt;/p&gt;
&lt;p&gt;打开终端，进入当前目录，输入&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="命令行" scheme="http://uteric.github.io/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记1-软件安装</title>
    <link href="http://uteric.github.io/RNASEQ%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    <id>http://uteric.github.io/RNASEQ软件安装/</id>
    <published>2018-03-22T04:39:36.000Z</published>
    <updated>2018-03-22T04:39:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>RNASEQ的基本软件包括：<em>sra-tools, fastqc, hisat2, samtools, htseq, r, rstudio</em>，建议使用conda命令安装软件，降低出错概率，<em>conda is a tool for managing and deploying applications, environments and packages.</em></p>
<h2 id="miniconda3"><a href="#miniconda3" class="headerlink" title="miniconda3"></a>miniconda3</h2><p>在官网下载相应的版本，安装即可，<a href="https://conda.io/miniconda.html" target="_blank" rel="external">https://conda.io/miniconda.html</a></p>
<p>安装完成后，需要创建频道，命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">conda config --add channels conda-forge</div><div class="line">conda config --add channels defaults</div><div class="line">conda config --add channels r</div><div class="line">conda config --add channels bioconda</div></pre></td></tr></table></figure>
<p>如果使用iTerm2作为终端，conda可能无法执行：<em>command not found: conda</em></p>
<p>原因：终端是 iTerm2，安装了 zsh 和 oh-my-zsh，因此，打开终端时不再执行~/.bash_profile。</p>
<p>若使该文件有效，需要修改 zsh 的配置文件，方法如下：</p>
<p>编辑~/.zshrc，在文件末尾加入一行：</p>
<blockquote>
<p>source ~/.bash_profile</p>
</blockquote>
<p><strong>注意：</strong> .zshrc是一个位于根目录下的隐藏文件，如果要显示隐藏文件，请在终端中输入：</p>
<p>defaults write com.apple.finder AppleShowAllFiles -bool true;<br>KillAll Finder</p>
<h2 id="sra-tools"><a href="#sra-tools" class="headerlink" title="sra-tools"></a>sra-tools</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda sra-tools=2.8.1</div></pre></td></tr></table></figure>
<h2 id="fastqc"><a href="#fastqc" class="headerlink" title="fastqc"></a>fastqc</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install fastqc</div></pre></td></tr></table></figure>
<h2 id="hisat2"><a href="#hisat2" class="headerlink" title="hisat2"></a>hisat2</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install hisat2</div></pre></td></tr></table></figure>
<h2 id="samtools"><a href="#samtools" class="headerlink" title="samtools"></a>samtools</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install samtools</div></pre></td></tr></table></figure>
<h2 id="htseq"><a href="#htseq" class="headerlink" title="htseq"></a>htseq</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda htseq</div></pre></td></tr></table></figure>
<h2 id="R"><a href="#R" class="headerlink" title="R"></a>R</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install r</div></pre></td></tr></table></figure>
<h2 id="Rstudio"><a href="#Rstudio" class="headerlink" title="Rstudio"></a>Rstudio</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install rstudio</div></pre></td></tr></table></figure>
<h2 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h2><p>另外，下载NCBI上的原始数据（SRA文件），还需要用到wget，安装语法为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install wget</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RNASEQ的基本软件包括：&lt;em&gt;sra-tools, fastqc, hisat2, samtools, htseq, r, rstudio&lt;/em&gt;，建议使用conda命令安装软件，降低出错概率，&lt;em&gt;conda is a tool for managing an
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记2-下载原始数据</title>
    <link href="http://uteric.github.io/RNASEQ%E4%B8%8B%E8%BD%BD%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE/"/>
    <id>http://uteric.github.io/RNASEQ下载原始数据/</id>
    <published>2018-03-21T21:41:13.000Z</published>
    <updated>2018-03-21T21:41:13.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="获取原始数据地址"><a href="#获取原始数据地址" class="headerlink" title="获取原始数据地址"></a>获取原始数据地址</h2><p>参考文献：<em>AKAP95 regulates splicing through scaffolding RNAs and RNA processing factors. Nat Commun 2016 Nov 8;7:13347. PMID: 27824034</em></p>
<p>根据文献，原始数据下载地址如下：ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747， 该目录下共有如下文件：</p>
<blockquote>
<p>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589948/" target="_blank" rel="external">SRR3589948</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589949/" target="_blank" rel="external">SRR3589949</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589950/" target="_blank" rel="external">SRR3589950</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589951/" target="_blank" rel="external">SRR3589951</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589952/" target="_blank" rel="external">SRR3589952</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589953/" target="_blank" rel="external">SRR3589953</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589954/" target="_blank" rel="external">SRR3589954</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589955/" target="_blank" rel="external">SRR3589955</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589956/" target="_blank" rel="external">SRR3589956</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589957/" target="_blank" rel="external">SRR3589957</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589958/" target="_blank" rel="external">SRR3589958</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589959/" target="_blank" rel="external">SRR3589959</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589960/" target="_blank" rel="external">SRR3589960</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589961/" target="_blank" rel="external">SRR3589961</a> |  |<br>| 26/May/2016 00:00 |    dir    | <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589962/" target="_blank" rel="external">SRR3589962</a> |</p>
</blockquote>
<p>我们只对最后4个来自小鼠的测序数据进行分析，即*59-62.sra</p>
<h2 id="下载文件语法"><a href="#下载文件语法" class="headerlink" title="下载文件语法"></a>下载文件语法</h2><h4 id="单个文件下载"><a href="#单个文件下载" class="headerlink" title="单个文件下载"></a>单个文件下载</h4><p>本文以下载SRR3589959.sra为例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589959/SRR3589959.sra</div></pre></td></tr></table></figure></p>
<p>下载过程如下：</p>
<blockquote>
<p>–2018-03-21 14:52:21–  ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589959/SRR3589959.sra<br>=&gt; ‘SRR3589959.sra’<br>Resolving ftp-trace.ncbi.nlm.nih.gov… 130.14.250.10, 2607:f220:41e:250::12<br>Connecting to ftp-trace.ncbi.nlm.nih.gov|130.14.250.10|:21… connected.<br>Logging in as anonymous … Logged in!<br>==&gt; SYST … done.    ==&gt; PWD … done.<br>==&gt; TYPE I … done.  ==&gt; CWD (1) /sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR3589959 … done.<br>==&gt; SIZE SRR3589959.sra … 1321462823<br>==&gt; PASV … done.    ==&gt; RETR SRR3589959.sra … done.<br>Length: 1321462823 (1.2G) (unauthoritative)<br>SRR3589959.sra      100%[===================&gt;]   1.23G  3.82MB/s    in 11m 8s<br>2018-03-21 15:03:31 (1.89 MB/s) - ‘SRR3589959.sra’ saved [1321462823]</p>
</blockquote>
<p>文件大小1.2GB，耗时约11Mins</p>
<h4 id="批量下载文件"><a href="#批量下载文件" class="headerlink" title="批量下载文件"></a>批量下载文件</h4><p>批量依次下载SRR3589959.sra，SRR3589960.sra，SRR3589961.sra，SRR3589962.sra，四个文件，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ` seq 59 62`;</div><div class="line"><span class="keyword">do</span></div><div class="line">wget ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR35899<span class="variable">$&#123;i&#125;</span>/SRR35899<span class="variable">$&#123;i&#125;</span>.sra  </div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>
<p>将上述语法保存为*.sh文件，并在终端中执行即可。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;获取原始数据地址&quot;&gt;&lt;a href=&quot;#获取原始数据地址&quot; class=&quot;headerlink&quot; title=&quot;获取原始数据地址&quot;&gt;&lt;/a&gt;获取原始数据地址&lt;/h2&gt;&lt;p&gt;参考文献：&lt;em&gt;AKAP95 regulates splicing through sca
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记5-参考基因组下载</title>
    <link href="http://uteric.github.io/RNASEQ%E5%8F%82%E8%80%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E4%B8%8B%E8%BD%BD/"/>
    <id>http://uteric.github.io/RNASEQ参考基因组下载/</id>
    <published>2018-03-21T03:46:13.000Z</published>
    <updated>2018-03-21T03:46:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>进入<strong>UCSC</strong>网站（<a href="http://genome.ucsc.edu/" target="_blank" rel="external">http://genome.ucsc.edu/</a>  ），Downloads&gt;&gt;Genome Data&gt;&gt;Human&gt;&gt;Feb. 2009 (GRCh37/hg19)&gt;&gt;full data set&gt;&gt;chromFa.tar.gz，右键复制链接地址如下：<br><a href="http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz" target="_blank" rel="external">http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz</a></p>
<p>下载参考基因组的代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mkdir hg19 <span class="comment">#在ncbi目录下新建hg19文件夹</span></div><div class="line"><span class="built_in">cd</span> hg19 <span class="comment">#切换到ncbi/hg19目录</span></div><div class="line">wget http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz <span class="comment">#下载GRCh37/hg19，文件大约905M</span></div><div class="line">tar -zxvf  chromFa.tar.gz <span class="comment">#解压文件</span></div></pre></td></tr></table></figure>
<p>解压后出现一大堆文件：</p>
<blockquote>
<p>chr1.fa                  chr5.fa                  chrUn_gl000223.fa<br>chr10.fa                 chr6.fa                  chrUn_gl000224.fa<br>chr11.fa                 chr6_apd_hap1.fa         chrUn_gl000225.fa<br>chr11_gl000202_random.fa chr6_cox_hap2.fa         chrUn_gl000226.fa<br>chr12.fa                 chr6_dbb_hap3.fa         chrUn_gl000227.fa<br>chr13.fa                 chr6_mann_hap4.fa        chrUn_gl000228.fa<br>chr14.fa                 chr6_mcf_hap5.fa         chrUn_gl000229.fa<br>chr15.fa                 chr6_qbl_hap6.fa         chrUn_gl000230.fa<br>chr16.fa                 chr6_ssto_hap7.fa        chrUn_gl000231.fa<br>chr17.fa                 chr7.fa                  chrUn_gl000232.fa<br>chr17_ctg5_hap1.fa       chr7_gl000195_random.fa  chrUn_gl000233.fa<br>chr17_gl000203_random.fa chr8.fa                  chrUn_gl000234.fa<br>chr17_gl000204_random.fa chr8_gl000196_random.fa  chrUn_gl000235.fa<br>chr17_gl000205_random.fa chr8_gl000197_random.fa  chrUn_gl000236.fa<br>chr17_gl000206_random.fa chr9.fa                  chrUn_gl000237.fa<br>chr18.fa                 chr9_gl000198_random.fa  chrUn_gl000238.fa<br>chr18_gl000207_random.fa chr9_gl000199_random.fa  chrUn_gl000239.fa<br>chr19.fa                 chr9_gl000200_random.fa  chrUn_gl000240.fa<br>chr19_gl000208_random.fa chr9_gl000201_random.fa  chrUn_gl000241.fa<br>chr19_gl000209_random.fa chrM.fa                  chrUn_gl000242.fa<br>chr1_gl000191_random.fa  chrUn_gl000211.fa        chrUn_gl000243.fa<br>chr1_gl000192_random.fa  chrUn_gl000212.fa        chrUn_gl000244.fa<br>chr2.fa                  chrUn_gl000213.fa        chrUn_gl000245.fa<br>chr20.fa                 chrUn_gl000214.fa        chrUn_gl000246.fa<br>chr21.fa                 chrUn_gl000215.fa        chrUn_gl000247.fa<br>chr21_gl000210_random.fa chrUn_gl000216.fa        chrUn_gl000248.fa<br>chr22.fa                 chrUn_gl000217.fa        chrUn_gl000249.fa<br>chr3.fa                  chrUn_gl000218.fa        chrX.fa<br>chr4.fa                  chrUn_gl000219.fa        chrY.fa<br>chr4_ctg9_hap1.fa        chrUn_gl000220.fa        chromFa.tar.gz<br>chr4_gl000193_random.fa  chrUn_gl000221.fa<br>chr4_gl000194_random.fa  chrUn_gl000222.fa</p>
</blockquote>
<p>仔细观察这些解压出来的新文件，就会发现全部都是同一类型，chr*.fa，这为我们合并文件提供了极大的方便，代码如下：</p>
<p>cat *.fa&gt;hg19.fa #将当前文件夹下所有.fa结尾的文件合并为一个文件，即hg19.fa</p>
<p>删除其他无关的解压文件，以及参考基因组压缩文件，以节省空间，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rm chr*.fa <span class="comment">#删除chr*.fa格式的所有文件</span></div><div class="line">rm chromFa.tar.gz <span class="comment">#删除下载的参考基因组压缩文件</span></div><div class="line">ls -l <span class="comment">#显示当前目录下得文件以及属性</span></div></pre></td></tr></table></figure>
<p>结果如下，只有一个文件，即hg19.fa，</p>
<blockquote>
<p>-rw-r–r–  1 Administrator  staff  3199905909 Mar 16 23:07 hg19.fa</p>
</blockquote>
<p>到此为止，参考基因组就准备好了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;进入&lt;strong&gt;UCSC&lt;/strong&gt;网站（&lt;a href=&quot;http://genome.ucsc.edu/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://genome.ucsc.edu/&lt;/a&gt;  ），Downloads&amp;gt;&amp;g
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>英语笔记24：Purchase ticket/pass from a ticket vending machine</title>
    <link href="http://uteric.github.io/%E8%8B%B1%E8%AF%AD%E7%AC%94%E8%AE%B024/"/>
    <id>http://uteric.github.io/英语笔记24/</id>
    <published>2017-12-29T04:12:22.000Z</published>
    <updated>2017-12-29T04:12:22.000Z</updated>
    
    <content type="html"><![CDATA[<hr>
<ul>
<li>SELECT TICKET TYPE/PASS </li>
<li>INSERT MONEY </li>
<li>TICKET/PASS &amp; CHANGE</li>
</ul>
<hr>
<p>这是在TVM（Ticket Vending Machine，自动售票机）买票的三个步骤，选择行程，插入硬币或纸币，出票找零；</p>
<p><strong>Purchase ticket</strong>，买票，通常指Two-hour ticket，限2小时内乘车，不限次数，$2.5/ticket；<br><strong>Pass</strong>，通票，分为多种：</p>
<p>1) <strong>Midday pass</strong>，午间通票，<em>Midday pass allows unlimited travel between 9:30 a.m. and 2:30 p.m. Monday through Friday</em>，限周一至周五9:30 A.M.至2:30 P.M乘车；<br>2) <strong>Day passes</strong>，日票，$5.0/pass；<br>3) <strong>Monthly passes</strong>，月票；<br>4) <strong>7 days passes</strong>，7天通票；<br>5) <strong>31 days passes</strong>，31天通票；</p>
<p>在美国，进站上车并不检票，而是抽检，概率极低，但是一旦被发现无票乘车，后果是比较严重的；</p>
<p><em>Hold on to your ticket or pass and be prepared to show them to a DART Fare Enforcement Officer, DART Police Officer or other uniformed DART or TRE personnel.</em></p>
<p>检票人员有上述提到的几种：DART Fare Enforcement Officer（列车票价执法官员），DART Police Officer（列车警官），uniformed DART personnel（穿制服的工作人员）；</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;SELECT TICKET TYPE/PASS &lt;/li&gt;
&lt;li&gt;INSERT MONEY &lt;/li&gt;
&lt;li&gt;TICKET/PASS &amp;amp; CHANGE&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;这是在TVM（Ticket Vending Mac
    
    </summary>
    
      <category term="英语进阶" scheme="http://uteric.github.io/categories/%E8%8B%B1%E8%AF%AD%E8%BF%9B%E9%98%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>英语笔记23：Please Note That</title>
    <link href="http://uteric.github.io/%E8%8B%B1%E8%AF%AD%E7%AC%94%E8%AE%B023/"/>
    <id>http://uteric.github.io/英语笔记23/</id>
    <published>2017-12-29T04:11:06.000Z</published>
    <updated>2017-12-29T04:11:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>实验室秘书提醒我们明天的会议举行地点与往常不同：</p>
<ul>
<li><strong>*Please note that</strong> the presentation is in D202 and not D218.*</li>
</ul>
<p><strong>Please note that</strong>，请注意，<em>to ask people politely to pay attention to something</em></p>
<ul>
<li><em>Please note that there are a limited number of tickets</em> 请注意，票的数量有限；</li>
<li><em>Please note that the movie starts at 7 o’clock</em> 请注意，电影7点开始；</li>
<li><em>Visitors please note that the safekeeping of personal valuables, take good care of portable objects</em> 游客们，请注意妥善保管个人的贵重物品，照顾好随身物件；</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;实验室秘书提醒我们明天的会议举行地点与往常不同：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;*Please note that&lt;/strong&gt; the presentation is in D202 and not D218.*&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong
    
    </summary>
    
      <category term="英语进阶" scheme="http://uteric.github.io/categories/%E8%8B%B1%E8%AF%AD%E8%BF%9B%E9%98%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>英语笔记22：Calibrate</title>
    <link href="http://uteric.github.io/%E8%8B%B1%E8%AF%AD%E7%AC%94%E8%AE%B022/"/>
    <id>http://uteric.github.io/英语笔记22/</id>
    <published>2017-12-29T04:05:46.000Z</published>
    <updated>2017-12-29T04:05:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近，实验室的PH Meter测定结果不够准确，需要校准；Calibrate，即校准之意；</p>
<ul>
<li><em>This is the instruction on how to calibrate a thermometer</em></li>
<li><em>The thermometer needs calibration</em></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近，实验室的PH Meter测定结果不够准确，需要校准；Calibrate，即校准之意；&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;This is the instruction on how to calibrate a thermometer&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;e
    
    </summary>
    
      <category term="英语进阶" scheme="http://uteric.github.io/categories/%E8%8B%B1%E8%AF%AD%E8%BF%9B%E9%98%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>英语笔记21：Accept, Tentative, Decline</title>
    <link href="http://uteric.github.io/%E8%8B%B1%E8%AF%AD%E7%AC%94%E8%AE%B021/"/>
    <id>http://uteric.github.io/英语笔记21/</id>
    <published>2017-11-03T03:05:55.000Z</published>
    <updated>2017-11-03T03:05:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>受到邮件邀请时，通常会有如下三个选项：<strong>Accept</strong>，<strong>Tentative</strong>，<strong>Decline</strong>， 分别代表接受，暂定，拒绝；</p>
<p><strong>Tentative</strong>，不确定的，临时的，或作暂定；</p>
<ul>
<li><em>We made a tentative arrangement to meet on Friday.</em> 我们暂定星期五见面。</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;受到邮件邀请时，通常会有如下三个选项：&lt;strong&gt;Accept&lt;/strong&gt;，&lt;strong&gt;Tentative&lt;/strong&gt;，&lt;strong&gt;Decline&lt;/strong&gt;， 分别代表接受，暂定，拒绝；&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tentative&lt;/s
    
    </summary>
    
      <category term="英语进阶" scheme="http://uteric.github.io/categories/%E8%8B%B1%E8%AF%AD%E8%BF%9B%E9%98%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>英语笔记20：Janitor</title>
    <link href="http://uteric.github.io/%E8%8B%B1%E8%AF%AD%E7%AC%94%E8%AE%B020/"/>
    <id>http://uteric.github.io/英语笔记20/</id>
    <published>2017-11-03T03:01:55.000Z</published>
    <updated>2017-11-03T03:01:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>Janitor，门警，<em>a person employed as a caretaker of a building</em>，翻译为看门人或门卫或许更为合适；</p>
<ul>
<li><em>The janitor comes round to turn the lights out.</em></li>
</ul>
<p>相应地，School Janitor，指学校门卫；Janitor Room，指传达室；</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Janitor，门警，&lt;em&gt;a person employed as a caretaker of a building&lt;/em&gt;，翻译为看门人或门卫或许更为合适；&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;The janitor comes round to turn the 
    
    </summary>
    
      <category term="英语进阶" scheme="http://uteric.github.io/categories/%E8%8B%B1%E8%AF%AD%E8%BF%9B%E9%98%B6/"/>
    
    
  </entry>
  
</feed>
