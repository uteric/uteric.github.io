<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2018-10-06T04:22:07.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>R语言学习笔记8-集合运算</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/"/>
    <id>http://uteric.github.io/R语言学习笔记8/</id>
    <published>2018-10-06T04:22:07.000Z</published>
    <updated>2018-10-06T04:22:07.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、交集"><a href="#一、交集" class="headerlink" title="一、交集"></a>一、交集</h2><p>使用intersect计算两个向量的交集：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x=1:10</div><div class="line">y=3:15</div><div class="line">z=5:9</div><div class="line"><span class="comment"># 定义x, y, z三个向量</span></div><div class="line">intersect(x,y)</div><div class="line"><span class="comment"># 3  4  5  6  7  8  9 10</span></div><div class="line">intersect(x,y,z)</div><div class="line"><span class="comment"># Error in intersect(x, y, z) : 参数没有用(z) #若使用intersect计算三个向量的交集，则会报错</span></div></pre></td></tr></table></figure>
<p>使用intersect计算两个以上向量的交集：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">A &lt;- Reduce(intersect,list(x,y,z)) <span class="comment"># 求x, y, z三个向量的交集</span></div><div class="line">5 6 7 8 9</div></pre></td></tr></table></figure>
<h2 id="二、并集"><a href="#二、并集" class="headerlink" title="二、并集"></a>二、并集</h2><p>两个向量求并集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">union(x,y)</div><div class="line"><span class="comment"># 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<p>多个向量求并集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b &lt;- Reduce(union,list(x,y,z))</div><div class="line"><span class="comment"># 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<h2 id="三、差集"><a href="#三、差集" class="headerlink" title="三、差集"></a>三、差集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">setdiff(x,y) <span class="comment"># x-y的差集，即x中存在但在y中不存在的元素</span></div><div class="line"><span class="comment"># 1 2</span></div><div class="line">setdiff(y,x) <span class="comment"># y-x的差集，即y中存在但在x中不存在的元素</span></div><div class="line"><span class="comment"># 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<h2 id="四、检验集合是否相同"><a href="#四、检验集合是否相同" class="headerlink" title="四、检验集合是否相同"></a>四、检验集合是否相同</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setequal(x,y)</div><div class="line"><span class="comment"># FALSE</span></div></pre></td></tr></table></figure>
<h2 id="五、检验元素是否属于集合"><a href="#五、检验元素是否属于集合" class="headerlink" title="五、检验元素是否属于集合"></a>五、检验元素是否属于集合</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">is.element(5,x)</div><div class="line"><span class="comment"># TRUE</span></div><div class="line">&gt; is.element(15,x)</div><div class="line"><span class="comment"># FALSE</span></div></pre></td></tr></table></figure>
<h2 id="六、检验集合B是否包含于集合A"><a href="#六、检验集合B是否包含于集合A" class="headerlink" title="六、检验集合B是否包含于集合A"></a>六、检验集合B是否包含于集合A</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">all(x%<span class="keyword">in</span>%y)</div><div class="line"><span class="comment"># FALSE</span></div><div class="line">all(z%<span class="keyword">in</span>%x)</div><div class="line"><span class="comment"># TRUE</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、交集&quot;&gt;&lt;a href=&quot;#一、交集&quot; class=&quot;headerlink&quot; title=&quot;一、交集&quot;&gt;&lt;/a&gt;一、交集&lt;/h2&gt;&lt;p&gt;使用intersect计算两个向量的交集：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;tabl
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记10-差异分析与绘制热图（命令集合）</title>
    <link href="http://uteric.github.io/RNASEQ%20%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90%E4%B8%8E%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE/"/>
    <id>http://uteric.github.io/RNASEQ 差异分析与绘制热图/</id>
    <published>2018-10-06T04:19:13.000Z</published>
    <updated>2018-10-06T04:19:13.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、差异分析"><a href="#一、差异分析" class="headerlink" title="一、差异分析"></a>一、差异分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">"E:/R/My Analysis/"</span>) <span class="comment"># 设置工作目录</span></div><div class="line">getwd() <span class="comment"># 查看当前工作目录</span></div><div class="line">dir() <span class="comment"># 查看工作目录下的文件</span></div><div class="line"></div><div class="line">library(DESeq2) <span class="comment"># 载入DESeq2</span></div><div class="line"></div><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>,header=T,row.names=1) <span class="comment"># 从剪贴板载入要分析的数据</span></div><div class="line"></div><div class="line">countData &lt;- data</div><div class="line">condition &lt;- factor(c(<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>)) <span class="comment"># 定义condition，根据具体情况作相应改变</span></div><div class="line">colData &lt;- data.frame(row.names=colnames(countData),condition)</div><div class="line">condition <span class="comment"># 查看condition</span></div><div class="line">colData <span class="comment"># 查看colData是否与预期一致</span></div><div class="line"></div><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData,DataFrame(condition),design= ~ condition) <span class="comment"># 构建dds矩阵</span></div><div class="line">head(dds) <span class="comment"># 查看dds矩阵的前端</span></div><div class="line">dds2 &lt;- DESeq(dds) <span class="comment"># 对dds矩阵进行Normalize</span></div><div class="line"></div><div class="line">res &lt;- results(dds2) <span class="comment"># 使用results()函数获取结果，并赋值给res</span></div><div class="line">summary(res) <span class="comment"># 查看res矩阵的总结信息</span></div><div class="line">table(res<span class="variable">$padj</span>&lt;0.05) <span class="comment"># 取padj小于0.05的数据，作为第一个checkpoint</span></div><div class="line">res &lt;- res[order(res<span class="variable">$padj</span>),] <span class="comment"># 按照padj的大小将res重新排列</span></div><div class="line"></div><div class="line">diff &lt;- subset(res,padj &lt; 0.05 &amp; (log2FoldChange &gt;1 | log2FoldChange &lt; -1)) <span class="comment"># 获取padj小于0.05，表达倍数取以2为对数后绝对值大于1的差异表达基因</span></div><div class="line">nrow(diff) <span class="comment"># 查看行数，作为第二个checkpoint</span></div><div class="line"></div><div class="line">resdata &lt;- merge(as.data.frame(diff),as.data.frame(counts(dds,normalize=FALSE)),by=<span class="string">"row.names"</span>,sort=FALSE) <span class="comment"># 合并文件</span></div><div class="line"></div><div class="line">write.csv(resdata,file=<span class="string">"diff_SR.csv"</span>) <span class="comment"># 结果输出为.CSV文件</span></div></pre></td></tr></table></figure>
<h2 id="二、绘制热图"><a href="#二、绘制热图" class="headerlink" title="二、绘制热图"></a>二、绘制热图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>,header=T,row.names=1) <span class="comment"># 从剪贴板载入数据</span></div><div class="line"></div><div class="line">col_anno=data.frame(PT=c(<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>),row.names=colnames(data)) <span class="comment"># 定义分组信息，具体情况具体设置，本例是对列进行分组，前12列为S，后11列为R</span></div><div class="line"></div><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,annotation_col=col_anno,color=colorRampPalette(c(<span class="string">"navy"</span>,<span class="string">"white"</span>,<span class="string">"firebrick3"</span>))(50)) <span class="comment"># 绘制热图</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、差异分析&quot;&gt;&lt;a href=&quot;#一、差异分析&quot; class=&quot;headerlink&quot; title=&quot;一、差异分析&quot;&gt;&lt;/a&gt;一、差异分析&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>EXCEL学习笔记1-AND与OR的用法</title>
    <link href="http://uteric.github.io/EXCEL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"/>
    <id>http://uteric.github.io/EXCEL学习笔记1/</id>
    <published>2018-10-06T04:16:43.000Z</published>
    <updated>2018-10-06T04:16:43.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">=IF(AND(AC2&lt;AD2,Y2&lt;AB2),<span class="string">"Y"</span>,<span class="string">"N"</span>) <span class="comment"># 套用IF语句，如果AC2&lt;AD2且Y2&lt;AB2，则判断为Y，否则为N，注意，Y或N要加引号，否则报错</span></div><div class="line">=IF(OR(AE2=<span class="string">"Y"</span>,AF2=<span class="string">"Y"</span>),<span class="string">"Y"</span>,<span class="string">"N"</span>) <span class="comment"># 套用IF语句，如果AE2="Y"或AF2="Y"，则判断为Y，否则为N</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;co
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="EXCEL" scheme="http://uteric.github.io/tags/EXCEL/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记7-最大整数问题</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B07/"/>
    <id>http://uteric.github.io/R语言学习笔记7/</id>
    <published>2018-09-27T04:16:58.000Z</published>
    <updated>2018-09-27T04:16:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在分析RNA-SEQ结果时，遇到一个问题，总是提示：</p>
<p><em>message: In mde(x) : NAs introduced by coercion to integer range </em></p>
<p>最开始时，我以为是原始数据中有NAs，但是检查了一遍发现没有，真正的原因是，原始数据中的整数太大，超出机器设定的最高限，因此才会报错。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.Machine<span class="variable">$integer</span>.max <span class="comment"># 查看最大整数</span></div><div class="line"><span class="comment"># [1] 2147483647</span></div><div class="line">x &lt;- as.interger(.Machine<span class="variable">$integer</span>.max)</div><div class="line">y&lt;- x+1</div><div class="line">as.integer(y)</div><div class="line"><span class="comment"># 猜猜会怎样？报错</span></div><div class="line"><span class="comment"># [1] NA</span></div><div class="line"><span class="comment"># Warning message: NAs introduced by coercion to integer range</span></div></pre></td></tr></table></figure>
<p>可见，最大整数不可以超过2147483647，当然，这不意味着系统不能对更大的数值进行计算，而是说，如果某函数中需要输入整数，则最大不可以超过此上限。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在分析RNA-SEQ结果时，遇到一个问题，总是提示：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;message: In mde(x) : NAs introduced by coercion to integer range &lt;/em&gt;&lt;/p&gt;
&lt;p&gt;最开始时，我以为是原始数据中有NAs，
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记6-基本命令</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B06/"/>
    <id>http://uteric.github.io/R语言学习笔记6/</id>
    <published>2018-09-27T04:15:28.000Z</published>
    <updated>2018-09-27T04:15:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>1、查看当前目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getwd() <span class="comment"># get working directory</span></div></pre></td></tr></table></figure>
<p>2、改变工作目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setwd()</div></pre></td></tr></table></figure>
<p>3、查看当前目录中的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dir()</div></pre></td></tr></table></figure>
<p>4、查看行数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nrow()</div></pre></td></tr></table></figure>
<p>5、排序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data &lt;- data[order(data<span class="variable">$row</span>,decreasing=FALSE),] <span class="comment"># decreasing=FALSE为默认升序排列</span></div></pre></td></tr></table></figure>
<p>6、查看文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">head() <span class="comment"># 查看前6行</span></div><div class="line">tail() <span class="comment"># 查看最后6行</span></div></pre></td></tr></table></figure>
<p>7、查看类型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class()</div></pre></td></tr></table></figure>
<p>8、载入文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">read.csv() <span class="comment"># 载入逗号分隔的CSV文档</span></div><div class="line">read.csv2() <span class="comment"># 载入分号分隔的CSV文档</span></div><div class="line">read.delim() <span class="comment"># 载入TAB键分隔的文档</span></div></pre></td></tr></table></figure>
<p>9、输出文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">write.csv() <span class="comment"># 输出逗号分隔的CSV文档</span></div><div class="line">write.csv2() <span class="comment"># 输出分号分隔的CSV文档</span></div></pre></td></tr></table></figure>
<p>10、数据筛选</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subset() <span class="comment"># 筛选特定子集</span></div></pre></td></tr></table></figure>
<p>11、绝对值函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">abs()</div></pre></td></tr></table></figure>
<p>12、开根号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sqrt()</div></pre></td></tr></table></figure>
<p>13、判断正负</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sign()</div></pre></td></tr></table></figure>
<p>14、自然指数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exp() <span class="comment"># e的指数</span></div></pre></td></tr></table></figure>
<p>15、对数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">log</span>(x,base)</div></pre></td></tr></table></figure>
<p>16、四舍五入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">round(x,n) <span class="comment"># 将x四舍五入到第n位</span></div></pre></td></tr></table></figure>
<p>17、取整数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">trunc()</div></pre></td></tr></table></figure>
<p>18、最大值与最小值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">max()</div><div class="line">min()</div></pre></td></tr></table></figure>
<p>19、求和</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">colSums() <span class="comment"># 按列求和</span></div><div class="line">rowSums() <span class="comment"># 按行求和</span></div></pre></td></tr></table></figure>
<p>20、平均值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">colMeans()</div><div class="line">rowMeans()</div></pre></td></tr></table></figure>
<p>21、缺失值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">na.fail() <span class="comment"># 检测是否有缺失值，若有则报错并停止</span></div><div class="line">na.omit() <span class="comment"># 去除缺失值</span></div><div class="line">na.exclude() <span class="comment"># 去除缺失值</span></div><div class="line">is.na() <span class="comment"># 判断是否是缺失值</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;1、查看当前目录&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记10-clusterProfiler富集分析</title>
    <link href="http://uteric.github.io/RNASEQ%20clusterProfiler%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/"/>
    <id>http://uteric.github.io/RNASEQ clusterProfiler富集分析/</id>
    <published>2018-09-25T02:11:12.000Z</published>
    <updated>2018-09-25T02:11:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、安装clusterProfiler"><a href="#一、安装clusterProfiler" class="headerlink" title="一、安装clusterProfiler"></a>一、安装clusterProfiler</h2><blockquote>
<p>source(“<a href="https://bioconductor.org/biocLite.R" target="_blank" rel="external">https://bioconductor.org/biocLite.R</a>“) # 如果报错，请尝试http://<br>biocLite(“clusterProfiler”)<br>library(clusterProfiler) # 载入包，测试是否安装成功，如果提示找不到某个包，则安装相关的包即可，比如我的电脑提示“<strong>不存在叫‘rvcheck’这个名字的程辑包</strong>”，则使用如下语法安装“rvcheck”，如缺乏其他包，也是同理。<br>install.packages(“rvcheck”)</p>
</blockquote>
<h2 id="二、安装基因组注释数据"><a href="#二、安装基因组注释数据" class="headerlink" title="二、安装基因组注释数据"></a>二、安装基因组注释数据</h2><p>目前，<a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb" target="_blank" rel="external">Bioconductor</a>官网支持19种生物的注释数据，可以直接安装：</p>
<blockquote>
<p>biocLite(“org.Hs.eg.db”) # 安装人类的注释数据<br>library(org.Hs.eg.db) # 测试，载入人类的注释数据<br>biocLite(“org.Mm.eg.db”) # 安装小鼠的注释数据<br>library(org.Mm.eg.db) # 测试，载入小鼠的注释数据</p>
</blockquote>
<h2 id="三、载入基因列表"><a href="#三、载入基因列表" class="headerlink" title="三、载入基因列表"></a>三、载入基因列表</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data &lt;- read.csv(<span class="string">"top50.csv"</span>) <span class="comment"># 从文件中载入数据，并赋值给data</span></div><div class="line"><span class="comment"># 我们需要的是第二列的基因列表，因此，只筛选第二列即可</span></div><div class="line">gene &lt;- data[,2] <span class="comment"># 抽取第二列，赋值给gene</span></div><div class="line">gene &lt;- bitr(gene,fromType=<span class="string">"SYMBOL"</span>,toType=<span class="string">"ENTREZID"</span>,OrgDb=org.Hs.eg.db) <span class="comment"># groupGO默认使用"ENTREZID"作为输入数据，因此首先将“SYMBOL”转化为“ENTREZID”，以防出错</span></div><div class="line">gene &lt;- gene[,2] <span class="comment"># 抽取第二列作为input</span></div></pre></td></tr></table></figure>
<h2 id="四、groupGO分析"><a href="#四、groupGO分析" class="headerlink" title="四、groupGO分析"></a>四、groupGO分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"BP"</span>,level=3,readable=TRUE)</div><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"CC"</span>,level=3,readable=TRUE)</div><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"MF"</span>,level=3,readable=TRUE)</div></pre></td></tr></table></figure>
<p>groupGO命令的格式为：<em>groupGO(gene,OrgDb,ont,level,readable)</em></p>
<p><strong>gene</strong>，指定前景基因文件，即要分析的基因集合，默认为”ENTREZID”格式；<br><strong>OrgDb</strong>，指定基因组注释数据；<br><strong>ont</strong>，即ontology，参数有三个，分别为CC，BP和MF，对应：细胞组分（cellular component，CC），生物过程（biological process，BP），分子功能（molecular function，MF）；<br><strong>level</strong>，指定分析的GO水平；<br><strong>readable</strong>，逻辑值，TRUE或FALSE；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(as.data.frame(ggo)) <span class="comment"># 查看前六行，结果是六行五列的数据</span></div></pre></td></tr></table></figure>
<p>ID                              Description Count<br>GO:0019953 GO:0019953                      sexual reproduction     7<br>GO:0019954 GO:0019954                     asexual reproduction     0<br>GO:0022414 GO:0022414                     reproductive process    26<br>GO:0032504 GO:0032504      multicellular organism reproduction     9<br>GO:0032505 GO:0032505 reproduction of a single-celled organism     0<br>GO:0061887 GO:0061887         reproduction of symbiont in host     0<br>GeneRatio<br>GO:0019953     7/298<br>GO:0019954     0/298<br>GO:0022414    26/298<br>GO:0032504     9/298<br>GO:0032505     0/298<br>GO:0061887     0/298<br>geneID<br>GO:0019953                                                                                                                 APOB/ABAT/ANG/AR/AVPR1A/LEPR/ACOX1<br>GO:0019954<br>GO:0022414 APOB/AGT/AMBP/RBP4/ABAT/SERPINF1/ANG/HNF4A/AR/AVPR1A/ARG1/LEPR/GJB1/BOK/DHODH/SLC38A3/PDGFRA/TBX3/ADGRG1/IGFBP2/TTPA/ACOX1/DBH/ETNK2/NAMPT/HSD17B2<br>GO:0032504                                                                                                  APOB/SERPINF1/ANG/AR/AVPR1A/ARG1/PDGFRA/ACOX1/DBH<br>GO:0032505<br>GO:0061887                                                                                           </p>
<h2 id="五、groupGo结果可视化"><a href="#五、groupGo结果可视化" class="headerlink" title="五、groupGo结果可视化"></a>五、groupGo结果可视化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(ggo,drop=TRUE,showCategory=20)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-f92d7ebc27bfe4e3.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggo barplot.jpeg"></p>
<h2 id="六、enrichGO分析"><a href="#六、enrichGO分析" class="headerlink" title="六、enrichGO分析"></a>六、enrichGO分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"BP"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"CC"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"MF"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div></pre></td></tr></table></figure>
<p>enrichGO命令语法：<em>enrichGO(gene,universe,OrgDb,ont,pvalueCutoff,qvalueCutoff,readable)</em></p>
<p>universe，背景基因文件，可以使用默认值；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(as.data.frame(ego))</div></pre></td></tr></table></figure>
<p>ID                                   Description<br>GO:0072562 GO:0072562                           blood microparticle<br>GO:0042627 GO:0042627                                   chylomicron<br>GO:0031093 GO:0031093                  platelet alpha granule lumen<br>GO:0005788 GO:0005788                   endoplasmic reticulum lumen<br>GO:0034361 GO:0034361         very-low-density lipoprotein particle<br>GO:0034385 GO:0034385 triglyceride-rich plasma lipoprotein particle<br>GeneRatio   BgRatio       pvalue     p.adjust       qvalue<br>GO:0072562    33/288 101/11817 9.367691e-29 2.519909e-26 2.336992e-26<br>GO:0042627     8/288  11/11817 1.750866e-11 2.354915e-09 2.183975e-09<br>GO:0031093    14/288  62/11817 1.938754e-10 1.738416e-08 1.612227e-08<br>GO:0005788    26/288 247/11817 3.097572e-10 2.083117e-08 1.931907e-08<br>GO:0034361     8/288  16/11817 1.227828e-09 5.504763e-08 5.105180e-08<br>GO:0034385     8/288  16/11817 1.227828e-09 5.504763e-08 5.105180e-08<br>geneID<br>GO:0072562 ITIH4/ALB/FGB/FGA/FGG/ORM1/HPX/HP/VTN/APOA2/AGT/AMBP/SERPINC1/F2/C3/C9/SERPING1/HRG/ITIH1/SERPINA3/AHSG/GC/APOA4/PLG/KNG1/TF/C4BPA/C8G/C8A/APOA1/HPR/ITIH2/C1S<br>GO:0042627                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>GO:0031093                                                                                       ALB/FGB/FGA/FGG/ORM1/SERPINA1/SERPING1/HRG/SERPINA3/AHSG/F5/PLG/KNG1/VWF<br>GO:0005788                           APOB/ALB/FGA/FGG/SERPINA1/VTN/APOA2/SERPINC1/F2/C3/IGFBP1/AHSG/F5/SERPIND1/APOA4/KNG1/TF/PROC/APOA1/F9/ITIH2/MTTP/F10/CES2/H6PD/CDH2<br>GO:0034361                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>GO:0034385                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>Count<br>GO:0072562    33<br>GO:0042627     8<br>GO:0031093    14<br>GO:0005788    26<br>GO:0034361     8<br>GO:0034385     8</p>
<h2 id="七、enrichGO可视化"><a href="#七、enrichGO可视化" class="headerlink" title="七、enrichGO可视化"></a>七、enrichGO可视化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(ego,drop=TRUE,showCategory=20)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-74b5709dbbde256d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ego barplot.jpeg"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dotplot(ego,title=<span class="string">"enrichGo CC dotplot"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-d804a07f00df5610.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ego cc dotplot.jpeg"></p>
<p>此外，还可以作enrichMap或cnetplot，命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">enrichMap(ego, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)</div><div class="line">cnetplot(ego, foldChange=geneList)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、安装clusterProfiler&quot;&gt;&lt;a href=&quot;#一、安装clusterProfiler&quot; class=&quot;headerlink&quot; title=&quot;一、安装clusterProfiler&quot;&gt;&lt;/a&gt;一、安装clusterProfiler&lt;/h2&gt;&lt;bloc
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记5-第1列作为行名</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05/"/>
    <id>http://uteric.github.io/R语言学习笔记5/</id>
    <published>2018-09-20T04:48:04.000Z</published>
    <updated>2018-09-20T04:48:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>比如一个名为diff的数据，我们来看一下最后五行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (diff, n=5) <span class="comment"># 查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>48816 ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>48817 ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>48818 ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>48819 ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>48820 ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
<p>这个表格的行名是：48816，48817，48818，48819，48820，然而，有的时候，我们需要把文件中的第一列作为行名，如何操作呢？</p>
<p><strong>首先把第一列指定为行名，然后，再把第一列删掉即可。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rownames(diff) &lt;- diff[,1] <span class="comment"># 指定第一列为行名</span></div><div class="line">tail (diff,n=5) <span class="comment"># 查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>ENSMUSG00000110418 ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110420 ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110421 ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>ENSMUSG00000110422 ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>ENSMUSG00000110423 ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">diff2 &lt;- diff[,-1] <span class="comment"># 删掉第一列</span></div><div class="line">tail (diff2,n=5) <span class="comment"># 再次查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;比如一个名为diff的数据，我们来看一下最后五行：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记9-使用pheatmap绘制热图</title>
    <link href="http://uteric.github.io/RNASEQ%20%E4%BD%BF%E7%94%A8pheatmap%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE/"/>
    <id>http://uteric.github.io/RNASEQ 使用pheatmap绘制热图/</id>
    <published>2018-09-19T05:14:41.000Z</published>
    <updated>2018-09-19T05:14:41.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、安装pheatmap"><a href="#一、安装pheatmap" class="headerlink" title="一、安装pheatmap"></a>一、安装pheatmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment">#调入安装工具</span></div><div class="line">biocLite(<span class="string">"pheatmap"</span>) <span class="comment"># 安装pheatmap</span></div><div class="line">library(pheatmap) <span class="comment"># 检测是否安装成功</span></div></pre></td></tr></table></figure>
<h2 id="二、读取数据"><a href="#二、读取数据" class="headerlink" title="二、读取数据"></a>二、读取数据</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">"E:/R"</span>) <span class="comment"># 设置工作路径，本例是在E盘下的R文件夹，如果要查询当前工作路径，则使用getwd()命令，其中，wd=working directory</span></div><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>, header = T, sep = <span class="string">"\t"</span>, row.names = 1) <span class="comment"># read.delim意思是读取delimited text files，即分隔符分隔的文件</span></div></pre></td></tr></table></figure>
<p>read.delim这个命令有必要详细解释一下，其格式为：read.delim(file, header=TRUE, sep=”\t”)</p>
<p>其中，第一个参数是文件的位置，本例中直接使用剪贴板的数据，也可以写文件名；header=T，表示第一行是列名；sep = “\t”指定分隔符类型为制表符，sep = “,”表示分隔符为逗号，sep = “ “表示制表符为空格；row.names=1，表示第一列包含行名。</p>
<h2 id="三、绘制热图"><a href="#三、绘制热图" class="headerlink" title="三、绘制热图"></a>三、绘制热图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,color=colorRampPalette(c(<span class="string">"navy"</span>,<span class="string">"white"</span>,<span class="string">"firebrick3"</span>))(50),fontsize_row=3,fontsize_col=10)</div></pre></td></tr></table></figure>
<p>scale # 对矩阵进行标准化，这一步是必要的，尤其是数据之间差异较大时效果非常明显，scale=”row”，对行进行标准化；scale=”column“，对列进行标准化；默认为none；<br>color # 指定小格的颜色；<br>fontsize_row，指定行字号；fontsize_col，指定列字号；</p>
<h2 id="四、参数设置"><a href="#四、参数设置" class="headerlink" title="四、参数设置"></a>四、参数设置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">display_numbers=TRUE <span class="comment"># 在热图格子中展示文本</span></div><div class="line">number_format = <span class="string">"%.2f"</span> <span class="comment"># 热图中文本保留小数点后两位</span></div><div class="line">number_format = <span class="string">"%.1e"</span> <span class="comment"># 热图中文本使用科学计数法</span></div><div class="line">number_color=<span class="string">"purple"</span> <span class="comment"># 热图中文本的颜色</span></div><div class="line">cluster_cols=F <span class="comment"># 不要对列进行聚类，默认是T</span></div><div class="line">cluster_rows=F <span class="comment"># 不要对行进行聚类，默认是T </span></div><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,cellwidth=15,cellheight=12,main=<span class="string">"example heatmap"</span>,fontsize=8,filename=<span class="string">"test.pdf"</span>)</div><div class="line"><span class="comment"># cellwidth，设置格子宽度；cellheight，设置格子高度</span></div><div class="line"><span class="comment"># main，设置标题；fontsize，标题字体</span></div><div class="line"><span class="comment"># filename，直接指定保存为文件，支持格式png, pdf, tiff, bmp, jpeg</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、安装pheatmap&quot;&gt;&lt;a href=&quot;#一、安装pheatmap&quot; class=&quot;headerlink&quot; title=&quot;一、安装pheatmap&quot;&gt;&lt;/a&gt;一、安装pheatmap&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;t
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ学习流程</title>
    <link href="http://uteric.github.io/RNASEQ%E5%AD%A6%E4%B9%A0%E6%B5%81%E7%A8%8B/"/>
    <id>http://uteric.github.io/RNASEQ学习流程/</id>
    <published>2018-05-22T04:33:04.000Z</published>
    <updated>2018-05-22T04:33:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考文献：<a href="https://link.jianshu.com/?t=http://www.nature.com/nprot/journal/v11/n9/full/nprot.2016.095.html" target="_blank" rel="external">Transcript-level expression analysis of RNA-seq experiments with HISAT, StringTie and Ballgown</a></p>
<hr>
<h2 id="一、下载数据并解压"><a href="#一、下载数据并解压" class="headerlink" title="一、下载数据并解压"></a>一、下载数据并解压</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/RNAseq_protocol/chrX_data.tar.gz <span class="comment"># 下载原始数据</span></div><div class="line">tar zxvf chrX_data.tar.gz <span class="comment"># 解压</span></div></pre></td></tr></table></figure>
<p>解压后在当前目录下生成新文件夹chrX_data，里面包含如下文件：</p>
<p>drwxr-xr-x   3 xiuliliu  staff  102 Jul 12  2016 genes<br>drwxr-xr-x   3 xiuliliu  staff  102 Jan 14  2016 genome<br>-rw-r–r–   1 xiuliliu  staff  337 Jan 14  2016 geuvadis_phenodata.csv<br>drwxr-xr-x  10 xiuliliu  staff  340 Jan 14  2016 indexes<br>-rw-r–r–   1 xiuliliu  staff  228 Jan 14  2016 mergelist.txt<br>drwxr-xr-x  26 xiuliliu  staff  884 Jan 14  2016 samples</p>
<p>其中，samples中包含24个.fastq.gz文件，分为12对，从GBR和YRI两地各取6个样，男女各3个，构成基本的生物学重复。</p>
<p>-rw-r–r–  1 xiuliliu  staff   91425269 Jan 14  2016 ERR188044_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   91314392 Jan 14  2016 ERR188044_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   87664981 Jan 14  2016 ERR188104_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   88268450 Jan 14  2016 ERR188104_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff  112984506 Jan 14  2016 ERR188234_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff  114271070 Jan 14  2016 ERR188234_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   61157734 Jan 14  2016 ERR188245_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   62378428 Jan 14  2016 ERR188245_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   67433106 Jan 14  2016 ERR188257_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   68213815 Jan 14  2016 ERR188257_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   39876761 Jan 14  2016 ERR188273_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   40639110 Jan 14  2016 ERR188273_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   91600737 Jan 14  2016 ERR188337_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   92210453 Jan 14  2016 ERR188337_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   66033878 Jan 14  2016 ERR188383_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   65623043 Jan 14  2016 ERR188383_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   90165491 Jan 14  2016 ERR188401_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   90548373 Jan 14  2016 ERR188401_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   57960187 Jan 14  2016 ERR188428_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   58159176 Jan 14  2016 ERR188428_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   73187016 Jan 14  2016 ERR188454_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   72904430 Jan 14  2016 ERR188454_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   77647967 Jan 14  2016 ERR204916_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   78167352 Jan 14  2016 ERR204916_chrX_2.fastq.gz</p>
<hr>
<h2 id="二、比对读段到基因组上-Align-the-RNA-seq-reads-to-the-genome"><a href="#二、比对读段到基因组上-Align-the-RNA-seq-reads-to-the-genome" class="headerlink" title="二、比对读段到基因组上 (Align the RNA-seq reads to the genome)"></a>二、比对读段到基因组上 (Align the RNA-seq reads to the genome)</h2><h3 id="1-Map-the-reads-for-each-sample-to-the-reference-genome"><a href="#1-Map-the-reads-for-each-sample-to-the-reference-genome" class="headerlink" title="1 | Map the reads for each sample to the reference genome"></a>1 | Map the reads for each sample to the reference genome</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR204916_chrX_1.fastq.gz -2 chrX_data/samples/ERR204916_chrX_2.fastq.gz -S ERR204916_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188454_chrX_1.fastq.gz -2 chrX_data/samples/ERR188454_chrX_2.fastq.gz -S ERR188454_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188428_chrX_1.fastq.gz -2 chrX_data/samples/ERR188428_chrX_2.fastq.gz -S ERR188428_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188401_chrX_1.fastq.gz -2 chrX_data/samples/ERR188401_chrX_2.fastq.gz -S ERR188401_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188383_chrX_1.fastq.gz -2 chrX_data/samples/ERR188383_chrX_2.fastq.gz -S ERR188383_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188337_chrX_1.fastq.gz -2 chrX_data/samples/ERR188337_chrX_2.fastq.gz -S ERR188337_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188273_chrX_1.fastq.gz -2 chrX_data/samples/ERR188273_chrX_2.fastq.gz -S ERR188273_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188257_chrX_1.fastq.gz -2 chrX_data/samples/ERR188257_chrX_2.fastq.gz -S ERR188257_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188245_chrX_1.fastq.gz -2 chrX_data/samples/ERR188245_chrX_2.fastq.gz -S ERR188245_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188234_chrX_1.fastq.gz -2 chrX_data/samples/ERR188234_chrX_2.fastq.gz -S ERR188234_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188104_chrX_1.fastq.gz -2 chrX_data/samples/ERR188104_chrX_2.fastq.gz -S ERR188104_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188044_chrX_1.fastq.gz -2 chrX_data/samples/ERR188044_chrX_2.fastq.gz -S ERR188044_chrX.sam</div></pre></td></tr></table></figure>
<p>以ERR188044为例，比对结果如下：</p>
<p>1321477 reads; of these:<br>1321477 (100.00%) were paired; of these:<br>121769 (9.21%) aligned concordantly 0 times<br>1183443 (89.55%) aligned concordantly exactly 1 time</p>
<h2 id="16265-1-23-aligned-concordantly-gt-1-times"><a href="#16265-1-23-aligned-concordantly-gt-1-times" class="headerlink" title="16265 (1.23%) aligned concordantly &gt;1 times"></a>16265 (1.23%) aligned concordantly &gt;1 times</h2><p>121769 pairs aligned concordantly 0 times; of these:</p>
<h2 id="4200-3-45-aligned-discordantly-1-time"><a href="#4200-3-45-aligned-discordantly-1-time" class="headerlink" title="4200 (3.45%) aligned discordantly 1 time"></a>4200 (3.45%) aligned discordantly 1 time</h2><p>117569 pairs aligned 0 times concordantly or discordantly; of these:<br>235138 mates make up the pairs; of these:<br>119859 (50.97%) aligned 0 times<br>112782 (47.96%) aligned exactly 1 time<br>2497 (1.06%) aligned &gt;1 times<br>95.46% overall alignment rate</p>
<p>比对完成后生成如下SAM文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff   774297504 May  1 22:25 ERR188044_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   751836403 May  1 22:33 ERR188104_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   917023342 May  1 22:36 ERR188234_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   502043631 May  1 22:37 ERR188245_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   558972026 May  1 22:39 ERR188257_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   335808493 May  1 22:41 ERR188273_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   748130535 May  1 22:43 ERR188337_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   561738897 May  1 22:44 ERR188383_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   769125833 May  1 22:46 ERR188401_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   490343972 May  1 22:47 ERR188428_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   611111154 May  1 22:49 ERR188454_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   640234529 May  1 22:50 ERR204916_chrX.sam</p>
<hr>
<h3 id="2-Sort-and-convert-the-SAM-files-to-BAM"><a href="#2-Sort-and-convert-the-SAM-files-to-BAM" class="headerlink" title="2 | Sort and convert the SAM files to BAM"></a>2 | Sort and convert the SAM files to BAM</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">samtools sort -@ 8 -o ERR188104_chrX.bam ERR188104_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188234_chrX.bam ERR188234_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188245_chrX.bam ERR188245_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188257_chrX.bam ERR188257_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188273_chrX.bam ERR188273_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188337_chrX.bam ERR188337_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188383_chrX.bam ERR188383_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188401_chrX.bam ERR188401_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188428_chrX.bam ERR188428_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188454_chrX.bam ERR188454_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR204916_chrX.bam ERR204916_chrX.sam</div></pre></td></tr></table></figure>
<p>运行完成后，生成对应的BAM文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff   149690318 May  1 23:25 ERR188044_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   144503638 May  1 23:26 ERR188104_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   192550220 May  1 23:27 ERR188234_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   105587796 May  1 23:28 ERR188245_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   117630914 May  1 23:29 ERR188257_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff    69857742 May  1 23:30 ERR188273_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   157532931 May  1 23:31 ERR188337_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   108256114 May  1 23:32 ERR188383_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   151150838 May  1 23:32 ERR188401_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff    97383432 May  1 23:33 ERR188428_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   121850605 May  1 23:34 ERR188454_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   131891473 May  1 23:34 ERR204916_chrX.bam</p>
<hr>
<h3 id="3-Assemble-transcripts-for-each-sample"><a href="#3-Assemble-transcripts-for-each-sample" class="headerlink" title="3 | Assemble transcripts for each sample"></a>3 | Assemble transcripts for each sample</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">conda install stringtie <span class="comment"># 安装stringtie</span></div><div class="line"><span class="comment"># [-p 8]：8个线程运行；[-G]：注释文件；[-o]：输出目录；[-l]：指定输出转录本的前缀；</span></div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188044_chrX.gtf -l ERR188044 ERR188044_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188104_chrX.gtf -l ERR188104 ERR188104_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188234_chrX.gtf -l ERR188234 ERR188234_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188245_chrX.gtf -l ERR188245 ERR188245_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188337_chrX.gtf -l ERR188337 ERR188337_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188257_chrX.gtf -l ERR188257 ERR188257_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188273_chrX.gtf -l ERR188273 ERR188273_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188383_chrX.gtf -l ERR188383 ERR188383_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188401_chrX.gtf -l ERR188401 ERR188401_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188428_chrX.gtf -l ERR188428 ERR188428_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188454_chrX.gtf -l ERR188454 ERR188454_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR204916_chrX.gtf -l ERR204916 ERR204916_chrX.bam</div></pre></td></tr></table></figure>
<p>运行完成后，生成如下文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff     1911015 May  2 22:09 ERR188044_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1905249 May  2 22:12 ERR188104_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1914897 May  2 22:13 ERR188234_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1750782 May  2 22:14 ERR188245_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1705229 May  2 22:19 ERR188257_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1487570 May  2 22:19 ERR188273_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1928401 May  2 22:17 ERR188337_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1744763 May  2 22:20 ERR188383_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1936094 May  2 22:20 ERR188401_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1617807 May  2 22:21 ERR188428_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1773237 May  2 22:21 ERR188454_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1818351 May  2 22:22 ERR204916_chrX.gtf</p>
<hr>
<h3 id="4-Merge-transcripts-from-all-samples"><a href="#4-Merge-transcripts-from-all-samples" class="headerlink" title="4 | Merge transcripts from all samples"></a>4 | Merge transcripts from all samples</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># [-p]：线程数；[-G]：注释文件；[-o]：输出目录</span></div><div class="line">stringtie --merge -p 8 -G chrX_data/genes/chrX.gtf -o stringtie_merged.gtf chrX_data/mergelist.txt</div></pre></td></tr></table></figure>
<p>运行完成后，生成一个新的文件：</p>
<p>stringtie_merged.gtf</p>
<hr>
<h3 id="5-Examine-how-the-transcripts-compare-with-the-reference-annotation"><a href="#5-Examine-how-the-transcripts-compare-with-the-reference-annotation" class="headerlink" title="5 | Examine how the transcripts compare with the reference annotation"></a>5 | Examine how the transcripts compare with the reference annotation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda install gffcompare <span class="comment"># 安装gffcompare</span></div><div class="line">ffcompare -r chrX_data/genes/chrX.gtf -G -o merged stringtie_merged.gtf</div></pre></td></tr></table></figure>
<p>运行完成后，生成多个文件：</p>
<p>merged.annotated.gtf<br>merged.loci<br>merged.stats<br>merged.stringtie_merged.gtf.refmap<br>merged.stringtie_merged.gtf.tmap<br>merged.tracking</p>
<hr>
<h3 id="6-Estimate-transcript-abundances-and-create-table-counts-for-Ballgown"><a href="#6-Estimate-transcript-abundances-and-create-table-counts-for-Ballgown" class="headerlink" title="6 | Estimate transcript abundances and create table counts for Ballgown"></a>6 | Estimate transcript abundances and create table counts for Ballgown</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188044/ERR188044_chrX.gtf ERR188044_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188104/ERR188104_chrX.gtf ERR188104_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188234/ERR188234_chrX.gtf ERR188234_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188245/ERR188245_chrX.gtf ERR188245_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188257/ERR188257_chrX.gtf ERR188257_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188273/ERR188273_chrX.gtf ERR188273_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188337/ERR188337_chrX.gtf ERR188337_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188383/ERR188383_chrX.gtf ERR188383_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188401/ERR188401_chrX.gtf ERR188401_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188428/ERR188428_chrX.gtf ERR188428_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188454/ERR188454_chrX.gtf ERR188454_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR204916/ERR204916_chrX.gtf ERR204916_chrX.bam</div></pre></td></tr></table></figure>
<p>运行完成后，将生成ballgown文件夹，</p>
<p>drwxr-xr-x  8 xiuliliu  staff  272 May  2 22:58 ERR188044<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:00 ERR188104<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:01 ERR188234<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:01 ERR188245<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:02 ERR188257<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:02 ERR188273<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:03 ERR188337<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:03 ERR188383<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:04 ERR188401<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:04 ERR188428<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:05 ERR188454<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:06 ERR204916</p>
<p>以ERR188044为例，包含：</p>
<p>-rw-r–r–  1 xiuliliu  staff  4737232 May  2 22:58 ERR188044_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff   279338 May  2 22:58 e2t.ctab<br>-rw-r–r–  1 xiuliliu  staff   767920 May  2 22:58 e_data.ctab<br>-rw-r–r–  1 xiuliliu  staff   244338 May  2 22:58 i2t.ctab<br>-rw-r–r–  1 xiuliliu  staff   358966 May  2 22:58 i_data.ctab<br>-rw-r–r–  1 xiuliliu  staff   288682 May  2 22:58 t_data.ctab</p>
<hr>
<h2 id="三、差异分析（Differential-Expression-Analysis）"><a href="#三、差异分析（Differential-Expression-Analysis）" class="headerlink" title="三、差异分析（Differential Expression Analysis）"></a>三、差异分析（Differential Expression Analysis）</h2><h3 id="7-Load-relevant-R-packages"><a href="#7-Load-relevant-R-packages" class="headerlink" title="7 | Load relevant R packages"></a>7 | Load relevant R packages</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; R</div><div class="line">&gt; <span class="built_in">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>)</div><div class="line">&gt; biocLite(<span class="string">"ballgown"</span>)</div><div class="line">&gt; biocLite(<span class="string">"dplyr"</span>)</div><div class="line">&gt; biocLite(<span class="string">"devtools"</span>)</div><div class="line">&gt; biocLite(<span class="string">"RSkittleBrewer"</span>) <span class="comment"># 安装RSkittleBrewer，如果不行，尝试如下方法：</span></div><div class="line">&gt; devtools::install_github(<span class="string">'RSkittleBrewer'</span>, <span class="string">'alyssafrazee'</span>)</div><div class="line"><span class="comment"># 安装完成后，加载相关R包</span></div><div class="line">&gt; library(ballgown) <span class="comment"># 分析转录组差异表达</span></div><div class="line">&gt; library(RSkittleBrewer) <span class="comment"># 设置颜色</span></div><div class="line">&gt; library(genefilter) <span class="comment"># 快速计算均值和方差（means &amp; variances）</span></div><div class="line">&gt; library(dplyr) <span class="comment"># 对结果进行分类排序</span></div><div class="line">&gt; library(devtools) <span class="comment"># 安装R包</span></div></pre></td></tr></table></figure>
<h3 id="8-Load-the-phenotype-data-for-the-samples"><a href="#8-Load-the-phenotype-data-for-the-samples" class="headerlink" title="8 | Load the phenotype data for the samples"></a>8 | Load the phenotype data for the samples</h3><p>chrX_data/geuvadis_phenodata.csv中包含样品的表型数据，<strong>行为样品，列为变量。</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; pheno_data = read.csv(<span class="string">"chrX_data/geuvadis_phenodata.csv"</span>)</div></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:center">“ids”</th>
<th style="text-align:center">“sex”</th>
<th style="text-align:center">“population”</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">“ERR188044”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188104”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188234”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188245”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188257”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188273”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188337”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188383”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188401”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188428”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188454”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR204916”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="9-Read-in-expression-data"><a href="#9-Read-in-expression-data" class="headerlink" title="9 | Read in expression data"></a>9 | Read in expression data</h3><p>ballgown包含三个参数：<br><strong>dataDir，</strong>数据存储目录，本例中命名为ballgown；<br><strong>samplePattern，</strong>样本名称的特征模式，本例中为ERR；<br><strong>pData，</strong>上一步加载的表型数据；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; bg_chrX = ballgown(dataDir = <span class="string">"ballgown"</span>, samplePattern = <span class="string">"ERR"</span>, pData=pheno_data)</div></pre></td></tr></table></figure>
<h3 id="10-Filter-to-remove-low-abundance-genes"><a href="#10-Filter-to-remove-low-abundance-genes" class="headerlink" title="10 | Filter to remove low-abundance genes"></a>10 | Filter to remove low-abundance genes</h3><p>使用方差过滤掉低丰度的基因，即去掉所有样本中方差小于1的基因。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; bg_chrX_filt = subset (bg_chrX, <span class="string">"rowVars(texpr(bg_chrX)) &gt;1"</span>, genomesubset=TRUE) </div><div class="line"><span class="comment"># texpr()，在ballgown中用于提取基因表达水平；</span></div><div class="line"><span class="comment"># rowVars()，计算数组中每一行的方差；</span></div><div class="line"><span class="comment"># rowVars(texpr(bg_chrX)) &gt;1，代表提取每一行的表达数据，计算方差，并保留方差大于1的基因作为形构成子集的条件；</span></div><div class="line"><span class="comment"># subset (x, cond, genomesubset=TRUE)，x，抽取子集的对象；cond，子集的条件；genomesubset=TRUE（对象为特定基因组），FALSE（对象为特定样品）</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="11-Identify-transcripts-that-show-statistically-significant-differences-between-groups"><a href="#11-Identify-transcripts-that-show-statistically-significant-differences-between-groups" class="headerlink" title="11 | Identify transcripts that show statistically significant differences between groups"></a>11 | Identify transcripts that show statistically significant differences between groups</h3><p>识别组间有显著差异的转录本：在此特别说明，我们需要考虑由其他变量引起的表达变化。在本例中，有两个变量，即sex &amp; population，在计算男女性别（sex）之间的差异时，需要考虑族群（population）这一变量对结果的影响，即需要修正由族群引起的表达差异。因此，需要使用stattest这个功能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = stattest(bg_chrX_filt, feature=<span class="string">"transcript"</span>, covariate=<span class="string">"sex"</span>, adjustvars = c(<span class="string">"population"</span>), getFC=TRUE, meas=<span class="string">"FPKM"</span>) </div><div class="line"><span class="comment"># stattest基本语法：stattest(gown = NULL, gowntable = NULL, pData = NULL, mod = NULL, mod0 = NULL, feature = c("gene", "exon", "intron", "transcript"), meas = c("cov", "FPKM", "rcount", "ucount", "mrcount", "mcov"), timecourse = FALSE, covariate = NULL, adjustvars = NULL, gexpr = NULL, df = 4, getFC = FALSE, libadjust = NULL, log = TRUE)</span></div><div class="line"><span class="comment"># feature，申明基因特征的类型，如"gene"/"transcript"/"exon"/"intron"</span></div><div class="line"><span class="comment"># covariate，协变量，感兴趣的协变量</span></div><div class="line"><span class="comment"># adjustvars，混杂因子</span></div><div class="line"><span class="comment"># getFC=TRUE，返回针对文库规模和混杂因子进行调整后的表达倍数变化</span></div><div class="line"><span class="comment"># meas，即measurement，包括"cov"/"FPKM"/"rcount"/"ucount"/"mrcount"/"mcov"</span></div><div class="line">&gt; head (results_transcripts) <span class="comment"># 显示前6行</span></div><div class="line">&gt; tail (results_transcripts) <span class="comment"># 显示后6行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.9705279</td>
<td style="text-align:center">0.8702505</td>
<td style="text-align:center">0.9680215</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1.8315567</td>
<td style="text-align:center">0.5824978</td>
<td style="text-align:center">0.9194471</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2.2376558</td>
<td style="text-align:center">0.5410260</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">4</td>
<td style="text-align:center">0.1745325</td>
<td style="text-align:center">0.2063035</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">5</td>
<td style="text-align:center">0.6220551</td>
<td style="text-align:center">0.2836476</td>
<td style="text-align:center">0.8997697</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">6</td>
<td style="text-align:center">0.6956666</td>
<td style="text-align:center">0.3957555</td>
<td style="text-align:center">0.8997697</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">2193</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3444</td>
<td style="text-align:center">1.5894619</td>
<td style="text-align:center">0.5488017</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2194</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3445</td>
<td style="text-align:center">1.3396594</td>
<td style="text-align:center">0.8246823</td>
<td style="text-align:center">0.9661891</td>
</tr>
<tr>
<td style="text-align:center">2195</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3446</td>
<td style="text-align:center">0.4460239</td>
<td style="text-align:center">0.5313140</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2196</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3447</td>
<td style="text-align:center">3.7182648</td>
<td style="text-align:center">0.2045574</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">2197</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.5894432</td>
<td style="text-align:center">0.5519984</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2198</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3449</td>
<td style="text-align:center">0.9296388</td>
<td style="text-align:center">0.8386784</td>
<td style="text-align:center">0.9662358</td>
</tr>
</tbody>
</table>
<p>我们看到，results_transcripts是一个2198x5的矩阵，即在男女两组间有显著差异的转录本共2198个。</p>
<hr>
<h3 id="12-Identify-genes-that-show-statistically-significant-differences-between-groups"><a href="#12-Identify-genes-that-show-statistically-significant-differences-between-groups" class="headerlink" title="12 | Identify genes that show statistically significant differences between groups"></a>12 | Identify genes that show statistically significant differences between groups</h3><p>识别组间有显著差异的基因：同样，再次使用stattest命令，但要设置feature=”gene”，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; results_genes = stattest(bg_chrX_filt, feature=<span class="string">"gene"</span>, covariate=<span class="string">"sex"</span>, adjustvars = c(<span class="string">"population"</span>), getFC=TRUE, meas=<span class="string">"FPKM"</span>)</div><div class="line">&gt; head (results_genes) </div><div class="line">&gt; tail (results_genes)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.1</td>
<td style="text-align:center">1.0842110</td>
<td style="text-align:center">0.6894045</td>
<td style="text-align:center">0.9108614</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.10</td>
<td style="text-align:center">0.5255349</td>
<td style="text-align:center">0.2155227</td>
<td style="text-align:center">0.7052821</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.100</td>
<td style="text-align:center">1.1078716</td>
<td style="text-align:center">0.8361049</td>
<td style="text-align:center">0.9714996</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">983</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_110830</td>
<td style="text-align:center">1.2138007</td>
<td style="text-align:center">0.5460477</td>
<td style="text-align:center">0.8687917</td>
</tr>
<tr>
<td style="text-align:center">984</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_131236</td>
<td style="text-align:center">2.0266878</td>
<td style="text-align:center">0.1630176</td>
<td style="text-align:center">0.6591538</td>
</tr>
<tr>
<td style="text-align:center">985</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_131237</td>
<td style="text-align:center">0.8019495</td>
<td style="text-align:center">0.6388593</td>
<td style="text-align:center">0.9074799</td>
</tr>
</tbody>
</table>
<p>总计发现985个在男女两组间有显著差异的基因。</p>
<hr>
<h3 id="13-Add-gene-names-and-gene-IDs-to-the-results-transcripts-data-frame"><a href="#13-Add-gene-names-and-gene-IDs-to-the-results-transcripts-data-frame" class="headerlink" title="13 | Add gene names and gene IDs to the results_transcripts data frame"></a>13 | Add gene names and gene IDs to the <em>results_transcripts</em> data frame</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = data.frame (geneNames=ballgown::geneNames(bg_chrX_filt), geneIDs=ballgown::geneIDs(bg_chrX_filt), results_transcripts)</div><div class="line"><span class="comment"># ballgown::geneNames，代表使用ballgown包中的geneNames函数</span></div><div class="line"><span class="comment"># ballgown::geneIDs，代表使用ballgown包中的geneIDs函数</span></div><div class="line">&gt; head (results_transcripts)</div><div class="line">&gt; tail (results_transcripts)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.9705279</td>
<td style="text-align:center">0.8702505</td>
<td style="text-align:center">0.9680215</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">PLCXD1</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1.8315567</td>
<td style="text-align:center">0.5824978</td>
<td style="text-align:center">0.9194471</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2.2376558</td>
<td style="text-align:center">0.5410260</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">3447</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.1033</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3447</td>
<td style="text-align:center">3.7182648</td>
<td style="text-align:center">0.2045574</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">3448</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.1033</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.5894432</td>
<td style="text-align:center">0.5519984</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">3449</td>
<td style="text-align:center">DDX11L16</td>
<td style="text-align:center">MSTRG.1034</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3449</td>
<td style="text-align:center">0.9296388</td>
<td style="text-align:center">0.8386784</td>
<td style="text-align:center">0.9662358</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="14-Sort-the-results-from-the-smallest-P-value-to-the-largest"><a href="#14-Sort-the-results-from-the-smallest-P-value-to-the-largest" class="headerlink" title="14 | Sort the results from the smallest P value to the largest"></a>14 | Sort the results from the smallest <em>P value</em> to the largest</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = arrange(results_transcripts, pval)</div><div class="line"><span class="comment"># arrange()，是dplyr下的函数，默认状态下，按指定的列对行进行升序排列</span></div><div class="line">&gt; results_genes = arrange(results_genes, pval)</div></pre></td></tr></table></figure>
<p>排序后的results_transcripts如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1623</td>
<td style="text-align:center">0.031022135</td>
<td style="text-align:center">1.600243e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1621</td>
<td style="text-align:center">0.016352577</td>
<td style="text-align:center">3.101146e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">XIST</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1622</td>
<td style="text-align:center">0.003107383</td>
<td style="text-align:center">3.598430e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">2196</td>
<td style="text-align:center">ARMCX5</td>
<td style="text-align:center">MSTRG.650</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1990</td>
<td style="text-align:center">1.0009910</td>
<td style="text-align:center">0.9991690</td>
<td style="text-align:center">0.9994574</td>
</tr>
<tr>
<td style="text-align:center">2197</td>
<td style="text-align:center">MAP7D3</td>
<td style="text-align:center">MSTRG.888</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2848</td>
<td style="text-align:center">1.0005197</td>
<td style="text-align:center">0.9991786</td>
<td style="text-align:center">0.9994574</td>
</tr>
<tr>
<td style="text-align:center">2198</td>
<td style="text-align:center">FHL1</td>
<td style="text-align:center">MSTRG.887</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2844</td>
<td style="text-align:center">0.9993523</td>
<td style="text-align:center">0.9994574</td>
<td style="text-align:center">0.9994574</td>
</tr>
</tbody>
</table>
<p>排序后的results_genes如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">0.002374652</td>
<td style="text-align:center">2.081024e-11</td>
<td style="text-align:center">2.049809e-08</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">0.082721440</td>
<td style="text-align:center">7.853611e-06</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">3.103423470</td>
<td style="text-align:center">1.032255e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">983</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.388</td>
<td style="text-align:center">0.9989017</td>
<td style="text-align:center">0.9977412</td>
<td style="text-align:center">0.9996474</td>
</tr>
<tr>
<td style="text-align:center">984</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.86</td>
<td style="text-align:center">1.0003031</td>
<td style="text-align:center">0.9995072</td>
<td style="text-align:center">0.9996474</td>
</tr>
<tr>
<td style="text-align:center">985</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.933</td>
<td style="text-align:center">1.0002451</td>
<td style="text-align:center">0.9996474</td>
<td style="text-align:center">0.9996474</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="15-Write-the-results-to-a-csv-file-that-can-be-shared-and-distributed"><a href="#15-Write-the-results-to-a-csv-file-that-can-be-shared-and-distributed" class="headerlink" title="15 | Write the results to a csv file that can be shared and distributed"></a>15 | Write the results to a csv file that can be shared and distributed</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; write.csv(results_transcripts, <span class="string">"chrX_transcripts_results.csv"</span>, row.names=FALSE)</div><div class="line">&gt; write.csv (results_genes, <span class="string">"chrX_gene_results.csv"</span>, row.names=FALSE)</div></pre></td></tr></table></figure>
<hr>
<h3 id="16-Identify-transcripts-and-genes-with-a-q-value-lt-0-05"><a href="#16-Identify-transcripts-and-genes-with-a-q-value-lt-0-05" class="headerlink" title="16 | Identify transcripts and genes with a q value &lt;0.05"></a>16 | Identify transcripts and genes with a q value &lt;0.05</h3><p>subset(x, …)，返回向量、矩阵或数据框中满足条件的子集，x代表被子集的对象，…代表补充条件；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; subset (results_transcripts, results_transcripts<span class="variable">$qval</span> &lt; 0.05) <span class="comment"># results_transcripts$qval，代表results_transcripts数据框中的变量qval</span></div><div class="line">&gt; subset (results_genes, results_genes<span class="variable">$qval</span>&lt;0.05)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1623</td>
<td style="text-align:center">0.031022135</td>
<td style="text-align:center">1.600243e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1621</td>
<td style="text-align:center">0.016352577</td>
<td style="text-align:center">3.101146e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">XIST</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1622</td>
<td style="text-align:center">0.003107383</td>
<td style="text-align:center">3.598430e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1624</td>
<td style="text-align:center">0.028430569</td>
<td style="text-align:center">4.552122e-08</td>
<td style="text-align:center">2.501391e-05</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">TSIX</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1620</td>
<td style="text-align:center">0.080804059</td>
<td style="text-align:center">2.230664e-06</td>
<td style="text-align:center">9.806001e-04</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.585</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1812</td>
<td style="text-align:center">7.403215751</td>
<td style="text-align:center">1.083185e-05</td>
<td style="text-align:center">3.968068e-03</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.734</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2296</td>
<td style="text-align:center">0.285432112</td>
<td style="text-align:center">4.293753e-05</td>
<td style="text-align:center">1.236355e-02</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.589</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1816</td>
<td style="text-align:center">9.079691942</td>
<td style="text-align:center">4.499928e-05</td>
<td style="text-align:center">1.236355e-02</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">415</td>
<td style="text-align:center">3.282982493</td>
<td style="text-align:center">9.861143e-05</td>
<td style="text-align:center">2.260472e-02</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">KDM6A</td>
<td style="text-align:center">MSTRG.242</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">721</td>
<td style="text-align:center">0.056618320</td>
<td style="text-align:center">1.028422e-04</td>
<td style="text-align:center">2.260472e-02</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">PNPLA4</td>
<td style="text-align:center">MSTRG.58</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">180</td>
<td style="text-align:center">0.592766066</td>
<td style="text-align:center">1.837704e-04</td>
<td style="text-align:center">3.672066e-02</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">0.002374652</td>
<td style="text-align:center">2.081024e-11</td>
<td style="text-align:center">2.049809e-08</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">0.082721440</td>
<td style="text-align:center">7.853611e-06</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">3.103423470</td>
<td style="text-align:center">1.032255e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.585</td>
<td style="text-align:center">7.275640247</td>
<td style="text-align:center">1.132560e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.734</td>
<td style="text-align:center">0.274009446</td>
<td style="text-align:center">1.719431e-05</td>
<td style="text-align:center">3.387279e-03</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.589</td>
<td style="text-align:center">9.144287534</td>
<td style="text-align:center">4.825828e-05</td>
<td style="text-align:center">7.922401e-03</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.491</td>
<td style="text-align:center">0.638039877</td>
<td style="text-align:center">9.299543e-05</td>
<td style="text-align:center">1.308579e-02</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.58</td>
<td style="text-align:center">0.599529415</td>
<td style="text-align:center">1.561007e-04</td>
<td style="text-align:center">1.921990e-02</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.355</td>
<td style="text-align:center">0.628725310</td>
<td style="text-align:center">2.718713e-04</td>
<td style="text-align:center">2.975480e-02</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.590</td>
<td style="text-align:center">7.808856957</td>
<td style="text-align:center">3.827458e-04</td>
<td style="text-align:center">3.770046e-02</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.213</td>
<td style="text-align:center">1.409064890</td>
<td style="text-align:center">4.535347e-04</td>
<td style="text-align:center">4.061197e-02</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="四、绘图（Data-visualization）"><a href="#四、绘图（Data-visualization）" class="headerlink" title="四、绘图（Data visualization）"></a>四、绘图（Data visualization）</h2><h3 id="17-Make-the-plots-pretty"><a href="#17-Make-the-plots-pretty" class="headerlink" title="17 | Make the plots pretty"></a>17 | Make the plots pretty</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; tropical = c(<span class="string">'darkorange'</span>, <span class="string">'dodgerblue'</span>, <span class="string">'hotpink'</span>, <span class="string">'limegreen'</span>, <span class="string">'yellow'</span>) </div><div class="line">&gt; palette (tropical) <span class="comment">#定义调色板</span></div></pre></td></tr></table></figure>
<h3 id="18-Show-the-distribution-of-gene-abundances-across-samples-colored-by-sex"><a href="#18-Show-the-distribution-of-gene-abundances-across-samples-colored-by-sex" class="headerlink" title="18 | Show the distribution of gene abundances across samples, colored by sex"></a>18 | Show the distribution of gene abundances across samples, colored by sex</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; fpkm = texpr(bg_chrX, meas=<span class="string">"FPKM"</span>) <span class="comment"># texpr(x, meas = "FPKM")，从ballgown中抽取转录本的表达值</span></div><div class="line">&gt; fpkm = log2(fpkm+1) <span class="comment"># +1的原因是避免出现log2(0)</span></div><div class="line">&gt; boxplot(fpkm, col=as.numeric(pheno_data<span class="variable">$sex</span>), las=2, ylab=<span class="string">'log2(FPKM+1)'</span>)</div><div class="line"><span class="comment"># las=2，定义坐标轴标记为垂直，默认las=1，即水平；ylab，定义y轴；</span></div></pre></td></tr></table></figure>
<p>fpkm如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">FPKM.ERR188044</th>
<th style="text-align:center">FPKM.ERR188104</th>
<th style="text-align:center">FPKM.ERR188234</th>
<th style="text-align:center">FPKM.ERR188245</th>
<th style="text-align:center">FPKM.ERR188257</th>
<th style="text-align:center">FPKM.ERR188273</th>
<th style="text-align:center">FPKM.ERR188337</th>
<th style="text-align:center">FPKM.ERR188383</th>
<th style="text-align:center">FPKM.ERR188401</th>
<th style="text-align:center">FPKM.ERR188428</th>
<th style="text-align:center">FPKM.ERR188454</th>
<th style="text-align:center">FPKM.ERR204916</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.658196</td>
<td style="text-align:center">4.287118</td>
<td style="text-align:center">5.348706</td>
<td style="text-align:center">3.878832</td>
<td style="text-align:center">4.730237</td>
<td style="text-align:center">4.636182</td>
<td style="text-align:center">4.997749</td>
<td style="text-align:center">4.442006</td>
<td style="text-align:center">4.861568</td>
<td style="text-align:center">4.700369</td>
<td style="text-align:center">4.872868</td>
<td style="text-align:center">4.410593</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.849373</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.523984</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.747225</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.750170</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.121661</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.345735</td>
<td style="text-align:center">5.597809</td>
<td style="text-align:center">5.524776</td>
<td style="text-align:center">5.223788</td>
<td style="text-align:center">5.967379</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">3447</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">7.0420943</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">3.699866</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.2154062</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">6.646315</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3449</td>
<td style="text-align:center">1.007382</td>
<td style="text-align:center">1.979173</td>
<td style="text-align:center">1.7364404</td>
<td style="text-align:center">1.343544</td>
<td style="text-align:center">0.6354767</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">1.047157</td>
<td style="text-align:center">1.739338</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
</tbody>
</table>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-c5ff5c5b0ea9d2c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="19-Make-plots-of-individual-transcripts-across-samples"><a href="#19-Make-plots-of-individual-transcripts-across-samples" class="headerlink" title="19 | Make plots of individual transcripts across samples"></a>19 | Make plots of individual transcripts across samples</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; ballgown::transcriptNames(bg_chrX)[9] <span class="comment"># 第九个转录本的名称</span></div><div class="line"><span class="comment"># 9</span></div><div class="line"><span class="comment"># "NM_012227"</span></div><div class="line">&gt; ballgown::geneNames(bg_chrX)[9] <span class="comment"># 第九个基因的名称</span></div><div class="line"><span class="comment"># 9</span></div><div class="line"><span class="comment"># "GTPBP6"</span></div><div class="line">&gt; plot (fpkm[9,] ~ pheno_data<span class="variable">$sex</span>, border=c(1,2), main=paste(ballgown::geneNames(bg_chrX)[9],<span class="string">':'</span>,ballgown::transcriptNames(bg_chrX)[9]), pch=19, xlab=<span class="string">"Sex"</span>, ylab=<span class="string">'log2(FPKM+1)'</span>)</div><div class="line">&gt; points(fpkm[9,] ~ jitter(as.numeric(pheno_data<span class="variable">$sex</span>)), col=as.numeric(pheno_data<span class="variable">$sex</span>))</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-b64fa21011cd51e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="20-Plot-the-structure-and-expression-levels-in-a-sample-of-all-transcripts-that-share-the-same-gene-locus"><a href="#20-Plot-the-structure-and-expression-levels-in-a-sample-of-all-transcripts-that-share-the-same-gene-locus" class="headerlink" title="20 | Plot the structure and expression levels in a sample of all transcripts that share the same gene locus"></a>20 | Plot the structure and expression levels in a sample of all transcripts that share the same gene locus</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plotTranscripts(ballgown::geneIDs(bg_chrX)[1622], bg_chrX, main=c(<span class="string">'Gene XIST in sample ERR188234'</span>), sample=c(<span class="string">'ERR188234'</span>))</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-17b30d74aeb41597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="21-Plot-the-average-expression-levels-for-all-transcripts-of-a-gene-within-different-groups"><a href="#21-Plot-the-average-expression-levels-for-all-transcripts-of-a-gene-within-different-groups" class="headerlink" title="21 | Plot the average expression levels for all transcripts of a gene within different groups"></a>21 | Plot the average expression levels for all transcripts of a gene within different groups</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plotMeans (<span class="string">'MSTRG.56'</span>, bg_chrX_filt, groupvar=<span class="string">"sex"</span>, legend=FALSE)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-db5a8b809b1ef072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;参考文献：&lt;a href=&quot;https://link.jianshu.com/?t=http://www.nature.com/nprot/journal/v11/n9/full/nprot.2016.095.html&quot; target=&quot;_blank&quot; rel=&quot;exter
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记4-随机数的产生</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/"/>
    <id>http://uteric.github.io/R语言学习笔记4/</id>
    <published>2018-04-10T04:05:30.000Z</published>
    <updated>2018-04-10T04:05:30.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、均匀分布随机数"><a href="#1、均匀分布随机数" class="headerlink" title="1、均匀分布随机数"></a>1、均匀分布随机数</h2><p>在R语言中，生成均匀分布随机数的函数是：runif()</p>
<p>基本语法：runif(n, min=0, max=1)，n表示生成的随机数的数量，min表示均匀分布的下限，max表示均匀分布的上限；在默认状态下，min=0，max=1，也可以指定。</p>
<p>例1：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; runif(10) <span class="comment"># 生成10个[0,1]上的均匀分布随机数</span></div><div class="line">[1] 0.22640211 0.44554231 0.51034146 0.43492569 0.02381349 0.16912671 0.56014004 0.67121007 0.99790301 0.72515818</div></pre></td></tr></table></figure>
<p>例2：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; runif(5,.5,3) <span class="comment"># 生成5个均匀分布随机数，并指定其分布区间[0.5,3]</span></div><div class="line">[1] 1.559970 2.113296 1.405775 2.280277 1.398960</div></pre></td></tr></table></figure>
<hr>
<h2 id="2、正态分布随机数"><a href="#2、正态分布随机数" class="headerlink" title="2、正态分布随机数"></a>2、正态分布随机数</h2><p>在R语言中，生成正态分布随机数的函数是：rnorm()</p>
<p>基本语法：rnorm(n,mean=0,sd=1)，其中，n表示随机数的数量，mean表示正太分布的均值，默认为0，sd表示正太分布的标准差，默认为1；</p>
<p>例3：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=rnorm(100) <span class="comment"># 生成100个均值为0，标准差为1的正态分布随机数</span></div><div class="line">&gt; hist(x,prob=T,main=<span class="string">"normal mu=0,sigma=1"</span>) <span class="comment"># 作概率直方图</span></div><div class="line">&gt; curve(dnorm(x),add=T) <span class="comment"># 添加正态分布的密度函数线</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="3、二项分布随机数"><a href="#3、二项分布随机数" class="headerlink" title="3、二项分布随机数"></a>3、二项分布随机数</h2><p>在R语言中，生成二项分布随机数的函数是：rbinom()</p>
<p>基本语法：rbinom(n,size,prob)，n表示生成的随机数的数量（代表试验成功的次数，涵义解释参见《<a href="https://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/">R语言学习笔记3-生成二项分布随机数</a>》），size表示进行伯努利试验的次数，prob表示一次伯努利试验成功的概率。</p>
<p>例4：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; rbinom(20,100,.5)</div><div class="line">[1] 52 53 45 52 43 53 56 47 53 51 53 51 50 51 48 51 48 48 51 52</div></pre></td></tr></table></figure>
<hr>
<h2 id="4、指数分布随机数"><a href="#4、指数分布随机数" class="headerlink" title="4、指数分布随机数"></a>4、指数分布随机数</h2><p>在R语言中，生成指数分布随机数的函数是rexp()</p>
<p>基本语法：rexp(n,lamda=1)，n表示生成的指数分布随机数的数量，lamda表示指数分布随机数的均值的倒数，即lamda=1/mean，默认为1，即默认生成均值为10的随机数。</p>
<p>例5：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=rexp(100) <span class="comment"># 生成100个均值为1的指数分布随机数</span></div><div class="line">&gt; mean(x) <span class="comment"># 查看均值，约为1</span></div><div class="line">[1] 1.1335</div></pre></td></tr></table></figure>
<p>例6：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; x=rexp(100,1/10) <span class="comment"># 生成100个均值为10的指数分布随机数</span></div><div class="line">&gt; mean(x)</div><div class="line">[1] 10.50919</div><div class="line">&gt; x=rexp(100,.1) <span class="comment"># .1同1/10</span></div><div class="line">&gt; mean(x)</div><div class="line">[1] 9.366332</div><div class="line">&gt; hist(x,prob=T,col=gray(.9),main=<span class="string">"mean=10"</span>) <span class="comment"># 作直方图</span></div><div class="line">&gt; curve(dexp(x,1/10),add=T) <span class="comment"># 添加指数分布密度线</span></div></pre></td></tr></table></figure>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、均匀分布随机数&quot;&gt;&lt;a href=&quot;#1、均匀分布随机数&quot; class=&quot;headerlink&quot; title=&quot;1、均匀分布随机数&quot;&gt;&lt;/a&gt;1、均匀分布随机数&lt;/h2&gt;&lt;p&gt;在R语言中，生成均匀分布随机数的函数是：runif()&lt;/p&gt;
&lt;p&gt;基本语法：ru
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记3-生成二项分布随机数</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/"/>
    <id>http://uteric.github.io/R语言学习笔记3/</id>
    <published>2018-04-07T23:31:44.000Z</published>
    <updated>2018-04-07T23:31:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="伯努利试验"><a href="#伯努利试验" class="headerlink" title="伯努利试验"></a>伯努利试验</h2><p>首先简单介绍一下<strong>伯努利试验（Bernoulli experiment）</strong>。</p>
<p>伯努利试验，是指在同样的条件下，重复地，相互独立地，进行的一种随机试验，该随机试验只有两种结果：<del>发生或不发生</del>。</p>
<p>假设：该项试验重复独立地进行了N次，则称为<strong>N重伯努利试验</strong>，N即为该试验的SIZE。</p>
<p><del>比如，连续抛N次硬币，每次抛硬币相互独立互不影响，结果只能是“正面”或者“反面”，得到正面的概率为0.5，每次抛硬币的试验即为伯努利试验。</del></p>
<hr>
<h2 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h2><p>多次伯努利试验的分布概率，即为二项分布；换句话说，当二项分布的试验次数为1时，符合伯努利试验。</p>
<hr>
<h2 id="生成二项分布随机数"><a href="#生成二项分布随机数" class="headerlink" title="生成二项分布随机数"></a>生成二项分布随机数</h2><p>在R语言中，生成二项分布随机数的函数是：<strong>rbinom()</strong></p>
<p>基本语法：rbinom(n,size,prob)，n表示生成的随机数的数量，size表示进行伯努利试验的次数，prob表示一次伯努利试验成功的概率。</p>
<p>仍以抛硬币为例，总共抛硬币100次（size=100），得到正面记为成功，即每次成功概率为0.5（prob=0.5），那么，n的含义是什么呢？现在，我们让计算机模拟30个随机数，看看这30个数字有何特点，据此来解释n的含义。</p>
<p>在本例中，n=30，size=100，prob=0.5，在R中输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rbinom(30,100,.5) <span class="comment"># 小数点前的0可以省略</span></div><div class="line">[1] 52 39 45 53 51 53 52 43 50 51 52 48 56 47 43 53 47 47 52 53 49 43 51 50 44 57 54 59 43 48</div></pre></td></tr></table></figure>
<p>仔细观察就会发现，生成的30个随机数都在50左右徘徊，这是为什么呢？因为每次伯努利试验（抛硬币）的成功概率是0.5，那么在理想状态下，模拟100次伯努利试验（抛100次硬币），成功的次数应为50次，由此可见，在函数rbinom()中，<strong>n的含义是伯努利试验成功的次数</strong>。</p>
<p>可以想见，如果模拟伯努利试验的次数减少，n值的偏差将会变大，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; rbinom(10,10,.5)</div><div class="line">[1] 5 6 6 4 4 4 3 5 6 8</div></pre></td></tr></table></figure>
<p>在本例中，单次试验的成功概率依旧为0.5，但是只模拟10次试验，并生成10个随机数，最大的数为8，远远偏离预期的5。</p>
<p>注意：在rbinom()函数中，n可以大于size，比如rbinom(100,10,.5)。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;伯努利试验&quot;&gt;&lt;a href=&quot;#伯努利试验&quot; class=&quot;headerlink&quot; title=&quot;伯努利试验&quot;&gt;&lt;/a&gt;伯努利试验&lt;/h2&gt;&lt;p&gt;首先简单介绍一下&lt;strong&gt;伯努利试验（Bernoulli experiment）&lt;/strong&gt;。&lt;/p&gt;

    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记2</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/"/>
    <id>http://uteric.github.io/R语言学习笔记2/</id>
    <published>2018-04-07T22:15:58.000Z</published>
    <updated>2018-04-07T22:15:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、数学运算（Arithmetic-Operators）"><a href="#1、数学运算（Arithmetic-Operators）" class="headerlink" title="1、数学运算（Arithmetic Operators）"></a>1、数学运算（Arithmetic Operators）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># BASIC ARITHMETIC OPERATORS</span></div><div class="line">&gt; 2-5+1 <span class="comment"># 加减法</span></div><div class="line">[1] -2</div><div class="line">&gt; 6/3*2 <span class="comment"># 乘除法</span></div><div class="line">[1] 4</div><div class="line">&gt; 3+2*5 <span class="comment"># 混合运算</span></div><div class="line">[1] 13</div><div class="line">&gt; 4^3 <span class="comment"># 4的3次方，^代表乘幂</span></div><div class="line">[1] 64</div><div class="line">&gt; exp(4) <span class="comment"># 自然常数e的乘幂，即e^4</span></div><div class="line">[1] 54.59815</div><div class="line">&gt; <span class="built_in">log</span>(2.742) <span class="comment"># 某数的自然对数</span></div><div class="line">[1] 1.008688</div><div class="line">&gt; log10(1000) <span class="comment"># 某数以10为底的对数</span></div><div class="line">[1] 3</div><div class="line">&gt; pi <span class="comment"># 圆周率π</span></div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="2、变量（Variables）"><a href="#2、变量（Variables）" class="headerlink" title="2、变量（Variables）"></a>2、变量（Variables）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VARIABLES</span></div><div class="line">x &lt;- 3 <span class="comment"># 将3储存到变量x</span></div><div class="line">x <span class="comment"># 输出x，也可以使用print(x)</span></div><div class="line">[1] 3</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根</span></div><div class="line">[1] 1.732051</div><div class="line">&gt; x^4 <span class="comment"># 指定次方</span></div><div class="line">[1] 81</div><div class="line">&gt; <span class="built_in">log</span>(x) <span class="comment"># 自然对数</span></div><div class="line">[1] 1.098612</div><div class="line">&gt; log10(x) <span class="comment"># 以10为底对数</span></div><div class="line">[1] 0.4771213</div><div class="line">&gt; exp(x) 自然常数的指定次方</div><div class="line">[1] 20.08554</div><div class="line">&gt; tan(x) <span class="comment"># tan</span></div><div class="line">[1] -0.1425465</div><div class="line">&gt; y &lt;- pi <span class="comment"># 将圆周率π的值储存为变量y</span></div><div class="line">&gt; y</div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="3、向量（VECTORS）"><a href="#3、向量（VECTORS）" class="headerlink" title="3、向量（VECTORS）"></a>3、向量（VECTORS）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VECTORS</span></div><div class="line">&gt; x &lt;- c(2,3,5,1,4,4) <span class="comment"># 创建向量x，值为（2,3,5,1,4,4) </span></div><div class="line">&gt; x</div><div class="line">[1] 2 3 5 1 4 4</div><div class="line">&gt; sum(x) <span class="comment"># 求和</span></div><div class="line">[1] 19</div><div class="line">&gt; mean(x) <span class="comment"># 平均值</span></div><div class="line">[1] 3.166667</div><div class="line">&gt; sd(x) <span class="comment"># 标准差</span></div><div class="line">[1] 1.47196</div><div class="line">&gt; median(x) <span class="comment"># 中位数</span></div><div class="line">[1] 3.5</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根 </span></div><div class="line">[1] 1.414214 1.732051 2.236068 1.000000 2.000000 2.000000</div><div class="line">&gt; x^2 <span class="comment"># 指定次方</span></div><div class="line">[1]  4  9 25  1 16 16</div><div class="line">&gt; seq(1,10) <span class="comment"># 创建向量，从1开始，每次增加1，至10结束；或者使用seq(1:10)</span></div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10</div><div class="line">&gt; seq(1,10,2) <span class="comment"># 创建向量，从1开始，每次增加2，至10结束；或者使用seq(1,10,by=2)</span></div><div class="line">[1] 1 3 5 7 9</div><div class="line">&gt; z &lt;- c(1:12,0,-6) <span class="comment"># 将值添加到向量中</span></div><div class="line">&gt; z</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12  0 -6</div><div class="line">------------------------------------------------------</div><div class="line">&gt; x &lt;- c(-5,0,7,-6,14,27) <span class="comment"># 创建向量</span></div><div class="line">&gt; x</div><div class="line">[1] -5  0  7 -6 14 27</div><div class="line">&gt; x[1] <span class="comment"># 输出第一个元素</span></div><div class="line">[1] -5</div><div class="line">&gt; x[7] <span class="comment"># 输出第七个元素，因为x向量一共6个元素，因此返回NA</span></div><div class="line">[1] NA</div><div class="line">&gt; length(x) <span class="comment"># x向量的元素个数</span></div><div class="line">[1] 6</div><div class="line">&gt; x[length(x)] <span class="comment"># 输出最后一个元素</span></div><div class="line">[1] 27</div><div class="line">&gt; x[-1] <span class="comment"># 输出除第一个以外的其他元素</span></div><div class="line">[1]  0  7 -6 14 27</div><div class="line">&gt; x <span class="comment"># 注意，上述操作并不改变x向量的组成</span></div><div class="line">[1] -5  0  7 -6 14 27 </div><div class="line">&gt; x[c(2,3)] <span class="comment"># 输出第二第三个元素</span></div><div class="line">[1] 0 7</div><div class="line">&gt; x[-c(2,3)] <span class="comment"># 输出除第二第三以外的其他元素</span></div><div class="line">[1] -5 -6 14 27</div><div class="line">&gt; x[2] &lt;- 5 <span class="comment"># 修改第二个元素为5</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27</div><div class="line">&gt; x[7] &lt;-3 <span class="comment"># 修改第七个元素为3，若不存在则添加</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27  3</div><div class="line">&gt; x[c(1,4)] &lt;- c(2,3) <span class="comment"># 同时修改多个元素</span></div><div class="line">&gt; x</div><div class="line">[1]  2  5  7  3 14 27  3</div><div class="line">&gt; x &lt;3 <span class="comment"># 给出逻辑判断</span></div><div class="line">[1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</div><div class="line">&gt; <span class="built_in">which</span>(x&lt;3) <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的位置</span></div><div class="line">[1] 1</div><div class="line">&gt; x[x&lt;3] <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的值</span></div><div class="line">[1] 2</div></pre></td></tr></table></figure>
<h2 id="4、矩阵（MATRIX"><a href="#4、矩阵（MATRIX" class="headerlink" title="4、矩阵（MATRIX)"></a>4、矩阵（MATRIX)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># MATRIX</span></div><div class="line">&gt; matrix(1:20,nrow=4,ncol=5) <span class="comment"># 创建矩阵，从1到20，共20个元素，4行5列，按列填充</span></div><div class="line">[,1] [,2] [,3] [,4] [,5]</div><div class="line">[1,]    1    5    9   13   17</div><div class="line">[2,]    2    6   10   14   18</div><div class="line">[3,]    3    7   11   15   19</div><div class="line">[4,]    4    8   12   16   20</div><div class="line">&gt; matrix(1:30,5,6) <span class="comment"># 简化输入方式</span></div><div class="line">[,1] [,2] [,3] [,4] [,5] [,6]</div><div class="line">[1,]    1    6   11   16   21   26</div><div class="line">[2,]    2    7   12   17   22   27</div><div class="line">[3,]    3    8   13   18   23   28</div><div class="line">[4,]    4    9   14   19   24   29</div><div class="line">[5,]    5   10   15   20   25   30</div></pre></td></tr></table></figure>
<h2 id="5、作图（GRAPHING）"><a href="#5、作图（GRAPHING）" class="headerlink" title="5、作图（GRAPHING）"></a>5、作图（GRAPHING）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRAPHING</span></div><div class="line"><span class="comment"># 创建2个长度为29的向量x，y</span></div><div class="line">&gt; x &lt;- c(2,4,4,6,6,5,5,7,3,7,3,8,9,7,9,6,4,3,4,4,6,2,2,1,2,4,6,6,8)</div><div class="line">&gt; y &lt;- c(1:29)</div><div class="line">&gt; x</div><div class="line">[1] 2 4 4 6 6 5 5 7 3 7 3 8 9 7 9 6 4 3 4 4 6 2 2 1 2 4 6 6 8</div><div class="line">&gt; y</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29</div><div class="line">&gt; hist(x) <span class="comment"># x的直方图</span></div><div class="line">&gt; hist(y) <span class="comment"># y的直方图</span></div><div class="line">&gt; plot(x) <span class="comment"># 散点图</span></div><div class="line">&gt; plot(x,<span class="built_in">type</span>=<span class="string">"b"</span>) <span class="comment"># 带连线的散点图，指示顺序</span></div><div class="line">&gt; plot(x,y) <span class="comment"># 二维散点图</span></div><div class="line">&gt; boxplot(x) <span class="comment"># 箱线图</span></div><div class="line">&gt; boxplot(x,y) <span class="comment"># 两个向量的箱线图</span></div><div class="line">&gt; pie(x) <span class="comment"># 饼图</span></div><div class="line">&gt; y &lt;- rbinom(20,12,.4) <span class="comment"># rbinom可生成随机数，语法为rbinom(n, size, prob)，即产生n个b(size,prob)的二项分布随机数</span></div><div class="line">&gt; hist(y) <span class="comment"># 可以看到，生成的直方图不是经典的二项分布</span></div><div class="line">&gt; y &lt;- rbinom(200,12,.4) <span class="comment"># 生成200个随机数，符合二项分布</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、数学运算（Arithmetic-Operators）&quot;&gt;&lt;a href=&quot;#1、数学运算（Arithmetic-Operators）&quot; class=&quot;headerlink&quot; title=&quot;1、数学运算（Arithmetic Operators）&quot;&gt;&lt;/a&gt;1、
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记8-使用DESeq2进行表达差异分析</title>
    <link href="http://uteric.github.io/RNASEQ%E4%BD%BF%E7%94%A8DESeq2%E8%BF%9B%E8%A1%8C%E8%A1%A8%E8%BE%BE%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90/"/>
    <id>http://uteric.github.io/RNASEQ使用DESeq2进行表达差异分析/</id>
    <published>2018-04-06T04:11:52.000Z</published>
    <updated>2018-04-06T04:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：</p>
<p><strong>1、在R中安装DESeq2软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div><div class="line">library(<span class="string">"DESeq2"</span>) <span class="comment"># 测试是否安装成功</span></div></pre></td></tr></table></figure>
<p>如果安装出错，请移步前文：《<a href="https://uteric.github.io/MAC%E5%AE%89%E8%A3%85DESeq2%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">MAC安装DESeq2报错及解决方案</a>》，作为一个生信小白，我花了3天时间才把安装DESeq2的问题解决，一路全是坑啊！</p>
<hr>
<p><strong>2、导入分析数据</strong></p>
<p>我们还是使用《<a href="https://uteric.github.io/RNASEQ%20HTSeq%E5%AE%9A%E9%87%8F%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/">RNASEQ分析入门笔记7-HTSeq定量基因表达水平</a>》中得到的数据进行分析，首先回顾一下：</p>
<p>上文中，我们得到了raw_count_filt2矩阵，格式如下（执行：tail (raw_count_filt2, n=5):</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ENSMUSG00000110420</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110421</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110422</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110423</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110424</td>
<td style="text-align:center">26</td>
<td style="text-align:center">20</td>
<td style="text-align:center">48</td>
<td style="text-align:center">24</td>
</tr>
</tbody>
</table>
<p>可以看到，该矩阵实际只有4列，是由整数组成的，而最前面的一列是行名，可以直接从保存的.csv文件中导入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt2 &lt;- read.csv (<span class="string">"raw_count_filt2.csv"</span>)  <span class="comment"># 从保存的.csv文件导入数据，并赋值给raw_count_filt2</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>3、加载DESeq2并设置样品信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(DESeq2) <span class="comment"># 加载DESeq2包</span></div><div class="line">countData &lt;- raw_count_filt2 <span class="comment"># 表达矩阵</span></div><div class="line">condition &lt;- factor(c(<span class="string">"control"</span>,<span class="string">"control"</span>,<span class="string">"KD"</span>,<span class="string">"KD"</span>)) <span class="comment"># 定义condition</span></div><div class="line">colData &lt;- data.frame(row.names=colnames(countData), condition) <span class="comment"># 样品信息矩阵</span></div></pre></td></tr></table></figure>
<p>condition：</p>
<blockquote>
<p>[1] control control KD      KD<br>Levels: KD control</p>
</blockquote>
<p>colData：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">condition</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">control1</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">control2</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">rep1</td>
<td style="text-align:center">KD</td>
</tr>
<tr>
<td style="text-align:center">rep2</td>
<td style="text-align:center">KD</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>4、构建dds矩阵</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData, DataFrame(condition), design= ~ condition ) <span class="comment"># 构建dds矩阵</span></div><div class="line">head(dds) <span class="comment"># 查看dds矩阵的前6行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>class: DESeqDataSet<br>dim: 6 4<br>metadata(1): version<br>assays(1): counts<br>rownames(6): ENSMUSG00000000001 ENSMUSG00000000003 …<br>ENSMUSG00000000037 ENSMUSG00000000049<br>rowData names(0):<br>colnames(4): control1 control2 rep1 rep2<br>colData names(1): condition</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dds2 &lt;- DESeq(dds) <span class="comment"># 对dds进行Normalize</span></div></pre></td></tr></table></figure>
<p>运行成功会有如下提示：</p>
<blockquote>
<p>estimating size factors<br>estimating dispersions<br>gene-wise dispersion estimates<br>mean-dispersion relationship<br>final dispersion estimates<br>fitting model and testing</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">resultsNames（dds) <span class="comment"># 查看结果的名称</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “Intercept”               “condition_control_vs_KD”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res &lt;- results(dds) <span class="comment"># 使用results()函数获取结果，并赋值给res</span></div><div class="line">head (res, n=5) <span class="comment"># 查看res矩阵的前5行</span></div></pre></td></tr></table></figure>
<p>输出的res矩阵有6列，分别是：baseMean，log2FoldChange，lfcSE，pvalue，padj：</p>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..0001</td>
<td style="text-align:center">2359.75391</td>
<td style="text-align:center">-0.08461265</td>
<td style="text-align:center">0.2081281</td>
<td style="text-align:center">-0.4065413</td>
<td style="text-align:center">0.68434494</td>
<td style="text-align:center">0.9040654</td>
</tr>
<tr>
<td style="text-align:center">E..0003</td>
<td style="text-align:center">0.00000</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
</tr>
<tr>
<td style="text-align:center">E..0028</td>
<td style="text-align:center">1027.82363</td>
<td style="text-align:center">0.03638541</td>
<td style="text-align:center">0.2036829</td>
<td style="text-align:center">0.1786375</td>
<td style="text-align:center">0.85822232</td>
<td style="text-align:center">0.9618582</td>
</tr>
<tr>
<td style="text-align:center">E..0031</td>
<td style="text-align:center">65.37333</td>
<td style="text-align:center">0.94588315</td>
<td style="text-align:center">0.4428518</td>
<td style="text-align:center">2.1358912</td>
<td style="text-align:center">0.03268828</td>
<td style="text-align:center">0.2511131</td>
</tr>
<tr>
<td style="text-align:center">E..0037</td>
<td style="text-align:center">69.75843</td>
<td style="text-align:center">0.11587980</td>
<td style="text-align:center">0.4400431</td>
<td style="text-align:center">0.2633374</td>
<td style="text-align:center">0.79229054</td>
<td style="text-align:center">0.9422796</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mcols(res,use.names= TRUE) <span class="comment"># 查看res矩阵每一列的含义</span></div></pre></td></tr></table></figure>
<blockquote>
<p>DataFrame with 6 rows and 2 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">type</th>
<th style="text-align:center">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><character></character></td>
<td style="text-align:center"><character></character></td>
</tr>
<tr>
<td style="text-align:center">baseMean</td>
<td style="text-align:center">intermediate</td>
<td style="text-align:center">mean of normalized counts for all samples</td>
</tr>
<tr>
<td style="text-align:center">log2FoldChange</td>
<td style="text-align:center">results</td>
<td style="text-align:center">log2 fold change (MLE): condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">lfcSE</td>
<td style="text-align:center">results</td>
<td style="text-align:center">standard error: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">stat</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald statistic: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">pvalue</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald test p-value: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">padj</td>
<td style="text-align:center">results</td>
<td style="text-align:center">BH adjusted p-values</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary(res) <span class="comment"># 对res矩阵进行总结</span></div></pre></td></tr></table></figure>
<blockquote>
<p>out of 28335 with nonzero total read count<br>adjusted p-value &lt; 0.1<br>LFC &gt; 0 (up)     : 445, 1.6%<br>LFC &lt; 0 (down)   : 625, 2.2%<br>outliers [1]     : 0, 0%<br>low counts [2]   : 12683, 45%<br>(mean count &lt; 18)<br>[1] see ‘cooksCutoff’ argument of ?results<br>[2] see ‘independentFiltering’ argument of ?results</p>
</blockquote>
<p>其中，445个基因表达上调，625个基因表达下降，可靠程度是：p-value &lt; 0.1</p>
<hr>
<p><strong>5、提取差异分析结果</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">table(res<span class="variable">$padj</span>&lt;0.05) <span class="comment"># 取padj小于0.05的数据，得到743行</span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">FALSE</th>
<th style="text-align:center">TRUE</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">14909</td>
<td style="text-align:center">743</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res &lt;- res[order(res<span class="variable">$padj</span>),] <span class="comment"># 按照padj的大小将res重新排列</span></div><div class="line">diff_gene_deseq2 &lt;- subset(res,padj &lt; 0.05 &amp; (log2FoldChange &gt;1 | log2FoldChange &lt; -1)) <span class="comment"># 获取padj小于0.05，表达倍数取以2为对数后绝对值大于1的差异表达基因，赋值给diff_gene_deseq2</span></div><div class="line">head (diff_gene_deseq2, n=5) <span class="comment"># 查看diff_gene_deseq2矩阵的前5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
</tr>
<tr>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
</tr>
<tr>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
</tr>
<tr>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
<tr>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">diff_gene_deseq2 &lt;- row.names(diff_gene_deseq2) <span class="comment"># 提取diff_gene_deseq2的行名</span></div><div class="line">head (diff_gene_deseq2, n=5)</div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “ENSMUSG00000003309”<br>[2] “ENSMUSG00000046323”<br>[3] “ENSMUSG00000001123”<br>[4] “ENSMUSG00000018569”<br>[5] “ENSMUSG00000023906”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">resdata &lt;- merge (as.data.frame(res),as.data.frame(counts(dds,normalize=TRUE)),by=<span class="string">"row.names"</span>,sort=FALSE)</div><div class="line">head (resdata,n=5)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Row.names</th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FC</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
<td style="text-align:center">1073.9977</td>
<td style="text-align:center">908.7239</td>
<td style="text-align:center">125.93083</td>
<td style="text-align:center">84.11803</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
<td style="text-align:center">723.4828</td>
<td style="text-align:center">721.5049</td>
<td style="text-align:center">97.10329</td>
<td style="text-align:center">74.66657</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
<td style="text-align:center">679.8243</td>
<td style="text-align:center">515.6735</td>
<td style="text-align:center">84.96538</td>
<td style="text-align:center">86.95347</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1113.9140</td>
<td style="text-align:center">630.6325</td>
<td style="text-align:center">127.44807</td>
<td style="text-align:center">69.94083</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1862.3445</td>
<td style="text-align:center">1333.5250</td>
<td style="text-align:center">351.99943</td>
<td style="text-align:center">259.91526</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.csv(resdata, file=<span class="string">"control_vs_akap95.csv"</span>) <span class="comment"># 将结果写入control_vs_akap95.csv文件</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1、在R中安装DESeq2软件包&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>MAC安装DESeq2报错及解决方案</title>
    <link href="http://uteric.github.io/MAC%E5%AE%89%E8%A3%85DESeq2%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://uteric.github.io/MAC安装DESeq2报错及解决方案/</id>
    <published>2018-04-05T01:43:45.000Z</published>
    <updated>2018-04-05T01:43:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="在R环境中安装DESeq2"><a href="#在R环境中安装DESeq2" class="headerlink" title="在R环境中安装DESeq2"></a>在R环境中安装DESeq2</h2><p><strong>1、安装DESeq2基本语法：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div><div class="line">library(<span class="string">"DESeq2"</span>) <span class="comment"># 测试是否安装成功</span></div></pre></td></tr></table></figure>
<p><strong>2、报错信息</strong></p>
<p>我的系统是MacOS 10.10.5，执行安装命令后各种报错：</p>
<hr>
<p><del>fatal error:<br><strong>‘string.h’ file not found</strong><br>include <string.h>            /<em> for memcpy, memset </em>/<br>1 error generated.<br>make: <em>*</em> [000.init.o] Error 1<br>ERROR: compilation failed for package ‘matrixStats’</string.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘math.h’ file not found</strong><br>include_next <math.h><br>1 error generated.<br>make: <em>*</em> [DbColumn.o] Error 1<br>ERROR: compilation failed for package ‘RSQLite’</math.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘ctype.h’ file not found</strong><br>include <ctype.h><br>1 error generated.<br>make: <em>*</em> [DocParse.o] Error 1<br>ERROR: compilation failed for package ‘XML’</ctype.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdlib.h’ file not found</strong><br>include <stdlib.h> /<em> Not used by R itself, but widely assumed in packages </em>/<br>1 error generated.<br>make: <em>*</em> [all_missing.o] Error 1<br>ERROR: compilation failed for package ‘checkmate’</stdlib.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘string.h’ file not found</strong><br>include <string.h><br>/<em> for memcpy, memset </em>/<br>1 error generated.<br>make: <em>*</em> [AEbufs.o] Error 1<br>ERROR: compilation failed for package ‘S4Vectors’</string.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdio.h’ file not found</strong><br>include <stdio.h><br>1 error generated.<br>make: <em>*</em> [Rinit.o] Error 1<br>ERROR: compilation failed for package ‘Biobase’</stdio.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘unistd.h’ file not found</strong><br>include <unistd.h><br>1 error generated.<br>make: <em>*</em> [ipcmutex.o] Error 1<br>ERROR: compilation failed for package ‘BiocParallel’</unistd.h></del></p>
<hr>
<p><del>fatal error:<br><strong>‘stdlib.h’ file not found</strong><br>include <stdlib.h><br>1 error generated.<br>make: <em>*</em> [S_enter.o] Error 1<br>ERROR: compilation failed for package ‘locfit’</stdlib.h></del></p>
<hr>
<p><del>configure: error:<br><strong>cannot run C++ compiled programs.</strong><br>If you meant to cross compile, use <code>--host&#39;.
See</code>config.log’ for more details<br>ERROR: configuration failed for package ‘RcppArmadillo’</del></p>
<hr>
<p><em>There were 22 warnings (use warnings() to see them)</em><br><strong>warnings()</strong><br>Warning messages:<br>1: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘matrixStats’ had non-zero exit status<br>2: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘RSQLite’ had non-zero exit status<br>3: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘XML’ had non-zero exit status<br>4: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘checkmate’ had non-zero exit status<br>5: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘S4Vectors’ had non-zero exit status<br>6: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘Biobase’ had non-zero exit status<br>7: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘BiocParallel’ had non-zero exit status<br>8: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘locfit’ had non-zero exit status<br>9: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘RcppArmadillo’ had non-zero exit status<br>10: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘htmlTable’ had non-zero exit status<br>11: In install.packages(pkgs = doing, lib = lib, …) :<br> installation of package ‘IRanges’ had non-zero exit status<br>12: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘GenomeInfoDb’ had non-zero exit status<br>13: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘XVector’ had non-zero exit status<br>14: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘DelayedArray’ had non-zero exit status<br>15: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘AnnotationDbi’ had non-zero exit status<br>16: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘Hmisc’ had non-zero exit status<br>17: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘annotate’ had non-zero exit status<br>18: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘GenomicRanges’ had non-zero exit status<br>19: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘SummarizedExperiment’ had non-zero exit status<br>20: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘genefilter’ had non-zero exit status<br>21: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘geneplotter’ had non-zero exit status<br>22: In install.packages(pkgs = doing, lib = lib, …) :<br>installation of package ‘DESeq2’ had non-zero exit status</p>
<hr>
<p><strong>3、报错原因</strong></p>
<p>根据返回的报错信息，可以知道，系统中缺乏’string.h’，’math.h’，’ctype.h’，’stdlib.h’，’stdio.h’，’unistd.h’这些文件，这些文件都是C++ library中得Header files，因此，需要安装C++，或者直接安装Xcode Command Line Tools。</p>
<hr>
<h2 id="安装Xcode命令行工具"><a href="#安装Xcode命令行工具" class="headerlink" title="安装Xcode命令行工具"></a>安装Xcode命令行工具</h2><p>Xcode Command Line Tools，包含一些命令行开发工具，例如gcc/g++编译器、make、git、nasm等，安装命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select --install <span class="comment"># 安装Xcode命令行工具（Xcode Command Line Tools）</span></div></pre></td></tr></table></figure>
<p>安装完成后，检查是否成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select -p <span class="comment"># 检查是否成功安装</span></div></pre></td></tr></table></figure>
<blockquote>
<p>/Applications/Xcode.app/Contents/Developer</p>
</blockquote>
<p>若看到如下信息，则表明Xcode Command Line Tools已经安装：</p>
<blockquote>
<p>xcode-select: error: command line tools are already installed, use “Software Update” to install update</p>
</blockquote>
<hr>
<h2 id="再次安装DESeq2"><a href="#再次安装DESeq2" class="headerlink" title="再次安装DESeq2"></a>再次安装DESeq2</h2><p>此时，就可以着手安装DESeq2软件包了，执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;在R环境中安装DESeq2&quot;&gt;&lt;a href=&quot;#在R环境中安装DESeq2&quot; class=&quot;headerlink&quot; title=&quot;在R环境中安装DESeq2&quot;&gt;&lt;/a&gt;在R环境中安装DESeq2&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;1、安装DESeq2基本语法：&lt;/s
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="MAC" scheme="http://uteric.github.io/tags/MAC/"/>
    
  </entry>
  
  <entry>
    <title>Hexo常用命令</title>
    <link href="http://uteric.github.io/Hexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://uteric.github.io/Hexo常用命令/</id>
    <published>2018-03-29T04:28:28.000Z</published>
    <updated>2018-03-29T04:28:28.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo-clean"><a href="#hexo-clean" class="headerlink" title="hexo clean"></a>hexo clean</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo clean <span class="comment"># 清除缓存文件db.json 和已生成的静态文件public</span></div></pre></td></tr></table></figure>
<h2 id="hexo-g"><a href="#hexo-g" class="headerlink" title="hexo g"></a>hexo g</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo g <span class="comment"># 是hexo generate的简写形式，生成静态文件到public文件夹</span></div></pre></td></tr></table></figure>
<h2 id="hexo-d"><a href="#hexo-d" class="headerlink" title="hexo d"></a>hexo d</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo d <span class="comment"># 是hexo deploy的简写形式，部署静态文件到设定的仓库</span></div></pre></td></tr></table></figure>
<h2 id="hexo-clean-amp-amp-hexo-g-amp-amp-hexo-d"><a href="#hexo-clean-amp-amp-hexo-g-amp-amp-hexo-d" class="headerlink" title="hexo clean &amp;&amp; hexo g &amp;&amp; hexo d"></a>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d <span class="comment"># 常用的组合命令，清除缓存，生成静态文件，并部署到指定仓库</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;hexo-clean&quot;&gt;&lt;a href=&quot;#hexo-clean&quot; class=&quot;headerlink&quot; title=&quot;hexo clean&quot;&gt;&lt;/a&gt;hexo clean&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="Hexo" scheme="http://uteric.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记1</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"/>
    <id>http://uteric.github.io/R语言学习笔记1/</id>
    <published>2018-03-28T04:26:51.000Z</published>
    <updated>2018-03-28T04:26:51.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="创建一个4-5的矩阵"><a href="#创建一个4-5的矩阵" class="headerlink" title="创建一个4*5的矩阵"></a>创建一个4*5的矩阵</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x &lt;- 1:20 <span class="comment"># 创建一个包含20个值的向量x，可以输入x查看：[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></div><div class="line">y &lt;- matrix (x, 4, 5) <span class="comment"># 使用向量x的值填充一个4行5列的矩阵</span></div><div class="line">y <span class="comment"># 查看y矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    2    6   10   14   18<br>[3,]    3    7   11   15   19<br>[4,]    4    8   12   16   20</p>
</blockquote>
<h2 id="删除行"><a href="#删除行" class="headerlink" title="删除行"></a>删除行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z1 &lt;- y [-2,] <span class="comment"># 删除y矩阵第2行，并赋值给z1矩阵</span></div><div class="line">z1 <span class="comment"># 查看z1矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>  [,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    3    7   11   15   19<br>[3,]    4    8   12   16   20</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z2 &lt;- y [-c(2,3),] <span class="comment"># 删除y矩阵第2，3行，并赋值给z2矩阵</span></div><div class="line">z2 <span class="comment"># 查看z2矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2] [,3] [,4] [,5]<br>[1,]    1    5    9   13   17<br>[2,]    4    8   12   16   20</p>
</blockquote>
<h2 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z3 &lt;- y [, 4] <span class="comment"># 删除y矩阵第4列，并赋值给z3矩阵</span></div><div class="line">z3 <span class="comment"># 查看z3矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3] [,4]<br>[1,]    1    5    9   17<br>[2,]    2    6   10   18<br>[3,]    3    7   11   19<br>[4,]    4    8   12   20</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z4 &lt;- y [,-c(3,4)] <span class="comment"># 删除y矩阵第3,4列，并赋值给z4矩阵</span></div><div class="line">z4 <span class="comment"># 查看z4矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3]<br>[1,]    1    5   17<br>[2,]    2    6   18<br>[3,]    3    7   19<br>[4,]    4    8   20</p>
</blockquote>
<h2 id="提取行"><a href="#提取行" class="headerlink" title="提取行"></a>提取行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z5 &lt;- y [2,] <span class="comment"># 提取y矩阵第2行，并赋值给z5矩阵</span></div><div class="line">z5 <span class="comment"># 查看z5矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1]  2  6 10 14 18</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z6 &lt;- y [c(2,3),] <span class="comment"># 提取y矩阵第2,3行，并赋值给z6矩阵</span></div><div class="line">z6 <span class="comment"># 查看z6矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p> [,1] [,2] [,3] [,4] [,5]<br>[1,]    2    6   10   14   18<br>[2,]    3    7   11   15   19</p>
</blockquote>
<h2 id="提取列"><a href="#提取列" class="headerlink" title="提取列"></a>提取列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z7 &lt;- y [, 3] <span class="comment"># 提取y矩阵第3列，并赋值给z7矩阵</span></div><div class="line">z7 <span class="comment"># 查看z7矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1]  9 10 11 12</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">z8 &lt;- y [, c(3,5)] <span class="comment"># 提取y矩阵第3,5列，并赋值给z8矩阵</span></div><div class="line">z8 <span class="comment"># 查看z8矩阵</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[,1] [,2]<br>[1,]    9   17<br>[2,]   10   18<br>[3,]   11   19<br>[4,]   12   20</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;创建一个4-5的矩阵&quot;&gt;&lt;a href=&quot;#创建一个4-5的矩阵&quot; class=&quot;headerlink&quot; title=&quot;创建一个4*5的矩阵&quot;&gt;&lt;/a&gt;创建一个4*5的矩阵&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>MAC命令行操作MacVim</title>
    <link href="http://uteric.github.io/MAC%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9CMacVim/"/>
    <id>http://uteric.github.io/MAC命令行操作MacVim/</id>
    <published>2018-03-28T03:50:22.000Z</published>
    <updated>2018-03-28T03:50:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>1. 打开MacVim</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim ./test.md <span class="comment"># 打开当前目录下的名位test.md的文件</span></div></pre></td></tr></table></figure></p>
<p><strong>2. 在Vim中修改文件</strong><br>在Vim中打开的文件不能直接修改，如要插入字符，需要按下i键，进入INSERT模式，按下ESC则可退出INSERT模式。</p>
<p><strong>3. 退出Vim</strong></p>
<p><em>在末行模式下：</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">:qw <span class="comment"># 先保存文档，退出Vim，返回到Shell</span></div><div class="line">:q! <span class="comment">#放弃修改，直接返回到Shell</span></div></pre></td></tr></table></figure></p>
<p><em>在命令行模式下：</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ZZ <span class="comment"># 保存修改，退出Vim，返回到Shell</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;1. 打开MacVim&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="MAC" scheme="http://uteric.github.io/tags/MAC/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记7- HTSeq定量基因表达水平</title>
    <link href="http://uteric.github.io/RNASEQ%20HTSeq%E5%AE%9A%E9%87%8F%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/"/>
    <id>http://uteric.github.io/RNASEQ HTSeq定量基因表达水平/</id>
    <published>2018-03-28T03:24:05.000Z</published>
    <updated>2018-03-28T03:24:05.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HTseq统计基因reads数"><a href="#HTseq统计基因reads数" class="headerlink" title="HTseq统计基因reads数"></a>HTseq统计基因reads数</h2><p><strong>HTseq</strong>是用于分析基因表达量的软件，能够根据基因结构注释GTF文件对排序过的SAM/BAM文件进行基因reads数的统计。</p>
<p><em>语法：htseq-count [options]</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir -p ncbi/matrix/ 在ncbi目录下创建matrix文件夹，用于存放HTseq生成的.count文件。-p (-parents)，加上此选项后，系统将自动建立那些尚不存在的目录。</div></pre></td></tr></table></figure>
<p>运行HTseq-count命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">htseq-count ~/ncbi/aligned/SRR3589959_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589959.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589960_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589960.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589961_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589961.count</div><div class="line">htseq-count ~/ncbi/aligned/SRR3589962_count.sam ~/ncbi/reference/mm10/gencode.vM10.annotation.gtf &gt; ~/ncbi/matrix/SRR3589962.count</div></pre></td></tr></table></figure>
<p>上述语法是将排序过的SAM文件（count.sam）进行reads数统计，并输出为.count文件（不用担心存储空间问题，每个文件仅1M左右）。此处，使用了绝对路径，也可以根据自己的情况选择使用相对路径。</p>
<p>为节省时间，可以将上述命令在4个终端中同时执行，大约需要2个小时左右可以完成，生成4个文件：</p>
<blockquote>
<p>SRR3589959.count<br>SRR3589960.count<br>SRR3589961.count<br>SRR3589962.count</p>
</blockquote>
<p>简单介绍一下.count文件的格式，在命令行下查看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~/ncbi/matrix <span class="comment"># 切换到.count文件所在的matrix目录</span></div><div class="line">head -n 10 SRR3589959.count <span class="comment"># 使用head命令查看SRR3589959.count文件的前10行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>ENSMUSG00000000001.4    1648<br>ENSMUSG00000000003.15    0<br>ENSMUSG00000000028.14    835<br>ENSMUSG00000000031.15    65<br>ENSMUSG00000000037.16    70<br>ENSMUSG00000000049.11    0<br>ENSMUSG00000000056.7 366<br>ENSMUSG00000000058.6    7<br>ENSMUSG00000000078.6    558<br>ENSMUSG00000000085.16    286</p>
</blockquote>
<p><strong>.count</strong>文件分为2列，第一列是基因名称（ENSMUSG00000000001.4），第二列是reads数（1648），由此可见，htseq-count命令的目的是将排序过的SAM文件（001，003，0028，0031，0037……）逐个统计reads数，但是，此时生成的.count文件只有两列。</p>
<p>因为所有的.count文件都排过序，并且共享相同的基因名称，所以下一步是将所有的.count文件合并起来，生成一个统一的文件，需要使用R语言脚本将4个.count文件合并为一个表达矩阵。</p>
<h2 id="R语言脚本合并表达矩阵"><a href="#R语言脚本合并表达矩阵" class="headerlink" title="R语言脚本合并表达矩阵"></a>R语言脚本合并表达矩阵</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">R <span class="comment"># 在命令行下输入R，进入R环境</span></div><div class="line">options(stringsAsFactors = FALSE) <span class="comment">#默认为TRUE，不要辨认为factors</span></div><div class="line"></div><div class="line"><span class="comment"># 59，61为对照组，60，62为处理组，首先将四个文件分别赋值为：control1，control2，rep1，rep2</span></div><div class="line">control1 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589959.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control1"</span>))</div><div class="line">control2 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589961.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control2"</span>))</div><div class="line">rep1 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589960.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"rep1"</span>))</div><div class="line">rep2 &lt;- read.table(<span class="string">"/Users/Administrator/ncbi/matrix/SRR3589962.count"</span>, sep=<span class="string">"\t"</span>,col.names = c(<span class="string">"gene_id"</span>,<span class="string">"rep2"</span>))</div><div class="line"></div><div class="line"><span class="comment"># 将4个矩阵文件按照gene_id进行合并，首先组内合并，接着组间合并，并且赋值给raw_count</span></div><div class="line">raw_count &lt;- merge(merge(control1, control2, by=<span class="string">"gene_id"</span>), merge(rep1,rep2, by=<span class="string">"gene_id"</span>))</div></pre></td></tr></table></figure>
<p>对raw_count进行赋值后，我们可以查看生成的合并矩阵：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count <span class="comment"># 查看合并矩阵</span></div></pre></td></tr></table></figure>
<p>但是raw_count文件太长，只能输出19999行，显示达到最大输出量：</p>
<blockquote>
<p>[ reached getOption(“max.print”) – omitted 28826 rows ]</p>
</blockquote>
<p>因此，我们只显示前10行数据，来查看一下生成的矩阵的格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head (raw_count, n=10) <span class="comment">#查看raw_count的前10行</span></div></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<blockquote>
<p> gene_id control1 control2 rep1 rep2<br>1   ENSMUSG00000000001.4     1648     2306 2941 2780<br>2  ENSMUSG00000000003.15        0        0    0    0<br>3  ENSMUSG00000000028.14      835      950 1366 1051<br>4  ENSMUSG00000000031.15       65       83   52   53<br>5  ENSMUSG00000000037.16       70       53   94   66<br>6  ENSMUSG00000000049.11        0        3    4    5<br>7   ENSMUSG00000000056.7      366      386  722  301<br>8   ENSMUSG00000000058.6        7       11    7    3<br>9   ENSMUSG00000000078.6      558      896 1265 1342<br>10 ENSMUSG00000000085.16      286      313  343  348</p>
</blockquote>
<p>合并后的矩阵共有5列，第一列是基因名称，其余四列分别是control1，control2，rep1，rep2，从上表中可以很直观地看到每个基因的表达情况。</p>
<p>我们再来看看raw_count的最后5行，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (raw_count, n=5)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>gene_id control1 control2     rep1     rep2<br>48821 <strong>alignment_not_unique 11278964 14080481 18440618 14495860<br>48822            </strong>ambiguous   295498   425708   498973   381237<br>48823           <strong>no_feature 12642161 15042888 22357626 18675857<br>48824          </strong>not_aligned  1025857  1067038  1675660  1529309<br>48825        __too_low_aQual  1107674  1303141  1799176  1542845</p>
</blockquote>
<p>这5行（48821， 48822， 48823， 48824， 48825）没有匹配到相应的基因，需要删除，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt &lt;- raw_count[-48821:-48825, ] <span class="comment"># 删除5行，重新赋值给raw_count_filt</span></div></pre></td></tr></table></figure>
<p>查看新矩阵raw_count_filt的最后5行，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (raw_count_filt, n=5)</div></pre></td></tr></table></figure>
<p>可以看到，48821：48825已经被删除了，</p>
<blockquote>
<p>gene_id control1 control2 rep1 rep2<br>48816 ENSMUSG00000110420.1        0        0    0    0<br>48817 ENSMUSG00000110421.1        0        0    0    1<br>48818 ENSMUSG00000110422.1        1        0    1    2<br>48819 ENSMUSG00000110423.1        0        0    0    0<br>48820 ENSMUSG00000110424.1       26       20   48   24</p>
</blockquote>
<p>以行48820为例，第一列是基因名称ENSMUSG00000110424.1，但是这个名称在<a href="https://www.ebi.ac.uk/" target="_blank" rel="external">EBI</a>数据库上是不能直接检索到的，只能是整数形式的ENSMUSG00000110424，因此，需要进一步替换为整数的形式，并且赋值给ENSEMBL。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ENSEMBL &lt;- gsub(<span class="string">"\\.\\d*"</span>, <span class="string">""</span>, raw_count_filt<span class="variable">$gene_id</span>)</div><div class="line">tail (ENSEMBL, n=5) <span class="comment"># 查看ENSEMBL的最后5行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>[1] “ENSMUSG00000110420” “ENSMUSG00000110421” “ENSMUSG00000110422”<br>[4] “ENSMUSG00000110423” “ENSMUSG00000110424”</p>
</blockquote>
<p>ENSEMBL只有一列，即修改为整数的基因名称，下一步再将ENSEMBL添加到raw_count_filt矩阵:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">row.names(raw_count_filt) &lt;- ENSEMBL <span class="comment"># 添加ENSENBL到raw_count_filt矩阵</span></div><div class="line">tail (raw_count_filt, n=5) <span class="comment"># 查看raw_count_filt的最后5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>gene_id control1 control2 rep1 rep2<br>ENSMUSG00000110420 ENSMUSG00000110420.1        0        0    0    0<br>ENSMUSG00000110421 ENSMUSG00000110421.1        0        0    0    1<br>ENSMUSG00000110422 ENSMUSG00000110422.1        1        0    1    2<br>ENSMUSG00000110423 ENSMUSG00000110423.1        0        0    0    0<br>ENSMUSG00000110424 ENSMUSG00000110424.1       26       20   48   24</p>
</blockquote>
<p>[optional] 这一步选做，即把raw_count_filt矩阵的第二列删掉，并赋值给raw_count_filt2：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">raw_count_filt2 &lt;- raw_count_filt [ ,-1] <span class="comment"># 删除raw_count_filt的第二列</span></div><div class="line">tail (raw_count_filt2, n=5) <span class="comment"># 查看raw_count_filt2最后5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>control1 control2 rep1 rep2<br>ENSMUSG00000110420        0        0    0    0<br>ENSMUSG00000110421        0        0    0    1<br>ENSMUSG00000110422        1        0    1    2<br>ENSMUSG00000110423        0        0    0    0<br>ENSMUSG00000110424       26       20   48   24</p>
</blockquote>
<p>下面，我们就可以检查一些基因的表达情况了，比如GAPDH，首先，可以在<a href="http://www.uniprot.org/" target="_blank" rel="external">uniprot</a>或者<a href="http://useast.ensembl.org/index.html" target="_blank" rel="external">Ensembl</a>数据库中找到GAPDH对应的基因编号，即ENSMUSG00000057666，并将该基因编号赋值给GAPDH：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GAPDH &lt;- raw_count_filt2 [rownames(raw_count_filt2)==<span class="string">"ENSMUSG00000057666"</span>,] <span class="comment"># 赋值给GAPDH</span></div><div class="line">GAPDH <span class="comment"># 查看GAPDH表达情况</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<blockquote>
<p>control1 control2 rep1 rep2<br>ENSMUSG00000057666     4136     4884 7200 4929</p>
</blockquote>
<p>如要查询其他基因的表达情况，以此类推！</p>
<p>另外，我们也可以看一看所有基因的表达概况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary (raw-count_filt2)</div></pre></td></tr></table></figure>
<blockquote>
<p>control1           control2             rep1               rep2<br> Min.   :     0.0   Min.   :     0.0   Min.   :     0.0   Min.   :     0.0<br> 1st Qu.:     0.0   1st Qu.:     0.0   1st Qu.:     0.0   1st Qu.:     0.0<br> Median :     0.0   Median :     0.0   Median :     1.0   Median :     1.0<br> Mean   :   237.6   Mean   :   290.6   Mean   :   417.4   Mean   :   342.2<br> 3rd Qu.:    62.0   3rd Qu.:    65.0   3rd Qu.:    93.0   3rd Qu.:    71.0<br> Max.   :108056.0   Max.   :164091.0   Max.   :171319.0   Max.   :132792.0</p>
</blockquote>
<p>如果想要把分析结果保存下来，则存储为.csv格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.csv (x=raw_count_filt2, file=<span class="string">"SRR35899.csv"</span>) <span class="comment"># 保存raw_count_filt2矩阵为SRR35899.csv文件，保存位置在当前命令行目录中</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;HTseq统计基因reads数&quot;&gt;&lt;a href=&quot;#HTseq统计基因reads数&quot; class=&quot;headerlink&quot; title=&quot;HTseq统计基因reads数&quot;&gt;&lt;/a&gt;HTseq统计基因reads数&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;HTseq&lt;/str
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记6-下载注释文件并导入IGV</title>
    <link href="http://uteric.github.io/RNASEQ%E4%B8%8B%E8%BD%BD%E6%B3%A8%E9%87%8A%E6%96%87%E4%BB%B6%E5%B9%B6%E5%AF%BC%E5%85%A5IGV/"/>
    <id>http://uteric.github.io/RNASEQ下载注释文件并导入IGV/</id>
    <published>2018-03-24T04:02:02.000Z</published>
    <updated>2018-03-24T04:02:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>注释文件下载流程</strong></p>
<p>进入Gencode网站（<a href="http://www.gencodegenes.org/%EF%BC%89" target="_blank" rel="external">http://www.gencodegenes.org/）</a>，data&gt;&gt;human&gt;&gt;GRCh37-mapped releases&gt;&gt;GENCODE release 26&gt;&gt;Comprehensive genome annotation/ GTF, GFF3</p>
<p>右键获取下载链接，使用wget命令进行下载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ncbi/hg19 <span class="comment">#切换到hg19目录下</span></div><div class="line">wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_26/GRCh37_mapping/gencode.v26lift37.annotation.gtf.gz <span class="comment"># 下载GTF文件</span></div><div class="line">wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_26/GRCh37_mapping/gencode.v26lift37.annotation.gff3.gz <span class="comment"># 下载GFF3文件</span></div></pre></td></tr></table></figure>
<p>文件下载完成后，使用gzip命令解压文件，同时删除压缩文件，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gzip -d gencode.v26lift37.annotation.gtf.gz <span class="comment"># 解压GTF文件</span></div><div class="line">gzip -d gencode.v26lift37.annotation.gff3.gz <span class="comment"># 解压GFF3文件</span></div></pre></td></tr></table></figure>
<p>使用ls命令查看当前目录下得文件，</p>
<blockquote>
<p>gencode.v26lift37.annotation.gff3<br>gencode.v26lift37.annotation.gtf<br>hg19.fa (之前下载并合并的参考基因组文件)</p>
</blockquote>
<p><strong>注释文件导入IGV流程</strong></p>
<p>IGV下载地址：<a href="http://software.broadinstitute.org/software/igv/download" target="_blank" rel="external">http://software.broadinstitute.org/software/igv/download</a></p>
<p>加载<em>hg19.fa</em>，点击Genome/load genome from files/hg19.fa<br>加载<em>gencode.v26lift37.annotation.gtf</em>与<em>gencode.v26lift37.annotation.gff3</em>，这两个文件不能直接加载，需要index文件，创建index文件流程如下：</p>
<ol>
<li>点击Tools/run igvtools/command选择sort，Input File选择GTF/GFF3文件，点击run，运行完成后会产生两个文件：gencode.v26lift37.annotation.sorted.gtf<br>gencode.v26lift37.annotation.sorted.gff3</li>
<li>点击Tools/run igvtools/command选择index，Input File选择 .sorted.gtf/ .sorted.gff3文件，点击run，运行完成后会产生另外两个文件：gencode.v26lift37.annotation.sorted.gtf.idx<br>gencode.v26lift37.annotation.sorted.gff3.idx</li>
<li>点击Genome/load genome from files/gencode.v26lift37.annotation.sorted.gtf.idx<br>点击Genome/load genome from files/gencode.v26lift37.annotation.sorted.gff3.idx<br>加载完成。</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;注释文件下载流程&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;进入Gencode网站（&lt;a href=&quot;http://www.gencodegenes.org/%EF%BC%89&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.ge
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记4-MAC安装RseQC</title>
    <link href="http://uteric.github.io/RNASEQ%E5%9C%A8MAC%E4%B8%AD%E5%AE%89%E8%A3%85RseQC/"/>
    <id>http://uteric.github.io/RNASEQ在MAC中安装RseQC/</id>
    <published>2018-03-24T03:38:56.000Z</published>
    <updated>2018-03-24T03:38:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>RseQC是对比对结果进行质控的工具，在MAC环境下，可以优先选用conda命令进行安装，不会报错。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install rseqc <span class="comment">#安装RseQC，注意都是小写</span></div></pre></td></tr></table></figure>
<p>Solving environment: /</p>
<p><em>The following packages will be downloaded:</em></p>
<table>
<thead>
<tr>
<th>package</th>
<th>build</th>
</tr>
</thead>
<tbody>
<tr>
<td>wheel-0.30.0</td>
<td>py27h677a027_1          66 KB</td>
</tr>
<tr>
<td>jedi-0.11.1</td>
<td>py27_0         297 KB</td>
</tr>
<tr>
<td>idna-2.6</td>
<td>py27hedea723_1         122 KB</td>
</tr>
<tr>
<td>python-2.7.14</td>
<td>h138c1fe_30        11.5 MB</td>
</tr>
<tr>
<td>backports.shutil_get_terminal_size-1.0.0</td>
<td>py27hc9115de_2           8 KB</td>
</tr>
<tr>
<td>pycparser-2.18</td>
<td>py27h0d28d88_1         167 KB</td>
</tr>
<tr>
<td>send2trash-1.5.0</td>
<td>py27_0          16 KB</td>
</tr>
<tr>
<td>bx-python-0.7.3</td>
<td>py27_0         863 KB  bioconda</td>
</tr>
<tr>
<td>ipython-5.4.1</td>
<td>py27_2        1014 KB</td>
</tr>
<tr>
<td>urllib3-1.22</td>
<td>py27hc3787e9_0         153 KB</td>
</tr>
<tr>
<td>configparser-3.5.0</td>
<td>py27hc7edf1b_0          35 KB</td>
</tr>
<tr>
<td>python-dateutil-2.3</td>
<td>py27_0         213 KB  bioconda</td>
</tr>
<tr>
<td>pygments-2.2.0</td>
<td>py27h1a556bb_0         1.3 MB</td>
</tr>
<tr>
<td>terminado-0.8.1</td>
<td>py27_1          20 KB</td>
</tr>
<tr>
<td>backports-1.0</td>
<td>py27hb4f9756_1           3 KB</td>
</tr>
<tr>
<td>testpath-0.3.1</td>
<td>py27h72d81a5_0          89 KB</td>
</tr>
<tr>
<td>notebook-5.4.0</td>
<td>py27_0         6.6 MB</td>
</tr>
<tr>
<td>pyopenssl-17.5.0</td>
<td>py27hfda213f_0          77 KB</td>
</tr>
<tr>
<td>decorator-4.2.1</td>
<td>py27_0          15 KB</td>
</tr>
<tr>
<td>webencodings-0.5.1</td>
<td>py27h19a9f58_1          19 KB</td>
</tr>
<tr>
<td>nbconvert-5.3.1</td>
<td>py27h6455e4c_0         394 KB</td>
</tr>
<tr>
<td>ipykernel-4.8.2</td>
<td>py27_0         143 KB</td>
</tr>
<tr>
<td>functools32-3.2.3.2</td>
<td>py27h8ceab06_1          22 KB</td>
</tr>
<tr>
<td>entrypoints-0.2.3</td>
<td>py27hd680fb1_2           9 KB</td>
</tr>
<tr>
<td>asn1crypto-0.24.0</td>
<td>py27_0         155 KB</td>
</tr>
<tr>
<td>pip-9.0.1</td>
<td>py27_5         2.2 MB</td>
</tr>
<tr>
<td>pyzmq-17.0.0</td>
<td>py27h1de35cc_0         393 KB</td>
</tr>
<tr>
<td>backports_abc-0.5</td>
<td>py27h6972548_0          12 KB</td>
</tr>
<tr>
<td>ruamel_yaml-0.15.35</td>
<td>py27h1de35cc_1         228 KB</td>
</tr>
<tr>
<td>backports.functools_lru_cache-1.5</td>
<td>py27_1           9 KB</td>
</tr>
<tr>
<td>scandir-1.7</td>
<td>py27h1de35cc_0          25 KB</td>
</tr>
<tr>
<td>setuptools-38.5.1</td>
<td>py27_0         509 KB</td>
</tr>
<tr>
<td>pyparsing-2.2.0</td>
<td>py27h5bb6aaf_0          94 KB</td>
</tr>
<tr>
<td>tornado-5.0</td>
<td>py27_0         618 KB</td>
</tr>
<tr>
<td>requests-2.18.4</td>
<td>py27h9b2b37c_1          91 KB</td>
</tr>
<tr>
<td>futures-3.2.0</td>
<td>py27h1b80678_0          24 KB</td>
</tr>
<tr>
<td>bleach-1.4.2</td>
<td>py27_0          31 KB  bioconda</td>
</tr>
<tr>
<td>kiwisolver-1.0.1</td>
<td>py27h9856860_0          57 KB</td>
</tr>
<tr>
<td>html5lib-1.0.1</td>
<td>py27h5233db4_0         188 KB</td>
</tr>
<tr>
<td>cycler-0.10.0</td>
<td>py27hfc73c78_0          13 KB</td>
</tr>
<tr>
<td>singledispatch-3.4.0.3</td>
<td>py27he22c18d_0          15 KB</td>
</tr>
<tr>
<td>jsonschema-2.6.0</td>
<td>py27hd9b497e_0          61 KB</td>
</tr>
<tr>
<td>numpy-1.14.2</td>
<td>py27ha9ae307_0         3.9 MB</td>
</tr>
<tr>
<td>nbformat-4.4.0</td>
<td>py27hddc86d0_0         136 KB</td>
</tr>
<tr>
<td>pandocfilters-1.4.2</td>
<td>py27hed78c4e_1          12 KB</td>
</tr>
<tr>
<td>pickleshare-0.7.4</td>
<td>py27h37e3d41_0          11 KB</td>
</tr>
<tr>
<td>jupyter_client-5.2.2</td>
<td>py27_0         121 KB</td>
</tr>
<tr>
<td>prompt_toolkit-1.0.15</td>
<td>py27h4a7b9c2_0         333 KB</td>
</tr>
<tr>
<td>jupyter_core-4.4.0</td>
<td>py27h5ea6ba4_0          60 KB</td>
</tr>
<tr>
<td>cython-0.27.3</td>
<td>py27h6429b90_0         2.6 MB</td>
</tr>
<tr>
<td>ipython_genutils-0.2.0</td>
<td>py27h8b9a179_0          38 KB</td>
</tr>
<tr>
<td>pytz-2018.3</td>
<td>py27_0         211 KB</td>
</tr>
<tr>
<td>markupsafe-1.0</td>
<td>py27hd3c86fa_1          23 KB</td>
</tr>
<tr>
<td>conda-4.4.11</td>
<td>py27_0         931 KB</td>
</tr>
<tr>
<td>chardet-3.0.4</td>
<td>py27h2842e91_1         180 KB</td>
</tr>
<tr>
<td>appnope-0.1.0</td>
<td>py27hb466136_0           8 KB</td>
</tr>
<tr>
<td>ptyprocess-0.5.2</td>
<td>py27h70f6364_0          22 KB</td>
</tr>
<tr>
<td>six-1.11.0</td>
<td>py27h7252ba3_1          21 KB</td>
</tr>
<tr>
<td>pathlib2-2.3.0</td>
<td>py27he09da1e_0          31 KB</td>
</tr>
<tr>
<td>pysocks-1.6.8</td>
<td>py27_0          22 KB</td>
</tr>
<tr>
<td>parso-0.1.1</td>
<td>py27he57c4c6_0         115 KB</td>
</tr>
<tr>
<td>ipaddress-1.0.19</td>
<td>py27_0          32 KB</td>
</tr>
<tr>
<td>python.app-2</td>
<td>py27hf2d5e94_7          11 KB</td>
</tr>
<tr>
<td>wcwidth-0.1.7</td>
<td>py27h817c265_0          25 KB</td>
</tr>
<tr>
<td>matplotlib-2.2.0</td>
<td>py27hfa7797c_0         6.6 MB</td>
</tr>
<tr>
<td>pycosat-0.6.3</td>
<td>py27h6c51c7e_0         106 KB</td>
</tr>
<tr>
<td>subprocess32-3.2.7</td>
<td>py27h24b2887_0          38 KB</td>
</tr>
<tr>
<td>htseq-0.9.1</td>
<td>py27_0         315 KB  bioconda</td>
</tr>
<tr>
<td>rseqc-2.6.4</td>
<td>py27_0         228 KB  bioconda</td>
</tr>
<tr>
<td>certifi-2018.1.18</td>
<td>py27_0         143 KB</td>
</tr>
<tr>
<td>simplegeneric-0.8.1</td>
<td>py27_2           9 KB</td>
</tr>
<tr>
<td>mistune-0.8.3</td>
<td>py27_0          52 KB</td>
</tr>
<tr>
<td>pexpect-4.4.0</td>
<td>py27_0          70 KB</td>
</tr>
<tr>
<td>pysam-0.14.0</td>
<td>py27_htslib1.7_2         2.0 MB  bioconda</td>
</tr>
<tr>
<td>jinja2-2.10</td>
<td>py27h70b8dc5_0         177 KB</td>
</tr>
<tr>
<td>hisat2-2.1.0</td>
<td>py27pl5.22.0_0         6.9 MB  bioconda</td>
</tr>
<tr>
<td>enum34-1.1.6</td>
<td>py27hf475452_1          57 KB</td>
</tr>
<tr>
<td>cffi-1.11.5</td>
<td>py27h342bebf_0         201 KB</td>
</tr>
<tr>
<td>traitlets-4.3.2</td>
<td>py27hcf08151_0         126 KB</td>
</tr>
<tr>
<td>cryptography-2.1.4</td>
<td>py27hdbc5e8f_0         548 KB</td>
</tr>
</tbody>
</table>
<p>——————————————————-Total:        54.1 MB</p>
<p><em>The following NEW packages will be INSTALLED:</em></p>
<p>backports:                          1.0-py27hb4f9756_1<br>backports.functools_lru_cache:      1.5-py27_1<br>backports.shutil_get_terminal_size: 1.0.0-py27hc9115de_2<br>backports_abc:                      0.5-py27h6972548_0<br>bx-python:                          0.7.3-py27_0            bioconda<br>configparser:                       3.5.0-py27hc7edf1b_0<br>cython:                             0.27.3-py27h6429b90_0<br>enum34:                             1.1.6-py27hf475452_1<br>functools32:                        3.2.3.2-py27h8ceab06_1<br>futures:                            3.2.0-py27h1b80678_0<br>ipaddress:                          1.0.19-py27_0<br>pathlib2:                           2.3.0-py27he09da1e_0<br>rseqc:                              2.6.4-py27_0            bioconda<br>scandir:                            1.7-py27h1de35cc_0<br>singledispatch:                     3.4.0.3-py27he22c18d_0<br>subprocess32:                       3.2.7-py27h24b2887_0</p>
<p><em>The following packages will be UPDATED:</em></p>
<p>appnope:                            0.1.0-py36hf537a9a_0             –&gt; 0.1.0-py27hb466136_0<br>asn1crypto:                         0.24.0-py36_0                    –&gt; 0.24.0-py27_0<br>bleach:                             1.4.2-py36_0            bioconda –&gt; 1.4.2-py27_0            bioconda<br>certifi:                            2018.1.18-py36_0                 –&gt; 2018.1.18-py27_0<br>cffi:                               1.11.4-py36h342bebf_0            –&gt; 1.11.5-py27h342bebf_0<br>chardet:                            3.0.4-py36h96c241c_1             –&gt; 3.0.4-py27h2842e91_1<br>conda:                              4.4.11-py36_0                    –&gt; 4.4.11-py27_0<br>cryptography:                       2.1.4-py36h842514c_0             –&gt; 2.1.4-py27hdbc5e8f_0<br>cycler:                             0.10.0-py36hfc81398_0            –&gt; 0.10.0-py27hfc73c78_0<br>decorator:                          4.2.1-py36_0                     –&gt; 4.2.1-py27_0<br>entrypoints:                        0.2.3-py36hd81d71f_2             –&gt; 0.2.3-py27hd680fb1_2<br>hisat2:                             2.1.0-py36pl5.22.0_0    bioconda –&gt; 2.1.0-py27pl5.22.0_0    bioconda<br>html5lib:                           1.0.1-py36h2f9c1c0_0             –&gt; 1.0.1-py27h5233db4_0<br>htseq:                              0.9.1-py36_0            bioconda –&gt; 0.9.1-py27_0            bioconda<br>idna:                               2.6-py36h8628d0a_1               –&gt; 2.6-py27hedea723_1<br>ipykernel:                          4.8.2-py36_0                     –&gt; 4.8.2-py27_0<br>ipython_genutils:                   0.2.0-py36h241746c_0             –&gt; 0.2.0-py27h8b9a179_0<br>jedi:                               0.11.1-py36_0                    –&gt; 0.11.1-py27_0<br>jinja2:                             2.10-py36hd36f9c5_0              –&gt; 2.10-py27h70b8dc5_0<br>jsonschema:                         2.6.0-py36hb385e00_0             –&gt; 2.6.0-py27hd9b497e_0<br>jupyter_client:                     5.2.2-py36_0                     –&gt; 5.2.2-py27_0<br>jupyter_core:                       4.4.0-py36h79cf704_0             –&gt; 4.4.0-py27h5ea6ba4_0<br>kiwisolver:                         1.0.1-py36h792292d_0             –&gt; 1.0.1-py27h9856860_0<br>markupsafe:                         1.0-py36h3a1e703_1               –&gt; 1.0-py27hd3c86fa_1<br>matplotlib:                         2.2.0-py36hfa7797c_0             –&gt; 2.2.0-py27hfa7797c_0<br>mistune:                            0.8.3-py36_0                     –&gt; 0.8.3-py27_0<br>nbconvert:                          5.3.1-py36h810822e_0             –&gt; 5.3.1-py27h6455e4c_0<br>nbformat:                           4.4.0-py36h827af21_0             –&gt; 4.4.0-py27hddc86d0_0<br>notebook:                           5.4.0-py36_0                     –&gt; 5.4.0-py27_0<br>numpy:                              1.14.2-py36ha9ae307_0            –&gt; 1.14.2-py27ha9ae307_0<br>pandocfilters:                      1.4.2-py36h3b0b094_1             –&gt; 1.4.2-py27hed78c4e_1<br>parso:                              0.1.1-py36hc90e01c_0             –&gt; 0.1.1-py27he57c4c6_0<br>pexpect:                            4.4.0-py36_0                     –&gt; 4.4.0-py27_0<br>pickleshare:                        0.7.4-py36hf512f8e_0             –&gt; 0.7.4-py27h37e3d41_0<br>pip:                                9.0.1-py36h1555ced_4             –&gt; 9.0.1-py27_5<br>prompt_toolkit:                     1.0.15-py36haeda067_0            –&gt; 1.0.15-py27h4a7b9c2_0<br>ptyprocess:                         0.5.2-py36he6521c3_0             –&gt; 0.5.2-py27h70f6364_0<br>pycosat:                            0.6.3-py36hee92d8f_0             –&gt; 0.6.3-py27h6c51c7e_0<br>pycparser:                          2.18-py36h724b2fc_1              –&gt; 2.18-py27h0d28d88_1<br>pygments:                           2.2.0-py36h240cd3f_0             –&gt; 2.2.0-py27h1a556bb_0<br>pyopenssl:                          17.5.0-py36h51e4350_0            –&gt; 17.5.0-py27hfda213f_0<br>pyparsing:                          2.2.0-py36hb281f35_0             –&gt; 2.2.0-py27h5bb6aaf_0<br>pysam:                              0.14.0-py36_htslib1.7_2 bioconda –&gt; 0.14.0-py27_htslib1.7_2 bioconda<br>pysocks:                            1.6.7-py36hfa33cec_1             –&gt; 1.6.8-py27_0<br>python.app:                         2-py36h54569d5_7                 –&gt; 2-py27hf2d5e94_7<br>pytz:                               2018.3-py36_0                    –&gt; 2018.3-py27_0<br>pyzmq:                              17.0.0-py36h1de35cc_0            –&gt; 17.0.0-py27h1de35cc_0<br>requests:                           2.18.4-py36h4516966_1            –&gt; 2.18.4-py27h9b2b37c_1<br>ruamel_yaml:                        0.15.35-py36h1de35cc_1           –&gt; 0.15.35-py27h1de35cc_1<br>send2trash:                         1.5.0-py36_0                     –&gt; 1.5.0-py27_0<br>setuptools:                         38.4.0-py36_0                    –&gt; 38.5.1-py27_0<br>simplegeneric:                      0.8.1-py36_2                     –&gt; 0.8.1-py27_2<br>six:                                1.11.0-py36h0e22d5e_1            –&gt; 1.11.0-py27h7252ba3_1<br>terminado:                          0.8.1-py36_1                     –&gt; 0.8.1-py27_1<br>testpath:                           0.3.1-py36h625a49b_0             –&gt; 0.3.1-py27h72d81a5_0<br>tornado:                            5.0-py36_0                       –&gt; 5.0-py27_0<br>traitlets:                          4.3.2-py36h65bd3ce_0             –&gt; 4.3.2-py27hcf08151_0<br>urllib3:                            1.22-py36h68b9469_0              –&gt; 1.22-py27hc3787e9_0<br>wcwidth:                            0.1.7-py36h8c6ec74_0             –&gt; 0.1.7-py27h817c265_0<br>webencodings:                       0.5.1-py36h3b9701d_1             –&gt; 0.5.1-py27h19a9f58_1<br>wheel:                              0.30.0-py36h5eb2c71_1            –&gt; 0.30.0-py27h677a027_1</p>
<p><em>The following packages will be DOWNGRADED:</em></p>
<p>ipython:                            6.2.1-py36h3dda519_1             –&gt; 5.4.1-py27_2<br>python:                             3.6.4-hc167b69_1                 –&gt; 2.7.14-h138c1fe_30<br>python-dateutil:                    2.7.0-py36_0                     –&gt; 2.3-py27_0              bioconda</p>
<p>询问是否继续？ Proceed ([y]/n)? y<br>输入y以完成安装。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RseQC是对比对结果进行质控的工具，在MAC环境下，可以优先选用conda命令进行安装，不会报错。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
</feed>
