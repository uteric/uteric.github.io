<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2020-10-21T18:08:00.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>外显子测序分析教程</title>
    <link href="http://uteric.github.io/wes/"/>
    <id>http://uteric.github.io/wes/</id>
    <published>2020-10-21T18:08:00.000Z</published>
    <updated>2020-10-21T18:08:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>一、原始数据下载</p><p>如果是从测序公司拿到数据，一般会得到处理过的fastq格式，而我们在此以SRA为数据源获得原始数据。以<a href="https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP287563&amp;o=bytes_l%3Aa" target="_blank" rel="noopener">PRJNA669198</a>这个项目为例，我们下载<em>SRR12846241</em>，原始数据2.76Gb，样本来自31岁的男性colon，患有林奇综合征（Lynch syndrome，或称HNPCC,遗传性非息肉性大肠癌），测序平台是Illumina，双端测序，以上是基本信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prefetch SRR12846241</span><br></pre></td></tr></table></figure><p>二、原始数据转换</p><p>下载完成后，我们获得的原始数据是SRA格式（SRR12846241.sra），需要首先使用sratool转换为fastq格式。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;一、原始数据下载&lt;/p&gt;
&lt;p&gt;如果是从测序公司拿到数据，一般会得到处理过的fastq格式，而我们在此以SRA为数据源获得原始数据。以&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP287563&amp;amp;
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="WES" scheme="http://uteric.github.io/tags/WES/"/>
    
  </entry>
  
  <entry>
    <title>在R中拆分与合并数据</title>
    <link href="http://uteric.github.io/R/reshape/"/>
    <id>http://uteric.github.io/R/reshape/</id>
    <published>2020-10-15T21:06:02.000Z</published>
    <updated>2020-10-15T21:06:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>数据的拆分与合并可以使用reshape2这个包，主要使用两个命令：melt/cast（dcast返回数据框）</p><p>一、准备数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; A &lt;- c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>)</span><br><span class="line">&gt; B &lt;- c(1,2,3,4)</span><br><span class="line">&gt; C &lt;- c(<span class="string">"Apple"</span>,<span class="string">"Orange"</span>,<span class="string">"Pear"</span>,<span class="string">"Banana"</span>)</span><br><span class="line">&gt; D &lt;- c(<span class="string">"Sun"</span>,<span class="string">"Moon"</span>,<span class="string">"Earth"</span>,<span class="string">"Star"</span>)</span><br><span class="line">&gt; data &lt;- data.frame(A,B,C,D)</span><br><span class="line">&gt; data</span><br><span class="line">  A B      C     D</span><br><span class="line">1 A 1  Apple   Sun</span><br><span class="line">2 B 2 Orange  Moon</span><br><span class="line">3 C 3   Pear Earth</span><br><span class="line">4 D 4 Banana  Star</span><br></pre></td></tr></table></figure><p>二、数据拆分</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(reshape2)</span><br><span class="line"></span><br><span class="line">&gt; data2 &lt;- melt(data,id=c(<span class="string">"A"</span>,<span class="string">"B"</span>))</span><br><span class="line">&gt; data2</span><br><span class="line">  A B variable  value</span><br><span class="line">1 A 1        C  Apple</span><br><span class="line">2 B 2        C Orange</span><br><span class="line">3 C 3        C   Pear</span><br><span class="line">4 D 4        C Banana</span><br><span class="line">5 A 1        D    Sun</span><br><span class="line">6 B 2        D   Moon</span><br><span class="line">7 C 3        D  Earth</span><br><span class="line">8 D 4        D   Star</span><br></pre></td></tr></table></figure><p>三、数据合并</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; data3 &lt;- dcast(data2,A+B~variable)</span><br><span class="line">&gt; data3</span><br><span class="line">  A B      C     D</span><br><span class="line">1 A 1  Apple   Sun</span><br><span class="line">2 B 2 Orange  Moon</span><br><span class="line">3 C 3   Pear Earth</span><br><span class="line">4 D 4 Banana  Star</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;数据的拆分与合并可以使用reshape2这个包，主要使用两个命令：melt/cast（dcast返回数据框）&lt;/p&gt;
&lt;p&gt;一、准备数据&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>在R中移除包含NA的行</title>
    <link href="http://uteric.github.io/R/removeNA/"/>
    <id>http://uteric.github.io/R/removeNA/</id>
    <published>2020-10-13T20:42:17.000Z</published>
    <updated>2020-10-13T20:42:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，如需去除包含NA的行，可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">na.omit(data)</span><br></pre></td></tr></table></figure><p>或者，可以在命令中加入na.rm=TRUE来避免NA造成干扰，</p><p>或者根据情况使用如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[!is.na(data<span class="variable">$V1</span>),]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，如需去除包含NA的行，可以使用以下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>LINUX下解压命令</title>
    <link href="http://uteric.github.io/Linux/unzip/"/>
    <id>http://uteric.github.io/Linux/unzip/</id>
    <published>2020-10-09T19:00:41.000Z</published>
    <updated>2020-10-09T19:00:41.000Z</updated>
    
    <content type="html"><![CDATA[<ol><li>tar.gz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf file.tar.gz</span><br></pre></td></tr></table></figure><p>参数的意义如下：</p><p>-z : 使用gzip命令解压<br>-x : 提取文件<br>-v : 显示操作过程</p><ol start="2"><li>.tgz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf file.tgz</span><br></pre></td></tr></table></figure><ol start="3"><li>.gz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d file.gz</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;tar.gz&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="解压" scheme="http://uteric.github.io/tags/%E8%A7%A3%E5%8E%8B/"/>
    
  </entry>
  
  <entry>
    <title>查看CPU核心数与线程数</title>
    <link href="http://uteric.github.io/Linux/coresThreads/"/>
    <id>http://uteric.github.io/Linux/coresThreads/</id>
    <published>2020-10-06T22:54:31.000Z</published>
    <updated>2020-10-06T22:54:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>WINDOWS下查看CPU的核心数与线程数，打开CMD，输入wmic，再输入cup get，NumberOfCores为核数 NumberOfLogicalProcessors为线程数。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;WINDOWS下查看CPU的核心数与线程数，打开CMD，输入wmic，再输入cup get，NumberOfCores为核数 NumberOfLogicalProcessors为线程数。&lt;/p&gt;

      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="CPU" scheme="http://uteric.github.io/tags/CPU/"/>
    
  </entry>
  
  <entry>
    <title>Windows中迁移子系统Ubuntu至非系统盘</title>
    <link href="http://uteric.github.io/Linux/linux-move/"/>
    <id>http://uteric.github.io/Linux/linux-move/</id>
    <published>2020-10-02T02:20:39.000Z</published>
    <updated>2020-10-02T02:20:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>下载LxRunOffline，并切换至包含LxRunOffline.exe的目录中，使用如下命令查看已安装的子系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; LxRunOffline.exe list</span><br><span class="line">Ubuntu-18.04</span><br></pre></td></tr></table></figure><p>迁移系统</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; LxRunOffline.exe move -n Ubuntu-18.04 -d F:\LINUX</span><br></pre></td></tr></table></figure><p>查看位置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; LxRunOffline.exe get-dir -n Ubuntu-18.04</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;下载LxRunOffline，并切换至包含LxRunOffline.exe的目录中，使用如下命令查看已安装的子系统：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cl
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="Ubuntu" scheme="http://uteric.github.io/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记09-GSE53757</title>
    <link href="http://uteric.github.io/GEO/GEO09/"/>
    <id>http://uteric.github.io/GEO/GEO09/</id>
    <published>2020-08-03T00:25:48.000Z</published>
    <updated>2020-08-03T00:25:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE53757，共72对144个样本，选取其中60对120个，分不同TUMOR GRADE，但这里不加以区分，只看总体表达情况；平台是GPL570，含54675个探针。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE53757'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),60))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">exprSet &lt;- exprSet[,c(1:78,87:128)]</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO60.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma) </span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO61.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line"><span class="keyword">if</span> (LogC) &#123; ex[<span class="built_in">which</span>(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex) &#125;</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL570'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL570.soft'</span>)</span><br><span class="line">GPL570 &lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL570$`Gene Symbol`,stringsAsFactors = F)</span><br><span class="line"><span class="comment">#library(dplyr)</span></span><br><span class="line"><span class="comment">#x1 &lt;- data.frame(probeset=rownames(exprSet))</span></span><br><span class="line"><span class="comment">#x2 &lt;- data.frame(probeset=GPL570$ID,symbol=GPL570$`Gene Symbol`)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- x1 %&gt;% inner_join(x2,by='probeset')</span></span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line"><span class="comment"># GENERATE PAIR INFO</span></span><br><span class="line">pair &lt;- data.frame(seq(1:60),seq(1:60))</span><br><span class="line">pair &lt;- data.frame(t(pair))</span><br><span class="line">pair &lt;- unlist(pair)</span><br><span class="line">pairinfo = factor(pair)</span><br><span class="line"></span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,NDUFA4L2,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'NDUFA4L2'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO62.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO63.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = F,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO64.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO65.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO66.png" alt></p><p><img src="/images/GEO/GEO67.png" alt></p><p><img src="/images/GEO/GEO68.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SAVE CSV ----</span></span><br><span class="line">write.csv(data,<span class="string">"GSE53757_data.csv"</span>)</span><br><span class="line">write.csv(allDiff_pair,<span class="string">"GSE53757_diff.csv"</span>)</span><br><span class="line">write.csv(allDiff_pair2,<span class="string">"GSE53757_diff2.csv"</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE53757，共72对144个样本，选取其中60对120个，分不同TUMOR GRADE，但这里不加以区分，只看总体表达情况；平台是GPL570，含54675个探针。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记08-GSE40435</title>
    <link href="http://uteric.github.io/GEO/GEO08/"/>
    <id>http://uteric.github.io/GEO/GEO08/</id>
    <published>2020-08-02T18:45:10.000Z</published>
    <updated>2020-08-02T18:45:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE40435，来自捷克的101例配对样本，平台是GPL10558，包含48107个探针。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE40435'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),9),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),4),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),9),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),14),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),16),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),31),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),4),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),8))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO52.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line"><span class="comment"># NO NEED NORMALIZATION</span></span><br><span class="line">library(limma) </span><br><span class="line"><span class="comment">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span></span><br><span class="line"><span class="comment">#boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL10558'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL10558.soft'</span>)</span><br><span class="line">GPL10558 &lt;- GEOquery::Table(gpl)</span><br><span class="line"><span class="comment">#probeset &lt;- rownames(exprSet)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- data.frame(probeset,symbol=GPL10558$ILMN_Gene,stringsAsFactors = F)</span></span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL10558<span class="variable">$ID</span>,symbol=GPL10558<span class="variable">$ILMN_Gene</span>)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=<span class="string">'probeset'</span>)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line"><span class="comment"># GENERATE PAIR INFO</span></span><br><span class="line">pair &lt;- data.frame(seq(1:101),seq(1:101))</span><br><span class="line">pair &lt;- data.frame(t(pair))</span><br><span class="line">pair &lt;- unlist(pair)</span><br><span class="line">pairinfo = factor(pair)</span><br><span class="line"></span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,UMOD,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'UMOD'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO53.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO54.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = F,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO55.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO56.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05166'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO57.png" alt></p><p><img src="/images/GEO/GEO58.png" alt></p><p><img src="/images/GEO/GEO59.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE40435，来自捷克的101例配对样本，平台是GPL10558，包含48107个探针。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记7</title>
    <link href="http://uteric.github.io/GEO/GEO07/"/>
    <id>http://uteric.github.io/GEO/GEO07/</id>
    <published>2020-08-02T04:12:41.000Z</published>
    <updated>2020-08-02T04:12:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE72922，23个样本，非配对，平台是GPL14951，然而，没有差异基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE72922'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,7),rep(<span class="string">'normal'</span>,4),rep(<span class="string">'tumor'</span>,2),rep(<span class="string">'normal'</span>,7),rep(<span class="string">'tumor'</span>,3))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO50.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"># NORMALIZATION ----</span><br><span class="line"># NO NEED NORMALIZATION</span><br><span class="line">library(limma) </span><br><span class="line">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">#boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br><span class="line"></span><br><span class="line"># LOG2 TRANSFORM ----</span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line">if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex) &#125;</span><br><span class="line">dim(exprSet)</span><br><span class="line"># ANNOTATION ----</span><br><span class="line">gpl &lt;- getGEO(&apos;GPL14951&apos;,destdir = &apos;./&apos;)</span><br><span class="line">gpl &lt;- getGEO(filename = &apos;./GPL14951.soft&apos;)</span><br><span class="line">GPL14951 &lt;- GEOquery::Table(gpl)</span><br><span class="line">#probeset &lt;- rownames(exprSet)</span><br><span class="line">#probe2symbol &lt;- data.frame(probeset,symbol=GPL14951$Symbol,stringsAsFactors = F)</span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL14951$ID,symbol=GPL14951$Symbol)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=&apos;probeset&apos;)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"># REMOVE NA ----</span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=&apos;probeset&apos;) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=&apos;probeset&apos;) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(&apos;GSM&apos;, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != &apos;NA&apos;) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = &apos;symbol&apos;)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"># DIFF EXPRESS ----</span><br><span class="line"># NO PAIRING</span><br><span class="line">design &lt;- model.matrix(~ group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf,p.value=0.05)</span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 0 0 # 没有差异基因，不必往下分析</span><br><span class="line"># PLOT ----</span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EEF1A1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=&apos;black&apos;, linetype=&apos;11&apos;) +</span><br><span class="line">  xlab(&apos;&apos;) +</span><br><span class="line">  ylab(paste(&apos;Expression of &apos;,&apos;EEF1A1&apos;))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = &apos;none&apos;)</span><br><span class="line"># COMBINE PLOT ----</span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=&apos;genesymbol&apos;) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange$genesymbol[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, function(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(&apos;pairinfo&apos;,&apos;group&apos;)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=&apos;black&apos;, linetype=&apos;11&apos;) +</span><br><span class="line">    xlab(&apos;&apos;) +</span><br><span class="line">    ylab(paste(&apos;Expression of &apos;,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = &apos;none&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br><span class="line"># HEATMAP ----</span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = &apos;row&apos;, </span><br><span class="line">         color =colorRampPalette(c(&apos;blue&apos;, &apos;white&apos;,&apos;red&apos;))(100))</span><br><span class="line"># VOLCANO PLOT ----</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data$significant &lt;- as.factor(data$adj.P.Val&lt;0.05 &amp; abs(data$logFC) &gt; 1)</span><br><span class="line">data$gene &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=&apos;black&apos;)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=&apos;red&apos;)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=&apos;blue&apos;)+</span><br><span class="line">  labs(x=&apos;log2 (fold change)&apos;,y=&apos;-log10 (adj.P.Val)&apos;)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = &apos;black&apos;))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO51.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE72922，23个样本，非配对，平台是GPL14951，然而，没有差异基因&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/sp
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记6</title>
    <link href="http://uteric.github.io/GEO/GEO06/"/>
    <id>http://uteric.github.io/GEO/GEO06/</id>
    <published>2020-08-02T03:32:43.000Z</published>
    <updated>2020-08-02T03:32:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE105288，共88个样本，只选取其中的PRIMARY TUMOR与配对的正常样本，9对18个，平台是GPL10558，但是结果有些出乎意料，居然没有差异显著的基因。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE105288'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet[,-c(7:13,18:23,28:35,40:44)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO47.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line"><span class="comment"># NO NEED NORMALIZATION</span></span><br><span class="line">library(limma) </span><br><span class="line"><span class="comment">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span></span><br><span class="line"><span class="comment">#boxplot(exprSet[,-c(7:13,18:23,28:35,40:44)],outline=FALSE,notch=T,col=group_list,las=2)</span></span><br><span class="line">exprSet &lt;- exprSet[,-c(7:13,18:23,28:35,40:44)]</span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL10558'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL10558.soft'</span>)</span><br><span class="line">GPL10558 &lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL10558<span class="variable">$ILMN_Gene</span>,stringsAsFactors = F)</span><br><span class="line"><span class="comment">#library(dplyr)</span></span><br><span class="line"><span class="comment">#x1 &lt;- data.frame(probeset=rownames(exprSet))</span></span><br><span class="line"><span class="comment">#x2 &lt;- data.frame(probeset=GPL6480$ID,symbol=GPL6480$GENE_SYMBOL)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- x1 %&gt;% inner_join(x2,by='probeset')</span></span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 0 0 <span class="comment"># 不用接着往下分析了，没有差异基因</span></span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EEF1A1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'EEF1A1'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO48.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO49.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE105288，共88个样本，只选取其中的PRIMARY TUMOR与配对的正常样本，9对18个，平台是GPL10558，但是结果有些出乎意料，居然没有差异显著的基因。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;t
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记05</title>
    <link href="http://uteric.github.io/GEO/GEO05/"/>
    <id>http://uteric.github.io/GEO/GEO05/</id>
    <published>2020-08-01T22:35:05.000Z</published>
    <updated>2020-08-01T22:35:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE16449，共70个样本，选取前17对配对样本，平台是GPL6480</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE16449'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,17),rep(<span class="string">'normal'</span>,17))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet[,1:34],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO38.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet[,1:34],outline=FALSE,notch=T,col=group_list,las=2)</span><br><span class="line">exprSet &lt;- exprSet[,1:34]</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO39.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL6480'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL6480.soft'</span>)</span><br><span class="line">GPL6480 &lt;- GEOquery::Table(gpl)</span><br><span class="line"><span class="comment"># different row #, need selection</span></span><br><span class="line"><span class="comment">#probeset &lt;- rownames(exprSet)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- data.frame(probeset,symbol=GPL6480$GENE_SYMBOL,stringsAsFactors = F)</span></span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL6480<span class="variable">$ID</span>,symbol=GPL6480<span class="variable">$GENE_SYMBOL</span>)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=<span class="string">'probeset'</span>)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(rep(1:17,2))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EGLN3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'EGLN3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO40.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO41.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO42.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO43.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO44.png" alt></p><p><img src="/images/GEO/GEO45.png" alt></p><p><img src="/images/GEO/GEO46.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE16449，共70个样本，选取前17对配对样本，平台是GPL6480&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记04</title>
    <link href="http://uteric.github.io/GEO/GEO04/"/>
    <id>http://uteric.github.io/GEO/GEO04/</id>
    <published>2020-08-01T22:34:54.000Z</published>
    <updated>2020-08-01T22:34:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE66271，样本共13对，平台是GPL570</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE66271'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),13)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO30.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO31.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL570'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL570.soft'</span>)</span><br><span class="line">GPL570&lt;- GEOquery::Table(gpl)</span><br><span class="line"></span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL570$`Gene Symbol`,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,TACC3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'TACC3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO32.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO33.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO34.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05169'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO35.png" alt></p><p><img src="/images/GEO/GEO36.png" alt></p><p><img src="/images/GEO/GEO37.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE66271，样本共13对，平台是GPL570&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cl
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记3</title>
    <link href="http://uteric.github.io/GEO/GEO03/"/>
    <id>http://uteric.github.io/GEO/GEO03/</id>
    <published>2020-08-01T16:55:19.000Z</published>
    <updated>2020-08-01T16:55:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE66270，28个样本，14对，平台是GPL570，54675个探针。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE66270'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),14)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO21.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO22.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ---- 已转化对数，略过此步</span></span><br><span class="line"><span class="comment"># ex &lt;- exprSet</span></span><br><span class="line"><span class="comment"># qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment"># LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment"># if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment"># exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment"># dim(exprSet)</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL570'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL570.soft'</span>)</span><br><span class="line">GPL570&lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL570$`Gene Symbol`,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,NDUFA4L2,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'NDUFA4L2'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO23.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO24.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO25.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO26.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05169'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO27.png" alt></p><p><img src="/images/GEO/GEO28.png" alt></p><p><img src="/images/GEO/GEO29.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE66270，28个样本，14对，平台是GPL570，54675个探针。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记2</title>
    <link href="http://uteric.github.io/GEO/GEO02/"/>
    <id>http://uteric.github.io/GEO/GEO02/</id>
    <published>2020-07-31T03:14:58.000Z</published>
    <updated>2020-07-31T03:14:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100666" target="_blank" rel="noopener">GSE100666</a>，6个配对样本，平台是GPL16951，分析过程如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE100666'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,3),rep(<span class="string">'normal'</span>,3))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO12.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO13.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line"><span class="keyword">if</span> (LogC) &#123; ex[<span class="built_in">which</span>(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex) &#125;</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL16951'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL16951.soft'</span>)</span><br><span class="line">GPL16951&lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL16951<span class="variable">$Gene_symbol</span>,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(rep(1:3,2))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=rep(1:3,2),</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,ATP6V1G3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'ATP6V1G3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO14.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO15.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line"><span class="comment">#heat &lt;- na.omit(heatdata)</span></span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heatdata, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO16.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO17.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO18.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO19.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO20.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100666&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GSE100666&lt;/a&gt;，6个配对样本，平台是GPL16951，
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记1</title>
    <link href="http://uteric.github.io/GEO/GEO01/"/>
    <id>http://uteric.github.io/GEO/GEO01/</id>
    <published>2020-07-25T21:14:01.000Z</published>
    <updated>2020-07-25T21:14:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文是学习过程，参考教程是《来完成你的生信作业，这是最有诚意的GEO数据库教程》，本文分析GSE32575，共36个配对样本，18个处理前，18个处理后。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt; setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">&gt; library(GEOquery)</span><br><span class="line">&gt; gset &lt;- getGEO(<span class="string">'GSE32575'</span>,destdir=<span class="string">"."</span>,getGPL=F) <span class="comment"># 下载数据</span></span><br><span class="line">&gt; gset &lt;- gset[[1]] <span class="comment"># 获取表达矩阵与分组信息</span></span><br><span class="line">&gt; pdata &lt;- pData(gset) <span class="comment"># 分组信息</span></span><br><span class="line">&gt; dim(pdata)</span><br><span class="line">[1] 48 37 <span class="comment"># 48个样品，下面要删除前12个，仅用后36个</span></span><br><span class="line">&gt; group_list &lt;- c(rep(<span class="string">'before'</span>,18),rep(<span class="string">'after'</span>,18))</span><br><span class="line">&gt; group_list &lt;-factor(group_list) <span class="comment"># 设定level</span></span><br><span class="line">&gt; group_list</span><br><span class="line"> [1] before before before before before before before before before</span><br><span class="line">[10] before before before before before before before before before</span><br><span class="line">[19] after  after  after  after  after  after  after  after  after </span><br><span class="line">[28] after  after  after  after  after  after  after  after  after </span><br><span class="line">Levels: after before</span><br><span class="line">&gt; group_list &lt;- relevel(group_list, ref=<span class="string">'before'</span>) <span class="comment"># 限定level</span></span><br><span class="line">&gt; group_list</span><br><span class="line"> [1] before before before before before before before before before</span><br><span class="line">[10] before before before before before before before before before</span><br><span class="line">[19] after  after  after  after  after  after  after  after  after </span><br><span class="line">[28] after  after  after  after  after  after  after  after  after </span><br><span class="line">Levels: before after</span><br><span class="line">&gt; exprSet &lt;- exprs(gset) <span class="comment"># 获取表达矩阵</span></span><br><span class="line">&gt; boxplot(exprSet[,-c(1:12)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO01.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(limma) <span class="comment"># 使用limma进行Normalization</span></span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet[,-c(1:12)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO02.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对数据进行LOG转换，否则数据太过分散</span></span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line"><span class="keyword">if</span> (LogC) &#123; ex[<span class="built_in">which</span>(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'log2 transform finished'</span>)&#125;<span class="keyword">else</span>&#123;<span class="built_in">print</span>(<span class="string">'log2 transform not needed'</span>)&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO03.png" alt></p><p>转换之后，行名是探针名称，需要先转换为基因名称</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt; index &lt;- gset@annotation</span><br><span class="line">&gt; index</span><br><span class="line">[1] <span class="string">"GPL6102"</span> <span class="comment"># 探针平台名称</span></span><br><span class="line">&gt; platformMap &lt;- data.table::fread(<span class="string">"platformMap.txt"</span>) <span class="comment"># 这个文件可在网上下载，对应着平台与R包之间的关系</span></span><br><span class="line">&gt; platformDB = paste0(platformMap<span class="variable">$bioc_package</span>[grep(index,platformMap<span class="variable">$gpl</span>)],<span class="string">'.db'</span>)</span><br><span class="line">&gt; platformDB</span><br><span class="line">[1] <span class="string">"illuminaHumanv2.db"</span> <span class="comment"># 我们需要这个R包的名称，或者直接在TXT文件中查找</span></span><br><span class="line">&gt; BiocManager::install(<span class="string">"illuminaHumanv2.db"</span>)</span><br><span class="line">&gt; library(illuminaHumanv2.db)</span><br><span class="line">&gt; probeset &lt;- rownames(exprSet)</span><br><span class="line">&gt; SYMBOL &lt;-  annotate::lookUp(probeset,<span class="string">'illuminaHumanv2.db'</span>, <span class="string">'SYMBOL'</span>)</span><br><span class="line">&gt; symbol &lt;- as.vector(unlist(SYMBOL))</span><br><span class="line">&gt; probe2symbol &lt;- data.frame(probeset,symbol,stringsAsFactors = F)</span><br><span class="line">&gt; dim(probe2symbol)</span><br><span class="line">[1] 48701     2</span><br><span class="line">&gt; head(probe2symbol)</span><br><span class="line">      probeset symbol</span><br><span class="line">1 ILMN_1343289   RPS9</span><br><span class="line">2 ILMN_1343290    UBC</span><br><span class="line">3 ILMN_1343291 EEF1A1</span><br><span class="line">4 ILMN_1343292 TUBB2A</span><br><span class="line">5 ILMN_1343293    TXN</span><br><span class="line">6 ILMN_1343294   ACTB</span><br></pre></td></tr></table></figure><p>其实，注释的过程中有些基因是没有名称的，会被标记为NA，另外也可能有重复的，即多个探针可能对应同一基因，因此，需要去掉重复与NA。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;%  <span class="comment"># 把行名转化为第一列，原因是行名不可以有重复，不方便操作</span></span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;%  <span class="comment"># 合并probe2symbol，即把symbol加到最后一列</span></span><br><span class="line">  select(-probeset) %&gt;% <span class="comment"># 去掉第一列，这是个过渡，用完就可以去掉</span></span><br><span class="line">  select(symbol,everything()) %&gt;% <span class="comment"># 重新排序，把symbol放在第一列</span></span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% <span class="comment"># 计算每行除symbol外的平均值</span></span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% <span class="comment"># 留下symbol不是NA的行，开始是48701行，筛选后剩下24459行</span></span><br><span class="line">  arrange(desc(rowMean)) %&gt;% <span class="comment"># 按行的平均值重新排列</span></span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% <span class="comment"># 若symbol有重复，留下第一个，即rowMean最大的一个，筛选后剩下18954行；</span></span><br><span class="line">  select(-rowMean) %&gt;% <span class="comment"># 去掉rowMean列</span></span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>) <span class="comment"># 把第一列转化为行名，操作结束</span></span><br><span class="line">&gt; dim(exprSet)</span><br><span class="line">[1] 18954    36</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO04.png" alt></p><p>到此，数据就准备好了，下面进行差异分析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt; pairinfo &lt;- factor(rep(1:18,2))</span><br><span class="line">&gt; pairinfo</span><br><span class="line"> [1] 1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 1  2  3  4 </span><br><span class="line">[23] 5  6  7  8  9  10 11 12 13 14 15 16 17 18</span><br><span class="line">Levels: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18</span><br><span class="line">&gt; design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">&gt; fit &lt;- lmFit(exprSet,design)</span><br><span class="line">&gt; fit &lt;- eBayes(fit) </span><br><span class="line">&gt; allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf,p.value=0.05) <span class="comment"># group_listafter是design中的一列</span></span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 7649    6 <span class="comment"># 得到7649个差异基因</span></span><br><span class="line">&gt; head(allDiff_pair)</span><br><span class="line">            logFC   AveExpr         t      P.Value    adj.P.Val</span><br><span class="line">R3HCC1 -0.5120536  9.488934 -21.00187 2.017132e-15 3.823273e-11</span><br><span class="line">CHD9    0.9151318  9.456901  20.10559 4.773134e-15 4.523499e-11</span><br><span class="line">PIK3CG  0.7508626  8.864623  18.75847 1.864086e-14 9.249356e-11</span><br><span class="line">SCAND1 -0.6169805 10.540154 -18.69975 1.982044e-14 9.249356e-11</span><br><span class="line">ASAH1  -0.7523775  9.364233 -18.50207 2.439948e-14 9.249356e-11</span><br><span class="line">FAM76B  0.8384345  8.265115  17.90582 4.623183e-14 1.413263e-10</span><br><span class="line">              B</span><br><span class="line">R3HCC1 25.17464</span><br><span class="line">CHD9   24.38000</span><br><span class="line">PIK3CG 23.10821</span><br><span class="line">SCAND1 23.05052</span><br><span class="line">ASAH1  22.85487</span><br><span class="line">FAM76B 22.25094</span><br></pre></td></tr></table></figure><p>作图验证一下，作图之前需要对数据格式进行调整，以适应ggplot2对输入数据的要求，即行是样品，列是基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=rep(1:18,2),</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,R3HCC1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'R3HCC1'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO05.png" alt></p><p>批量作图，挑差异最大的10个基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(dplyr)</span><br><span class="line">&gt; library(tibble)</span><br><span class="line">&gt; allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% <span class="comment"># 行名转化为第一列</span></span><br><span class="line">  arrange(desc(abs(logFC))) <span class="comment"># 对logFC的绝对值进行降序排列</span></span><br><span class="line">&gt; genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10] <span class="comment"># 排名前10的基因</span></span><br><span class="line">&gt; genes</span><br><span class="line"> [1] <span class="string">"CH25H"</span>  <span class="string">"HOXA5"</span>  <span class="string">"ID1"</span>    <span class="string">"ZBTB16"</span> <span class="string">"IL1R2"</span>  <span class="string">"CA4"</span>    <span class="string">"SLC7A5"</span></span><br><span class="line"> [8] <span class="string">"DDIT4"</span>  <span class="string">"KLF9"</span>   <span class="string">"ACKR3"</span></span><br><span class="line">&gt; plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">&gt; library(cowplot)</span><br><span class="line">&gt; plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10]) <span class="comment"># 这个作图方法真是高明，感叹！</span></span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO06.png" alt></p><p>画热图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf,p.value=0.05,lfc = 1) <span class="comment"># lfc=1，代表logFC绝对值大于1</span></span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">annotation_col&lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heatdata, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = T,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, <span class="comment"># scale一定选行，即在基因内标准化</span></span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO07.png" alt></p><p>绘制火山图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; library(ggrepel)</span><br><span class="line">&gt; library(dplyr)</span><br><span class="line">&gt; data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf) </span><br><span class="line">&gt; data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 0.6) <span class="comment">#以logFC=1.5为界</span></span><br><span class="line">&gt; data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line">&gt; ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">+   geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">+   geom_point(data=subset(data, logFC &gt; 0.6),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">+   geom_point(data=subset(data, logFC &lt; -0.6),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">+   labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">+   theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">+   geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">+   geom_vline(xintercept = c(0.6,-0.6),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">+   theme_bw()+</span><br><span class="line">+   theme(panel.border = element_blank(),</span><br><span class="line">+         panel.grid.major = element_blank(), </span><br><span class="line">+         panel.grid.minor = element_blank(),   </span><br><span class="line">+         axis.line = element_line(colour = <span class="string">'black'</span>)) +</span><br><span class="line">+   geom_point(data=subset(data, abs(logFC) &gt; 1),alpha=0.8, size=3,col=<span class="string">'green'</span>)+</span><br><span class="line">+   geom_text_repel(data=subset(data, abs(logFC) &gt; 1), </span><br><span class="line">+                   aes(label=gene),col=<span class="string">'black'</span>,alpha = 0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO08.png" alt></p><p>富集分析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(clusterProfiler)</span><br><span class="line">&gt; gene &lt;- rownames(allDiff_pair) <span class="comment"># 只需要基因名</span></span><br><span class="line">&gt; gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">&gt; de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">&gt; go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO09.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">&gt; dotplot(EGG)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO10.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">&gt; head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">               ID                    Description GeneRatio  BgRatio</span><br><span class="line">hsa04120 hsa04120 Ubiquitin mediated proteolysis   88/3122 140/8048</span><br><span class="line">hsa04218 hsa04218            Cellular senescence   94/3122 156/8048</span><br><span class="line">hsa04210 hsa04210                      Apoptosis   84/3122 136/8048</span><br><span class="line">hsa04110 hsa04110                     Cell cycle   76/3122 124/8048</span><br><span class="line">hsa05220 hsa05220       Chronic myeloid leukemia   51/3122  76/8048</span><br><span class="line">hsa05131 hsa05131                    Shigellosis  130/3122 242/8048</span><br><span class="line">               pvalue     p.adjust       qvalue</span><br><span class="line">hsa04120 5.535090e-09 1.787834e-06 1.229373e-06</span><br><span class="line">hsa04218 3.626260e-08 4.287401e-06 2.948155e-06</span><br><span class="line">hsa04210 3.982106e-08 4.287401e-06 2.948155e-06</span><br><span class="line">hsa04110 2.770947e-07 2.237540e-05 1.538605e-05</span><br><span class="line">hsa05220 4.909519e-07 3.171549e-05 2.180860e-05</span><br><span class="line">hsa05131 1.268222e-06 6.827259e-05 4.694645e-05</span><br><span class="line">&gt; browseKEGG(EGG, <span class="string">'hsa04218'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO11.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本文是学习过程，参考教程是《来完成你的生信作业，这是最有诚意的GEO数据库教程》，本文分析GSE32575，共36个配对样本，18个处理前，18个处理后。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记14-基因集富集分析GSEA</title>
    <link href="http://uteric.github.io/TCGA/TCGA14GSEA/"/>
    <id>http://uteric.github.io/TCGA/TCGA14GSEA/</id>
    <published>2020-07-19T03:36:48.000Z</published>
    <updated>2020-07-19T03:36:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>GSEA（Gene Set Enrichment Analysis），是基因集富集分析，也是软件的名称，顾名思议，GSEA用于分析给定分组中差异表达的基因是否在给定的基因集中有富集。</p><p>下载<a href="https://www.gsea-msigdb.org/gsea/downloads.jsp" target="_blank" rel="noopener">GSEA</a>软件：根据操作系统下载相应的版本并安装</p><p>软件主界面如下图：</p><p><img src="/images/TCGA/TCGA22.png" alt></p><p>这个软件操作十分容易，简单明了，唯一的难度在于输入数据的准备，简单来说，有两个数据是必须提前准备好的，即表达数据与表型注释</p><p>表达数据格式：可以有多种输入格式，这里以TXT为例，我们先在R中将我们需要的数据提取并保存为CSV格式，处理完成后再保存为TXT即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 回顾一下前面的数据，差异表达筛选之后有4913个基因（result_select），注释后剩下4863个（result_select_annot）</span></span><br><span class="line">&gt; x1 &lt;- result_select_annot<span class="variable">$hgnc_symbol</span></span><br><span class="line">&gt; length(x1)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; tail(x1)</span><br><span class="line">[1] <span class="string">""</span>           <span class="string">"SLFNL1-AS1"</span> <span class="string">"HELLPAR"</span>    <span class="string">"SNHG4"</span>      <span class="string">"LINC01176"</span> </span><br><span class="line">[6] <span class="string">"CICP14"</span>    </span><br><span class="line">&gt; x1[x1==<span class="string">""</span>]=NA <span class="comment">#把""转换为NA，方便逻辑判断</span></span><br><span class="line">&gt; tail(x1)</span><br><span class="line">[1] NA           <span class="string">"SLFNL1-AS1"</span> <span class="string">"HELLPAR"</span>    <span class="string">"SNHG4"</span>      <span class="string">"LINC01176"</span> </span><br><span class="line">[6] <span class="string">"CICP14"</span> </span><br><span class="line">&gt; table(is.na(x1))</span><br><span class="line">FALSE  TRUE </span><br><span class="line"> 4259   604 <span class="comment">#4863个注释后的基因，居然只有4259个有名字，下面就取出这些基因的表达数据来做富集分析</span></span><br><span class="line"></span><br><span class="line">&gt; write.csv(result_select_annot,<span class="string">"result_select_annot.csv"</span>) <span class="comment"># 这是差异分析并注释过后的4863个基因</span></span><br><span class="line">&gt; <span class="comment"># Remove BLANKs in EXCEL, rename as "unique_annot.csv"</span></span><br><span class="line">&gt; unique_annot &lt;- read.csv(<span class="string">"unique_annot.csv"</span>)</span><br><span class="line">&gt; dim(unique_annot)</span><br><span class="line">[1] 4259    9 <span class="comment"># 把没有名字的在EXCEL中去掉，剩下4259个</span></span><br><span class="line">&gt; head(unique_annot)</span><br><span class="line">  ï.. ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1   1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2   2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3   3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4   4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5   5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6   6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">    pvalue     padj hgnc_symbol</span><br><span class="line">1 1.79e-51 2.15e-50         FGR</span><br><span class="line">2 7.05e-37 4.97e-36      SEMA3F</span><br><span class="line">3 6.83e-22 2.56e-21     CYP51A1</span><br><span class="line">4 1.01e-49 1.14e-48        CD99</span><br><span class="line">5 4.84e-62 8.09e-61       HECW1</span><br><span class="line">6 4.80e-24 1.98e-23    TMEM176A</span><br><span class="line">&gt; data_annot &lt;- data_select[match(unique_annot<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),] <span class="comment"># 提取表达数据</span></span><br><span class="line">&gt; dim(data_annot)</span><br><span class="line">[1] 4259  611</span><br><span class="line">&gt; head(data_annot)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000001617                     16862                     10888</span><br><span class="line">ENSG00000001630                       310                        77</span><br><span class="line">ENSG00000002586                     10729                      8611</span><br><span class="line">ENSG00000002746                         7                        37</span><br><span class="line">ENSG00000002933                     60355                     29448</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000000938                      1100</span><br><span class="line">ENSG00000001617                      9299</span><br><span class="line">ENSG00000001630                       305</span><br><span class="line">ENSG00000002586                      7618</span><br><span class="line">ENSG00000002746                         7</span><br><span class="line">ENSG00000002933                     47857</span><br><span class="line">&gt; data_annot<span class="variable">$symbol</span> &lt;- unique_annot<span class="variable">$hgnc_symbol</span> <span class="comment"># 加入基因名称</span></span><br><span class="line">&gt; dim(data_annot)</span><br><span class="line">[1] 4259  612</span><br><span class="line">&gt; head(data_annot)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000001617                     16862                     10888</span><br><span class="line">ENSG00000001630                       310                        77</span><br><span class="line">ENSG00000002586                     10729                      8611</span><br><span class="line">ENSG00000002746                         7                        37</span><br><span class="line">ENSG00000002933                     60355                     29448</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000000938                      1100</span><br><span class="line">ENSG00000001617                      9299</span><br><span class="line">ENSG00000001630                       305</span><br><span class="line">ENSG00000002586                      7618</span><br><span class="line">ENSG00000002746                         7</span><br><span class="line">ENSG00000002933                     47857</span><br><span class="line">&gt; data_annot2 &lt;- data_annot[,c(612,1:611)] <span class="comment"># 把基因名称放到第一列</span></span><br><span class="line">&gt; dim(data_annot2)</span><br><span class="line">[1] 4259  612</span><br><span class="line">&gt; head(data_annot2)[,1:3]</span><br><span class="line">                  symbol TCGA-CZ-5465-01A-01R-1503</span><br><span class="line">ENSG00000000938      FGR                       899</span><br><span class="line">ENSG00000001617   SEMA3F                     16862</span><br><span class="line">ENSG00000001630  CYP51A1                       310</span><br><span class="line">ENSG00000002586     CD99                     10729</span><br><span class="line">ENSG00000002746    HECW1                         7</span><br><span class="line">ENSG00000002933 TMEM176A                     60355</span><br><span class="line">                TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                      1211</span><br><span class="line">ENSG00000001617                     10888</span><br><span class="line">ENSG00000001630                        77</span><br><span class="line">ENSG00000002586                      8611</span><br><span class="line">ENSG00000002746                        37</span><br><span class="line">ENSG00000002933                     29448</span><br><span class="line">&gt; write.csv(data_annot2,<span class="string">"data_annot2.csv"</span>) <span class="comment"># 这个文件就是GSEA的表达文件，但是在输入GSEA前需要处理，第一列改为基因名称，新加第二列DESCRIPTION，内容为na即可；</span></span><br><span class="line">&gt; data_annot2<span class="variable">$symbol</span>[duplicated(data_annot2<span class="variable">$symbol</span>)] <span class="comment"># 检查一下基因名称是否有重复</span></span><br><span class="line">factor(0)</span><br><span class="line">4259 Levels: A4GNT AACSP1 AATBC AATK ABAT ABCA1 ABCA12 ... ZYG11A</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA23.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面准备表型文件</span></span><br><span class="line">&gt; phetype &lt;- data.frame(colnames(data_annot2)[2:612],group)</span><br><span class="line">&gt; dim(phetype)</span><br><span class="line">[1] 611   2</span><br><span class="line">&gt; head(phetype)</span><br><span class="line">  colnames.data_annot2..2.612.  group</span><br><span class="line">1    TCGA-CZ-5465-01A-01R-1503 cancer</span><br><span class="line">2    TCGA-BP-4355-01A-01R-1289 cancer</span><br><span class="line">3    TCGA-CZ-5451-01A-01R-1503 cancer</span><br><span class="line">4    TCGA-B0-5081-01A-01R-1334 cancer</span><br><span class="line">5    TCGA-CZ-5454-11A-01R-1503 normal</span><br><span class="line">6    TCGA-B0-5697-01A-11R-1541 cancer</span><br><span class="line">&gt; phetypeOrder &lt;- phetype[order(phetype<span class="variable">$group</span>),]</span><br><span class="line">&gt; head(phetypeOrder)</span><br><span class="line">   colnames.data_annot2..2.612.  group</span><br><span class="line">5     TCGA-CZ-5454-11A-01R-1503 normal</span><br><span class="line">10    TCGA-B0-5691-11A-01R-1541 normal</span><br><span class="line">21    TCGA-B0-5701-11A-01R-1541 normal</span><br><span class="line">41    TCGA-B2-5636-11A-01R-1541 normal</span><br><span class="line">44    TCGA-B0-5703-11A-01R-1541 normal</span><br><span class="line">45    TCGA-CZ-4864-11A-01R-1503 normal</span><br><span class="line">&gt; tail(phetypeOrder)</span><br><span class="line">    colnames.data_annot2..2.612.  group</span><br><span class="line">606    TCGA-BP-5200-01A-01R-1426 cancer</span><br><span class="line">607    TCGA-BP-4999-01A-01R-1334 cancer</span><br><span class="line">608    TCGA-GK-A6C7-01A-11R-A33J cancer</span><br><span class="line">609    TCGA-B0-5113-01A-01R-1420 cancer</span><br><span class="line">610    TCGA-CJ-4893-01A-01R-1305 cancer</span><br><span class="line">611    TCGA-CZ-4856-01A-02R-1426 cancer</span><br><span class="line">&gt; write.csv(phetypeOrder,<span class="string">"phetypeOrder.csv"</span>) <span class="comment"># 表型文件，排序是为方便在GSEA软件中输入</span></span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA24.png" alt></p><p>如上图，输入表达文件和表型文件，并且将下载好的基因集文件导入，就可以运行了，如果跑所有的基因集，需要耗费几分钟时间，运行完成后，生成一个网页，里面是对结果的描述。</p><p><img src="/images/TCGA/TCGA25.png" alt></p><p>程序共运行了12388个基因集，使用了4259个基因。那么，富集结果怎么读呢？一般认为，|NES|&gt;1，NOM p-val&lt;0.05，FDR q-val&lt;0.25的通路是显著富集的。</p><p>根据这个标准，富集结果并不理想，不论肿瘤或是正常组织中，都不存在符合以上标准的基因集。</p><p>当然，以上富集分析有一个硬伤，即只选取了差异表达的基因，并且由于注释的缘故，一部分基因被滤掉了，这可能导致富集结果出现偏差。我们也可以尝试使用所有的基因来做个分析。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(data_select)</span><br><span class="line">[1] 18129   611 <span class="comment"># 原始数据经筛选后留下18129个基因</span></span><br><span class="line">&gt; library(biomaRt)</span><br><span class="line">&gt; geneName_select2 &lt;- rownames(data_select)</span><br><span class="line">&gt; length(geneName_select2)</span><br><span class="line">[1] 18129</span><br><span class="line">ensemb &lt;- useDataset(<span class="string">"hsapiens_gene_ensembl"</span>,mart=useMart(<span class="string">"ensembl"</span>))</span><br><span class="line">ensemb</span><br><span class="line">annot2 &lt;- getBM(attributes = c(<span class="string">"ensembl_gene_id"</span>,<span class="string">"hgnc_symbol"</span>),</span><br><span class="line">               filters = <span class="string">"ensembl_gene_id"</span>,values = geneName_select2, mart=ensemb)</span><br><span class="line">class(annot2)</span><br><span class="line">&gt; dim(annot2)</span><br><span class="line">[1] 17972     2 <span class="comment"># 注释后剩下17192个基因</span></span><br><span class="line">&gt; head(annot2)</span><br><span class="line">  ensembl_gene_id hgnc_symbol</span><br><span class="line">1 ENSG00000000419        DPM1</span><br><span class="line">2 ENSG00000000457       SCYL3</span><br><span class="line">3 ENSG00000000460    C1orf112</span><br><span class="line">4 ENSG00000000938         FGR</span><br><span class="line">5 ENSG00000000971         CFH</span><br><span class="line">6 ENSG00000001036       FUCA2</span><br><span class="line">&gt; annot2<span class="variable">$hgnc_symbol</span>[duplicated(annot2<span class="variable">$hgnc_symbol</span>)]</span><br><span class="line">   [1] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [22] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [43] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [64] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [85] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [106] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [127] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [148] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [169] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [190] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [211] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [232] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [253] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [274] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [295] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [316] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [337] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [358] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [379] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [400] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [421] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [442] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [463] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [484] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [505] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [526] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [547] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [568] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [589] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [610] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [631] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [652] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [673] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [694] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [715] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [736] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [757] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [778] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [799] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [820] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [841] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [862] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [883] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [904] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [925] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [946] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [967] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [988] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [ reached getOption(<span class="string">"max.print"</span>) -- omitted 589 entries ] <span class="comment"># 查重，居然有1589个是""，这些需要去掉</span></span><br><span class="line">annot2_unique &lt;- annot2[match(unique(annot2<span class="variable">$hgnc_symbol</span>),annot2<span class="variable">$hgnc_symbol</span>),]</span><br><span class="line">&gt; dim(annot2_unique)</span><br><span class="line">[1] 16383     2 <span class="comment"># 去掉重复后剩下16383个基因，其实还有一行""剩下，需要去掉</span></span><br><span class="line">&gt; head(annot2_unique)</span><br><span class="line">  ensembl_gene_id hgnc_symbol</span><br><span class="line">1 ENSG00000000419        DPM1</span><br><span class="line">2 ENSG00000000457       SCYL3</span><br><span class="line">3 ENSG00000000460    C1orf112</span><br><span class="line">4 ENSG00000000938         FGR</span><br><span class="line">5 ENSG00000000971         CFH</span><br><span class="line">6 ENSG00000001036       FUCA2</span><br><span class="line">data_select_annot &lt;- data_select[match(annot2_unique<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),]</span><br><span class="line">&gt; dim(data_select_annot)</span><br><span class="line">[1] 16383   611 <span class="comment"># 其实应当是16382行，有一行是""，没有去掉</span></span><br><span class="line">head(data_select_annot)[,1:3]</span><br><span class="line">Descriptions &lt;- rep(<span class="string">"NA"</span>,16383) <span class="comment"># 加一列</span></span><br><span class="line">data_select_annot2 &lt;- cbind(symbol=annot2_unique<span class="variable">$hgnc_symbol</span>,Descriptions,data_select_annot)</span><br><span class="line">dim(data_select_annot2)</span><br><span class="line">head(data_select_annot2)[,1:3]</span><br><span class="line">write.csv(data_select_annot2,<span class="string">"data_select_annot2.csv"</span>)</span><br><span class="line"><span class="comment"># 在EXCEL中去掉""这一列，并保存为TXT文件</span></span><br><span class="line">&gt; data_select_annot2<span class="variable">$symbol</span>[duplicated(data_select_annot2<span class="variable">$symbol</span>)] <span class="comment"># 这回没有重复</span></span><br><span class="line">factor(0)</span><br><span class="line">16383 Levels:  A1BG-AS1 A1CF A2M A2M-AS1 A4GALT A4GNT AAAS ... ZZEF1</span><br><span class="line"><span class="comment"># 上面这个TXT文件即为表达文件</span></span><br><span class="line">phetype &lt;- data.frame(colnames(data_select_annot2)[3:613],group)</span><br><span class="line">dim(phetype)</span><br><span class="line">head(phetype)</span><br><span class="line">phetypeOrder &lt;- phetype[order(phetype<span class="variable">$group</span>),]</span><br><span class="line">head(phetypeOrder)</span><br><span class="line">tail(phetypeOrder)</span><br><span class="line">write.csv(phetypeOrder,<span class="string">"phetypeOrder.csv"</span>) <span class="comment"># 表型文件</span></span><br></pre></td></tr></table></figure><p>运行之后，结果是一致的，即没有显著富集的基因集。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;GSEA（Gene Set Enrichment Analysis），是基因集富集分析，也是软件的名称，顾名思议，GSEA用于分析给定分组中差异表达的基因是否在给定的基因集中有富集。&lt;/p&gt;
&lt;p&gt;下载&lt;a href=&quot;https://www.gsea-msigdb.org
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记13-对所有差异表达基因进行生存分析</title>
    <link href="http://uteric.github.io/TCGA/TCGA13Survival/"/>
    <id>http://uteric.github.io/TCGA/TCGA13Survival/</id>
    <published>2020-07-05T21:37:58.000Z</published>
    <updated>2020-07-05T21:37:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们以padj或FoldChange为依据筛选了TOP10基因，并进行了生存分析，但效果并不理想，原因很简单，因为不论是P值还是变化倍数，其实都与病例生存时间没有必然关联。这次，我们来对所有差异表达基因批量进行生存分析，看有多少基因影响病例生存，并且找找规律。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(result_select_annot) <span class="comment"># 注释后的4863个基因</span></span><br><span class="line">[1] 4863    8</span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A</span><br><span class="line"></span><br><span class="line">&gt; annot_symbol &lt;- result_select_annot<span class="variable">$hgnc_symbol</span></span><br><span class="line">&gt; length(annot_symbol)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; annot_id &lt;- result_select_annot<span class="variable">$ensembl_gene_id</span></span><br><span class="line">&gt; length(annot_id)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; annot_data &lt;- data_select[match(result_select_annot<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),]</span><br><span class="line">&gt; colnames(annot_data) &lt;- substr(colnames(annot_data),1,15)</span><br><span class="line">&gt; head(annot_data)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000000938             899            1211            1100</span><br><span class="line">ENSG00000001617           16862           10888            9299</span><br><span class="line">ENSG00000001630             310              77             305</span><br><span class="line">ENSG00000002586           10729            8611            7618</span><br><span class="line">ENSG00000002746               7              37               7</span><br><span class="line">ENSG00000002933           60355           29448           47857</span><br><span class="line">&gt; dim(annot_data)</span><br><span class="line">[1] 4863  611 <span class="comment"># 数据准备就绪</span></span><br><span class="line"></span><br><span class="line">&gt; kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>)</span><br><span class="line">&gt; dim(kidney_clinic)</span><br><span class="line">[1] 530  14</span><br><span class="line">&gt; head(kidney_clinic)</span><br><span class="line">                      id classification_of_tumor tumor_stage gender</span><br><span class="line">1 TCGA-CZ-5986_diagnosis            not reported     stage i   male</span><br><span class="line">2 TCGA-CZ-4858_diagnosis            not reported    stage ii   male</span><br><span class="line">3 TCGA-B8-5551_diagnosis            not reported     stage i female</span><br><span class="line">4 TCGA-B0-4817_diagnosis            not reported   stage iii   male</span><br><span class="line">5 TCGA-BP-4325_diagnosis            not reported     stage i female</span><br><span class="line">6 TCGA-B0-4698_diagnosis            not reported    stage iv   male</span><br><span class="line">  year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">1          1945  not reported              2006  not reported  61</span><br><span class="line">2          1966  not reported              2005          2105  39</span><br><span class="line">3          1945  not reported              2010  not reported  65</span><br><span class="line">4          1921          2004              2002          1019  81</span><br><span class="line">5          1937  not reported              2001  not reported  64</span><br><span class="line">6          1928          2003              2003            42  75</span><br><span class="line">  deadORlive                      race      alcohol years_smoked</span><br><span class="line">1      Alive                     white Not Reported not reported</span><br><span class="line">2       Dead                     white Not Reported not reported</span><br><span class="line">3      Alive black or african american Not Reported not reported</span><br><span class="line">4       Dead                     white Not Reported not reported</span><br><span class="line">5      Alive                     white Not Reported not reported</span><br><span class="line">6       Dead                     white Not Reported not reported</span><br><span class="line">            newID</span><br><span class="line">1 TCGA-CZ-5986-01</span><br><span class="line">2 TCGA-CZ-4858-01</span><br><span class="line">3 TCGA-B8-5551-01</span><br><span class="line">4 TCGA-B0-4817-01</span><br><span class="line">5 TCGA-BP-4325-01</span><br><span class="line">6 TCGA-B0-4698-01</span><br><span class="line">&gt; km_plot &lt;- apply(annot_data,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;)</span><br><span class="line">&gt; dim(km_plot)</span><br><span class="line">[1]  611 4863</span><br><span class="line">&gt; head(km_plot)[,1:3]</span><br><span class="line">                ENSG00000000938 ENSG00000001617 ENSG00000001630</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>    </span><br><span class="line">&gt; km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),]</span><br><span class="line">&gt; dim(km_plot_cancer)</span><br><span class="line">[1]  538 4863</span><br><span class="line">&gt; head(km_plot_cancer)[,1:3]</span><br><span class="line">                ENSG00000000938 ENSG00000001617 ENSG00000001630</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>   </span><br><span class="line">&gt; kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">&gt; dim(kidney_clinic_km)</span><br><span class="line">[1] 538  14</span><br><span class="line">&gt; head(kidney_clinic_km)</span><br><span class="line">                        id classification_of_tumor tumor_stage gender</span><br><span class="line">274 TCGA-CZ-5465_diagnosis            not reported   stage iii female</span><br><span class="line">358 TCGA-BP-4355_diagnosis            not reported   stage iii female</span><br><span class="line">517 TCGA-CZ-5451_diagnosis            not reported    stage ii   male</span><br><span class="line">119 TCGA-B0-5081_diagnosis            not reported   stage iii female</span><br><span class="line">201 TCGA-B0-5697_diagnosis            not reported     stage i   male</span><br><span class="line">484 TCGA-A3-A8OV_diagnosis            not reported     stage i   male</span><br><span class="line">    year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">274          1931  not reported              2007          2564  76</span><br><span class="line">358          1949          2010              2008           953  59</span><br><span class="line">517          1932  not reported              2006  not reported  74</span><br><span class="line">119          1926          2005              2005           362  79</span><br><span class="line">201          1957  not reported              2007  not reported  50</span><br><span class="line">484          1936  not reported              2011  not reported  75</span><br><span class="line">    deadORlive                      race      alcohol years_smoked</span><br><span class="line">274       Dead              not reported Not Reported not reported</span><br><span class="line">358       Dead                     white Not Reported not reported</span><br><span class="line">517      Alive                     white Not Reported not reported</span><br><span class="line">119       Dead                     white Not Reported not reported</span><br><span class="line">201      Alive                     white Not Reported not reported</span><br><span class="line">484      Alive black or african american Not Reported           65</span><br><span class="line">              newID</span><br><span class="line">274 TCGA-CZ-5465-01</span><br><span class="line">358 TCGA-BP-4355-01</span><br><span class="line">517 TCGA-CZ-5451-01</span><br><span class="line">119 TCGA-B0-5081-01</span><br><span class="line">201 TCGA-B0-5697-01</span><br><span class="line">484 TCGA-A3-A8OV-01</span><br><span class="line">&gt; daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>))</span><br><span class="line">&gt; daysToDeath</span><br><span class="line">  [1] 2564  953   NA  362   NA   NA   62 1493   51   NA   NA   NA 1588</span><br><span class="line"> [14]   NA  885 2227  137   NA   NA 1432   NA   NA   NA   NA   NA   NA</span><br><span class="line"> [27] 1657   NA   18   NA 1964   NA  109   NA 1661   NA   NA   NA   NA</span><br><span class="line"> [40]   NA   NA   NA   NA 1315 1404  562  445   NA   NA   NA   NA 1238</span><br><span class="line"> [53]  182 1912   NA   NA   NA   NA 2454  344   NA 1913 1111   NA 1980</span><br><span class="line"> [66]   NA  600 1003   NA   NA   NA   NA 2105 1371  334   NA 1337   NA</span><br><span class="line"> [79]   NA   NA   NA   NA   NA   NA  727   NA   NA 2256   NA   NA   NA</span><br><span class="line"> [92]  782   NA   NA   NA   NA   NA   NA   NA 1625   NA   NA   NA   NA</span><br><span class="line">[105]   NA   NA  768   NA   NA   NA   NA   NA  563   NA 2145   NA   NA</span><br><span class="line">[118]   NA  561   NA   NA   NA   NA   NA   NA   NA   NA 1200   NA   NA</span><br><span class="line">[131]   NA   NA   NA   NA   NA   NA 1317   NA   NA   NA   NA   NA   NA</span><br><span class="line">[144]  329   NA   NA   NA   NA  242   NA   NA  646   NA   NA   NA   NA</span><br><span class="line">[157]  683  587  952    0   NA  320 1092   NA   NA   68  510   NA   NA</span><br><span class="line">[170]  245    2   NA  793   NA   NA   NA 2601   NA   NA   NA 1714   NA</span><br><span class="line">[183]   NA   NA 1230 1170 2386   NA  571  883 1912   NA   NA   NA 1986</span><br><span class="line">[196]   NA 1091   NA   NA   NA   NA   NA 1417   NA   NA   65   NA   NA</span><br><span class="line">[209]   NA   NA   NA   NA 1378   NA   NA   NA   NA   NA   NA   NA   NA</span><br><span class="line">[222]   NA   NA  679  866   NA   NA   NA   NA   NA  330   NA   NA  885</span><br><span class="line">[235]   NA  946   NA   NA  375   NA   NA   NA 1133   NA   NA  561   NA</span><br><span class="line">[248]  431   NA 2764   NA   NA   NA   NA 1696   NA   42   NA   59    0</span><br><span class="line">[261]   NA   NA   NA   NA   NA 1034 1270 1200 2241  333   NA   NA   NA</span><br><span class="line">[274]   NA  342   NA  722   NA   NA 1075   NA   NA   NA   NA  709   NA</span><br><span class="line">[287]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  164</span><br><span class="line">[300]   NA   NA   NA   NA   NA  701   69   NA   NA  574  106   NA   NA</span><br><span class="line">[313]   NA   NA  475 1019   NA   NA   NA  162  845   NA   NA  552  139</span><br><span class="line">[326]   NA   NA   NA   NA 1589   NA 1045  735   NA   NA   NA   NA   NA</span><br><span class="line">[339]   NA   NA 1972  459   NA 2299   NA   NA   NA  819 1463   NA   NA</span><br><span class="line">[352] 1724   NA   NA  313   NA   NA   NA  183   NA   NA   NA   NA   NA</span><br><span class="line">[365]   NA   NA 1626  822   NA  206  932 1097   NA   NA   NA   NA   NA</span><br><span class="line">[378]   NA   NA   NA  166  478   NA 1584   NA   NA   NA   NA  480   NA</span><br><span class="line">[391]   NA  311   NA   NA   NA   NA  202   NA  927 1343 1590  454   NA</span><br><span class="line">[404]  834   NA   NA   NA 2090 1598   NA 1639  878  992   NA   NA   NA</span><br><span class="line">[417]   NA   43   NA 2419   NA   NA   NA   NA 1121   NA   NA   NA   NA</span><br><span class="line">[430] 2343  485  110   NA   NA  313  204   NA   NA   NA  238   NA   NA</span><br><span class="line">[443]   NA   NA   NA   NA  480   NA  168   NA   73   NA   NA  101   NA</span><br><span class="line">[456]   NA   NA   NA  446 3615   NA  645   NA 1567   NA 3554   NA   NA</span><br><span class="line">[469]   NA   NA   NA  139   NA   NA   NA  841   NA   NA  336   NA   NA</span><br><span class="line">[482]   NA   99   NA   NA   NA   NA  637   NA   NA   NA   NA 1111   NA</span><br><span class="line">[495]   NA   NA   77  770   NA   NA   NA   NA  222   NA   NA   NA   NA</span><br><span class="line">[508]   41   NA   NA   NA   NA   NA   NA   NA   NA 1610  224   NA 1191</span><br><span class="line">[521]   NA   93   NA   NA  307   NA  211   NA   NA 1625   NA  578   NA</span><br><span class="line">[534]   NA   NA   NA   NA   NA</span><br><span class="line">&gt; daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath)</span><br><span class="line">&gt; daysToDeathN</span><br><span class="line">  [1] 2564  953 3615  362 3615 3615   62 1493   51 3615 3615 3615 1588</span><br><span class="line"> [14] 3615  885 2227  137 3615 3615 1432 3615 3615 3615 3615 3615 3615</span><br><span class="line"> [27] 1657 3615   18 3615 1964 3615  109 3615 1661 3615 3615 3615 3615</span><br><span class="line"> [40] 3615 3615 3615 3615 1315 1404  562  445 3615 3615 3615 3615 1238</span><br><span class="line"> [53]  182 1912 3615 3615 3615 3615 2454  344 3615 1913 1111 3615 1980</span><br><span class="line"> [66] 3615  600 1003 3615 3615 3615 3615 2105 1371  334 3615 1337 3615</span><br><span class="line"> [79] 3615 3615 3615 3615 3615 3615  727 3615 3615 2256 3615 3615 3615</span><br><span class="line"> [92]  782 3615 3615 3615 3615 3615 3615 3615 1625 3615 3615 3615 3615</span><br><span class="line">[105] 3615 3615  768 3615 3615 3615 3615 3615  563 3615 2145 3615 3615</span><br><span class="line">[118] 3615  561 3615 3615 3615 3615 3615 3615 3615 3615 1200 3615 3615</span><br><span class="line">[131] 3615 3615 3615 3615 3615 3615 1317 3615 3615 3615 3615 3615 3615</span><br><span class="line">[144]  329 3615 3615 3615 3615  242 3615 3615  646 3615 3615 3615 3615</span><br><span class="line">[157]  683  587  952    0 3615  320 1092 3615 3615   68  510 3615 3615</span><br><span class="line">[170]  245    2 3615  793 3615 3615 3615 2601 3615 3615 3615 1714 3615</span><br><span class="line">[183] 3615 3615 1230 1170 2386 3615  571  883 1912 3615 3615 3615 1986</span><br><span class="line">[196] 3615 1091 3615 3615 3615 3615 3615 1417 3615 3615   65 3615 3615</span><br><span class="line">[209] 3615 3615 3615 3615 1378 3615 3615 3615 3615 3615 3615 3615 3615</span><br><span class="line">[222] 3615 3615  679  866 3615 3615 3615 3615 3615  330 3615 3615  885</span><br><span class="line">[235] 3615  946 3615 3615  375 3615 3615 3615 1133 3615 3615  561 3615</span><br><span class="line">[248]  431 3615 2764 3615 3615 3615 3615 1696 3615   42 3615   59    0</span><br><span class="line">[261] 3615 3615 3615 3615 3615 1034 1270 1200 2241  333 3615 3615 3615</span><br><span class="line">[274] 3615  342 3615  722 3615 3615 1075 3615 3615 3615 3615  709 3615</span><br><span class="line">[287] 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615  164</span><br><span class="line">[300] 3615 3615 3615 3615 3615  701   69 3615 3615  574  106 3615 3615</span><br><span class="line">[313] 3615 3615  475 1019 3615 3615 3615  162  845 3615 3615  552  139</span><br><span class="line">[326] 3615 3615 3615 3615 1589 3615 1045  735 3615 3615 3615 3615 3615</span><br><span class="line">[339] 3615 3615 1972  459 3615 2299 3615 3615 3615  819 1463 3615 3615</span><br><span class="line">[352] 1724 3615 3615  313 3615 3615 3615  183 3615 3615 3615 3615 3615</span><br><span class="line">[365] 3615 3615 1626  822 3615  206  932 1097 3615 3615 3615 3615 3615</span><br><span class="line">[378] 3615 3615 3615  166  478 3615 1584 3615 3615 3615 3615  480 3615</span><br><span class="line">[391] 3615  311 3615 3615 3615 3615  202 3615  927 1343 1590  454 3615</span><br><span class="line">[404]  834 3615 3615 3615 2090 1598 3615 1639  878  992 3615 3615 3615</span><br><span class="line">[417] 3615   43 3615 2419 3615 3615 3615 3615 1121 3615 3615 3615 3615</span><br><span class="line">[430] 2343  485  110 3615 3615  313  204 3615 3615 3615  238 3615 3615</span><br><span class="line">[443] 3615 3615 3615 3615  480 3615  168 3615   73 3615 3615  101 3615</span><br><span class="line">[456] 3615 3615 3615  446 3615 3615  645 3615 1567 3615 3554 3615 3615</span><br><span class="line">[469] 3615 3615 3615  139 3615 3615 3615  841 3615 3615  336 3615 3615</span><br><span class="line">[482] 3615   99 3615 3615 3615 3615  637 3615 3615 3615 3615 1111 3615</span><br><span class="line">[495] 3615 3615   77  770 3615 3615 3615 3615  222 3615 3615 3615 3615</span><br><span class="line">[508]   41 3615 3615 3615 3615 3615 3615 3615 3615 1610  224 3615 1191</span><br><span class="line">[521] 3615   93 3615 3615  307 3615  211 3615 3615 1625 3615  578 3615</span><br><span class="line">[534] 3615 3615 3615 3615 3615</span><br><span class="line">&gt; fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">&gt; p &lt;- rep(0,length(annot_id)) <span class="comment"># 定义变量p，放p value</span></span><br><span class="line">&gt; s &lt;- rep(0,length(annot_id)) <span class="comment"># 定义变量s，放surv，即生存预期</span></span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(annot_id))&#123;</span><br><span class="line">+   m &lt;- survdiff(fit~km_plot_cancer[,i])</span><br><span class="line">+   p[i] &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">+   s[i] &lt;- ifelse(m<span class="variable">$obs</span>[1]/m<span class="variable">$n</span>[[1]] &gt; m<span class="variable">$obs</span>[2]/m<span class="variable">$n</span>[[2]],0,1) <span class="comment"># 0=低表达生存预期差，高表达生存预期好；1=低表达生存预期好，高表达生存预期差；</span></span><br><span class="line">+ &#125;</span><br><span class="line">&gt; class(p)</span><br><span class="line">[1] <span class="string">"numeric"</span></span><br><span class="line">&gt; length(p)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; class(s)</span><br><span class="line">[1] <span class="string">"numeric"</span></span><br><span class="line">&gt; length(s)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; table(s)</span><br><span class="line">s</span><br><span class="line">   0    1 </span><br><span class="line">2245 2618 <span class="comment"># 大致各一半</span></span><br><span class="line"></span><br><span class="line">&gt; result_select_annot<span class="variable">$survP</span> &lt;- p</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863    9 <span class="comment"># 多出新的一列</span></span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol        survP</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR 9.088360e-01</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F 2.033993e-03</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99 3.377814e-01</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1 7.404867e-01</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A 7.017783e-01</span><br><span class="line">&gt; result_select_annot<span class="variable">$surv</span> &lt;- s</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863   10 <span class="comment"># 又多出一列</span></span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol        survP surv</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR 9.088360e-01    0</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F 2.033993e-03    0</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05    0</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99 3.377814e-01    1</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1 7.404867e-01    0</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A 7.017783e-01    0</span><br><span class="line">&gt; result_survP &lt;- result_select_annot[result_select_annot<span class="variable">$survP</span> &lt; 0.001,] <span class="comment"># 筛选survP&lt;0.001的基因，共922个 </span></span><br><span class="line">&gt; dim(result_survP)</span><br><span class="line">[1] 922   9</span><br><span class="line">&gt; head(result_survP)</span><br><span class="line">   ensembl_gene_id   baseMean log2FoldChange     lfcSE       <span class="built_in">stat</span></span><br><span class="line">3  ENSG00000001630   218.0296      -1.154463 0.1200534  -9.616248</span><br><span class="line">20 ENSG00000005108  2576.9645      -1.624881 0.1633055  -9.949951</span><br><span class="line">36 ENSG00000007314   397.9782       1.635177 0.1774570   9.214498</span><br><span class="line">47 ENSG00000008988 45747.5469       1.061020 0.0931570  11.389586</span><br><span class="line">49 ENSG00000009765   462.9210      -4.288686 0.2380812 -18.013543</span><br><span class="line">54 ENSG00000010319  2118.5841      -1.634110 0.1484228 -11.009836</span><br><span class="line">         pvalue         padj hgnc_symbol        survP surv</span><br><span class="line">3  6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05    0</span><br><span class="line">20 2.523085e-23 1.004634e-22      THSD7A 2.232279e-04    0</span><br><span class="line">36 3.127375e-20 1.092412e-19       SCN4A 3.566491e-05    0</span><br><span class="line">47 4.712258e-30 2.505970e-29       RPS20 1.083688e-04    1</span><br><span class="line">49 1.525459e-72 3.707111e-71         IYD 2.896293e-04    0</span><br><span class="line">54 3.426265e-28 1.691118e-27      SEMA3G 4.535900e-08    0</span><br></pre></td></tr></table></figure><p>最终筛选出来的这922个基因，符合FoldChange &gt; 2 &amp;&amp; pvalue &lt; 0.001 &amp;&amp; survP &lt; 0.001，下面，我们给这些基因分个组，</p><p>1）HG，在肿瘤中表达上调，且高表达生存预期好；log2FoldChange &gt; 1 &amp;&amp; surv = 0<br>2）HB，在肿瘤中表达上调，且高表达生存预期坏，暂且认为是原癌基因；log2FoldChange &gt; 1 &amp;&amp; surv = 1<br>3）LG，在肿瘤中表达下调，且高表达生存预期好，暂且认为是抑癌基因；log2FoldChange &lt; -1 &amp;&amp; surv = 0<br>4）LB，在肿瘤中表达下调，且高表达生存预期坏；log2FoldChange &lt; -1 &amp;&amp; surv = 1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; result_survP_HG &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &gt; 1 &amp; result_survP<span class="variable">$surv</span> == 0,]</span><br><span class="line">&gt; result_survP_HB &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &gt; 1 &amp; result_survP<span class="variable">$surv</span> == 1,]</span><br><span class="line">&gt; result_survP_LG &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &lt; -1 &amp; result_survP<span class="variable">$surv</span> == 0,]</span><br><span class="line">&gt; result_survP_LB &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &lt; -1 &amp; result_survP<span class="variable">$surv</span> == 1,]</span><br><span class="line"></span><br><span class="line">&gt; dim(result_survP_HG)</span><br><span class="line">[1] 141  10</span><br><span class="line">&gt; dim(result_survP_HB)</span><br><span class="line">[1] 416  10</span><br><span class="line">&gt; dim(result_survP_LG)</span><br><span class="line">[1] 314  10</span><br><span class="line">&gt; dim(result_survP_LB)</span><br><span class="line">[1] 51 10</span><br></pre></td></tr></table></figure><p>看一下这四个集合的基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line">&gt; result_survP_HG<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"SCN4A"</span>       <span class="string">"NRXN3"</span>       <span class="string">"TLL1"</span>        <span class="string">"ATP11A"</span>     </span><br><span class="line">  [5] <span class="string">"VASH1"</span>       <span class="string">"ADCY2"</span>       <span class="string">"SCGN"</span>        <span class="string">"NRP1"</span>       </span><br><span class="line">  [9] <span class="string">"SLC5A1"</span>      <span class="string">"BMX"</span>         <span class="string">"FLT1"</span>        <span class="string">"RGCC"</span>       </span><br><span class="line"> [13] <span class="string">"GRB10"</span>       <span class="string">"PRUNE2"</span>      <span class="string">"DOCK8"</span>       <span class="string">"LIPA"</span>       </span><br><span class="line"> [17] <span class="string">"VWF"</span>         <span class="string">"SLC17A2"</span>     <span class="string">"HAVCR1"</span>      <span class="string">"HHLA2"</span>      </span><br><span class="line"> [21] <span class="string">"SLC1A4"</span>      <span class="string">"PCDH17"</span>      <span class="string">"TEX11"</span>       <span class="string">"IQSEC3"</span>     </span><br><span class="line"> [25] <span class="string">"TMEM131L"</span>    <span class="string">"PREX1"</span>       <span class="string">"COL21A1"</span>     <span class="string">"CD93"</span>       </span><br><span class="line"> [29] <span class="string">"MCF2L"</span>       <span class="string">"MASP1"</span>       <span class="string">"F2RL3"</span>       <span class="string">"FBXL16"</span>     </span><br><span class="line"> [33] <span class="string">"KDR"</span>         <span class="string">"ACLY"</span>        <span class="string">"PER2"</span>        <span class="string">"ETS1"</span>       </span><br><span class="line"> [37] <span class="string">"DYSF"</span>        <span class="string">"TM6SF1"</span>      <span class="string">"HECW2"</span>       <span class="string">"CLEC18B"</span>    </span><br><span class="line"> [41] <span class="string">"CDH13"</span>       <span class="string">"RGS5"</span>        <span class="string">"HMCN1"</span>       <span class="string">"RIT1"</span>       </span><br><span class="line"> [45] <span class="string">"MALL"</span>        <span class="string">"MARCHF4"</span>     <span class="string">"SLC10A6"</span>     <span class="string">"ARHGAP26"</span>   </span><br><span class="line"> [49] <span class="string">"GFOD1"</span>       <span class="string">"SLC17A4"</span>     <span class="string">"DIAPH2"</span>      <span class="string">"PLIN2"</span>      </span><br><span class="line"> [53] <span class="string">"CDKN2B"</span>      <span class="string">"ANO4"</span>        <span class="string">"PDK1"</span>        <span class="string">"PTPRR"</span>      </span><br><span class="line"> [57] <span class="string">"LURAP1L"</span>     <span class="string">"ENPP3"</span>       <span class="string">"PIEZO2"</span>      <span class="string">"SLC28A1"</span>    </span><br><span class="line"> [61] <span class="string">"FZD1"</span>        <span class="string">"TSPAN18"</span>     <span class="string">"GALNT14"</span>     <span class="string">"ABCG1"</span>      </span><br><span class="line"> [65] <span class="string">"ADGRL4"</span>      <span class="string">"SPATA18"</span>     <span class="string">"TGFA"</span>        <span class="string">"SPRY1"</span>      </span><br><span class="line"> [69] <span class="string">"TLR3"</span>        <span class="string">"TMEM200A"</span>    <span class="string">"SLC18A2"</span>     <span class="string">"BTNL9"</span>      </span><br><span class="line"> [73] <span class="string">"ARHGAP42"</span>    <span class="string">"GALR1"</span>       <span class="string">"KCNAB1"</span>      <span class="string">"DPY19L2P2"</span>  </span><br><span class="line"> [77] <span class="string">"PDGFD"</span>       <span class="string">"INSR"</span>        <span class="string">"CYSLTR1"</span>     <span class="string">"ARL10"</span>      </span><br><span class="line"> [81] <span class="string">"BNIP3"</span>       <span class="string">"CLEC14A"</span>     <span class="string">""</span>            <span class="string">"SCN4B"</span>      </span><br><span class="line"> [85] <span class="string">"RIMKLA"</span>      <span class="string">"DNAJC22"</span>     <span class="string">"APOLD1"</span>      <span class="string">"EXOC3L1"</span>    </span><br><span class="line"> [89] <span class="string">"CDH4"</span>        <span class="string">"CDH5"</span>        <span class="string">"NLRP11"</span>      <span class="string">"P2RY8"</span>      </span><br><span class="line"> [93] <span class="string">""</span>            <span class="string">"F8"</span>          <span class="string">"QRFPR"</span>       <span class="string">"ZNF395"</span>     </span><br><span class="line"> [97] <span class="string">"C3orf70"</span>     <span class="string">"SPRY4"</span>       <span class="string">"PEAK3"</span>       <span class="string">"LRRK2"</span>      </span><br><span class="line">[101] <span class="string">"CTSE"</span>        <span class="string">"GIMAP5"</span>      <span class="string">"SLC22A4"</span>     <span class="string">"BNIP3P1"</span>    </span><br><span class="line">[105] <span class="string">"AVPR1B"</span>      <span class="string">"TRIM15"</span>      <span class="string">"INSYN2B"</span>     <span class="string">"C17orf107"</span>  </span><br><span class="line">[109] <span class="string">""</span>            <span class="string">""</span>            <span class="string">"LDHAP4"</span>      <span class="string">"ZNF812P"</span>    </span><br><span class="line">[113] <span class="string">"NPY6R"</span>       <span class="string">"LINC01738"</span>   <span class="string">"UBTFL6"</span>      <span class="string">"PRKAR1B-AS2"</span></span><br><span class="line">[117] <span class="string">""</span>            <span class="string">"HS1BP3-IT1"</span>  <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[121] <span class="string">"LDHAP3"</span>      <span class="string">"GGT8P"</span>       <span class="string">"LILRA4"</span>      <span class="string">"ACAD11"</span>     </span><br><span class="line">[125] <span class="string">"VWFP1"</span>       <span class="string">""</span>            <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[129] <span class="string">""</span>            <span class="string">"LINC01843"</span>   <span class="string">"SHANK3"</span>      <span class="string">"PTP4A2P2"</span>   </span><br><span class="line">[133] <span class="string">"PABPC4L"</span>     <span class="string">"LINC02747"</span>   <span class="string">"SLC5A8"</span>      <span class="string">""</span>           </span><br><span class="line">[137] <span class="string">""</span>            <span class="string">"PECAM1"</span>      <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[141] <span class="string">""</span>           </span><br><span class="line">&gt; result_survP_HB<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"RPS20"</span>        <span class="string">"PLAUR"</span>        <span class="string">"DDX11"</span>        <span class="string">"TACC3"</span>       </span><br><span class="line">  [5] <span class="string">"SLC38A5"</span>      <span class="string">"SLC11A1"</span>      <span class="string">"DEF6"</span>         <span class="string">"TYMP"</span>        </span><br><span class="line">  [9] <span class="string">"RNASET2"</span>      <span class="string">"SH2D2A"</span>       <span class="string">"POU2F2"</span>       <span class="string">"RTN4R"</span>       </span><br><span class="line"> [13] <span class="string">"FOXP3"</span>        <span class="string">"CYBA"</span>         <span class="string">"YBX3"</span>         <span class="string">"COL11A1"</span>     </span><br><span class="line"> [17] <span class="string">"VMP1"</span>         <span class="string">"CHI3L2"</span>       <span class="string">"CACNB1"</span>       <span class="string">"CLEC2D"</span>      </span><br><span class="line"> [21] <span class="string">"TRIP13"</span>       <span class="string">"GSDMB"</span>        <span class="string">"PPP2R2C"</span>      <span class="string">"GTSE1"</span>       </span><br><span class="line"> [25] <span class="string">"ACTN2"</span>        <span class="string">"NDC80"</span>        <span class="string">"CXCL2"</span>        <span class="string">"RAD54L"</span>      </span><br><span class="line"> [29] <span class="string">"PPEF1"</span>        <span class="string">"ACHE"</span>         <span class="string">"TPX2"</span>         <span class="string">"BIRC5"</span>       </span><br><span class="line"> [33] <span class="string">"LAG3"</span>         <span class="string">"DTX2"</span>         <span class="string">"TF"</span>           <span class="string">"ORC6"</span>        </span><br><span class="line"> [37] <span class="string">"RGS17"</span>        <span class="string">"UNC13D"</span>       <span class="string">"HSD3B7"</span>       <span class="string">"DERL3"</span>       </span><br><span class="line"> [41] <span class="string">"OSM"</span>          <span class="string">"LGALS1"</span>       <span class="string">"CENPM"</span>        <span class="string">"HDAC10"</span>      </span><br><span class="line"> [45] <span class="string">"POLE2"</span>        <span class="string">"CDKN3"</span>        <span class="string">"MMP9"</span>         <span class="string">"MYBL2"</span>       </span><br><span class="line"> [49] <span class="string">"PABPC1L"</span>      <span class="string">"SLC17A9"</span>      <span class="string">"PTK6"</span>         <span class="string">"TRIB3"</span>       </span><br><span class="line"> [53] <span class="string">"PIM2"</span>         <span class="string">"TAZ"</span>          <span class="string">"TIMP1"</span>        <span class="string">"RRN3P2"</span>      </span><br><span class="line"> [57] <span class="string">"PYCARD"</span>       <span class="string">"AQP9"</span>         <span class="string">"IGDCC4"</span>       <span class="string">"PDGFRL"</span>      </span><br><span class="line"> [61] <span class="string">"KCNN4"</span>        <span class="string">"GRIN2D"</span>       <span class="string">"JAK3"</span>         <span class="string">"HAMP"</span>        </span><br><span class="line"> [65] <span class="string">"PBX4"</span>         <span class="string">"HOXA13"</span>       <span class="string">"NSUN5P2"</span>      <span class="string">"TFR2"</span>        </span><br><span class="line"> [69] <span class="string">"RAPGEFL1"</span>     <span class="string">"KAT2A"</span>        <span class="string">"CNTNAP1"</span>      <span class="string">"DLX4"</span>        </span><br><span class="line"> [73] <span class="string">"NEIL3"</span>        <span class="string">"HPX"</span>          <span class="string">"MDK"</span>          <span class="string">"TCIRG1"</span>      </span><br><span class="line"> [77] <span class="string">"CDCA3"</span>        <span class="string">"KIF20A"</span>       <span class="string">"STEAP3"</span>       <span class="string">"CENPA"</span>       </span><br><span class="line"> [81] <span class="string">"TPSG1"</span>        <span class="string">"KIAA1324"</span>     <span class="string">"OPRD1"</span>        <span class="string">"CDC20"</span>       </span><br><span class="line"> [85] <span class="string">"NEK2"</span>         <span class="string">"CCDC18"</span>       <span class="string">"DDX39A"</span>       <span class="string">"CENPK"</span>       </span><br><span class="line"> [89] <span class="string">"HJURP"</span>        <span class="string">"BATF3"</span>        <span class="string">"WFDC3"</span>        <span class="string">"TNFSF14"</span>     </span><br><span class="line"> [93] <span class="string">"RBCK1"</span>        <span class="string">"IGFLR1"</span>       <span class="string">"HCST"</span>         <span class="string">"IDUA"</span>        </span><br><span class="line"> [97] <span class="string">"PKMYT1"</span>       <span class="string">"CHTF18"</span>       <span class="string">"LRFN1"</span>        <span class="string">"CPA4"</span>        </span><br><span class="line">[101] <span class="string">"ATP8B3"</span>       <span class="string">"FCHO1"</span>        <span class="string">"C1QL1"</span>        <span class="string">"THOC6"</span>       </span><br><span class="line">[105] <span class="string">"PODNL1"</span>       <span class="string">"SERPINF1"</span>     <span class="string">"C1QTNF6"</span>      <span class="string">"FKBP11"</span>      </span><br><span class="line">[109] <span class="string">"IL15RA"</span>       <span class="string">"SPOCD1"</span>       <span class="string">"CDCA8"</span>        <span class="string">"SLC43A3"</span>     </span><br><span class="line">[113] <span class="string">"OASL"</span>         <span class="string">"TROAP"</span>        <span class="string">"SLC9A5"</span>       <span class="string">"CCM2"</span>        </span><br><span class="line">[117] <span class="string">"LIMD2"</span>        <span class="string">"CD72"</span>         <span class="string">"SLCO5A1"</span>      <span class="string">"ITPKA"</span>       </span><br><span class="line">[121] <span class="string">"CEP55"</span>        <span class="string">"ZNF365"</span>       <span class="string">"ADAMTS14"</span>     <span class="string">"INHBE"</span>       </span><br><span class="line">[125] <span class="string">"GPR84"</span>        <span class="string">"MAP3K12"</span>      <span class="string">"BCL2A1"</span>       <span class="string">"PIF1"</span>        </span><br><span class="line">[129] <span class="string">"TICRR"</span>        <span class="string">"PRELID3A"</span>     <span class="string">"ASGR1"</span>        <span class="string">"CARD14"</span>      </span><br><span class="line">[133] <span class="string">"FKBP10"</span>       <span class="string">"EMP3"</span>         <span class="string">"SH3BGRL3"</span>     <span class="string">"KIF2C"</span>       </span><br><span class="line">[137] <span class="string">"NUF2"</span>         <span class="string">"TMEM44"</span>       <span class="string">"DOK3"</span>         <span class="string">"NFKBIE"</span>      </span><br><span class="line">[141] <span class="string">"MTFR2"</span>        <span class="string">"SLC25A37"</span>     <span class="string">"PRSS53"</span>       <span class="string">"ADAM8"</span>       </span><br><span class="line">[145] <span class="string">"CCDC74B"</span>      <span class="string">"SPC25"</span>        <span class="string">"TRIM36"</span>       <span class="string">"SKA1"</span>        </span><br><span class="line">[149] <span class="string">"GOLGA7B"</span>      <span class="string">"BATF"</span>         <span class="string">"BUB1B"</span>        <span class="string">"ZFHX2-AS1"</span>   </span><br><span class="line">[153] <span class="string">"CDC25C"</span>       <span class="string">"DUSP23"</span>       <span class="string">"NBL1"</span>         <span class="string">"RUNX1"</span>       </span><br><span class="line">[157] <span class="string">"C1R"</span>          <span class="string">"PPP1R35"</span>      <span class="string">"HK3"</span>          <span class="string">"SYCE2"</span>       </span><br><span class="line">[161] <span class="string">"SPC24"</span>        <span class="string">"CCDC78"</span>       <span class="string">"TEDC2"</span>        <span class="string">"LBHD1"</span>       </span><br><span class="line">[165] <span class="string">"CCDC74A"</span>      <span class="string">"DCST2"</span>        <span class="string">"TRIM46"</span>       <span class="string">"RPL22L1"</span>     </span><br><span class="line">[169] <span class="string">"CXCL1"</span>        <span class="string">"UCN"</span>          <span class="string">"SPDYA"</span>        <span class="string">"PTTG1"</span>       </span><br><span class="line">[173] <span class="string">"AGBL2"</span>        <span class="string">"PLEKHF1"</span>      <span class="string">"MSS51"</span>        <span class="string">"PKD1L2"</span>      </span><br><span class="line">[177] <span class="string">"FAM86GP"</span>      <span class="string">"CATSPER2"</span>     <span class="string">"PCLAF"</span>        <span class="string">"PLK1"</span>        </span><br><span class="line">[181] <span class="string">"MEI1"</span>         <span class="string">"PRRX2"</span>        <span class="string">"ENGASE"</span>       <span class="string">"TEPSIN"</span>      </span><br><span class="line">[185] <span class="string">"VKORC1"</span>       <span class="string">"JSRP1"</span>        <span class="string">"CORO6"</span>        <span class="string">"TTYH1"</span>       </span><br><span class="line">[189] <span class="string">"TRPV3"</span>        <span class="string">"CCDC88B"</span>      <span class="string">"REEP4"</span>        <span class="string">"THBS3"</span>       </span><br><span class="line">[193] <span class="string">"NPIPB3"</span>       <span class="string">"RNASE2"</span>       <span class="string">"BUB1"</span>         <span class="string">"CHRNA5"</span>      </span><br><span class="line">[197] <span class="string">"MZB1"</span>         <span class="string">"OSCAR"</span>        <span class="string">"ZNF692"</span>       <span class="string">"RRM2"</span>        </span><br><span class="line">[201] <span class="string">"LRRC15"</span>       <span class="string">"CEBPB"</span>        <span class="string">"MZT2A"</span>        <span class="string">"SAA1"</span>        </span><br><span class="line">[205] <span class="string">"NABP1"</span>        <span class="string">"CD7"</span>          <span class="string">"C1QTNF1"</span>      <span class="string">"IL20RB"</span>      </span><br><span class="line">[209] <span class="string">"RIN1"</span>         <span class="string">"CNIH2"</span>        <span class="string">"UBE2C"</span>        <span class="string">"GOLGA8A"</span>     </span><br><span class="line">[213] <span class="string">"CATSPER1"</span>     <span class="string">"B3GNTL1"</span>      <span class="string">"SPHK1"</span>        <span class="string">"CLK2"</span>        </span><br><span class="line">[217] <span class="string">"C8G"</span>          <span class="string">"LRRN4CL"</span>      <span class="string">"CPNE7"</span>        <span class="string">"MSC"</span>         </span><br><span class="line">[221] <span class="string">"RFLNA"</span>        <span class="string">"AURKB"</span>        <span class="string">"LBX2"</span>         <span class="string">"DNHD1"</span>       </span><br><span class="line">[225] <span class="string">"TMEM86B"</span>      <span class="string">"MAP6D1"</span>       <span class="string">"ARL6IP4"</span>      <span class="string">"B4GALNT4"</span>    </span><br><span class="line">[229] <span class="string">"KCNJ14"</span>       <span class="string">"FBXL6"</span>        <span class="string">"C1S"</span>          <span class="string">"CCNYL2"</span>      </span><br><span class="line">[233] <span class="string">"PYCR1"</span>        <span class="string">"GPR19"</span>        <span class="string">"NPIPA1"</span>       <span class="string">"BMP8A"</span>       </span><br><span class="line">[237] <span class="string">"CHEK2"</span>        <span class="string">"IQGAP3"</span>       <span class="string">"DUSP5P1"</span>      <span class="string">"STAC3"</span>       </span><br><span class="line">[241] <span class="string">"IRF7"</span>         <span class="string">"PRAME"</span>        <span class="string">"KIF18B"</span>       <span class="string">"TNFRSF18"</span>    </span><br><span class="line">[245] <span class="string">"PLEKHN1"</span>      <span class="string">"ISG15"</span>        <span class="string">"FANCA"</span>        <span class="string">"EIF4EBP1"</span>    </span><br><span class="line">[249] <span class="string">"TPRG1"</span>        <span class="string">"RUFY4"</span>        <span class="string">"ZP3"</span>          <span class="string">"NPIPP1"</span>      </span><br><span class="line">[253] <span class="string">"SLC4A5"</span>       <span class="string">"FAM78B"</span>       <span class="string">"SNHG17"</span>       <span class="string">"PDLIM7"</span>      </span><br><span class="line">[257] <span class="string">"ADAM32"</span>       <span class="string">"RAD54B"</span>       <span class="string">"ELOVL2"</span>       <span class="string">"GOLGA6L9"</span>    </span><br><span class="line">[261] <span class="string">"FCGR1B"</span>       <span class="string">"MMP17"</span>        <span class="string">"RYR2"</span>         <span class="string">"PLXNB3"</span>      </span><br><span class="line">[265] <span class="string">""</span>             <span class="string">"AGAP6"</span>        <span class="string">"LILRB3"</span>       <span class="string">"GABBR1"</span>      </span><br><span class="line">[269] <span class="string">"SYCE1L"</span>       <span class="string">"MUC12"</span>        <span class="string">"DUXAP8"</span>       <span class="string">"IGKC"</span>        </span><br><span class="line">[273] <span class="string">"IGLV1-47"</span>     <span class="string">"IGLV1-44"</span>     <span class="string">"IGLV3-19"</span>     <span class="string">"IGLC2"</span>       </span><br><span class="line">[277] <span class="string">"IGLC3"</span>        <span class="string">"IGHG4"</span>        <span class="string">"IGHG2"</span>        <span class="string">"IGHA1"</span>       </span><br><span class="line">[281] <span class="string">"IGHG1"</span>        <span class="string">"IGHG3"</span>        <span class="string">"CRYGS"</span>        <span class="string">"ASIC3"</span>       </span><br><span class="line">[285] <span class="string">"MXD3"</span>         <span class="string">"RPLP1P6"</span>      <span class="string">"LAT"</span>          <span class="string">"RPL17P50"</span>    </span><br><span class="line">[289] <span class="string">"PPM1N"</span>        <span class="string">"LTB4R"</span>        <span class="string">"NPEPL1"</span>       <span class="string">"IFI30"</span>       </span><br><span class="line">[293] <span class="string">"PRELID1P1"</span>    <span class="string">"PAM16"</span>        <span class="string">""</span>             <span class="string">"ZGLP1"</span>       </span><br><span class="line">[297] <span class="string">"FADS3"</span>        <span class="string">"CYTOR"</span>        <span class="string">"TSSC2"</span>        <span class="string">""</span>            </span><br><span class="line">[301] <span class="string">"C5orf66"</span>      <span class="string">"ZMIZ1-AS1"</span>    <span class="string">"MIAT"</span>         <span class="string">"LINC00115"</span>   </span><br><span class="line">[305] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"SLC16A1-AS1"</span>  <span class="string">"LINC00511"</span>   </span><br><span class="line">[309] <span class="string">"LTB"</span>          <span class="string">""</span>             <span class="string">"MELTF-AS1"</span>    <span class="string">"DPY19L1P1"</span>   </span><br><span class="line">[313] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"CYP21A2"</span>      <span class="string">"SNHG15"</span>      </span><br><span class="line">[317] <span class="string">"LINC02609"</span>    <span class="string">"YEATS2-AS1"</span>   <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[321] <span class="string">"LINC01871"</span>    <span class="string">"KDM4A-AS1"</span>    <span class="string">"MAP3K2-DT"</span>    <span class="string">"PRKAR1B-AS1"</span> </span><br><span class="line">[325] <span class="string">"FOXD2-AS1"</span>    <span class="string">"PCDHGC5"</span>      <span class="string">"CFB"</span>          <span class="string">"NPIPB5"</span>      </span><br><span class="line">[329] <span class="string">"APOBEC3D"</span>     <span class="string">""</span>             <span class="string">"IGKV3-15"</span>     <span class="string">""</span>            </span><br><span class="line">[333] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"LINC00926"</span>    <span class="string">"TNXA"</span>        </span><br><span class="line">[337] <span class="string">"LUCAT1"</span>       <span class="string">""</span>             <span class="string">"SRD5A3-AS1"</span>   <span class="string">"PVT1"</span>        </span><br><span class="line">[341] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"IGHGP"</span>        <span class="string">""</span>            </span><br><span class="line">[345] <span class="string">"IGLL5"</span>        <span class="string">"AGAP2-AS1"</span>    <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[349] <span class="string">"KLRA1P"</span>       <span class="string">"PPP1R14B-AS1"</span> <span class="string">"HP"</span>           <span class="string">""</span>            </span><br><span class="line">[353] <span class="string">"IFITM3P6"</span>     <span class="string">"LINC02328"</span>    <span class="string">"MC1R"</span>         <span class="string">"ZHX1-C8orf76"</span></span><br><span class="line">[357] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"LINC01355"</span>    <span class="string">"VPS9D1-AS1"</span>  </span><br><span class="line">[361] <span class="string">""</span>             <span class="string">"SMG1P7"</span>       <span class="string">"H2BC20P"</span>      <span class="string">""</span>            </span><br><span class="line">[365] <span class="string">"CORO7"</span>        <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[369] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[373] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[377] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[381] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[385] <span class="string">"GTF2IP20"</span>     <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[389] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[393] <span class="string">""</span>             <span class="string">"EPOP"</span>         <span class="string">""</span>             <span class="string">"NOL12"</span>       </span><br><span class="line">[397] <span class="string">"LINC01138"</span>    <span class="string">""</span>             <span class="string">"TBC1D3L"</span>      <span class="string">""</span>            </span><br><span class="line">[401] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[405] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[409] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[413] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">"HELLPAR"</span>     </span><br><span class="line">&gt; result_survP_LG<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"CYP51A1"</span>    <span class="string">"THSD7A"</span>     <span class="string">"IYD"</span>        <span class="string">"SEMA3G"</span>     <span class="string">"CHDH"</span>      </span><br><span class="line">  [6] <span class="string">"SLC7A9"</span>     <span class="string">"NDUFS1"</span>     <span class="string">"USP2"</span>       <span class="string">"VPS13D"</span>     <span class="string">"KITLG"</span>     </span><br><span class="line"> [11] <span class="string">"NEDD4L"</span>     <span class="string">"FSTL4"</span>      <span class="string">"AP5M1"</span>      <span class="string">"SYNE2"</span>      <span class="string">"CYFIP2"</span>    </span><br><span class="line"> [16] <span class="string">"ZMYND12"</span>    <span class="string">"MPPED2"</span>     <span class="string">"FECH"</span>       <span class="string">"PTPN3"</span>      <span class="string">"RPS6KA6"</span>   </span><br><span class="line"> [21] <span class="string">"LNX1"</span>       <span class="string">"MPP5"</span>       <span class="string">"EVC"</span>        <span class="string">"FRY"</span>        <span class="string">"NTN4"</span>      </span><br><span class="line"> [26] <span class="string">"ACAT1"</span>      <span class="string">"FMO4"</span>       <span class="string">"NEBL"</span>       <span class="string">"CEACAM1"</span>    <span class="string">"FDFT1"</span>     </span><br><span class="line"> [31] <span class="string">"OPHN1"</span>      <span class="string">"MAGI3"</span>      <span class="string">"COL4A4"</span>     <span class="string">"CADPS2"</span>     <span class="string">"COBLL1"</span>    </span><br><span class="line"> [36] <span class="string">"TRPM3"</span>      <span class="string">"ABCB1"</span>      <span class="string">"L2HGDH"</span>     <span class="string">"PTPN4"</span>      <span class="string">"JPH4"</span>      </span><br><span class="line"> [41] <span class="string">"XYLB"</span>       <span class="string">"SMIM24"</span>     <span class="string">"ERMP1"</span>      <span class="string">"MIOX"</span>       <span class="string">"CDKL1"</span>     </span><br><span class="line"> [46] <span class="string">"DCAF11"</span>     <span class="string">"MCF2"</span>       <span class="string">"CAB39L"</span>     <span class="string">"VWA8"</span>       <span class="string">"TOX3"</span>      </span><br><span class="line"> [51] <span class="string">"CA2"</span>        <span class="string">"SH2D4A"</span>     <span class="string">"DHDH"</span>       <span class="string">"COBL"</span>       <span class="string">"TMEM245"</span>   </span><br><span class="line"> [56] <span class="string">"BAG1"</span>       <span class="string">"CPEB3"</span>      <span class="string">"PBLD"</span>       <span class="string">"TBC1D9"</span>     <span class="string">"TRIM2"</span>     </span><br><span class="line"> [61] <span class="string">"PPARGC1A"</span>   <span class="string">"AKAP3"</span>      <span class="string">"FRK"</span>        <span class="string">"NCOA7"</span>      <span class="string">"EPM2A"</span>     </span><br><span class="line"> [66] <span class="string">"SEMA5A"</span>     <span class="string">"NNT"</span>        <span class="string">"AGXT2"</span>      <span class="string">"CPEB4"</span>      <span class="string">"HYAL1"</span>     </span><br><span class="line"> [71] <span class="string">"ATP6V1A"</span>    <span class="string">"EPB41L5"</span>    <span class="string">"TACR1"</span>      <span class="string">"PLCL1"</span>      <span class="string">"PARD3B"</span>    </span><br><span class="line"> [76] <span class="string">"WLS"</span>        <span class="string">"AGMAT"</span>      <span class="string">"HAO2"</span>       <span class="string">"ACADM"</span>      <span class="string">"ABCD3"</span>     </span><br><span class="line"> [81] <span class="string">"IRF6"</span>       <span class="string">"TREH"</span>       <span class="string">"ECRG4"</span>      <span class="string">"BSPRY"</span>      <span class="string">"ALDH6A1"</span>   </span><br><span class="line"> [86] <span class="string">"GOT1"</span>       <span class="string">"TEK"</span>        <span class="string">"EPHX2"</span>      <span class="string">"PDZRN3"</span>     <span class="string">"CAT"</span>       </span><br><span class="line"> [91] <span class="string">"PLG"</span>        <span class="string">"PCK1"</span>       <span class="string">"SCGB1D2"</span>    <span class="string">"FLRT3"</span>      <span class="string">"PLEKHG3"</span>   </span><br><span class="line"> [96] <span class="string">"PODXL"</span>      <span class="string">"HOXD1"</span>      <span class="string">"HOXD3"</span>      <span class="string">"SYNE1"</span>      <span class="string">"SLC34A1"</span>   </span><br><span class="line">[101] <span class="string">"NAPSA"</span>      <span class="string">"G6PC"</span>       <span class="string">"FMO5"</span>       <span class="string">"ZNF132"</span>     <span class="string">"DDC"</span>       </span><br><span class="line">[106] <span class="string">"ENAM"</span>       <span class="string">"ANGPTL3"</span>    <span class="string">"MYH10"</span>      <span class="string">"KL"</span>         <span class="string">"BEX2"</span>      </span><br><span class="line">[111] <span class="string">"GSTM3"</span>      <span class="string">"VAV3"</span>       <span class="string">"HMGCS2"</span>     <span class="string">"MYCN"</span>       <span class="string">"CLDN10"</span>    </span><br><span class="line">[116] <span class="string">"FBXO21"</span>     <span class="string">"EDAR"</span>       <span class="string">"TBC1D4"</span>     <span class="string">"SUCLA2"</span>     <span class="string">"LMO7"</span>      </span><br><span class="line">[121] <span class="string">"ALDOB"</span>      <span class="string">"BPHL"</span>       <span class="string">"SORL1"</span>      <span class="string">"PAQR5"</span>      <span class="string">"SEMA6D"</span>    </span><br><span class="line">[126] <span class="string">"DBT"</span>        <span class="string">"ARHGAP24"</span>   <span class="string">"GPAT3"</span>      <span class="string">"FRAS1"</span>      <span class="string">"CDKL2"</span>     </span><br><span class="line">[131] <span class="string">"SHROOM3"</span>    <span class="string">"HADH"</span>       <span class="string">"PELI2"</span>      <span class="string">"SLC27A2"</span>    <span class="string">"SLC14A1"</span>   </span><br><span class="line">[136] <span class="string">"ERBB2"</span>      <span class="string">"CGN"</span>        <span class="string">"GDF7"</span>       <span class="string">"CTDSPL"</span>     <span class="string">"ALDH1L1"</span>   </span><br><span class="line">[141] <span class="string">"SCD5"</span>       <span class="string">"USP53"</span>      <span class="string">"UGT3A1"</span>     <span class="string">"BHMT"</span>       <span class="string">"IQGAP2"</span>    </span><br><span class="line">[146] <span class="string">"CRHBP"</span>      <span class="string">"SLC25A48"</span>   <span class="string">"MMUT"</span>       <span class="string">"CYP39A1"</span>    <span class="string">"MFHAS1"</span>    </span><br><span class="line">[151] <span class="string">"AK3"</span>        <span class="string">"AUH"</span>        <span class="string">"ALAD"</span>       <span class="string">"SLC25A25"</span>   <span class="string">"CNNM2"</span>     </span><br><span class="line">[156] <span class="string">"SLC5A12"</span>    <span class="string">"GLYAT"</span>      <span class="string">"SLC22A8"</span>    <span class="string">"TMEM25"</span>     <span class="string">"MPP7"</span>      </span><br><span class="line">[161] <span class="string">"DLG2"</span>       <span class="string">"FREM2"</span>      <span class="string">"THRB"</span>       <span class="string">"ANK3"</span>       <span class="string">"NR3C2"</span>     </span><br><span class="line">[166] <span class="string">"ASAP2"</span>      <span class="string">"SLC25A4"</span>    <span class="string">"GPD1L"</span>      <span class="string">"SLC16A12"</span>   <span class="string">"PANK1"</span>     </span><br><span class="line">[171] <span class="string">"MARVELD2"</span>   <span class="string">"FRMD1"</span>      <span class="string">"KCNJ16"</span>     <span class="string">"PGM5"</span>       <span class="string">"SFXN2"</span>     </span><br><span class="line">[176] <span class="string">"FUT6"</span>       <span class="string">"DHRS4"</span>      <span class="string">"KCNJ15"</span>     <span class="string">"PAFAH2"</span>     <span class="string">"WNT9B"</span>     </span><br><span class="line">[181] <span class="string">"CPAMD8"</span>     <span class="string">"PTH1R"</span>      <span class="string">"MYL3"</span>       <span class="string">"CYP3A7"</span>     <span class="string">"NAPEPLD"</span>   </span><br><span class="line">[186] <span class="string">"TMEM82"</span>     <span class="string">"AKR7A3"</span>     <span class="string">"CDS1"</span>       <span class="string">"PTPN13"</span>     <span class="string">"DNASE1L3"</span>  </span><br><span class="line">[191] <span class="string">"RBM47"</span>      <span class="string">"EMCN"</span>       <span class="string">"HPGD"</span>       <span class="string">"ADGRV1"</span>     <span class="string">"TMEM174"</span>   </span><br><span class="line">[196] <span class="string">"RAET1E"</span>     <span class="string">"FREM1"</span>      <span class="string">"MYORG"</span>      <span class="string">"FBP1"</span>       <span class="string">"SLC16A9"</span>   </span><br><span class="line">[201] <span class="string">"CRYL1"</span>      <span class="string">"EML5"</span>       <span class="string">"NDRG2"</span>      <span class="string">"CCDC186"</span>    <span class="string">"OTOGL"</span>     </span><br><span class="line">[206] <span class="string">"CLMN"</span>       <span class="string">"WDR72"</span>      <span class="string">"CDH16"</span>      <span class="string">"LDHD"</span>       <span class="string">"GLYATL1"</span>   </span><br><span class="line">[211] <span class="string">"MTMR10"</span>     <span class="string">"CA4"</span>        <span class="string">"ACOX2"</span>      <span class="string">"GJB1"</span>       <span class="string">"PKHD1"</span>     </span><br><span class="line">[216] <span class="string">"FUT3"</span>       <span class="string">"UGT2B7"</span>     <span class="string">"CLCN5"</span>      <span class="string">"GPHN"</span>       <span class="string">"GATM"</span>      </span><br><span class="line">[221] <span class="string">"TLN2"</span>       <span class="string">"SUCLG2"</span>     <span class="string">"SLC22A13"</span>   <span class="string">"NUDT4"</span>      <span class="string">"JUP"</span>       </span><br><span class="line">[226] <span class="string">"SLC25A30"</span>   <span class="string">"ZHX3"</span>       <span class="string">"SLC6A19"</span>    <span class="string">"MFSD4A"</span>     <span class="string">"PCCA"</span>      </span><br><span class="line">[231] <span class="string">"TOM1L2"</span>     <span class="string">"KDF1"</span>       <span class="string">"MSRA"</span>       <span class="string">"HSD11B2"</span>    <span class="string">"GNG7"</span>      </span><br><span class="line">[236] <span class="string">"RNF152"</span>     <span class="string">"GCNT4"</span>      <span class="string">"SHMT1"</span>      <span class="string">"GRAMD1C"</span>    <span class="string">""</span>          </span><br><span class="line">[241] <span class="string">"KLHDC7A"</span>    <span class="string">"TCAIM"</span>      <span class="string">"MTURN"</span>      <span class="string">"WDFY3-AS2"</span>  <span class="string">"PAQR7"</span>     </span><br><span class="line">[246] <span class="string">"C11orf54"</span>   <span class="string">"SLC8A1"</span>     <span class="string">"ZNRF3"</span>      <span class="string">"LRRC55"</span>     <span class="string">"ST6GALNAC3"</span></span><br><span class="line">[251] <span class="string">"PRKD1"</span>      <span class="string">"CCSER1"</span>     <span class="string">"LRRC19"</span>     <span class="string">"ROBO2"</span>      <span class="string">"HS6ST3"</span>    </span><br><span class="line">[256] <span class="string">"PBX1"</span>       <span class="string">"SYN3"</span>       <span class="string">"SOWAHB"</span>     <span class="string">"PPARA"</span>      <span class="string">"AKR1C1"</span>    </span><br><span class="line">[261] <span class="string">"TSPYL4"</span>     <span class="string">"TCL6"</span>       <span class="string">"MEIS3P2"</span>    <span class="string">"SHISA6"</span>     <span class="string">"TSPYL1"</span>    </span><br><span class="line">[266] <span class="string">"KAZN"</span>       <span class="string">"ACADSB"</span>     <span class="string">"AJAP1"</span>      <span class="string">"MYO6"</span>       <span class="string">"SMIM10L2B"</span> </span><br><span class="line">[271] <span class="string">"OGDHL"</span>      <span class="string">"OCLN"</span>       <span class="string">"SLC22A12"</span>   <span class="string">"KIF13B"</span>     <span class="string">"SLC22A6"</span>   </span><br><span class="line">[276] <span class="string">"HIBCH"</span>      <span class="string">"PEG3"</span>       <span class="string">"ARC"</span>        <span class="string">"LRBA"</span>       <span class="string">"ECI2"</span>      </span><br><span class="line">[281] <span class="string">"MTOR"</span>       <span class="string">"BHLHB9"</span>     <span class="string">"SLC44A4"</span>    <span class="string">"ZNF204P"</span>    <span class="string">"CYS1"</span>      </span><br><span class="line">[286] <span class="string">"SYNJ2BP"</span>    <span class="string">"B3GNT10"</span>    <span class="string">"TTC3P1"</span>     <span class="string">"ZNF844"</span>     <span class="string">"PSMG3-AS1"</span> </span><br><span class="line">[291] <span class="string">"LINC00271"</span>  <span class="string">""</span>           <span class="string">"RAP2C-AS1"</span>  <span class="string">""</span>           <span class="string">""</span>          </span><br><span class="line">[296] <span class="string">"RPL34-AS1"</span>  <span class="string">""</span>           <span class="string">"MKLN1-AS"</span>   <span class="string">"SUCLG2-AS1"</span> <span class="string">"LINC02027"</span> </span><br><span class="line">[301] <span class="string">"C1orf210"</span>   <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>          </span><br><span class="line">[306] <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">"DYNLL2"</span>     <span class="string">""</span>          </span><br><span class="line">[311] <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">"PWAR5"</span>     </span><br><span class="line">&gt; result_survP_LB<span class="variable">$hgnc_symbol</span></span><br><span class="line"> [1] <span class="string">"CLDN11"</span>   <span class="string">"GPRC5A"</span>   <span class="string">"GYG2"</span>     <span class="string">"STYK1"</span>    <span class="string">"BCAS1"</span>    <span class="string">"IGF2BP2"</span> </span><br><span class="line"> [7] <span class="string">"SULT2B1"</span>  <span class="string">"EPB41L4B"</span> <span class="string">"CAPS"</span>     <span class="string">"PTGDS"</span>    <span class="string">"DNAJC12"</span>  <span class="string">"VTN"</span>     </span><br><span class="line">[13] <span class="string">"SLPI"</span>     <span class="string">"CHAC1"</span>    <span class="string">"PSAT1"</span>    <span class="string">"PPP1R1A"</span>  <span class="string">"KCNH3"</span>    <span class="string">"WNT10A"</span>  </span><br><span class="line">[19] <span class="string">"TFAP2A"</span>   <span class="string">"CILP"</span>     <span class="string">"BMPR1B"</span>   <span class="string">"NECTIN4"</span>  <span class="string">"SUSD4"</span>    <span class="string">"ATP6V1C2"</span></span><br><span class="line">[25] <span class="string">"SSC4D"</span>    <span class="string">"PLEKHG4B"</span> <span class="string">"FAM167A"</span>  <span class="string">"PROM2"</span>    <span class="string">"PPM1J"</span>    <span class="string">"SIM2"</span>    </span><br><span class="line">[31] <span class="string">"TLCD1"</span>    <span class="string">"BNIPL"</span>    <span class="string">"LIPH"</span>     <span class="string">"MELTF"</span>    <span class="string">"SHOC1"</span>    <span class="string">"SCNN1B"</span>  </span><br><span class="line">[37] <span class="string">"PHYHIP"</span>   <span class="string">"LRRN2"</span>    <span class="string">"HOXB9"</span>    <span class="string">"CEL"</span>      <span class="string">"MUC13"</span>    <span class="string">"B3GNT8"</span>  </span><br><span class="line">[43] <span class="string">"SMCO3"</span>    <span class="string">"WT1"</span>      <span class="string">"CLCNKA"</span>   <span class="string">"DNER"</span>     <span class="string">"SERPINA5"</span> <span class="string">"L1CAM"</span>   </span><br><span class="line">[49] <span class="string">"GEMIN8P4"</span> <span class="string">"MRPS6"</span>    <span class="string">"TRNP1"</span></span><br></pre></td></tr></table></figure><p>有了这个基因列表，后续可以进行富集分析或者GSEA分析。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们以padj或FoldChange为依据筛选了TOP10基因，并进行了生存分析，但效果并不理想，原因很简单，因为不论是P值还是变化倍数，其实都与病例生存时间没有必然关联。这次，我们来对所有差异表达基因批量进行生存分析，看有多少基因影响病例生存，并且找找规律。&lt;/p&gt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记12-富集分析</title>
    <link href="http://uteric.github.io/TCGA/TCGA12Enrich/"/>
    <id>http://uteric.github.io/TCGA/TCGA12Enrich/</id>
    <published>2020-07-05T21:13:51.000Z</published>
    <updated>2020-07-05T21:13:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，差异分析得到了4913个基因，注释后剩下4863个基因，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(result_select)</span><br><span class="line">[1] 4913    7</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863    8</span><br></pre></td></tr></table></figure><p>现在，我们对这4863个已知基因进行富集分析，看这些基因都集中在哪些信号通路或者生物过程当中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">library(clusterProfiler)</span><br><span class="line">library(topGO)</span><br><span class="line">library(Rgraphviz)</span><br><span class="line">library(pathview)</span><br><span class="line">library(org.Hs.eg.db)</span><br><span class="line"></span><br><span class="line">DEGs_entrez_id &lt;- mapIds(x=org.Hs.eg.db,column=<span class="string">"ENTREZID"</span>,</span><br><span class="line">                         keys=as.character(result_select_annot<span class="variable">$hgnc_symbol</span>),keytype = <span class="string">"SYMBOL"</span>)</span><br><span class="line">enrich_go_BP &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"BP"</span>,pvalueCutoff = 0.05) <span class="comment"># BP, Biological Process，生物学过程</span></span><br><span class="line">enrich_go_MF &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"MF"</span>,pvalueCutoff = 0.05) <span class="comment"># MF, Molecular Function，分子功能 </span></span><br><span class="line">enrich_go_CC &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"CC"</span>,pvalueCutoff = 0.05) <span class="comment"># CC, Celular Components，细胞组份</span></span><br><span class="line">enrich_go_KEGG &lt;- enrichKEGG(gene=DEGs_entrez_id,organism=<span class="string">"hsa"</span>,keyType=<span class="string">"kegg"</span>,pvalueCutoff=0.05)</span><br></pre></td></tr></table></figure><p>现在，准备工作完成了，开始绘图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_BP,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA18.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_MF,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA19.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_CC,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA20.png" alt></p><p>由于肾脏是排泄器官，可以看到绝大多数基因都集中在细胞外或细胞膜，而功能方面多参与膜运输，而参与的生物学过程多与免疫相关。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_KEGG)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA21.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，差异分析得到了4913个基因，注释后剩下4863个基因，如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记11-生存曲线</title>
    <link href="http://uteric.github.io/TCGA/TCGA11Survival/"/>
    <id>http://uteric.github.io/TCGA/TCGA11Survival/</id>
    <published>2020-07-05T19:51:30.000Z</published>
    <updated>2020-07-05T19:51:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们在差异表达结果中按照padj筛选出了TOP10基因，现在，我们对TOP10基因绘制生存曲线，看它们的表达是否与病例的生存时间相关。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(survival)</span><br><span class="line">&gt; kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>) <span class="comment"># 将id列中的"diagnosis"替换为01，以便保持样本名称一致</span></span><br><span class="line">&gt; dim(kidney_clinic)</span><br><span class="line">[1] 530  14</span><br><span class="line">&gt; head(kidney_clinic)</span><br><span class="line">                      id classification_of_tumor tumor_stage gender</span><br><span class="line">1 TCGA-CZ-5986_diagnosis            not reported     stage i   male</span><br><span class="line">2 TCGA-CZ-4858_diagnosis            not reported    stage ii   male</span><br><span class="line">3 TCGA-B8-5551_diagnosis            not reported     stage i female</span><br><span class="line">4 TCGA-B0-4817_diagnosis            not reported   stage iii   male</span><br><span class="line">5 TCGA-BP-4325_diagnosis            not reported     stage i female</span><br><span class="line">6 TCGA-B0-4698_diagnosis            not reported    stage iv   male</span><br><span class="line">  year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">1          1945  not reported              2006  not reported  61</span><br><span class="line">2          1966  not reported              2005          2105  39</span><br><span class="line">3          1945  not reported              2010  not reported  65</span><br><span class="line">4          1921          2004              2002          1019  81</span><br><span class="line">5          1937  not reported              2001  not reported  64</span><br><span class="line">6          1928          2003              2003            42  75</span><br><span class="line">  deadORlive                      race      alcohol years_smoked</span><br><span class="line">1      Alive                     white Not Reported not reported</span><br><span class="line">2       Dead                     white Not Reported not reported</span><br><span class="line">3      Alive black or african american Not Reported not reported</span><br><span class="line">4       Dead                     white Not Reported not reported</span><br><span class="line">5      Alive                     white Not Reported not reported</span><br><span class="line">6       Dead                     white Not Reported not reported</span><br><span class="line">            newID</span><br><span class="line">1 TCGA-CZ-5986-01</span><br><span class="line">2 TCGA-CZ-4858-01</span><br><span class="line">3 TCGA-B8-5551-01</span><br><span class="line">4 TCGA-B0-4817-01</span><br><span class="line">5 TCGA-BP-4325-01</span><br><span class="line">6 TCGA-B0-4698-01</span><br><span class="line">&gt; km_plot &lt;- apply(padj_top10,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;) <span class="comment"># 这里的1表示对行操作，即对每个基因判断表达高，注意，输入的是data.frame，返回的是matrix</span></span><br><span class="line">&gt; dim(km_plot)</span><br><span class="line">[1] 611  10</span><br><span class="line">&gt; head(km_plot)</span><br><span class="line">                ENSG00000174514 ENSG00000249859 ENSG00000224490</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000061656 ENSG00000213963 ENSG00000185633</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000014257 ENSG00000187730 ENSG00000129521</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">                ENSG00000135245</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span></span><br><span class="line">&gt; km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),] <span class="comment"># km_plot来源于padj_top10，后者包含611个样本，有对照有肿瘤，而在做生存分析时只需要肿瘤样本，因此匹配01是为了筛选所有肿瘤样本</span></span><br><span class="line">&gt; dim(km_plot_cancer)</span><br><span class="line">[1] 538  10 <span class="comment"># 611个样本中，538个是肿瘤，然而，CASE只有530个，可见有来源于同一个病例的多个样本</span></span><br><span class="line">&gt; class(km_plot_cancer)</span><br><span class="line">[1] <span class="string">"matrix"</span> <span class="comment"># matrix允许重复的行</span></span><br><span class="line">&gt; head(km_plot_cancer)</span><br><span class="line">                ENSG00000174514 ENSG00000249859 ENSG00000224490</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">                ENSG00000061656 ENSG00000213963 ENSG00000185633</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000014257 ENSG00000187730 ENSG00000129521</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000135245</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>  </span><br><span class="line">&gt; kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">&gt; dim(kidney_clinic_km)</span><br><span class="line">[1] 538  14 <span class="comment"># 还是538行，有8行重复</span></span><br><span class="line">&gt; class(kidney_clinic_km)</span><br><span class="line">[1] <span class="string">"data.frame"</span> <span class="comment"># data.frame行名不能重复，但内容可以重复</span></span><br><span class="line">&gt; head(kidney_clinic_km)</span><br><span class="line">                        id classification_of_tumor tumor_stage gender</span><br><span class="line">274 TCGA-CZ-5465_diagnosis            not reported   stage iii female</span><br><span class="line">358 TCGA-BP-4355_diagnosis            not reported   stage iii female</span><br><span class="line">517 TCGA-CZ-5451_diagnosis            not reported    stage ii   male</span><br><span class="line">119 TCGA-B0-5081_diagnosis            not reported   stage iii female</span><br><span class="line">201 TCGA-B0-5697_diagnosis            not reported     stage i   male</span><br><span class="line">484 TCGA-A3-A8OV_diagnosis            not reported     stage i   male</span><br><span class="line">    year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">274          1931  not reported              2007          2564  76</span><br><span class="line">358          1949          2010              2008           953  59</span><br><span class="line">517          1932  not reported              2006  not reported  74</span><br><span class="line">119          1926          2005              2005           362  79</span><br><span class="line">201          1957  not reported              2007  not reported  50</span><br><span class="line">484          1936  not reported              2011  not reported  75</span><br><span class="line">    deadORlive                      race      alcohol years_smoked</span><br><span class="line">274       Dead              not reported Not Reported not reported</span><br><span class="line">358       Dead                     white Not Reported not reported</span><br><span class="line">517      Alive                     white Not Reported not reported</span><br><span class="line">119       Dead                     white Not Reported not reported</span><br><span class="line">201      Alive                     white Not Reported not reported</span><br><span class="line">484      Alive black or african american Not Reported           65</span><br><span class="line">              newID</span><br><span class="line">274 TCGA-CZ-5465-01</span><br><span class="line">358 TCGA-BP-4355-01</span><br><span class="line">517 TCGA-CZ-5451-01</span><br><span class="line">119 TCGA-B0-5081-01</span><br><span class="line">201 TCGA-B0-5697-01</span><br><span class="line">484 TCGA-A3-A8OV-01</span><br><span class="line"></span><br><span class="line">&gt; daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>)) <span class="comment"># 临床数据需要用到的是days_to_death</span></span><br><span class="line">Warning message:</span><br><span class="line">NAs introduced by coercion </span><br><span class="line">&gt; daysToDeath <span class="comment"># 有许多是NA</span></span><br><span class="line">  [1] 2564  953   NA  362   NA   NA   62 1493   51   NA   NA   NA 1588</span><br><span class="line"> [14]   NA  885 2227  137   NA   NA 1432   NA   NA   NA   NA   NA   NA</span><br><span class="line"> [27] 1657   NA   18   NA 1964   NA  109   NA 1661   NA   NA   NA   NA</span><br><span class="line"> [40]   NA   NA   NA   NA 1315 1404  562  445   NA   NA   NA   NA 1238</span><br><span class="line"> [53]  182 1912   NA   NA   NA   NA 2454  344   NA 1913 1111   NA 1980</span><br><span class="line"> [66]   NA  600 1003   NA   NA   NA   NA 2105 1371  334   NA 1337   NA</span><br><span class="line"> [79]   NA   NA   NA   NA   NA   NA  727   NA   NA 2256   NA   NA   NA</span><br><span class="line"> [92]  782   NA   NA   NA   NA   NA   NA   NA 1625   NA   NA   NA   NA</span><br><span class="line">[105]   NA   NA  768   NA   NA   NA   NA   NA  563   NA 2145   NA   NA</span><br><span class="line">[118]   NA  561   NA   NA   NA   NA   NA   NA   NA   NA 1200   NA   NA</span><br><span class="line">[131]   NA   NA   NA   NA   NA   NA 1317   NA   NA   NA   NA   NA   NA</span><br><span class="line">[144]  329   NA   NA   NA   NA  242   NA   NA  646   NA   NA   NA   NA</span><br><span class="line">[157]  683  587  952    0   NA  320 1092   NA   NA   68  510   NA   NA</span><br><span class="line">[170]  245    2   NA  793   NA   NA   NA 2601   NA   NA   NA 1714   NA</span><br><span class="line">[183]   NA   NA 1230 1170 2386   NA  571  883 1912   NA   NA   NA 1986</span><br><span class="line">[196]   NA 1091   NA   NA   NA   NA   NA 1417   NA   NA   65   NA   NA</span><br><span class="line">[209]   NA   NA   NA   NA 1378   NA   NA   NA   NA   NA   NA   NA   NA</span><br><span class="line">[222]   NA   NA  679  866   NA   NA   NA   NA   NA  330   NA   NA  885</span><br><span class="line">[235]   NA  946   NA   NA  375   NA   NA   NA 1133   NA   NA  561   NA</span><br><span class="line">[248]  431   NA 2764   NA   NA   NA   NA 1696   NA   42   NA   59    0</span><br><span class="line">[261]   NA   NA   NA   NA   NA 1034 1270 1200 2241  333   NA   NA   NA</span><br><span class="line">[274]   NA  342   NA  722   NA   NA 1075   NA   NA   NA   NA  709   NA</span><br><span class="line">[287]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  164</span><br><span class="line">[300]   NA   NA   NA   NA   NA  701   69   NA   NA  574  106   NA   NA</span><br><span class="line">[313]   NA   NA  475 1019   NA   NA   NA  162  845   NA   NA  552  139</span><br><span class="line">[326]   NA   NA   NA   NA 1589   NA 1045  735   NA   NA   NA   NA   NA</span><br><span class="line">[339]   NA   NA 1972  459   NA 2299   NA   NA   NA  819 1463   NA   NA</span><br><span class="line">[352] 1724   NA   NA  313   NA   NA   NA  183   NA   NA   NA   NA   NA</span><br><span class="line">[365]   NA   NA 1626  822   NA  206  932 1097   NA   NA   NA   NA   NA</span><br><span class="line">[378]   NA   NA   NA  166  478   NA 1584   NA   NA   NA   NA  480   NA</span><br><span class="line">[391]   NA  311   NA   NA   NA   NA  202   NA  927 1343 1590  454   NA</span><br><span class="line">[404]  834   NA   NA   NA 2090 1598   NA 1639  878  992   NA   NA   NA</span><br><span class="line">[417]   NA   43   NA 2419   NA   NA   NA   NA 1121   NA   NA   NA   NA</span><br><span class="line">[430] 2343  485  110   NA   NA  313  204   NA   NA   NA  238   NA   NA</span><br><span class="line">[443]   NA   NA   NA   NA  480   NA  168   NA   73   NA   NA  101   NA</span><br><span class="line">[456]   NA   NA   NA  446 3615   NA  645   NA 1567   NA 3554   NA   NA</span><br><span class="line">[469]   NA   NA   NA  139   NA   NA   NA  841   NA   NA  336   NA   NA</span><br><span class="line">[482]   NA   99   NA   NA   NA   NA  637   NA   NA   NA   NA 1111   NA</span><br><span class="line">[495]   NA   NA   77  770   NA   NA   NA   NA  222   NA   NA   NA   NA</span><br><span class="line">[508]   41   NA   NA   NA   NA   NA   NA   NA   NA 1610  224   NA 1191</span><br><span class="line">[521]   NA   93   NA   NA  307   NA  211   NA   NA 1625   NA  578   NA</span><br><span class="line">[534]   NA   NA   NA   NA   NA</span><br><span class="line"></span><br><span class="line">&gt; daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath) <span class="comment"># 没有报道死亡天数的，认为还活着，使用最大天数</span></span><br><span class="line">&gt; daysToDeathN</span><br><span class="line">  [1] 2564  953 3615  362 3615 3615   62 1493   51 3615 3615 3615 1588</span><br><span class="line"> [14] 3615  885 2227  137 3615 3615 1432 3615 3615 3615 3615 3615 3615</span><br><span class="line"> [27] 1657 3615   18 3615 1964 3615  109 3615 1661 3615 3615 3615 3615</span><br><span class="line"> [40] 3615 3615 3615 3615 1315 1404  562  445 3615 3615 3615 3615 1238</span><br><span class="line"> [53]  182 1912 3615 3615 3615 3615 2454  344 3615 1913 1111 3615 1980</span><br><span class="line"> [66] 3615  600 1003 3615 3615 3615 3615 2105 1371  334 3615 1337 3615</span><br><span class="line"> [79] 3615 3615 3615 3615 3615 3615  727 3615 3615 2256 3615 3615 3615</span><br><span class="line"> [92]  782 3615 3615 3615 3615 3615 3615 3615 1625 3615 3615 3615 3615</span><br><span class="line">[105] 3615 3615  768 3615 3615 3615 3615 3615  563 3615 2145 3615 3615</span><br><span class="line">[118] 3615  561 3615 3615 3615 3615 3615 3615 3615 3615 1200 3615 3615</span><br><span class="line">[131] 3615 3615 3615 3615 3615 3615 1317 3615 3615 3615 3615 3615 3615</span><br><span class="line">[144]  329 3615 3615 3615 3615  242 3615 3615  646 3615 3615 3615 3615</span><br><span class="line">[157]  683  587  952    0 3615  320 1092 3615 3615   68  510 3615 3615</span><br><span class="line">[170]  245    2 3615  793 3615 3615 3615 2601 3615 3615 3615 1714 3615</span><br><span class="line">[183] 3615 3615 1230 1170 2386 3615  571  883 1912 3615 3615 3615 1986</span><br><span class="line">[196] 3615 1091 3615 3615 3615 3615 3615 1417 3615 3615   65 3615 3615</span><br><span class="line">[209] 3615 3615 3615 3615 1378 3615 3615 3615 3615 3615 3615 3615 3615</span><br><span class="line">[222] 3615 3615  679  866 3615 3615 3615 3615 3615  330 3615 3615  885</span><br><span class="line">[235] 3615  946 3615 3615  375 3615 3615 3615 1133 3615 3615  561 3615</span><br><span class="line">[248]  431 3615 2764 3615 3615 3615 3615 1696 3615   42 3615   59    0</span><br><span class="line">[261] 3615 3615 3615 3615 3615 1034 1270 1200 2241  333 3615 3615 3615</span><br><span class="line">[274] 3615  342 3615  722 3615 3615 1075 3615 3615 3615 3615  709 3615</span><br><span class="line">[287] 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615  164</span><br><span class="line">[300] 3615 3615 3615 3615 3615  701   69 3615 3615  574  106 3615 3615</span><br><span class="line">[313] 3615 3615  475 1019 3615 3615 3615  162  845 3615 3615  552  139</span><br><span class="line">[326] 3615 3615 3615 3615 1589 3615 1045  735 3615 3615 3615 3615 3615</span><br><span class="line">[339] 3615 3615 1972  459 3615 2299 3615 3615 3615  819 1463 3615 3615</span><br><span class="line">[352] 1724 3615 3615  313 3615 3615 3615  183 3615 3615 3615 3615 3615</span><br><span class="line">[365] 3615 3615 1626  822 3615  206  932 1097 3615 3615 3615 3615 3615</span><br><span class="line">[378] 3615 3615 3615  166  478 3615 1584 3615 3615 3615 3615  480 3615</span><br><span class="line">[391] 3615  311 3615 3615 3615 3615  202 3615  927 1343 1590  454 3615</span><br><span class="line">[404]  834 3615 3615 3615 2090 1598 3615 1639  878  992 3615 3615 3615</span><br><span class="line">[417] 3615   43 3615 2419 3615 3615 3615 3615 1121 3615 3615 3615 3615</span><br><span class="line">[430] 2343  485  110 3615 3615  313  204 3615 3615 3615  238 3615 3615</span><br><span class="line">[443] 3615 3615 3615 3615  480 3615  168 3615   73 3615 3615  101 3615</span><br><span class="line">[456] 3615 3615 3615  446 3615 3615  645 3615 1567 3615 3554 3615 3615</span><br><span class="line">[469] 3615 3615 3615  139 3615 3615 3615  841 3615 3615  336 3615 3615</span><br><span class="line">[482] 3615   99 3615 3615 3615 3615  637 3615 3615 3615 3615 1111 3615</span><br><span class="line">[495] 3615 3615   77  770 3615 3615 3615 3615  222 3615 3615 3615 3615</span><br><span class="line">[508]   41 3615 3615 3615 3615 3615 3615 3615 3615 1610  224 3615 1191</span><br><span class="line">[521] 3615   93 3615 3615  307 3615  211 3615 3615 1625 3615  578 3615</span><br><span class="line">[534] 3615 3615 3615 3615 3615</span><br><span class="line"></span><br><span class="line">&gt; fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">&gt; fit</span><br><span class="line">  [1] 2564   953  3615+  362  3615+ 3615+   62  1493    51  3615+</span><br><span class="line"> [11] 3615+ 3615+ 1588  3615+  885  2227   137  3615+ 3615+ 1432 </span><br><span class="line"> [21] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1657  3615+   18  3615+</span><br><span class="line"> [31] 1964  3615+  109  3615+ 1661  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line"> [41] 3615+ 3615+ 3615+ 1315  1404   562   445  3615+ 3615+ 3615+</span><br><span class="line"> [51] 3615+ 1238   182  1912  3615+ 3615+ 3615+ 3615+ 2454   344 </span><br><span class="line"> [61] 3615+ 1913  1111  3615+ 1980  3615+  600  1003  3615+ 3615+</span><br><span class="line"> [71] 3615+ 3615+ 2105  1371   334  3615+ 1337  3615+ 3615+ 3615+</span><br><span class="line"> [81] 3615+ 3615+ 3615+ 3615+  727  3615+ 3615+ 2256  3615+ 3615+</span><br><span class="line"> [91] 3615+  782  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1625 </span><br><span class="line">[101] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  768  3615+ 3615+ 3615+</span><br><span class="line">[111] 3615+ 3615+  563  3615+ 2145  3615+ 3615+ 3615+  561  3615+</span><br><span class="line">[121] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1200  3615+ 3615+</span><br><span class="line">[131] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1317  3615+ 3615+ 3615+</span><br><span class="line">[141] 3615+ 3615+ 3615+  329  3615+ 3615+ 3615+ 3615+  242  3615+</span><br><span class="line">[151] 3615+  646  3615+ 3615+ 3615+ 3615+  683   587   952     0 </span><br><span class="line">[161] 3615+  320  1092  3615+ 3615+   68   510  3615+ 3615+  245 </span><br><span class="line">[171]    2  3615+  793  3615+ 3615+ 3615+ 2601  3615+ 3615+ 3615+</span><br><span class="line">[181] 1714  3615+ 3615+ 3615+ 1230  1170  2386  3615+  571   883 </span><br><span class="line">[191] 1912  3615+ 3615+ 3615+ 1986  3615+ 1091  3615+ 3615+ 3615+</span><br><span class="line">[201] 3615+ 3615+ 1417  3615+ 3615+   65  3615+ 3615+ 3615+ 3615+</span><br><span class="line">[211] 3615+ 3615+ 1378  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[221] 3615+ 3615+ 3615+  679   866  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[231]  330  3615+ 3615+  885  3615+  946  3615+ 3615+  375  3615+</span><br><span class="line">[241] 3615+ 3615+ 1133  3615+ 3615+  561  3615+  431  3615+ 2764 </span><br><span class="line">[251] 3615+ 3615+ 3615+ 3615+ 1696  3615+   42  3615+   59     0 </span><br><span class="line">[261] 3615+ 3615+ 3615+ 3615+ 3615+ 1034  1270  1200  2241   333 </span><br><span class="line">[271] 3615+ 3615+ 3615+ 3615+  342  3615+  722  3615+ 3615+ 1075 </span><br><span class="line">[281] 3615+ 3615+ 3615+ 3615+  709  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[291] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  164  3615+</span><br><span class="line">[301] 3615+ 3615+ 3615+ 3615+  701    69  3615+ 3615+  574   106 </span><br><span class="line">[311] 3615+ 3615+ 3615+ 3615+  475  1019  3615+ 3615+ 3615+  162 </span><br><span class="line">[321]  845  3615+ 3615+  552   139  3615+ 3615+ 3615+ 3615+ 1589 </span><br><span class="line">[331] 3615+ 1045   735  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[341] 1972   459  3615+ 2299  3615+ 3615+ 3615+  819  1463  3615+</span><br><span class="line">[351] 3615+ 1724  3615+ 3615+  313  3615+ 3615+ 3615+  183  3615+</span><br><span class="line">[361] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1626   822  3615+  206 </span><br><span class="line">[371]  932  1097  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[381]  166   478  3615+ 1584  3615+ 3615+ 3615+ 3615+  480  3615+</span><br><span class="line">[391] 3615+  311  3615+ 3615+ 3615+ 3615+  202  3615+  927  1343 </span><br><span class="line">[401] 1590   454  3615+  834  3615+ 3615+ 3615+ 2090  1598  3615+</span><br><span class="line">[411] 1639   878   992  3615+ 3615+ 3615+ 3615+   43  3615+ 2419 </span><br><span class="line">[421] 3615+ 3615+ 3615+ 3615+ 1121  3615+ 3615+ 3615+ 3615+ 2343 </span><br><span class="line">[431]  485   110  3615+ 3615+  313   204  3615+ 3615+ 3615+  238 </span><br><span class="line">[441] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  480  3615+  168  3615+</span><br><span class="line">[451]   73  3615+ 3615+  101  3615+ 3615+ 3615+ 3615+  446  3615 </span><br><span class="line">[461] 3615+  645  3615+ 1567  3615+ 3554  3615+ 3615+ 3615+ 3615+</span><br><span class="line">[471] 3615+  139  3615+ 3615+ 3615+  841  3615+ 3615+  336  3615+</span><br><span class="line">[481] 3615+ 3615+   99  3615+ 3615+ 3615+ 3615+  637  3615+ 3615+</span><br><span class="line">[491] 3615+ 3615+ 1111  3615+ 3615+ 3615+   77   770  3615+ 3615+</span><br><span class="line">[501] 3615+ 3615+  222  3615+ 3615+ 3615+ 3615+   41  3615+ 3615+</span><br><span class="line">[511] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1610   224  3615+ 1191 </span><br><span class="line">[521] 3615+   93  3615+ 3615+  307  3615+  211  3615+ 3615+ 1625 </span><br><span class="line">[531] 3615+  578  3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line"></span><br><span class="line">&gt; par(mfrow=c(2,5))</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(padj_top10_id))&#123;</span><br><span class="line">+   kmfit1 &lt;- survfit(fit~km_plot_cancer[,i])</span><br><span class="line">+   plot(kmfit1,lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),col=c(<span class="string">"blue"</span>,<span class="string">"red"</span>),lwd=c(2,2),cex.main=1.8,</span><br><span class="line">+        xlab=<span class="string">"survival time in days"</span>,ylab=<span class="string">"survival probabilities"</span>,cex.lab=1.6,</span><br><span class="line">+        cex.axis=1.8,main=padj_top10_symbol[i])</span><br><span class="line">+ m &lt;- survdiff(y~km_plot_cancer[,i])</span><br><span class="line">+ p_value &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">+ text(2000,0.95,paste(<span class="string">"P="</span>, round(p_value,digit=4)),cex=1.2)</span><br><span class="line">+ legend(<span class="string">"bottom"</span>,c(<span class="string">"High"</span>,<span class="string">"Low"</span>),lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),seg.len = 1, col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>),border=<span class="string">"white"</span>,bty=<span class="string">"n"</span>,cex=1.2,lwd=c(2,2))</span><br><span class="line">+ &#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA16.png" alt></p><p>这个结果并不理想，只有前两个基因的表达量与生存时间有关联，MFSD4A高表达生存时间长，而PVT1低表达生存时间长。</p><p>我们可以换个角度思考同一个问题，如果以FoldChange来挑选TOP10基因，结果如何？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&gt; annot_order_FC &lt;- result_select_annot[order(abs(result_select_annot<span class="variable">$log2FoldChange</span>),decreasing = T),]</span><br><span class="line">&gt; head(annot_order_FC)</span><br><span class="line">     ensembl_gene_id   baseMean log2FoldChange     lfcSE      <span class="built_in">stat</span></span><br><span class="line">3736 ENSG00000224490  1714.5650       8.442435 0.2386643  35.37369</span><br><span class="line">271  ENSG00000074803 22193.6542      -8.275817 0.3329828 -24.85359</span><br><span class="line">2856 ENSG00000178776   886.3988       7.706962 0.3261798  23.62795</span><br><span class="line">3468 ENSG00000204362   354.1751       7.570398 0.2945341  25.70296</span><br><span class="line">597  ENSG00000104327  2844.9568      -7.529189 0.2863865 -26.29031</span><br><span class="line">2280 ENSG00000164434 11701.5196       7.440639 0.3247560  22.91148</span><br><span class="line">            pvalue          padj hgnc_symbol</span><br><span class="line">3736 4.335266e-274 2.619801e-270  TTC21B-AS1</span><br><span class="line">271  2.364992e-136 4.660319e-134     SLC12A1</span><br><span class="line">2856 1.989551e-123 2.632742e-121     C5orf46</span><br><span class="line">3468 1.083083e-145 2.727112e-143   LINC02783</span><br><span class="line">597  2.474996e-152 8.309111e-150       CALB1</span><br><span class="line">2280 3.570399e-116 3.785249e-114       FABP7</span><br><span class="line">&gt; FC_top10_symbol &lt;- head(annot_order_FC<span class="variable">$hgnc_symbol</span>,10)</span><br><span class="line">&gt; FC_top10_id &lt;- head(annot_order_FC<span class="variable">$ensembl_gene_id</span>,10)</span><br><span class="line">&gt; FC_top10 &lt;- data_select[match(FC_top10_id,rownames(data_select)),]</span><br><span class="line">&gt; colnames(FC_top10) &lt;- substr(colnames(FC_top10),1,15)</span><br><span class="line">&gt; head(FC_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000224490            8222             864            3772</span><br><span class="line">ENSG00000074803           19360             100              10</span><br><span class="line">ENSG00000178776            1165              97             423</span><br><span class="line">ENSG00000204362             201             519              20</span><br><span class="line">ENSG00000104327              24              35               6</span><br><span class="line">ENSG00000164434           17120            6341           21755</span><br><span class="line">&gt; dim(FC_top10)</span><br><span class="line">[1]  10 611</span><br><span class="line"></span><br><span class="line">kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>)</span><br><span class="line">dim(kidney_clinic)</span><br><span class="line">head(kidney_clinic)</span><br><span class="line">km_plot &lt;- apply(FC_top10,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;)</span><br><span class="line">dim(km_plot)</span><br><span class="line">head(km_plot)</span><br><span class="line">km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),]</span><br><span class="line">dim(km_plot_cancer)</span><br><span class="line">head(km_plot_cancer)</span><br><span class="line">kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">dim(kidney_clinic_km)</span><br><span class="line">head(kidney_clinic_km)</span><br><span class="line">daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>))</span><br><span class="line">daysToDeath</span><br><span class="line">daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath)</span><br><span class="line">daysToDeathN</span><br><span class="line">fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">par(mfrow=c(2,5))</span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(FC_top10_id))&#123;</span><br><span class="line">  kmfit1 &lt;- survfit(fit~km_plot_cancer[,i])</span><br><span class="line">  plot(kmfit1,lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),col=c(<span class="string">"blue"</span>,<span class="string">"red"</span>),lwd=c(2,2),cex.main=1.8,</span><br><span class="line">       xlab=<span class="string">"survival time in days"</span>,ylab=<span class="string">"survival probabilities"</span>,cex.lab=1.6,</span><br><span class="line">       cex.axis=1.8,main=FC_top10_symbol[i])</span><br><span class="line">  m &lt;- survdiff(y~km_plot_cancer[,i])</span><br><span class="line">  p_value &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">  text(2000,0.95,paste(<span class="string">"P="</span>, round(p_value,digit=4)),cex=1.2)</span><br><span class="line">  legend(<span class="string">"bottom"</span>,c(<span class="string">"High"</span>,<span class="string">"Low"</span>),lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),seg.len = 1, col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>),border=<span class="string">"white"</span>,bty=<span class="string">"n"</span>,cex=1.2,lwd=c(2,2))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA17.png" alt></p><p>结果还不如使用padj，可见，表达差异大的基因不一定与生存时间有关联。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们在差异表达结果中按照padj筛选出了TOP10基因，现在，我们对TOP10基因绘制生存曲线，看它们的表达是否与病例的生存时间相关。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记10-受试者工作曲线</title>
    <link href="http://uteric.github.io/TCGA/TCGA10Roc/"/>
    <id>http://uteric.github.io/TCGA/TCGA10Roc/</id>
    <published>2020-07-05T04:16:52.000Z</published>
    <updated>2020-07-05T04:16:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>得到差异表达结果之后，我们可以根据padj来挑选排名前10的基因，来绘制受试者工作曲线，评估这些基因是否能作为判断肿瘤的标志基因。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&gt; annot_order &lt;- result_select_annot[order(result_select_annot<span class="variable">$padj</span>),] <span class="comment"># 按padj由小到大排序</span></span><br><span class="line">&gt; head(annot_order)</span><br><span class="line">     ensembl_gene_id   baseMean log2FoldChange     lfcSE      <span class="built_in">stat</span></span><br><span class="line">2718 ENSG00000174514  3783.7694      -5.246630 0.1256629 -41.75163</span><br><span class="line">4214 ENSG00000249859   880.8528       4.645581 0.1208287  38.44768</span><br><span class="line">3736 ENSG00000224490  1714.5650       8.442435 0.2386643  35.37369</span><br><span class="line">190  ENSG00000061656  2539.8779       4.097458 0.1185899  34.55149</span><br><span class="line">3632 ENSG00000213963   495.6315      -3.594074 0.1061639 -33.85401</span><br><span class="line">3104 ENSG00000185633 84959.2141       5.793502 0.1737995  33.33440</span><br><span class="line">            pvalue          padj hgnc_symbol</span><br><span class="line">2718  0.000000e+00  0.000000e+00      MFSD4A</span><br><span class="line">4214  0.000000e+00  0.000000e+00        PVT1</span><br><span class="line">3736 4.335266e-274 2.619801e-270  TTC21B-AS1</span><br><span class="line">190  1.353764e-261 6.135596e-258       SPAG4</span><br><span class="line">3632 3.168412e-251 1.148803e-247             <span class="comment"># 这个基因注释后没有名字</span></span><br><span class="line">3104 1.226108e-243 3.704687e-240    NDUFA4L2</span><br><span class="line">&gt; padj_top10_symbol &lt;- head(annot_order<span class="variable">$hgnc_symbol</span>,10) <span class="comment"># TOP10基因名称</span></span><br><span class="line">&gt; padj_top10_symbol</span><br><span class="line"> [1] <span class="string">"MFSD4A"</span>     <span class="string">"PVT1"</span>       <span class="string">"TTC21B-AS1"</span> <span class="string">"SPAG4"</span>      <span class="string">""</span>          </span><br><span class="line"> [6] <span class="string">"NDUFA4L2"</span>   <span class="string">"ACP3"</span>       <span class="string">"GABRD"</span>      <span class="string">"EGLN3"</span>      <span class="string">"HILPDA"</span>    </span><br><span class="line">&gt; padj_top10_id &lt;- head(annot_order<span class="variable">$ensembl_gene_id</span>,10) <span class="comment"># TOP10基因ID</span></span><br><span class="line">&gt; padj_top10_id</span><br><span class="line"> [1] <span class="string">"ENSG00000174514"</span> <span class="string">"ENSG00000249859"</span> <span class="string">"ENSG00000224490"</span></span><br><span class="line"> [4] <span class="string">"ENSG00000061656"</span> <span class="string">"ENSG00000213963"</span> <span class="string">"ENSG00000185633"</span></span><br><span class="line"> [7] <span class="string">"ENSG00000014257"</span> <span class="string">"ENSG00000187730"</span> <span class="string">"ENSG00000129521"</span></span><br><span class="line">[10] <span class="string">"ENSG00000135245"</span></span><br><span class="line">&gt; padj_top10 &lt;- data_select[match(padj_top10_id,rownames(data_select)),] <span class="comment"># TOP10表达数据</span></span><br><span class="line">&gt; head(padj_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000174514                      1784                       295</span><br><span class="line">ENSG00000249859                      3335                      1050</span><br><span class="line">ENSG00000224490                      8222                       864</span><br><span class="line">ENSG00000061656                      3397                      2055</span><br><span class="line">ENSG00000213963                       346                       243</span><br><span class="line">ENSG00000185633                    153042                    114967</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000174514                       511</span><br><span class="line">ENSG00000249859                       415</span><br><span class="line">ENSG00000224490                      3772</span><br><span class="line">ENSG00000061656                      3020</span><br><span class="line">ENSG00000213963                       124</span><br><span class="line">ENSG00000185633                    114580</span><br><span class="line">&gt; dim(padj_top10)</span><br><span class="line">[1]  10 611</span><br><span class="line">&gt; colnames(padj_top10) &lt;- substr(colnames(padj_top10),1,15) <span class="comment"># 这里对列名作处理，为了后面与临床信息对应</span></span><br><span class="line">&gt; head(padj_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000174514            1784             295             511</span><br><span class="line">ENSG00000249859            3335            1050             415</span><br><span class="line">ENSG00000224490            8222             864            3772</span><br><span class="line">ENSG00000061656            3397            2055            3020</span><br><span class="line">ENSG00000213963             346             243             124</span><br><span class="line">ENSG00000185633          153042          114967          114580</span><br><span class="line"></span><br><span class="line">&gt; library(pROC) <span class="comment"># 加载ROC软件包</span></span><br><span class="line">&gt; par(mfrow=c(2,5)) <span class="comment"># 绘图区布局，2行5列</span></span><br><span class="line">&gt; group_number &lt;- as.factor(ifelse(group==<span class="string">"cancer"</span>,1,0))</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(padj_top10_id))&#123;</span><br><span class="line">+   plot.roc(group_number,as.numeric(padj_top10[i,]),main=padj_top10_symbol[i],</span><br><span class="line">+            print.auc=T, percent=T,cex.lab=1.5,print.auc.cex=1.5,col=i)</span><br><span class="line">+ &#125;</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA14.png" alt></p><p>换个角度，如果以FoldChange筛选排名前10的基因，结果如何？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">annot_order_FC &lt;- result_select_annot[order(abs(result_select_annot<span class="variable">$log2FoldChange</span>),decreasing = T),]</span><br><span class="line">head(annot_order_FC)</span><br><span class="line">FC_top10_symbol &lt;- head(annot_order_FC<span class="variable">$hgnc_symbol</span>,10)</span><br><span class="line">FC_top10_id &lt;- head(annot_order_FC<span class="variable">$ensembl_gene_id</span>,10)</span><br><span class="line">FC_top10 &lt;- data_select[match(FC_top10_id,rownames(data_select)),]</span><br><span class="line">colnames(FC_top10) &lt;- substr(colnames(FC_top10),1,15)</span><br><span class="line">head(FC_top10)[,1:3]</span><br><span class="line">dim(FC_top10)</span><br><span class="line"></span><br><span class="line">par(mfrow=c(2,5))</span><br><span class="line">group_number &lt;- as.factor(ifelse(group==<span class="string">"cancer"</span>,1,0))</span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(FC_top10_id))&#123;</span><br><span class="line">  plot.roc(group_number,as.numeric(FC_top10[i,]),main=FC_top10_symbol[i],</span><br><span class="line">           print.auc=T, percent=T,cex.lab=1.5,print.auc.cex=1.5,col=i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA15.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;得到差异表达结果之后，我们可以根据padj来挑选排名前10的基因，来绘制受试者工作曲线，评估这些基因是否能作为判断肿瘤的标志基因。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
</feed>
