<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2020-11-19T03:27:15.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BCFTOOLS VIEW 命令查看VCF文件</title>
    <link href="http://uteric.github.io/WES/bcftools_view/"/>
    <id>http://uteric.github.io/WES/bcftools_view/</id>
    <published>2020-11-19T03:27:15.000Z</published>
    <updated>2020-11-19T03:27:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>BCFTOOLS VIEW 可以用于查看VCF或BCF文件，VCF/BCF互相转换，提取子集，或进行过滤，用法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bcftools view [options] &lt;in.vcf.gz&gt; [region1 [...]]</span><br><span class="line"><span class="comment"># 只针对压缩的VCF文件，即vcf.gz，若不是压缩格式，先转换成压缩格式，比如现在有一个文件，xxx.vcf，使用bgzip进行压缩，</span></span><br><span class="line">&gt; bgzip xxx.vcf</span><br><span class="line"><span class="comment"># 得到xxx.vcf.gz，生成索引</span></span><br><span class="line">&gt; bcftools index -t xxx.vcf.gz</span><br><span class="line"><span class="comment"># 得到xxx.vcf.gz.tbi，即可开始使用BCFTOOLS VIEW进行操作</span></span><br></pre></td></tr></table></figure><p>参数如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">About:   VCF/BCF conversion, view, subset and filter VCF/BCF files.</span><br><span class="line">Usage:   bcftools view [options] &lt;in.vcf.gz&gt; [region1 [...]]</span><br><span class="line"></span><br><span class="line">Output options:</span><br><span class="line">    -G,   --drop-genotypes              drop individual genotype information (after subsetting <span class="keyword">if</span> -s option <span class="built_in">set</span>)</span><br><span class="line">    -h/H, --header-only/--no-header     <span class="built_in">print</span> the header only/suppress the header <span class="keyword">in</span> VCF output</span><br><span class="line">    -l,   --compression-level [0-9]     compression level: 0 uncompressed, 1 best speed, 9 best compression [-1]</span><br><span class="line">          --no-version                  <span class="keyword">do</span> not append version and <span class="built_in">command</span> line to the header</span><br><span class="line">    -o,   --output-file &lt;file&gt;          output file name [stdout]</span><br><span class="line">    -O,   --output-type &lt;b|u|z|v&gt;       b: compressed BCF, u: uncompressed BCF, z: compressed VCF, v: uncompressed VCF [v]</span><br><span class="line">    -r, --regions &lt;region&gt;              restrict to comma-separated list of regions</span><br><span class="line">    -R, --regions-file &lt;file&gt;           restrict to regions listed <span class="keyword">in</span> a file</span><br><span class="line">    -t, --targets [^]&lt;region&gt;           similar to -r but streams rather than index-jumps. Exclude regions with <span class="string">"^"</span> prefix</span><br><span class="line">    -T, --targets-file [^]&lt;file&gt;        similar to -R but streams rather than index-jumps. Exclude regions with <span class="string">"^"</span> prefix</span><br><span class="line">        --threads &lt;int&gt;                 number of extra (de)compression threads [0]</span><br><span class="line"></span><br><span class="line">Subset options:</span><br><span class="line">    -a, --trim-alt-alleles        trim alternate alleles not seen <span class="keyword">in</span> the subset</span><br><span class="line">    -I, --no-update               <span class="keyword">do</span> not (re)calculate INFO fields <span class="keyword">for</span> the subset (currently INFO/AC and INFO/AN)</span><br><span class="line">    -s, --samples [^]&lt;list&gt;       comma separated list of samples to include (or exclude with <span class="string">"^"</span> prefix)</span><br><span class="line">    -S, --samples-file [^]&lt;file&gt;  file of samples to include (or exclude with <span class="string">"^"</span> prefix)</span><br><span class="line">        --force-samples           only warn about unknown subset samples</span><br><span class="line"></span><br><span class="line">Filter options:</span><br><span class="line">    -c/C, --min-ac/--max-ac &lt;int&gt;[:&lt;<span class="built_in">type</span>&gt;]      minimum/maximum count <span class="keyword">for</span> non-reference (nref), 1st alternate (alt1), least frequent</span><br><span class="line">                                                   (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles [nref]</span><br><span class="line">    -f,   --apply-filters &lt;list&gt;                require at least one of the listed FILTER strings (e.g. <span class="string">"PASS,."</span>)</span><br><span class="line">    -g,   --genotype [^]&lt;hom|het|miss&gt;          require one or more hom/het/missing genotype or, <span class="keyword">if</span> prefixed with <span class="string">"^"</span>, exclude sites with hom/het/missing genotypes</span><br><span class="line">    -i/e, --include/--exclude &lt;expr&gt;            select/exclude sites <span class="keyword">for</span> <span class="built_in">which</span> the expression is <span class="literal">true</span> (see man page <span class="keyword">for</span> details)</span><br><span class="line">    -k/n, --known/--novel                       select known/novel sites only (ID is not/is <span class="string">'.'</span>)</span><br><span class="line">    -m/M, --min-alleles/--max-alleles &lt;int&gt;     minimum/maximum number of alleles listed <span class="keyword">in</span> REF and ALT (e.g. -m2 -M2 <span class="keyword">for</span> biallelic sites)</span><br><span class="line">    -p/P, --phased/--exclude-phased             select/exclude sites <span class="built_in">where</span> all samples are phased</span><br><span class="line">    -q/Q, --min-af/--max-af &lt;<span class="built_in">float</span>&gt;[:&lt;<span class="built_in">type</span>&gt;]    minimum/maximum frequency <span class="keyword">for</span> non-reference (nref), 1st alternate (alt1), least frequent</span><br><span class="line">                                                   (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles [nref]</span><br><span class="line">    -u/U, --uncalled/--exclude-uncalled         select/exclude sites without a called genotype</span><br><span class="line">    -v/V, --types/--exclude-types &lt;list&gt;        select/exclude comma-separated list of variant types: snps,indels,mnps,ref,bnd,other [null]</span><br><span class="line">    -x/X, --private/--exclude-private           select/exclude sites <span class="built_in">where</span> the non-reference alleles are exclusive (private) to the subset samples</span><br></pre></td></tr></table></figure><h2 id="一、查找条目"><a href="#一、查找条目" class="headerlink" title="一、查找条目"></a>一、查找条目</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt; bcftools view -e <span class="string">'GT="1|1"'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找不符合 GT="1|1" 的条目，并输出数量</span></span><br><span class="line">&gt; bcftools view -i <span class="string">'GT="1|1"'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找符合 GT="1|1" 的条目，并输出数量</span></span><br><span class="line"><span class="comment"># -i/e，前者是包含，后者是排除</span></span><br><span class="line">&gt; bcftools view -i <span class="string">'AF=0.500'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找符合 AF=0.500 的条目，并输出数量</span></span><br><span class="line">&gt; bcftools view -e <span class="string">'AF=0.500'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找不符合 AF=0.500 的条目，并输出数量</span></span><br><span class="line"><span class="comment"># 上面是针对VCF文件第8列，即INFO列，也可针对其他列，如QUAL或REF等</span></span><br><span class="line">&gt; bcftools view -i <span class="string">'QUAL=59.28'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找符合 QUAL=59.28 的条目，并输出数量</span></span><br><span class="line">&gt; bcftools view -e <span class="string">'QUAL=59.28'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找不符合 QUAL=59.28 的条目，并输出数量</span></span><br><span class="line"><span class="comment"># 特别注意，等号之后的字符串要加""，如REF="G"</span></span><br><span class="line">&gt; bcftools view -i <span class="string">'REF="G"'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找符合 QUAL=59.28 的条目，并输出数量</span></span><br><span class="line">&gt; bcftools view -e <span class="string">'REF="G"'</span> xxx.vcf.gz | wc -l <span class="comment"># 查找不符合 QUAL=59.28 的条目，并输出数量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 若需展示条目，可传递给less/more，</span></span><br><span class="line">&gt; bcftools view -i -H <span class="string">'GT="1|1"'</span> xxx.vcf.gz | less</span><br><span class="line"></span><br><span class="line"><span class="comment">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  sample1</span></span><br><span class="line">chr1    187485  .       G       A       2007.06 .       AC=2;AF=1;AN=2;CNN_1D=-0.124;DP=76;ExcessHet=3.0103;FS=0;MLEAC=2;MLEAF=1;MQ=39.48;QD=27.12;SOR=0.992    GT:AD:DP:GQ:PGT:PID:PL:PS       1|1:0,74:74:99:1|1:187485_G_A:2021,221,0:187485</span><br><span class="line">chr1    827209  .       G       C       255.97  .       AC=2;AF=1;AN=2;CNN_1D=1.611;DP=6;ExcessHet=3.0103;FS=0;MLEAC=2;MLEAF=1;MQ=49.2;QD=27.24;SOR=0.693       GT:AD:DP:GQ:PGT:PID:PL:PS       1|1:0,6:6:18:1|1:827209_G_C:270,18,0:827209</span><br><span class="line">chr1    827212  .       C       G       255.97  .       AC=2;AF=1;AN=2;CNN_1D=2.44;DP=6;ExcessHet=3.0103;FS=0;MLEAC=2;MLEAF=1;MQ=49.2;QD=28.2;SOR=0.693 GT:AD:DP:GQ:PGT:PID:PL:PS       1|1:0,6:6:18:1|1:827209_G_C:270,18,0:827209</span><br><span class="line">chr1    827221  .       T       C       255.97  .       AC=2;AF=1;AN=2;CNN_1D=1.913;DP=6;ExcessHet=3.0103;FS=0;MLEAC=2;MLEAF=1;MQ=49.2;QD=25;SOR=0.693  GT:AD:DP:GQ:PGT:PID:PL:PS       1|1:0,6:6:18:1|1:827209_G_C:270,18,0:827209</span><br></pre></td></tr></table></figure><h2 id="二、提取INDEL-SNP"><a href="#二、提取INDEL-SNP" class="headerlink" title="二、提取INDEL/SNP"></a>二、提取INDEL/SNP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&gt; bcftools view -v indels xxx.vcf.gz | wc -l</span><br><span class="line"><span class="comment"># 11993</span></span><br><span class="line">&gt; bcftools view -v indels xxx.vcf.gz | less</span><br><span class="line"><span class="comment">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  sample1</span></span><br><span class="line">chr1    15903   .       G       GC      59.28   .       AC=2;AF=1;AN=2;CNN_1D=-0.8;DP=3;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=30.13;QD=29.64;SOR=2.303     GT:AD:DP:GQ:PL  1/1:0,2:2:6:71,6,0</span><br><span class="line">chr1    16734   .       TG      T       31.6    .       AC=1;AF=0.5;AN=2;BaseQRankSum=-0.674;CNN_1D=-6.239;DP=10;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=32.17;MQRankSum=-0.14;QD=3.51;ReadPosRankSum=-0.921;SOR=0.132       GT:AD:DP:GQ:PL  0/1:7,2:9:39:39,0,197</span><br><span class="line">chr1    19190   .       GC      G       32.6    .       AC=1;AF=0.5;AN=2;BaseQRankSum=-0.669;CNN_1D=-7.533;DP=13;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=31.81;MQRankSum=-2.12;QD=2.51;ReadPosRankSum=0.099;SOR=0.33 GT:AD:DP:GQ:PL  0/1:11,2:13:40:40,0,330</span><br><span class="line">chr1    63735   .       CCTA    C       367.61  .       AC=1;AF=0.5;AN=2;BaseQRankSum=0.385;CNN_1D=0.827;DP=12;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=46.67;MQRankSum=0.385;QD=25.36;ReadPosRankSum=0.674;SOR=0.307 GT:AD:DP:GQ:PL  0/1:1,9:10:15:375,0,15</span><br><span class="line">chr1    189392  .       ACC     A       2306.03 .       AC=2;AF=1;AN=2;BaseQRankSum=-1.809;CNN_1D=0.211;DP=57;ExcessHet=3.0103;FS=0;MLEAC=2;MLEAF=1;MQ=35.61;MQRankSum=1.12;QD=28.73;ReadPosRankSum=1.48;SOR=0.504      GT:AD:DP:GQ:PL  1/1:1,53:54:99:2320,118,0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以直接输出文件，</span></span><br><span class="line">&gt; bcftools view -v indels xxx.vcf.gz &gt; indel.vcf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同理，提取SNP,</span></span><br><span class="line">&gt; bcftools view -v snps xxx.vcf.gz | wc -l</span><br><span class="line"><span class="comment"># 58314</span></span><br><span class="line">&gt; bcftools view -v snps xxx.vcf.gz | less</span><br><span class="line"><span class="comment">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  sample1</span></span><br><span class="line">chr1    16495   .       G       C       36.65   .       AC=1;AF=0.5;AN=2;BaseQRankSum=-0.967;CNN_1D=-4.292;DP=3;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=22;MQRankSum=0;QD=12.22;ReadPosRankSum=0.967;SOR=1.179       GT:AD:DP:GQ:PL  0/1:1,2:3:18:44,0,18</span><br><span class="line">chr1    17614   .       G       A       54.64   .       AC=1;AF=0.5;AN=2;BaseQRankSum=0;CNN_1D=-0.693;DP=5;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=47.88;MQRankSum=-1.645;QD=10.93;ReadPosRankSum=1.04;SOR=1.179     GT:AD:DP:GQ:PL  0/1:2,3:5:35:62,0,35</span><br><span class="line">chr1    19322   .       C       T       44.64   .       AC=1;AF=0.5;AN=2;BaseQRankSum=0.703;CNN_1D=-3.724;DP=8;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=38.66;MQRankSum=-0.956;QD=5.58;ReadPosRankSum=0.414;SOR=0.818 GT:AD:DP:GQ:PGT:PID:PL:PS       0|1:5,3:8:52:0|1:19322_C_T:52,0,140:19322</span><br><span class="line">chr1    19342   .       G       A       58.64   .       AC=1;AF=0.5;AN=2;BaseQRankSum=1.65;CNN_1D=-3.127;DP=5;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=41.16;MQRankSum=-0.524;QD=11.73;ReadPosRankSum=-1.036;SOR=1.609        GT:AD:DP:GQ:PGT:PID:PL:PS       0|1:3,2:5:66:1|0:19322_C_T:66,0,116:19322</span><br><span class="line">chr1    29443   .       A       G       41.32   .       AC=2;AF=1;AN=2;CNN_1D=-3.532;DP=3;ExcessHet=3.0103;FS=0;MLEAC=1;MLEAF=0.5;MQ=22;QD=20.66;SOR=2.303      GT:AD:DP:GQ:PL  1/1:0,2:2:6:53,6,0</span><br><span class="line"><span class="comment"># 直接输出文件</span></span><br><span class="line">&gt; bcftools view -v snps xxx.vcf.gz &gt; snp.vcf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这个VCF总条目数为70294，INDEL=11993，SNP=58314，合计70307，是否有既是SNP又是INDEL的条目？</span></span><br><span class="line">&gt; bcftools view -v indels xxx.vcf.gz | bcftools view -v snps | wc -l</span><br><span class="line"><span class="comment"># 511</span></span><br><span class="line">&gt; bcftools view -v indels xxx.vcf.gz | bcftools view -v snps | less</span><br><span class="line"></span><br><span class="line"><span class="comment">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  sample1</span></span><br><span class="line">chr1    78005376        .       T       C,TTC   268.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=0.499;DP=9;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=29.78;SOR=1.402 GT:AD:DP:GQ:PL  1/2:0,6,3:9:84:285,101,84,175,0,196</span><br><span class="line">chr10   58717368        .       A       C,AC    329.06  .       AC=1,1;AF=0.5,0.5;AN=2;BaseQRankSum=2.17;CNN_1D=0.755;DP=13;ExcessHet=3.0103;FS=3.358;MLEAC=1,1;MLEAF=0.5,0.5;MQ=58.98;MQRankSum=0;QD=25.31;ReadPosRankSum=1.61;SOR=0.707       GT:AD:DP:GQ:PL  1/2:1,7,5:13:99:346,129,102,168,0,202</span><br><span class="line">chr13   35044829        .       TAG     T,GAG   110.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=0.437;DP=4;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=27.51;SOR=0.693 GT:AD:DP:GQ:PL  1/2:0,2,2:4:49:127,49,78,84,0,78</span><br><span class="line">chr13   40558927        .       G       T,GT    150.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=-0.053;DP=5;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=27.85;SOR=0.693        GT:AD:DP:GQ:PL  1/2:0,2,2:4:62:167,72,62,74,0,64</span><br><span class="line">chr17   67072015        .       A       AC,C    395.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=0.428;DP=10;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=28.72;SOR=1.863        GT:AD:DP:GQ:PL  1/2:0,4,4:8:89:412,119,89,119,0,89</span><br><span class="line">chr17   76292181        .       T       C,TGCTGAACTGCACCAGGTTGGACCAAACCAC       425.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=3.964;DP=19;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=26.76;SOR=1.27 GT:AD:DP:GQ:PL  1/2:0,7,4:11:99:442,150,230,184,0,200</span><br><span class="line">chr2    97151827        .       C       CT,T    441.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=0.512;DP=12;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=29.84;QD=31.8;SOR=1.022      GT:AD:DP:GQ:PL  1/2:0,6,6:12:99:458,217,193,220,0,234</span><br><span class="line">chr2    197008003       .       T       TTCTC,C 235.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=3.73;DP=6;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=31.03;SOR=0.693  GT:AD:DP:GQ:PL  1/2:0,4,2:6:31:252,49,31,99,0,81</span><br><span class="line">chr22   24755923        .       CA      C,AA    209.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=1.317;DP=8;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=29.87;SOR=0.941 GT:AD:DP:GQ:PL  1/2:0,4,3:7:62:226,82,62,103,0,119</span><br><span class="line">chr3    149515881       .       T       G,TTG   280.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=1.794;DP=9;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=31.12;SOR=0.892 GT:AD:DP:GQ:PL  1/2:0,4,5:9:96:297,208,194,96,0,132</span><br><span class="line">chr6    125929252       .       T       TAAAA,A 193.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=1.255;DP=5;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=28.92;SOR=1.022 GT:AD:DP:GQ:PL  1/2:0,2,3:5:69:210,97,88,80,0,69</span><br><span class="line">chr7    98315625        .       A       ATAAT,T 371.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=1.314;DP=10;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=33.02;SOR=0.941        GT:AD:DP:GQ:PL  1/2:0,5,2:7:28:388,58,28,148,0,120</span><br><span class="line">chr8    19404624        .       T       A,TATA  295.06  .       AC=1,1;AF=0.5,0.5;AN=2;CNN_1D=1.322;DP=11;ExcessHet=3.0103;FS=0;MLEAC=1,1;MLEAF=0.5,0.5;MQ=60;QD=31.75;SOR=1.179        GT:AD:DP:GQ:PL  1/2:0,2,4:8:59:312,193,178,59,0,67</span><br><span class="line">(END)</span><br><span class="line"><span class="comment"># 果如预料，在13个条目中，二倍体中的两个等位基因皆发生突变，而且突变后的ALT不同，因此，会同时被认定是INDEL或SNP</span></span><br><span class="line"><span class="comment"># 注意，上面提到INDEL+SNP=70307，而文件的总条目是70294，多出13条，代表有13条记录既是INDEL又是SNP，我们确实看到13条相应的条目，但为何使用“wc -l”命令查看时却有511条记录呢？这是因为VCF文件头部有注释行，正确的查看方式是使用"grep -v "^#""命令，略过注释行</span></span><br><span class="line"></span><br><span class="line">&gt; bcftools view -v indels xxx.vcf.gz | bcftools view -v snps | grep -v <span class="string">"^#"</span> | wc -l</span><br><span class="line"><span class="comment"># 13</span></span><br><span class="line"></span><br><span class="line">相应地，我们看一下真实的INDEL与SNP的条目数，</span><br><span class="line">&gt; bcftools view -v snps xxx.vcf.gz | grep -v <span class="string">"^#"</span> | wc -l</span><br><span class="line"><span class="comment"># 57817，相比58314，少497行，即有497行注释</span></span><br><span class="line">bcftools view -v indels xxx.vcf.gz | grep -v <span class="string">"^#"</span> | wc -l</span><br><span class="line"><span class="comment"># 11496，相比11993，少少497行，即有497行注释</span></span><br><span class="line"><span class="comment"># 另外，同时是INDEL和SNP的行有13行，如果加上注释为511行，注释497行，还有一行是标题行</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;BCFTOOLS VIEW 可以用于查看VCF或BCF文件，VCF/BCF互相转换，提取子集，或进行过滤，用法如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cl
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="VCF" scheme="http://uteric.github.io/tags/VCF/"/>
    
  </entry>
  
  <entry>
    <title>理解VCF文件</title>
    <link href="http://uteric.github.io/WES/vcf_file/"/>
    <id>http://uteric.github.io/WES/vcf_file/</id>
    <published>2020-11-18T21:04:56.000Z</published>
    <updated>2020-11-18T21:04:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>VCF（Variant Call Format），是存储变异信息的文件格式，包括SNP（单核苷酸多态性，指单碱基变异）、INDEL（插入或缺失，指短片段变异）、SV（结构变异，指长片段变异）、CNV（拷贝数变异）。</p><h2 id="一、VCF文件内容"><a href="#一、VCF文件内容" class="headerlink" title="一、VCF文件内容"></a>一、VCF文件内容</h2><p>VCF文件包含两个部分，注释与主体。注释部分以##开头，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##fileformat=VCFv4.2</span></span><br><span class="line"><span class="comment"># VCF版本号</span></span><br><span class="line"><span class="comment">##ALT=&lt;ID=NON_REF,Description="Represents any possible alternative allele not already represented at this location by REF and ALT"&gt;</span></span><br><span class="line"><span class="comment">##FILTER=&lt;ID=LowQual,Description="Low quality"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=AD,Number=R,Type=Integer,Description="Allelic depths for the ref and alt alleles in the order listed"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description="Approximate read depth (reads with MQ=255 or with bad mates are filtered)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description="Genotype Quality"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=MIN_DP,Number=1,Type=Integer,Description="Minimum DP observed within the GVCF block"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PGT,Number=1,Type=String,Description="Physical phasing haplotype information, describing how the alternate alleles are phased in relation to one another; will always be heterozygous and is not intended to describe called alleles"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PID,Number=1,Type=String,Description="Physical phasing ID information, where each unique ID within a given sample (but not across samples) connects records within a phasing group"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PL,Number=G,Type=Integer,Description="Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PS,Number=1,Type=Integer,Description="Phasing set (typically the position of the first variant in the set)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=RGQ,Number=1,Type=Integer,Description="Unconditional reference genotype confidence, encoded as a phred quality -10*log10 p(genotype call is wrong)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=SB,Number=4,Type=Integer,Description="Per-sample component statistics which comprise the Fisher's Exact Test to detect strand bias."&gt;</span></span><br><span class="line"><span class="comment"># 上面这些信息都是对主体内容的解释，主体内容中的任何缩写在注释信息中都找得到，比如，ALT表示NON_REF，“Represents any possible alternative allele not already represented at this location by REF and ALT”；下面是FORMAT信息，包括AD，DP，GQ，GT，MIN_DP，PGT，PID等，比如，AD表示“Allelic depths for the ref and alt alleles in the order listed”，即参考序列与实际序列的位点深度。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##GATKCommandLine=&lt;ID=CNNScoreVariants,CommandLine="CNNScoreVariants  --output /gatk/my_data/wes/sample/annotate/annotated.vcf --disable-avx-check true --variant /gatk/my_data/wes/sample/caller/output.vcf.gz --reference /gatk/my_data/ncbi/hg38/chroms/hg38.fa  --tensor-type reference --window-size 128 --read-limit 128 --filter-symbolic-and-sv false --info-annotation-keys MQ --info-annotation-keys DP --info-annotation-keys SOR --info-annotation-keys FS --info-annotation-keys QD --info-annotation-keys MQRankSum --info-annotation-keys ReadPosRankSum --inference-batch-size 256 --transfer-batch-size 512 --inter-op-threads 0 --intra-op-threads 0 --output-tensor-dir  --enable-journal false --keep-temp-file false --interval-set-rule UNION --interval-padding 0 --interval-exclusion-padding 0 --interval-merging-rule ALL --read-validation-stringency SILENT --seconds-between-progress-updates 10.0 --disable-sequence-dictionary-validation false --create-output-bam-index true --create-output-bam-md5 false --create-output-variant-index true --create-output-variant-md5 false --lenient false --add-output-sam-program-record true --add-output-vcf-command-line true --cloud-prefetch-buffer 40 --cloud-index-prefetch-buffer -1 --disable-bam-index-caching false --sites-only-vcf-output false --help false --version false --showHidden false --verbosity INFO --QUIET false --use-jdk-deflater false --use-jdk-inflater false --gcs-max-retries 20 --gcs-project-for-requester-pays  --disable-tool-default-read-filters false --read-group-black-list ID:ArtificialHaplotypeRG --read-group-black-list ID:ArtificialHaplotype",Version="4.1.3.0",Date="November 12, 2020 1:29:06 AM UTC"&gt;</span></span><br><span class="line"><span class="comment"># 接着，是使用过的程序及命令甚至时间，非常详细</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##INFO=&lt;ID=AC,Number=A,Type=Integer,Description="Allele count in genotypes, for each ALT allele, in the same order as listed"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=AF,Number=A,Type=Float,Description="Allele Frequency, for each ALT allele, in the same order as listed"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=AN,Number=1,Type=Integer,Description="Total number of alleles in called genotypes"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=BaseQRankSum,Number=1,Type=Float,Description="Z-score from Wilcoxon rank sum test of Alt Vs. Ref base qualities"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=CNN_1D,Number=1,Type=Float,Description="Log odds of being a true variant versus being false under the trained 1D Convolutional Neural Network"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=DP,Number=1,Type=Integer,Description="Approximate read depth; some reads may have been filtered"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=END,Number=1,Type=Integer,Description="Stop position of the interval"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=ExcessHet,Number=1,Type=Float,Description="Phred-scaled p-value for exact test of excess heterozygosity"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=FS,Number=1,Type=Float,Description="Phred-scaled p-value using Fisher's exact test to detect strand bias"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=InbreedingCoeff,Number=1,Type=Float,Description="Inbreeding coefficient as estimated from the genotype likelihoods per-sample when compared against the Hardy-Weinberg expectation"&gt;</span></span><br><span class="line"><span class="comment">##INFO=&lt;ID=MLEAC,Number=A,Type=Integer,Description="Maximum likelihood expectation (MLE) for the allele counts (not necessarily the same as the AC), for each ALT allele, in the same order as listed"&gt;</span></span><br><span class="line"><span class="comment"># 后面是INFO，包括AC，AF，AN，DP，FS等标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrX,length=156040895&gt;</span></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrX_KI270880v1_alt,length=284869&gt;</span></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrX_KI270881v1_alt,length=144206&gt;</span></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrX_KI270913v1_alt,length=274009&gt;</span></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrY,length=57227415&gt;</span></span><br><span class="line"><span class="comment">##contig=&lt;ID=chrY_KI270740v1_random,length=37240&gt;</span></span><br><span class="line"><span class="comment"># 接着，是长长的contig，记录每条染色体以及长度，以及source信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##source=CNNScoreVariants</span></span><br><span class="line"><span class="comment">##source=GenotypeGVCFs</span></span><br><span class="line"><span class="comment">##source=HaplotypeCaller</span></span><br></pre></td></tr></table></figure><p>主体部分没有#号，共10列：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  sample1</span></span><br><span class="line">chr1    15903   .       G       GC      59.28   .       AC=2;AF=1.00;AN=2;CNN_1D=-0.800;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303  GT:AD:DP:GQ:PL  1/1:0,2:2:6:71,6,0</span><br><span class="line">chr1    16495   .       G       C       36.65   .       AC=1;AF=0.500;AN=2;BaseQRankSum=-9.670e-01;CNN_1D=-4.292;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=22.00;MQRankSum=0.00;QD=12.22;ReadPosRankSum=0.967;SOR=1.179     GT:AD:DP:GQ:PL  0/1:1,2:3:18:44,0,18</span><br><span class="line">chr1    16734   .       TG      T       31.60   .       AC=1;AF=0.500;AN=2;BaseQRankSum=-6.740e-01;CNN_1D=-6.239;DP=10;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=32.17;MQRankSum=-1.400e-01;QD=3.51;ReadPosRankSum=-9.210e-01;SOR=0.132  GT:AD:DP:GQ:PL  0/1:7,2:9:39:39,0,197</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里列举三行</span></span><br><span class="line"><span class="comment"># CHROM，染色体</span></span><br><span class="line"><span class="comment"># POS，位置，“with the 1st base having position 1”</span></span><br><span class="line"><span class="comment"># ID，对应dbSNP数据库中的ID，默认未设置，为"."</span></span><br><span class="line"><span class="comment"># REF，参考序列，A,C,G,T,N</span></span><br><span class="line"><span class="comment"># ALT，实际序列，A,C,G,T,N,*</span></span><br><span class="line"><span class="comment"># QUAL，质量分数，这个数值有必要解释一下，根据VCF说明文件，“Phred-scaled quality score for the assertion made in ALT. i.e. −10log10 prob(call in ALT is wrong). If ALT is ‘.’ (no variant) then this is −10log10 prob(variant), and if ALT is not ‘.’ this is −10log10 prob(no variant). If unknown, the missing value should be specified. (Numeric)”，即 QUAL= −10log10 prob，此处的prob是错误概率，比如prob = 0.01，则QUAL= −10log10x0.01 = 20，即当QUAL=20时，ALT可能出错的概率是0.01，即可能正确的概率是0.99。质量分数是我们在判断一个位点的突变是否为真突变的主要参考，在后面的过滤中还会用到。</span></span><br><span class="line"><span class="comment"># FILTER，是否满足过滤条件，说明：“ PASS if this position has passed all filters, i.e., a call is made at this position. Otherwise, if the site has not passed all filters, a semicolon-separated list of codes for filters that fail. e.g. “q10;s50” might indicate that at this site the quality is below 10 and the number of samples with data is below 50% of the total number of samples. ‘0’ is reserved and should not be used as a filter String. If filters have not been applied, then this field should be set to the missing value. (String, no white-space or semi-colons permitted)，若满足所有过滤条件，则显示PASS，若某个过滤条件不满足，则显示不满足过滤条件，多个过滤条件之间用分号分隔；在这个例子中，FILTER这一项是"."，代表未被过滤。</span></span><br><span class="line"><span class="comment"># INFO，额外信息，包括多个字段，用分号分隔，如本例中的“AC=2;AF=1.00;AN=2”。</span></span><br><span class="line"><span class="comment"># 关于INFO字段，详细信息如下：</span></span><br><span class="line">• AA : ancestral allele</span><br><span class="line">• AC : allele count <span class="keyword">in</span> genotypes, <span class="keyword">for</span> each ALT allele, <span class="keyword">in</span> the same order as listed</span><br><span class="line">• AF : allele frequency <span class="keyword">for</span> each ALT allele <span class="keyword">in</span> the same order as listed: use this when estimated from primary data, not called genotypes</span><br><span class="line">• AN : total number of alleles <span class="keyword">in</span> called genotypes</span><br><span class="line"><span class="comment"># AC=2;AF=1.00;AN=2，代表二倍体，该位点有2个等位基因，2个发生变异，突变等位基因为100%，即纯合突变。</span></span><br><span class="line">• BQ : RMS base quality at this position</span><br><span class="line">• CIGAR : cigar string describing how to align an alternate allele to the reference allele</span><br><span class="line">• DB : dbSNP membership</span><br><span class="line">• DP : combined depth across samples, e.g. DP=154</span><br><span class="line">• END : end position of the variant described <span class="keyword">in</span> this record (<span class="keyword">for</span> use with symbolic alleles)</span><br><span class="line">• H2 : membership <span class="keyword">in</span> hapmap2</span><br><span class="line">• H3 : membership <span class="keyword">in</span> hapmap3</span><br><span class="line">• MQ : RMS mapping quality, e.g. MQ=52</span><br><span class="line">• MQ0 : Number of MAPQ == 0 reads covering this record</span><br><span class="line">• NS : Number of samples with data</span><br><span class="line">• SB : strand bias at this position</span><br><span class="line">• SOMATIC : indicates that the record is a somatic mutation, <span class="keyword">for</span> cancer genomics</span><br><span class="line">• VALIDATED : validated by follow-up experiment</span><br><span class="line">• 1000G : membership <span class="keyword">in</span> 1000 Genomes</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;VCF（Variant Call Format），是存储变异信息的文件格式，包括SNP（单核苷酸多态性，指单碱基变异）、INDEL（插入或缺失，指短片段变异）、SV（结构变异，指长片段变异）、CNV（拷贝数变异）。&lt;/p&gt;
&lt;h2 id=&quot;一、VCF文件内容&quot;&gt;&lt;a hre
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="VCF" scheme="http://uteric.github.io/tags/VCF/"/>
    
  </entry>
  
  <entry>
    <title>R中去除某列中重复的值</title>
    <link href="http://uteric.github.io/R/duplicate/"/>
    <id>http://uteric.github.io/R/duplicate/</id>
    <published>2020-11-17T20:12:52.000Z</published>
    <updated>2020-11-17T20:12:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，如果要将data.frame的某一列转化为行名，则不能有重复，否则会报错，简单的办法就是对要操作的列进行去重，比如</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现在，data是data.frame，35976行</span></span><br><span class="line">&gt; dim(data)</span><br><span class="line">[1] 35976    39</span><br><span class="line">&gt; head(data<span class="variable">$X</span>)</span><br><span class="line">[1] Adora1 Sntg1  Adgrb3 Prim2  Cflar  Obsl1 </span><br><span class="line">35974 Levels: 0610005C13Rik 0610006L08Rik 0610007P14Rik ... Zzz3 </span><br><span class="line"><span class="comment"># 要操作的列有35976行，但是Levels=35974，说明有两行有重复，看一下重复的两行</span></span><br><span class="line">&gt; x &lt;- duplicated(data<span class="variable">$X</span>)</span><br><span class="line">&gt; data[x,]<span class="variable">$X</span></span><br><span class="line">[1] 43891 43892</span><br><span class="line">35974 Levels: 0610005C13Rik 0610006L08Rik 0610007P14Rik ... Zzz3</span><br><span class="line"><span class="comment"># data$X这一列中，重复的值是43891和43892，下面去掉重复的值</span></span><br><span class="line">&gt; data2 &lt;- data[!duplicated(data<span class="variable">$X</span>),]</span><br><span class="line"><span class="comment"># 去掉重复的行后，剩下35974行</span></span><br><span class="line">&gt; head(data2<span class="variable">$X</span>)</span><br><span class="line">[1] Adora1 Sntg1  Adgrb3 Prim2  Cflar  Obsl1 </span><br><span class="line">35974 Levels: 0610005C13Rik 0610006L08Rik 0610007P14Rik ... Zzz3</span><br><span class="line">&gt; dim(data2)</span><br><span class="line">[1] 35974    39</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，如果要将data.frame的某一列转化为行名，则不能有重复，否则会报错，简单的办法就是对要操作的列进行去重，比如&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>clusterProfiler富集分析将ID转换为SYMBOL</title>
    <link href="http://uteric.github.io/RNASEQ/KEGG_ID_symbol/"/>
    <id>http://uteric.github.io/RNASEQ/KEGG_ID_symbol/</id>
    <published>2020-11-17T18:31:36.000Z</published>
    <updated>2020-11-17T18:31:36.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">library(clusterProfiler)</span><br><span class="line">library(org.Mm.eg.db)</span><br><span class="line"></span><br><span class="line">&gt; X &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Mm.eg.db'</span>)</span><br><span class="line">&gt; EGG &lt;- enrichKEGG(gene= X<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'mmu'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line"><span class="comment"># 默认情况下，如果将EGG转为data.frame，ID这一行显示“ENTREZID”</span></span><br><span class="line">&gt; <span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">IDDescriptionGeneRatioBgRatiopvaluep.adjustqvaluegeneIDCount</span><br><span class="line">mmu04066mmu04066HIF-1 signaling pathway11/171114/89101.10E-050.0023158450.002137347228026/18127/14254/16828/11674/18641/11676/15251/112407/56421/2233911</span><br><span class="line">mmu00010mmu00010Glycolysis / Gluconeogenesis8/17167/89103.89E-050.003193740.00294757814751/14447/16828/11674/18746/18641/11676/564218</span><br><span class="line">mmu05230mmu05230Central carbon metabolism <span class="keyword">in</span> cancer8/17169/89104.82E-050.003193740.002947578228026/16828/18746/18641/80879/15251/56421/185968</span><br><span class="line">mmu04015mmu04015Rap1 signaling pathway14/171214/89106.05E-050.003193740.00294757814810/13636/14254/16542/244668/23880/29857/16415/240168/22339/18596/106952/20469/1939514</span><br><span class="line">mmu00030mmu00030Pentose phosphate pathway5/17133/89100.0003770440.0159112750.01468488914751/11674/18641/11676/564215</span><br><span class="line">mmu04330mmu04330Notch signaling pathway6/17154/89100.0005511440.0193818980.01788800818128/433586/15214/16450/18131/181326</span><br><span class="line"></span><br><span class="line"><span class="comment"># 若需显示SYMBOL，使用如下命令：</span></span><br><span class="line">&gt; <span class="built_in">test</span> &lt;- setReadable(EGG, OrgDb = org.Mm.eg.db, keyType=<span class="string">"ENTREZID"</span>)</span><br><span class="line"></span><br><span class="line">IDDescriptionGeneRatioBgRatiopvaluep.adjustqvaluegeneIDCount</span><br><span class="line">mmu04066HIF-1 signaling pathway11/171114/89101.10E-050.0023158450.002137347Pdk1/Nos3/Flt1/Ldha/Aldoa/Pfkl/Aldoc/Hif1a/Egln3/Pfkp/Vegfa11</span><br><span class="line">mmu00010Glycolysis / Gluconeogenesis8/17167/89103.89E-050.003193740.002947578Gpi1/Gapdhs/Ldha/Aldoa/Pkm/Pfkl/Aldoc/Pfkp8</span><br><span class="line">mmu05230Central carbon metabolism <span class="keyword">in</span> cancer8/17169/89104.82E-050.003193740.002947578Pdk1/Ldha/Pkm/Pfkl/Slc16a3/Hif1a/Pfkp/Pdgfrb8</span><br><span class="line">mmu04015Rap1 signaling pathway14/171214/89106.05E-050.003193740.002947578Grin1/Efna1/Flt1/Kdr/Sipa1l2/Fyb/Mapk12/Itgb2l/Rasgrp3/Vegfa/Pdgfrb/Arap3/Sipa1/Rasgrp214</span><br><span class="line">mmu00030Pentose phosphate pathway5/17133/89100.0003770440.0159112750.014684889Gpi1/Aldoa/Pfkl/Aldoc/Pfkp5</span><br><span class="line">mmu04330Notch signaling pathway6/17154/89100.0005511440.0193818980.017888008Notch1/Maml3/Hey2/Jag2/Notch3/Notch46</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="KEGG" scheme="http://uteric.github.io/tags/KEGG/"/>
    
  </entry>
  
  <entry>
    <title>在IGV中可视化VCF文件</title>
    <link href="http://uteric.github.io/WES/vcf_igv/"/>
    <id>http://uteric.github.io/WES/vcf_igv/</id>
    <published>2020-11-17T15:24:20.000Z</published>
    <updated>2020-11-17T15:24:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>VCF是Variant Call Format的首字母缩写，是存储变异信息的文件格式，在进行下游分析之前，我们先在IGV中对VCF进行简单的可视化，以有直观的印象，当然，也可检查特定位点是否存在突变，这可以帮助判断某单基因疾病是否由某基因的突变所致。</p><p>首先，启动IGV，安装教程见前面的文章。</p><p>检查VCF文件是否有对应的索引文件(vcf.idx)，如有索引，可以直接载入IGV，如无索引，使用tabix命令生成索引，并载入IGV中，如下图</p><p><img src="/images/WES/vcf01.png" alt></p><p>从上图中可以看出，对于样本，分为深蓝与青色，深蓝代表杂合突变，青色代表纯合突变，</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;VCF是Variant Call Format的首字母缩写，是存储变异信息的文件格式，在进行下游分析之前，我们先在IGV中对VCF进行简单的可视化，以有直观的印象，当然，也可检查特定位点是否存在突变，这可以帮助判断某单基因疾病是否由某基因的突变所致。&lt;/p&gt;
&lt;p&gt;首先，启
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="VCF" scheme="http://uteric.github.io/tags/VCF/"/>
    
  </entry>
  
  <entry>
    <title>绘制VENN图</title>
    <link href="http://uteric.github.io/R/venn_plot/"/>
    <id>http://uteric.github.io/R/venn_plot/</id>
    <published>2020-11-16T22:16:48.000Z</published>
    <updated>2020-11-16T22:16:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>这个教程是使用VennDiagram程序绘制简洁美观的VENN（韦恩图），最多支持五组数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(VennDiagram)</span><br><span class="line"><span class="comment"># 准备3组数据</span></span><br><span class="line">&gt; x &lt;- c(1:35)</span><br><span class="line">&gt; y &lt;- c(27:80)</span><br><span class="line">&gt; z &lt;- c(22:50,90:100)</span><br><span class="line">&gt; x</span><br><span class="line"> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24</span><br><span class="line">[25] 25 26 27 28 29 30 31 32 33 34 35</span><br><span class="line">&gt; y</span><br><span class="line"> [1] 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span><br><span class="line">[25] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74</span><br><span class="line">[49] 75 76 77 78 79 80</span><br><span class="line">&gt; z</span><br><span class="line"> [1]  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39</span><br><span class="line">[19]  40  41  42  43  44  45  46  47  48  49  50  90  91  92  93  94  95  96</span><br><span class="line">[37]  97  98  99 100</span><br><span class="line"><span class="comment"># 画图</span></span><br><span class="line">&gt; v &lt;- venn.diagram(x=list(X=x,Y=y,Z=z),</span><br><span class="line">+                   filename = NULL,</span><br><span class="line">+                   col = c(<span class="string">"blue"</span>, <span class="string">"red"</span>,<span class="string">"green"</span>),lwd=3,cex=2,cat.cex=1.5,</span><br><span class="line">+                   alpha = 0.50,margin=0.1)</span><br><span class="line">&gt; grid.draw(v)</span><br></pre></td></tr></table></figure><p><img src="/images/R/venn01.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;这个教程是使用VennDiagram程序绘制简洁美观的VENN（韦恩图），最多支持五组数据&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>在R中将向量转换成表格</title>
    <link href="http://uteric.github.io/R/text_to_table/"/>
    <id>http://uteric.github.io/R/text_to_table/</id>
    <published>2020-11-16T21:54:55.000Z</published>
    <updated>2020-11-16T21:54:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，对于长向量，如果需要展示，直接打印不够美观，可以将其转换为表格，美观而且直白，可以使用ggtexttable这个函数，比如，我们现在有一个向量，有许多基因名称，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x是"character",长度是388</span></span><br><span class="line">&gt; class(x)</span><br><span class="line">[1] <span class="string">"character"</span></span><br><span class="line">&gt; x</span><br><span class="line">[1] <span class="string">"Adora1"</span>        <span class="string">"Dock10"</span>        <span class="string">"Rcsd1"</span>         <span class="string">"Myo1b"</span>        </span><br><span class="line">  [5] <span class="string">"Hecw2"</span>         <span class="string">"Raph1"</span>         <span class="string">"Serpine2"</span>      <span class="string">"Fam129a"</span>      </span><br><span class="line">  [9] <span class="string">"Ncf2"</span>          <span class="string">"Pappa2"</span>        <span class="string">"Sox17"</span>         <span class="string">"Tram2"</span>        </span><br><span class="line"> [13] <span class="string">"Mpp4"</span>          <span class="string">"Ino80d"</span>        <span class="string">"Igfbp5"</span>        <span class="string">"Tmbim1"</span>       </span><br><span class="line"> [17] <span class="string">"Dnajb3"</span>        <span class="string">"Acmsd"</span>         <span class="string">"Mdm4"</span>          <span class="string">"Hlx"</span>          </span><br><span class="line"> [21] <span class="string">"Smyd2"</span>         <span class="string">"Cd34"</span>          <span class="string">"Zeb2"</span>          <span class="string">"Rbms1"</span>        </span><br><span class="line"> [25] <span class="string">"Grin1"</span>         <span class="string">"Grin1os"</span>       <span class="string">"Notch1"</span>        <span class="string">"Adamts13"</span>     </span><br><span class="line"> [29] <span class="string">"Baz2b"</span>         <span class="string">"Pla2r1"</span>        <span class="string">"Dpp4"</span>          <span class="string">"Itgav"</span>        </span><br><span class="line"> [33] <span class="string">"Tnks1bp1"</span>      <span class="string">"D430041D05Rik"</span> <span class="string">"Meis2"</span>         <span class="string">"Cdan1"</span>        </span><br><span class="line"> [37] <span class="string">"Sema6d"</span>        <span class="string">"Zmynd8"</span>        <span class="string">"Lama5"</span>         <span class="string">"Il15ra"</span>       </span><br><span class="line"> [41] <span class="string">"Tmem210"</span>       <span class="string">"Egfl7"</span>         <span class="string">"Stkld1"</span>        <span class="string">"Pkn3"</span>         </span><br><span class="line"> [45] <span class="string">"Wdr38"</span>         <span class="string">"Slc38a11"</span>      <span class="string">"Nostrin"</span>       <span class="string">"Dcaf17"</span>       </span><br><span class="line"> [49] <span class="string">"Pdk1"</span>          <span class="string">"Wipf1"</span>         <span class="string">"Serping1"</span>      <span class="string">"Eif2ak4"</span>      </span><br><span class="line"> [53] <span class="string">"Serinc4"</span>       <span class="string">"Gpat2"</span>         <span class="string">"Slc4a11"</span>       <span class="string">"Rrbp1"</span>        </span><br><span class="line"> [57] <span class="string">"Sstr4"</span>         <span class="string">"Defb28"</span>        <span class="string">"Defb29"</span>        <span class="string">"Defb21"</span>       </span><br><span class="line"> [61] <span class="string">"Defb19"</span>        <span class="string">"Cox4i2"</span>        <span class="string">"Ccm2l"</span>         <span class="string">"R3hdml"</span>       </span><br><span class="line"> [65] <span class="string">"Zfp972"</span>        <span class="string">"Helz2"</span>         <span class="string">"Sox18"</span>         <span class="string">"Tcea2"</span>        </span><br><span class="line"> [69] <span class="string">"Emcn"</span>          <span class="string">"Maml3"</span>         <span class="string">"Frem2"</span>         <span class="string">"Bcl9"</span>         </span><br><span class="line"> [73] <span class="string">"Igsf3"</span>         <span class="string">"Abca4"</span>         <span class="string">"Mgarp"</span>         <span class="string">"Fhdc1"</span>        </span><br><span class="line"> [77] <span class="string">"Efna1"</span>         <span class="string">"S100a6"</span>        <span class="string">"Rptn"</span>          <span class="string">"BC028528"</span>     </span><br><span class="line"> [81] <span class="string">"Mab21l3"</span>       <span class="string">"Prpf38b"</span>       <span class="string">"Alpk1"</span>         <span class="string">"Pitx2"</span>        </span><br><span class="line"> [85] <span class="string">"Cfi"</span>           <span class="string">"Tet2"</span>          <span class="string">"Nexn"</span>          <span class="string">"Srsf11"</span>       </span><br><span class="line"> [89] <span class="string">"Tie1"</span>          <span class="string">"Zfp292"</span>        <span class="string">"Zfp462"</span>        <span class="string">"Mroh7"</span>        </span><br><span class="line"> [93] <span class="string">"Hspg2"</span>         <span class="string">"Pnisr"</span>         <span class="string">"Fam166b"</span>       <span class="string">"Orm2"</span>         </span><br><span class="line"> [97] <span class="string">"Akna"</span>          <span class="string">"Psip1"</span>         <span class="string">"Angptl3"</span>       <span class="string">"Gja4"</span>         </span><br><span class="line">[101] <span class="string">"Col16a1"</span>       <span class="string">"Ptpru"</span>         <span class="string">"Masp2"</span>         <span class="string">"Uts2"</span>         </span><br><span class="line">[105] <span class="string">"Tnfrsf18"</span>      <span class="string">"Agrn"</span>          <span class="string">"Plekhn1"</span>       <span class="string">"Prom1"</span>        </span><br><span class="line">[109] <span class="string">"Nos3"</span>          <span class="string">"Stk32b"</span>        <span class="string">"Cmklr1"</span>        <span class="string">"Flt1"</span>         </span><br><span class="line">[113] <span class="string">"Steap4"</span>        <span class="string">"Kdr"</span>           <span class="string">"Rasa4"</span>         <span class="string">"Dysf"</span>         </span><br><span class="line">[117] <span class="string">"Alms1"</span>         <span class="string">"Fgd5"</span>          <span class="string">"Adamts9"</span>       <span class="string">"Impdh1"</span>       </span><br><span class="line">[121] <span class="string">"Hilpda"</span>        <span class="string">"Olfr434"</span>       <span class="string">"Gimap8"</span>        <span class="string">"Capg"</span>         </span><br><span class="line">[125] <span class="string">"Tmsb10"</span>        <span class="string">"Plxnd1"</span>        <span class="string">"Fxyd4"</span>         <span class="string">"C1s1"</span>         </span><br><span class="line">[129] <span class="string">"Vamp1"</span>         <span class="string">"Cd27"</span>          <span class="string">"Clec1b"</span>        <span class="string">"Clec9a"</span>       </span><br><span class="line">[133] <span class="string">"Emp1"</span>          <span class="string">"Taok2"</span>         <span class="string">"Gltscr1"</span>       <span class="string">"Pafah1b3"</span>     </span><br><span class="line">[137] <span class="string">"Gpi1"</span>          <span class="string">"Tjp1"</span>          <span class="string">"Arhgef17"</span>      <span class="string">"Pde2a"</span>        </span><br><span class="line">[141] <span class="string">"Folr2"</span>         <span class="string">"Trim34b"</span>       <span class="string">"Chst15"</span>        <span class="string">"Myadm"</span>        </span><br><span class="line">[145] <span class="string">"Pira1"</span>         <span class="string">"Gm14548"</span>       <span class="string">"Lilra6"</span>        <span class="string">"Leng8"</span>        </span><br><span class="line">[149] <span class="string">"Cox6b2"</span>        <span class="string">"Tmem190"</span>       <span class="string">"Cyp2s1"</span>        <span class="string">"Cyp2t4"</span>       </span><br><span class="line">[153] <span class="string">"Plekhg2"</span>       <span class="string">"Gapdhs"</span>        <span class="string">"Sbsn"</span>          <span class="string">"Fxyd5"</span>        </span><br><span class="line">[157] <span class="string">"Snrnp70"</span>       <span class="string">"Gys1"</span>          <span class="string">"Rasip1"</span>        <span class="string">"Ldha"</span>         </span><br><span class="line">[161] <span class="string">"Fes"</span>           <span class="string">"Trim6"</span>         <span class="string">"Trim34a"</span>       <span class="string">"Trim5"</span>        </span><br><span class="line">[165] <span class="string">"Nlrp10"</span>        <span class="string">"Atxn2l"</span>        <span class="string">"Apobr"</span>         <span class="string">"Gdpd3"</span>        </span><br><span class="line">[169] <span class="string">"Aldoa"</span>         <span class="string">"Tgfb1i1"</span>       <span class="string">"Bnip3"</span>         <span class="string">"Ano9"</span>         </span><br><span class="line">[173] <span class="string">"Muc6"</span>          <span class="string">"Rasa3"</span>         <span class="string">"Dlc1"</span>          <span class="string">"Inpp4b"</span>       </span><br><span class="line">[177] <span class="string">"Arhgef7"</span>       <span class="string">"Kifc3"</span>         <span class="string">"Nfat5"</span>         <span class="string">"Ankrd11"</span>      </span><br><span class="line">[181] <span class="string">"Sipa1l2"</span>       <span class="string">"Tex29"</span>         <span class="string">"Plpp5"</span>         <span class="string">"Ankrd37"</span>      </span><br><span class="line">[185] <span class="string">"Lrp2bp"</span>        <span class="string">"Ushbp1"</span>        <span class="string">"Plvap"</span>         <span class="string">"Sall1"</span>        </span><br><span class="line">[189] <span class="string">"Fhod1"</span>         <span class="string">"Ctrl"</span>          <span class="string">"Fli1"</span>          <span class="string">"Phldb1"</span>       </span><br><span class="line">[193] <span class="string">"Kmt2a"</span>         <span class="string">"Pstpip1"</span>       <span class="string">"Peak1"</span>         <span class="string">"Cspg4"</span>        </span><br><span class="line">[197] <span class="string">"Parp6"</span>         <span class="string">"Coro2b"</span>        <span class="string">"Megf11"</span>        <span class="string">"Rasl12"</span>       </span><br><span class="line">[201] <span class="string">"Rbm6"</span>          <span class="string">"Map4"</span>          <span class="string">"Ddi1"</span>          <span class="string">"Mmp7"</span>         </span><br><span class="line">[205] <span class="string">"Mtnr1b"</span>        <span class="string">"AB124611"</span>      <span class="string">"Dock6"</span>         <span class="string">"Angptl8"</span>      </span><br><span class="line">[209] <span class="string">"Robo4"</span>         <span class="string">"Esam"</span>          <span class="string">"Apoc3"</span>         <span class="string">"Trcg1"</span>        </span><br><span class="line">[213] <span class="string">"Pkm"</span>           <span class="string">"Uchl4"</span>         <span class="string">"Plod2"</span>         <span class="string">"Sema3f"</span>       </span><br><span class="line">[217] <span class="string">"Fam212a"</span>       <span class="string">"Ccr1"</span>          <span class="string">"Gpc3"</span>          <span class="string">"Atrx"</span>         </span><br><span class="line">[221] <span class="string">"Plp2"</span>          <span class="string">"Ssxb5"</span>         <span class="string">"Gm6592"</span>        <span class="string">"Flna"</span>         </span><br><span class="line">[225] <span class="string">"Dnase1l1"</span>      <span class="string">"Ogt"</span>           <span class="string">"Rgag4"</span>         <span class="string">"Arl13a"</span>       </span><br><span class="line">[229] <span class="string">"Bhlhb9"</span>        <span class="string">"Arxes2"</span>        <span class="string">"Tspyl2"</span>        <span class="string">"Asb11"</span>        </span><br><span class="line">[233] <span class="string">"Syne1"</span>         <span class="string">"Col13a1"</span>       <span class="string">"Mthfd1l"</span>       <span class="string">"Epb41l2"</span>      </span><br><span class="line">[237] <span class="string">"Pfkl"</span>          <span class="string">"Fgd6"</span>          <span class="string">"Lrriq1"</span>        <span class="string">"Nxph4"</span>        </span><br><span class="line">[241] <span class="string">"Hey2"</span>          <span class="string">"Prdm1"</span>         <span class="string">"Lilrb4a"</span>       <span class="string">"Rufy2"</span>        </span><br><span class="line">[245] <span class="string">"Aire"</span>          <span class="string">"Ankrd24"</span>       <span class="string">"B4galnt1"</span>      <span class="string">"Arhgef25"</span>     </span><br><span class="line">[249] <span class="string">"Mbd6"</span>          <span class="string">"Ndufa4l2"</span>      <span class="string">"Esyt1"</span>         <span class="string">"Npm1"</span>         </span><br><span class="line">[253] <span class="string">"Slc22a4"</span>       <span class="string">"Arhgef15"</span>      <span class="string">"Efcab5"</span>        <span class="string">"Ppm1e"</span>        </span><br><span class="line">[257] <span class="string">"Pitpnc1"</span>       <span class="string">"Itgb4"</span>         <span class="string">"Stc2"</span>          <span class="string">"Fndc9"</span>        </span><br><span class="line">[261] <span class="string">"Olfr1396"</span>      <span class="string">"Btnl9"</span>         <span class="string">"Slc22a21"</span>      <span class="string">"Chrnb1"</span>       </span><br><span class="line">[265] <span class="string">"Fgf11"</span>         <span class="string">"Nlgn2"</span>         <span class="string">"Tnk1"</span>          <span class="string">"Acap1"</span>        </span><br><span class="line">[269] <span class="string">"Zmynd15"</span>       <span class="string">"Aldoc"</span>         <span class="string">"Wsb1"</span>          <span class="string">"Heatr9"</span>       </span><br><span class="line">[273] <span class="string">"Higd1b"</span>        <span class="string">"Prr29"</span>         <span class="string">"Cep95"</span>         <span class="string">"Slc16a3"</span>      </span><br><span class="line">[277] <span class="string">"Hif1a"</span>         <span class="string">"Ccdc88c"</span>       <span class="string">"Pqlc3"</span>         <span class="string">"Egln3"</span>        </span><br><span class="line">[281] <span class="string">"Pnn"</span>           <span class="string">"Tomm20l"</span>       <span class="string">"Akap5"</span>         <span class="string">"Arg2"</span>         </span><br><span class="line">[285] <span class="string">"Gm4787"</span>        <span class="string">"Jag2"</span>          <span class="string">"Crip1"</span>         <span class="string">"Nid1"</span>         </span><br><span class="line">[289] <span class="string">"Zfp458"</span>        <span class="string">"Slc6a18"</span>       <span class="string">"Map3k1"</span>        <span class="string">"Parp8"</span>        </span><br><span class="line">[293] <span class="string">"Pfkp"</span>          <span class="string">"Prl2c3"</span>        <span class="string">"Slc17a4"</span>       <span class="string">"Irf4"</span>         </span><br><span class="line">[297] <span class="string">"Ppp1r3g"</span>       <span class="string">"Wnk2"</span>          <span class="string">"Fam193b"</span>       <span class="string">"Plk2"</span>         </span><br><span class="line">[301] <span class="string">"Slc25a30"</span>      <span class="string">"Scel"</span>          <span class="string">"Il17rb"</span>        <span class="string">"Stab1"</span>        </span><br><span class="line">[305] <span class="string">"Mmrn2"</span>         <span class="string">"Gm10375"</span>       <span class="string">"Ang"</span>           <span class="string">"Rnase4"</span>       </span><br><span class="line">[309] <span class="string">"Arhgef40"</span>      <span class="string">"Tmem253"</span>       <span class="string">"Nfatc4"</span>        <span class="string">"Sox7"</span>         </span><br><span class="line">[313] <span class="string">"Cysltr2"</span>       <span class="string">"Ednrb"</span>         <span class="string">"Ipo5"</span>          <span class="string">"Card6"</span>        </span><br><span class="line">[317] <span class="string">"Fyb"</span>           <span class="string">"Parvb"</span>         <span class="string">"Shank3"</span>        <span class="string">"Fmnl3"</span>        </span><br><span class="line">[321] <span class="string">"Slc11a2"</span>       <span class="string">"Map3k12"</span>       <span class="string">"Pabpc1"</span>        <span class="string">"Ptp4a3"</span>       </span><br><span class="line">[325] <span class="string">"Gpihbp1"</span>       <span class="string">"Nrbp2"</span>         <span class="string">"Plec"</span>          <span class="string">"Mb"</span>           </span><br><span class="line">[329] <span class="string">"Myh9"</span>          <span class="string">"Lgals2"</span>        <span class="string">"Cyp2d22"</span>       <span class="string">"Cyp2d11"</span>      </span><br><span class="line">[333] <span class="string">"Mapk12"</span>        <span class="string">"Hdac7"</span>         <span class="string">"Kmt2d"</span>         <span class="string">"Ciita"</span>        </span><br><span class="line">[337] <span class="string">"Erg"</span>           <span class="string">"Zc3h7a"</span>        <span class="string">"Atp13a4"</span>       <span class="string">"Heg1"</span>         </span><br><span class="line">[341] <span class="string">"Arhgap31"</span>      <span class="string">"Cyyr1"</span>         <span class="string">"Setd4"</span>         <span class="string">"Dopey2"</span>       </span><br><span class="line">[345] <span class="string">"AU021092"</span>      <span class="string">"Ypel1"</span>         <span class="string">"Apod"</span>          <span class="string">"Stx19"</span>        </span><br><span class="line">[349] <span class="string">"Itgb2l"</span>        <span class="string">"Rasgrp3"</span>       <span class="string">"Spaca6"</span>        <span class="string">"Mapk8ip3"</span>     </span><br><span class="line">[353] <span class="string">"Kank3"</span>         <span class="string">"Smchd1"</span>        <span class="string">"Srrm2"</span>         <span class="string">"Rab26"</span>        </span><br><span class="line">[357] <span class="string">"Meiob"</span>         <span class="string">"Ccdc78"</span>        <span class="string">"Rgs11"</span>         <span class="string">"Notch3"</span>       </span><br><span class="line">[361] <span class="string">"Pram1"</span>         <span class="string">"Notch4"</span>        <span class="string">"Msh5"</span>          <span class="string">"Mdc1"</span>         </span><br><span class="line">[365] <span class="string">"Olfr99"</span>        <span class="string">"Olfr110"</span>       <span class="string">"Tnfsf9"</span>        <span class="string">"Gpr108"</span>       </span><br><span class="line">[369] <span class="string">"Prelid2"</span>       <span class="string">"Nrg2"</span>          <span class="string">"Gm5820"</span>        <span class="string">"Pdgfrb"</span>       </span><br><span class="line">[373] <span class="string">"Piezo2"</span>        <span class="string">"Slc14a1"</span>       <span class="string">"Setbp1"</span>        <span class="string">"Pcdhb15"</span>      </span><br><span class="line">[377] <span class="string">"Arap3"</span>         <span class="string">"Lrp5"</span>          <span class="string">"Ahnak"</span>         <span class="string">"Tcirg1"</span>       </span><br><span class="line">[381] <span class="string">"Lrfn4"</span>         <span class="string">"Cd248"</span>         <span class="string">"Fosl1"</span>         <span class="string">"Sipa1"</span>        </span><br><span class="line">[385] <span class="string">"Rasgrp2"</span>       <span class="string">"Slc22a29"</span>      <span class="string">"Ppp1r3c"</span>       <span class="string">"Obfc1"</span>  </span><br><span class="line"><span class="comment"># 转换之前需要将其转化为向量，但向量需要定义行与列，需要满足整除，即长度=行数X列数，388=4X97，4行97列或者97行列都不匀称，因此，先改变它的长度至390（390=13X30），这样，可以做成13列30行的向量，大约1：3比率的矩形</span></span><br><span class="line">&gt; y &lt;- c(x,<span class="string">""</span>,<span class="string">""</span>)</span><br><span class="line">&gt; z &lt;- matrix(y,ncol=13)</span><br><span class="line"><span class="comment"># 下面，转换为表格</span></span><br><span class="line">&gt; library(ggpubr)</span><br><span class="line">&gt; ggtexttable(z,rows = NULL,cols=NULL,theme = ttheme(<span class="string">"classic"</span>))</span><br><span class="line"><span class="comment"># 直接展示是很长而且杂乱的，表格则更加美观整洁。</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/table01.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，对于长向量，如果需要展示，直接打印不够美观，可以将其转换为表格，美观而且直白，可以使用ggtexttable这个函数，比如，我们现在有一个向量，有许多基因名称，&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cl
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>人与小鼠基因名称互相转换</title>
    <link href="http://uteric.github.io/R/gene-symbol-trans/"/>
    <id>http://uteric.github.io/R/gene-symbol-trans/</id>
    <published>2020-11-15T20:37:50.000Z</published>
    <updated>2020-11-15T20:37:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，如需对人和小鼠的基因名进行互相转换，可以使用biomaRt程序包。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(biomaRt)</span><br><span class="line">&gt; human &lt;- useMart(<span class="string">"ensembl"</span>,dataset=<span class="string">"hsapiens_gene_ensembl"</span>)</span><br><span class="line">&gt; mouse &lt;- useMart(<span class="string">"ensembl"</span>,dataset=<span class="string">"mmusculus_gene_ensembl"</span>)</span><br><span class="line"><span class="comment"># 可以查看Attributes</span></span><br><span class="line">&gt; head(listAttributes(mouse),100)[,1]</span><br><span class="line">  [1] <span class="string">"ensembl_gene_id"</span>                 <span class="string">"ensembl_gene_id_version"</span>        </span><br><span class="line">  [3] <span class="string">"ensembl_transcript_id"</span>           <span class="string">"ensembl_transcript_id_version"</span>  </span><br><span class="line">  [5] <span class="string">"ensembl_peptide_id"</span>              <span class="string">"ensembl_peptide_id_version"</span>     </span><br><span class="line">  [7] <span class="string">"ensembl_exon_id"</span>                 <span class="string">"description"</span>                    </span><br><span class="line">  [9] <span class="string">"chromosome_name"</span>                 <span class="string">"start_position"</span>                 </span><br><span class="line"> [11] <span class="string">"end_position"</span>                    <span class="string">"strand"</span>                         </span><br><span class="line"> [13] <span class="string">"band"</span>                            <span class="string">"transcript_start"</span>               </span><br><span class="line"> [15] <span class="string">"transcript_end"</span>                  <span class="string">"transcription_start_site"</span>       </span><br><span class="line"> [17] <span class="string">"transcript_length"</span>               <span class="string">"transcript_tsl"</span>                 </span><br><span class="line"> [19] <span class="string">"transcript_gencode_basic"</span>        <span class="string">"transcript_appris"</span>              </span><br><span class="line"> [21] <span class="string">"external_gene_name"</span>              <span class="string">"external_gene_source"</span>           </span><br><span class="line"> [23] <span class="string">"external_transcript_name"</span>        <span class="string">"external_transcript_source_name"</span></span><br><span class="line"> [25] <span class="string">"transcript_count"</span>                <span class="string">"percentage_gene_gc_content"</span>     </span><br><span class="line"> [27] <span class="string">"gene_biotype"</span>                    <span class="string">"transcript_biotype"</span>             </span><br><span class="line"> [29] <span class="string">"source"</span>                          <span class="string">"transcript_source"</span>              </span><br><span class="line"> [31] <span class="string">"version"</span>                         <span class="string">"transcript_version"</span>             </span><br><span class="line"> [33] <span class="string">"peptide_version"</span>                 <span class="string">"external_synonym"</span>               </span><br><span class="line"> [35] <span class="string">"phenotype_description"</span>           <span class="string">"source_name"</span>                    </span><br><span class="line"> [37] <span class="string">"study_external_id"</span>               <span class="string">"strain_name"</span>                    </span><br><span class="line"> [39] <span class="string">"strain_gender"</span>                   <span class="string">"p_value"</span>                        </span><br><span class="line"> [41] <span class="string">"go_id"</span>                           <span class="string">"name_1006"</span>                      </span><br><span class="line"> [43] <span class="string">"definition_1006"</span>                 <span class="string">"go_linkage_type"</span>                </span><br><span class="line"> [45] <span class="string">"namespace_1003"</span>                  <span class="string">"goslim_goa_accession"</span>           </span><br><span class="line"> [47] <span class="string">"goslim_goa_description"</span>          <span class="string">"ccds"</span>                           </span><br><span class="line"> [49] <span class="string">"chembl"</span>                          <span class="string">"clone_based_ensembl_gene"</span>       </span><br><span class="line"> [51] <span class="string">"clone_based_ensembl_transcript"</span>  <span class="string">"entrezgene_trans_name"</span>          </span><br><span class="line"> [53] <span class="string">"embl"</span>                            <span class="string">"arrayexpress"</span>                   </span><br><span class="line"> [55] <span class="string">"genedb"</span>                          <span class="string">"ottg"</span>                           </span><br><span class="line"> [57] <span class="string">"ottt"</span>                            <span class="string">"ottp"</span>                           </span><br><span class="line"> [59] <span class="string">"hgnc_id"</span>                         <span class="string">"hgnc_symbol"</span>                    </span><br><span class="line"> [61] <span class="string">"protein_id"</span>                      <span class="string">"kegg_enzyme"</span>                    </span><br><span class="line"> [63] <span class="string">"merops"</span>                          <span class="string">"mgi_description"</span>                </span><br><span class="line"> [65] <span class="string">"mgi_symbol"</span>                      <span class="string">"mgi_id"</span>                         </span><br><span class="line"> [67] <span class="string">"mgi_trans_name"</span>                  <span class="string">"mirbase_accession"</span>              </span><br><span class="line"> [69] <span class="string">"mirbase_id"</span>                      <span class="string">"entrezgene_description"</span>         </span><br><span class="line"> [71] <span class="string">"entrezgene_accession"</span>            <span class="string">"entrezgene_id"</span>                  </span><br><span class="line"> [73] <span class="string">"pdb"</span>                             <span class="string">"reactome"</span>                       </span><br><span class="line"> [75] <span class="string">"reactome_gene"</span>                   <span class="string">"refseq_mrna"</span>                    </span><br><span class="line"> [77] <span class="string">"refseq_mrna_predicted"</span>           <span class="string">"refseq_ncrna"</span>                   </span><br><span class="line"> [79] <span class="string">"refseq_ncrna_predicted"</span>          <span class="string">"refseq_peptide"</span>                 </span><br><span class="line"> [81] <span class="string">"refseq_peptide_predicted"</span>        <span class="string">"rfam"</span>                           </span><br><span class="line"> [83] <span class="string">"rnacentral"</span>                      <span class="string">"hgnc_trans_name"</span>                </span><br><span class="line"> [85] <span class="string">"ucsc"</span>                            <span class="string">"uniparc"</span>                        </span><br><span class="line"> [87] <span class="string">"uniprot_gn_symbol"</span>               <span class="string">"uniprot_gn_id"</span>                  </span><br><span class="line"> [89] <span class="string">"uniprotswissprot"</span>                <span class="string">"uniprotsptrembl"</span>                </span><br><span class="line"> [91] <span class="string">"vega_gene"</span>                       <span class="string">"vega_transcript"</span>                </span><br><span class="line"> [93] <span class="string">"vega_translation"</span>                <span class="string">"wikigene_description"</span>           </span><br><span class="line"> [95] <span class="string">"wikigene_name"</span>                   <span class="string">"wikigene_id"</span>                    </span><br><span class="line"> [97] <span class="string">"affy_mg_u74a"</span>                    <span class="string">"affy_mg_u74av2"</span>                 </span><br><span class="line"> [99] <span class="string">"affy_mg_u74b"</span>                    <span class="string">"affy_mg_u74bv2"</span>      </span><br><span class="line"><span class="comment"># 基因名称对应的Attributes在小鼠中是"mgi_symbol"，在人中是"hgnc_symbol"</span></span><br><span class="line">&gt; geneHs = c(<span class="string">"TP53"</span>,<span class="string">"TSC1"</span>)</span><br><span class="line"><span class="comment"># 上面是人的三个基因名称，如需转换成小鼠基因，使用如下语法：</span></span><br><span class="line">&gt; geneMm &lt;- getLDS(attributes = <span class="string">"hgnc_symbol"</span>,filters=<span class="string">"hgnc_symbol"</span>,values=geneHs,mart=human,attributesL = <span class="string">"mgi_symbol"</span>,martL=mouse,uniqueRows = TRUE)</span><br><span class="line">&gt; geneMm</span><br><span class="line">  HGNC.symbol MGI.symbol</span><br><span class="line">1        TSC1       Tsc1</span><br><span class="line">2        TP53      Trp53</span><br><span class="line"><span class="comment"># 同理，如需将小鼠基因转成人的基因，不举例子</span></span><br><span class="line">&gt; geneHs &lt;- getLDS(attributes = <span class="string">"mgi_symbol"</span>,filters=<span class="string">"mgi_symbol"</span>,values=genes,mart=mouse,attributesL = <span class="string">"hgnc_symbol"</span>,martL=human,uniqueRows = TRUE)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，如需对人和小鼠的基因名进行互相转换，可以使用biomaRt程序包。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;b
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>在LINUX中查看文件时略过头部的注释部分</title>
    <link href="http://uteric.github.io/Linux/grepbody/"/>
    <id>http://uteric.github.io/Linux/grepbody/</id>
    <published>2020-11-13T01:51:14.000Z</published>
    <updated>2020-11-13T01:51:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>在LINUX中查看文件常用less命令，但是在遇到带有注释的文件时，如果单单使用less命令，会看到长长的注释部分，给查看文件带来极大不便，比如VCF文件，头部使用#注释</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##fileformat=VCFv4.2</span></span><br><span class="line"><span class="comment">##ALT=&lt;ID=NON_REF,Description="Represents any possible alternative allele not already represented at this location by REF and ALT"&gt;</span></span><br><span class="line"><span class="comment">##FILTER=&lt;ID=CNN_1D_INDEL_Tranche_99.40_100.00,Description="INDEL truth resource sensitivity between 99.40 and 100.00 for info key CNN_1D"&gt;</span></span><br><span class="line"><span class="comment">##FILTER=&lt;ID=CNN_1D_SNP_Tranche_99.95_100.00,Description="SNP truth resource sensitivity between 99.95 and 100.00 for info key CNN_1D"&gt;</span></span><br><span class="line"><span class="comment">##FILTER=&lt;ID=LowQual,Description="Low quality"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=AD,Number=R,Type=Integer,Description="Allelic depths for the ref and alt alleles in the order listed"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description="Approximate read depth (reads with MQ=255 or with bad mates are filtered)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description="Genotype Quality"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=MIN_DP,Number=1,Type=Integer,Description="Minimum DP observed within the GVCF block"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PGT,Number=1,Type=String,Description="Physical phasing haplotype information, describing how the alternate alleles are phased in relation to one another; will always be heterozygous and is not intended to describe called alleles"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PID,Number=1,Type=String,Description="Physical phasing ID information, where each unique ID within a given sample (but not across samples) connects records within a phasing group"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PL,Number=G,Type=Integer,Description="Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=PS,Number=1,Type=Integer,Description="Phasing set (typically the position of the first variant in the set)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=RGQ,Number=1,Type=Integer,Description="Unconditional reference genotype confidence, encoded as a phred quality -10*log10 p(genotype call is wrong)"&gt;</span></span><br><span class="line"><span class="comment">##FORMAT=&lt;ID=SB,Number=4,Type=Integer,Description="Per-sample component statistics which comprise the Fisher's Exact Test to detect strand bias."&gt;</span></span><br><span class="line"><span class="comment">##Funcotator Version=4.1.9.0 | Gencode 34 CANONICAL | ACMGLMMLof 1 | ACMG_recommendation SF_v2.0 | ClinVar_VCF 20180429_hg38 | LMMKnown 20180618</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 此处仅列举部分，注释部分其实很长</span></span><br></pre></td></tr></table></figure><p>查看VCF时如需略过注释部分，直接查看主体内容，可以结合grep命令，使用-v参数（select non-matching lines），选择不匹配的行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ grep -v <span class="string">"^#"</span> annotated.filtered.funcotator.germline.vcf | less</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此时，略过头部带##的注释部分，可以直接查看文件主体</span></span><br><span class="line">chr1    15903   .       G       GC      59.28   PASS    AC=2;AF=1.00;AN=2;CNN_1D=-0.800;DP=3;ExcessHet=3.0103;FS=0.000;FUNCOTATION=[WASH7P|hg38|chr1|15903|15904|RNA||INS|-|-|C|g.chr1:15903_15904insC|ENST00000488147.1|-|||c.e9-44C&gt;GC|||0.6475|AGCAGAGTGGCCAGCCACCG||||||||||||||||||||||||||||||<span class="literal">false</span>||];MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303    GT:AD:DP:GQ:PL  1/1:0,2:2:6:71,6,0</span><br><span class="line">chr1    16495   .       G       C       36.65   CNN_1D_SNP_Tranche_99.95_100.00 AC=1;AF=0.500;AN=2;BaseQRankSum=-9.670e-01;CNN_1D=-4.292;DP=3;ExcessHet=3.0103;FS=0.000;FUNCOTATION=[WASH7P|hg38|chr1|16495|16495|RNA||SNP|G|G|C|g.chr1:16495G&gt;C|ENST00000488147.1|-|||c.e8-112C&gt;G|||0.486284289276808|TATTTGAAATGGAAACTATTC||||||||||||||||||||||||||||||<span class="literal">false</span>||];MLEAC=1;MLEAF=0.500;MQ=22.00;MQRankSum=0.00;QD=12.22;ReadPosRankSum=0.967;SOR=1.179  GT:AD:DP:GQ:PL  0/1:1,2:3:18:44,0,18</span><br><span class="line">chr1    16734   .       TG      T       31.60   CNN_1D_INDEL_Tranche_99.40_100.00       AC=1;AF=0.500;AN=2;BaseQRankSum=-6.740e-01;CNN_1D=-6.239;DP=10;ExcessHet=3.0103;FS=0.000;FUNCOTATION=[WASH7P|hg38|chr1|16735|16735|RNA||DEL|G|G|-|g.chr1:16735delG|ENST00000488147.1|-|||c.e8-31CA&gt;A|||0.6309226932668329|TGGGGGCGGTGGGGGTGGTGT||||||||||||||||||||||||||||||<span class="literal">false</span>||];MLEAC=1;MLEAF=0.500;MQ=32.17;MQRankSum=-1.400e-01;QD=3.51;ReadPosRankSum=-9.210e-01;SOR=0.132     GT:AD:DP:GQ:PL  0/1:7,2:9:39:39,0,197</span><br><span class="line">chr1    17614   .       G       A       54.64   PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=0.00;CNN_1D=-0.693;DP=5;ExcessHet=3.0103;FS=0.000;FUNCOTATION=[WASH7P|hg38|chr1|17614|17614|RNA||SNP|G|G|A|g.chr1:17614G&gt;A|ENST00000488147.1|-|||c.e5+8C&gt;T|||0.6259351620947631|ACAGGTTCTCGGTGGTGTTGA|MIR6859-1_ENST00000619216.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||<span class="literal">false</span>||];MLEAC=1;MLEAF=0.500;MQ=47.88;MQRankSum=-1.645e+00;QD=10.93;ReadPosRankSum=1.04;SOR=1.179        GT:AD:DP:GQ:PL  0/1:2,3:5:35:62,0,35</span><br><span class="line">chr1    19190   .       GC      G       32.60   CNN_1D_INDEL_Tranche_99.40_100.00       AC=1;AF=0.500;AN=2;BaseQRankSum=-6.690e-01;CNN_1D=-7.533;DP=13;ExcessHet=3.0103;FS=0.000;FUNCOTATION=[WASH7P|hg38|chr1|19191|19191|RNA||DEL|C|C|-|g.chr1:19191delC|ENST00000488147.1|-|||c.e3+824GC&gt;C|||0.5985037406483791|CTCCCAGTCGCCCCTGTAGCT|MIR6859-1_ENST00000619216.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||<span class="literal">false</span>||];MLEAC=1;MLEAF=0.500;MQ=31.81;MQRankSum=-2.120e+00;QD=2.51;ReadPosRankSum=0.099;SOR=0.330     GT:AD:DP:GQ:PL  0/1:11,2:13:40:40,0,330</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在LINUX中查看文件常用less命令，但是在遇到带有注释的文件时，如果单单使用less命令，会看到长长的注释部分，给查看文件带来极大不便，比如VCF文件，头部使用#注释&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="LINUX" scheme="http://uteric.github.io/tags/LINUX/"/>
    
  </entry>
  
  <entry>
    <title>在UBUNTU上安装GATK官方Docker Engine</title>
    <link href="http://uteric.github.io/WES/docker_engine_install/"/>
    <id>http://uteric.github.io/WES/docker_engine_install/</id>
    <published>2020-11-10T19:58:34.000Z</published>
    <updated>2020-11-10T19:58:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>安装步骤参考官方<a href="https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository" target="_blank" rel="noopener">安装指南</a></p><h2 id="一、卸载旧版本"><a href="#一、卸载旧版本" class="headerlink" title="一、卸载旧版本"></a>一、卸载旧版本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get remove docker docker-engine docker.io containerd runc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为确保安装顺利，先卸载旧版本，如果未曾安装，则会提示：</span></span><br><span class="line"><span class="comment"># Package 'docker-engine' is not installed, so not removed</span></span><br><span class="line"><span class="comment"># Package 'docker' is not installed, so not removed</span></span><br><span class="line"><span class="comment"># Package 'containerd' is not installed, so not removed</span></span><br><span class="line"><span class="comment"># Package 'docker.io' is not installed, so not removed</span></span><br><span class="line"><span class="comment"># Package 'runc' is not installed, so not removed</span></span><br></pre></td></tr></table></figure><h2 id="二、设置REPOSITORY"><a href="#二、设置REPOSITORY" class="headerlink" title="二、设置REPOSITORY"></a>二、设置REPOSITORY</h2><h3 id="2-1-更新安装包索引并安装必要软件包以允许通过HTTPS使用存储库"><a href="#2-1-更新安装包索引并安装必要软件包以允许通过HTTPS使用存储库" class="headerlink" title="2.1 更新安装包索引并安装必要软件包以允许通过HTTPS使用存储库"></a>2.1 更新安装包索引并安装必要软件包以允许通过HTTPS使用存储库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line"></span><br><span class="line">$ sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg-agent \</span><br><span class="line">    software-properties-common</span><br></pre></td></tr></table></figure><h3 id="2-2-添加官方GPG密钥"><a href="#2-2-添加官方GPG密钥" class="headerlink" title="2.2 添加官方GPG密钥"></a>2.2 添加官方GPG密钥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"><span class="comment"># 提示OK</span></span><br><span class="line"><span class="comment"># 通过搜索指纹最后8个字符确保密钥是正确的</span></span><br><span class="line">$ sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"></span><br><span class="line">pub   rsa4096 2017-02-22 [SCEA]</span><br><span class="line">      9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88</span><br><span class="line">uid           [ unknown] Docker Release (CE deb) &lt;docker@docker.com&gt;</span><br><span class="line">sub   rsa4096 2017-02-22 [S]</span><br></pre></td></tr></table></figure><h3 id="2-3-设置stable-repository"><a href="#2-3-设置stable-repository" class="headerlink" title="2.3 设置stable repository"></a>2.3 设置stable repository</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository \</span><br><span class="line">   <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">   <span class="variable">$(lsb_release -cs)</span> \</span></span><br><span class="line"><span class="string">   stable"</span></span><br></pre></td></tr></table></figure><h2 id="三、安装DOCKER-ENGINE"><a href="#三、安装DOCKER-ENGINE" class="headerlink" title="三、安装DOCKER ENGINE"></a>三、安装DOCKER ENGINE</h2><h3 id="3-1-更新安装包索引并安装最新DOCKER-ENGINE"><a href="#3-1-更新安装包索引并安装最新DOCKER-ENGINE" class="headerlink" title="3.1 更新安装包索引并安装最新DOCKER ENGINE"></a>3.1 更新安装包索引并安装最新DOCKER ENGINE</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><h3 id="3-2-检查DOCKER-ENGINE是否正确安装"><a href="#3-2-检查DOCKER-ENGINE是否正确安装" class="headerlink" title="3.2 检查DOCKER ENGINE是否正确安装"></a>3.2 检查DOCKER ENGINE是否正确安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run hello-world</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者直接调用，检查版本</span></span><br><span class="line">$ docker --version</span><br><span class="line">Docker version 19.03.13, build 4484c46d9d</span><br></pre></td></tr></table></figure><h3 id="3-3-检查运行状态"><a href="#3-3-检查运行状态" class="headerlink" title="3.3 检查运行状态"></a>3.3 检查运行状态</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service docker status</span><br><span class="line">* Docker is Running</span><br></pre></td></tr></table></figure><h2 id="四、DOCKER中安装GATK"><a href="#四、DOCKER中安装GATK" class="headerlink" title="四、DOCKER中安装GATK"></a>四、DOCKER中安装GATK</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker pull broadinstitute/gatk:4.1.3.0 <span class="comment"># 后面是版本号，可以根据需要更换</span></span><br></pre></td></tr></table></figure><h2 id="五、启动GATK容器"><a href="#五、启动GATK容器" class="headerlink" title="五、启动GATK容器"></a>五、启动GATK容器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it broadinstitute/gatk:4.1.3.0</span><br><span class="line">(gatk)root@ea3a5218f494:/gatk<span class="comment"># # 成功启动后会有这个前缀</span></span><br></pre></td></tr></table></figure><h2 id="六、运行GATK命令"><a href="#六、运行GATK命令" class="headerlink" title="六、运行GATK命令"></a>六、运行GATK命令</h2><h3 id="6-1-查看GATK命令"><a href="#6-1-查看GATK命令" class="headerlink" title="6.1 查看GATK命令"></a>6.1 查看GATK命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br></pre></td><td class="code"><pre><span class="line">./gatk --list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 罗列所有GATK命令</span></span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar --<span class="built_in">help</span></span><br><span class="line">USAGE:  &lt;program name&gt; [-h]</span><br><span class="line"></span><br><span class="line">Available Programs:</span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Base Calling:                                    Tools that process sequencing machine data, e.g. Illumina base calls, and detect sequencing level attributes, e.g. adapters</span><br><span class="line">    CheckIlluminaDirectory (Picard)              Asserts the validity <span class="keyword">for</span> specified Illumina basecalling data.</span><br><span class="line">    CollectIlluminaBasecallingMetrics (Picard)   Collects Illumina Basecalling metrics <span class="keyword">for</span> a sequencing run.</span><br><span class="line">    CollectIlluminaLaneMetrics (Picard)          Collects Illumina lane metrics <span class="keyword">for</span> the given BaseCalling analysis directory.</span><br><span class="line">    ExtractIlluminaBarcodes (Picard)             Tool determines the barcode <span class="keyword">for</span> each <span class="built_in">read</span> <span class="keyword">in</span> an Illumina lane.</span><br><span class="line">    IlluminaBasecallsToFastq (Picard)            Generate FASTQ file(s) from Illumina basecall <span class="built_in">read</span> data.</span><br><span class="line">    IlluminaBasecallsToSam (Picard)              Transforms raw Illumina sequencing data into an unmapped SAM or BAM file.</span><br><span class="line">    MarkIlluminaAdapters (Picard)                Reads a SAM or BAM file and rewrites it with new adapter-trimming tags.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Copy Number Variant Discovery:                   Tools that analyze <span class="built_in">read</span> coverage to detect copy number variants.</span><br><span class="line">    AnnotateIntervals                            Annotates intervals with GC content, mappability, and segmental-duplication content</span><br><span class="line">    CallCopyRatioSegments                        Calls copy-ratio segments as amplified, deleted, or copy-number neutral</span><br><span class="line">    CombineSegmentBreakpoints                    (EXPERIMENTAL Tool) Combine the breakpoints of two segment files and annotate the resulting intervals with chosen columns from each file.</span><br><span class="line">    CreateReadCountPanelOfNormals                Creates a panel of normals <span class="keyword">for</span> <span class="built_in">read</span>-count denoising</span><br><span class="line">    DenoiseReadCounts                            Denoises <span class="built_in">read</span> counts to produce denoised copy ratios</span><br><span class="line">    DetermineGermlineContigPloidy                Determines the baseline contig ploidy <span class="keyword">for</span> germline samples given counts data</span><br><span class="line">    FilterIntervals                              Filters intervals based on annotations and/or count statistics</span><br><span class="line">    GermlineCNVCaller                            Calls copy-number variants <span class="keyword">in</span> germline samples given their counts and the output of DetermineGermlineContigPloidy</span><br><span class="line">    MergeAnnotatedRegions                        (EXPERIMENTAL Tool) Merge annotated genomic regions based entirely on touching/overlapping intervals.</span><br><span class="line">    MergeAnnotatedRegionsByAnnotation            (EXPERIMENTAL Tool) Merge annotated genomic regions within specified distance <span class="keyword">if</span> annotation value(s) are exactly the same.</span><br><span class="line">    ModelSegments                                Models segmented copy ratios from denoised <span class="built_in">read</span> counts and segmented minor-allele fractions from allelic counts</span><br><span class="line">    PlotDenoisedCopyRatios                       Creates plots of denoised copy ratios</span><br><span class="line">    PlotModeledSegments                          Creates plots of denoised and segmented copy-ratio and minor-allele-fraction estimates</span><br><span class="line">    PostprocessGermlineCNVCalls                  Postprocesses the output of GermlineCNVCaller and generates VCFs and denoised copy ratios</span><br><span class="line">    TagGermlineEvents                            (EXPERIMENTAL Tool) Do a simplistic tagging of germline events <span class="keyword">in</span> a tumor segment file.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Coverage Analysis:                               Tools that count coverage, e.g. depth per allele</span><br><span class="line">    ASEReadCounter                               Generates table of filtered base counts at het sites <span class="keyword">for</span> allele specific expression</span><br><span class="line">    AnalyzeSaturationMutagenesis                 (BETA Tool) (EXPERIMENTAL) Processes reads from a MITESeq or other saturation mutagenesis experiment.</span><br><span class="line">    CollectAllelicCounts                         Collects reference and alternate allele counts at specified sites</span><br><span class="line">    CollectAllelicCountsSpark                    Collects reference and alternate allele counts at specified sites</span><br><span class="line">    CollectF1R2Counts                            Collect F1R2 <span class="built_in">read</span> counts <span class="keyword">for</span> the Mutect2 orientation bias mixture model filter</span><br><span class="line">    CollectReadCounts                            Collects <span class="built_in">read</span> counts at specified intervals</span><br><span class="line">    CountBases                                   Count bases <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    CountBasesSpark                              Counts bases <span class="keyword">in</span> the input SAM/BAM</span><br><span class="line">    CountReads                                   Count reads <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    CountReadsSpark                              Counts reads <span class="keyword">in</span> the input SAM/BAM</span><br><span class="line">    DepthOfCoverage                              (BETA Tool) Generate coverage summary information <span class="keyword">for</span> reads data</span><br><span class="line">    GeneExpressionEvaluation                     (BETA Tool) Evaluate gene expression from RNA-seq reads aligned to genome.</span><br><span class="line">    GetPileupSummaries                           Tabulates pileup metrics <span class="keyword">for</span> inferring contamination</span><br><span class="line">    Pileup                                       Prints <span class="built_in">read</span> alignments <span class="keyword">in</span> samtools pileup format</span><br><span class="line">    PileupSpark                                  (BETA Tool) Prints <span class="built_in">read</span> alignments <span class="keyword">in</span> samtools pileup format</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Diagnostics and Quality Control:                 Tools that collect sequencing quality related and comparative metrics</span><br><span class="line">    AccumulateVariantCallingMetrics (Picard)     Combines multiple Variant Calling Metrics files into a single file</span><br><span class="line">    AnalyzeCovariates                            Evaluate and compare base quality score recalibration (BQSR) tables</span><br><span class="line">    BamIndexStats (Picard)                       Generate index statistics from a BAM file</span><br><span class="line">    CalcMetadataSpark                            (BETA Tool) (Internal) Collects <span class="built_in">read</span> metrics relevant to structural variant discovery</span><br><span class="line">    CalculateContamination                       Calculate the fraction of reads coming from cross-sample contamination</span><br><span class="line">    CalculateFingerprintMetrics (Picard)         Calculate statistics on fingerprints, checking their viability</span><br><span class="line">    CalculateReadGroupChecksum (Picard)          Creates a <span class="built_in">hash</span> code based on the <span class="built_in">read</span> groups (RG).</span><br><span class="line">    CheckDuplicateMarking (Picard)               Checks the consistency of duplicate markings.</span><br><span class="line">    CheckFingerprint (Picard)                    Computes a fingerprint from the supplied input (SAM/BAM or VCF) file and compares it to the provided genotypes</span><br><span class="line">    CheckPileup                                  Compare GATK<span class="string">'s internal pileup to a reference Samtools mpileup</span></span><br><span class="line"><span class="string">    CheckTerminatorBlock (Picard)                Asserts the provided gzip file'</span>s (e.g., BAM) last block is well-formed; RC 100 otherwise</span><br><span class="line">    ClusterCrosscheckMetrics (Picard)            Clusters the results of a CrosscheckFingerprints run by LOD score</span><br><span class="line">    CollectAlignmentSummaryMetrics (Picard)      &lt;b&gt;Produces a summary of alignment metrics from a SAM or BAM file.&lt;/b&gt;</span><br><span class="line">    CollectArraysVariantCallingMetrics (Picard)  Collects summary and per-sample from the provided arrays VCF file</span><br><span class="line">    CollectBaseDistributionByCycle (Picard)      Chart the nucleotide distribution per cycle <span class="keyword">in</span> a SAM or BAM file</span><br><span class="line">    CollectBaseDistributionByCycleSpark          (BETA Tool) Collects base distribution per cycle <span class="keyword">in</span> SAM/BAM/CRAM file(s).</span><br><span class="line">    CollectGcBiasMetrics (Picard)                Collect metrics regarding GC bias.</span><br><span class="line">    CollectHiSeqXPfFailMetrics (Picard)          Classify PF-Failing reads <span class="keyword">in</span> a HiSeqX Illumina Basecalling directory into various categories.</span><br><span class="line">    CollectHsMetrics (Picard)                    Collects hybrid-selection (HS) metrics <span class="keyword">for</span> a SAM or BAM file.</span><br><span class="line">    CollectIndependentReplicateMetrics (Picard)  (EXPERIMENTAL Tool) Estimates the rate of independent replication rate of reads within a bam.</span><br><span class="line"></span><br><span class="line">    CollectInsertSizeMetrics (Picard)            Collect metrics about the insert size distribution of a paired-end library.</span><br><span class="line">    CollectInsertSizeMetricsSpark                (BETA Tool) Collects insert size distribution information on alignment data</span><br><span class="line">    CollectJumpingLibraryMetrics (Picard)        Collect jumping library metrics.</span><br><span class="line">    CollectMultipleMetrics (Picard)              Collect multiple classes of metrics.</span><br><span class="line">    CollectMultipleMetricsSpark                  (BETA Tool) Runs multiple metrics collection modules <span class="keyword">for</span> a given alignment file</span><br><span class="line">    CollectOxoGMetrics (Picard)                  Collect metrics to assess oxidative artifacts.</span><br><span class="line">    CollectQualityYieldMetrics (Picard)          Collect metrics about reads that pass quality thresholds and Illumina-specific filters.</span><br><span class="line">    CollectQualityYieldMetricsSpark              (BETA Tool) Collects quality yield metrics from SAM/BAM/CRAM file(s).</span><br><span class="line">    CollectRawWgsMetrics (Picard)                Collect whole genome sequencing-related metrics.</span><br><span class="line">    CollectRnaSeqMetrics (Picard)                Produces RNA alignment metrics <span class="keyword">for</span> a SAM or BAM file.</span><br><span class="line">    CollectRrbsMetrics (Picard)                  &lt;b&gt;Collects metrics from reduced representation bisulfite sequencing (Rrbs) data.&lt;/b&gt;</span><br><span class="line">    CollectSamErrorMetrics (Picard)              Program to collect error metrics on bases stratified <span class="keyword">in</span> various ways.</span><br><span class="line">    CollectSequencingArtifactMetrics (Picard)    Collect metrics to quantify single-base sequencing artifacts.</span><br><span class="line">    CollectTargetedPcrMetrics (Picard)           Calculate PCR-related metrics from targeted sequencing data.</span><br><span class="line">    CollectVariantCallingMetrics (Picard)        Collects per-sample and aggregate (spanning all samples) metrics from the provided VCF file</span><br><span class="line">    CollectWgsMetrics (Picard)                   Collect metrics about coverage and performance of whole genome sequencing (WGS) experiments.</span><br><span class="line">    CollectWgsMetricsWithNonZeroCoverage (Picard)(EXPERIMENTAL Tool) Collect metrics about coverage and performance of whole genome sequencing (WGS) experiments.</span><br><span class="line">    CompareBaseQualities                         Compares the base qualities of two SAM/BAM/CRAM files</span><br><span class="line">    CompareDuplicatesSpark                       (BETA Tool) Determine <span class="keyword">if</span> two potentially identical BAMs have the same duplicate reads</span><br><span class="line">    CompareMetrics (Picard)                      Compare two metrics files.</span><br><span class="line">    CompareSAMs (Picard)                         Compare two input <span class="string">".sam"</span> or <span class="string">".bam"</span> files.</span><br><span class="line">    ConvertSequencingArtifactToOxoG (Picard)     Extract OxoG metrics from generalized artifacts metrics.</span><br><span class="line">    CrosscheckFingerprints (Picard)              Checks that all data <span class="keyword">in</span> the input files appear to have come from the same individual</span><br><span class="line">    CrosscheckReadGroupFingerprints (Picard)     DEPRECATED: USE CrosscheckFingerprints.</span><br><span class="line">    EstimateLibraryComplexity (Picard)           Estimates the numbers of unique molecules <span class="keyword">in</span> a sequencing library.</span><br><span class="line">    ExtractFingerprint (Picard)                  Computes a fingerprint from the supplied SAM/BAM file.</span><br><span class="line">    FlagStat                                     Accumulate flag statistics given a BAM file</span><br><span class="line">    FlagStatSpark                                Spark tool to accumulate flag statistics</span><br><span class="line">    GatherPileupSummaries                        Combine output files from GetPileupSummary <span class="keyword">in</span> the order defined by a sequence dictionary</span><br><span class="line">    GetSampleName                                Emit a single sample name</span><br><span class="line">    IdentifyContaminant (Picard)                 Computes a fingerprint from the supplied SAM/BAM file, given a contamination estimate.</span><br><span class="line">    LiftOverHaplotypeMap (Picard)                Lifts over a haplotype database from one reference to another</span><br><span class="line">    MeanQualityByCycle (Picard)                  Collect mean quality by cycle.</span><br><span class="line">    MeanQualityByCycleSpark                      (BETA Tool) MeanQualityByCycle on Spark</span><br><span class="line">    QualityScoreDistribution (Picard)            Chart the distribution of quality scores.</span><br><span class="line">    QualityScoreDistributionSpark                (BETA Tool) QualityScoreDistribution on Spark</span><br><span class="line">    ValidateSamFile (Picard)                     Validates a SAM or BAM file.</span><br><span class="line">    ViewSam (Picard)                             Prints a SAM or BAM file to the screen</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Example Tools:                                   Example tools that show developers how to implement new tools</span><br><span class="line">    HtsgetReader                                 (EXPERIMENTAL Tool) Download a file using htsget</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Genotyping Arrays Manipulation:                  Tools that manipulate data generated by Genotyping arrays</span><br><span class="line">    BpmToNormalizationManifestCsv (Picard)       Program to convert an Illumina bpm file into a bpm.csv file.</span><br><span class="line">    CombineGenotypingArrayVcfs (Picard)          Program to combine multiple genotyping array VCF files into one VCF.</span><br><span class="line">    CompareGtcFiles (Picard)                     Compares two GTC files.</span><br><span class="line">    CreateVerifyIDIntensityContaminationMetricsFile (Picard)    Program to generate a picard metrics file from the output of the VerifyIDIntensity tool.</span><br><span class="line">    GtcToVcf (Picard)                            Program to convert an Illumina GTC file to a VCF</span><br><span class="line">    MergePedIntoVcf (Picard)                     Program to merge a single-sample ped file from zCall into a single-sample VCF.</span><br><span class="line">    VcfToAdpc (Picard)                           Program to convert an Arrays VCF to an ADPC file.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Intervals Manipulation:                          Tools that process genomic intervals <span class="keyword">in</span> various formats</span><br><span class="line">    BedToIntervalList (Picard)                   Converts a BED file to a Picard Interval List.</span><br><span class="line">    CompareIntervalLists                         Compare two interval lists <span class="keyword">for</span> equality</span><br><span class="line">    IntervalListToBed (Picard)                   Converts an Picard IntervalList file to a BED file.</span><br><span class="line">    IntervalListTools (Picard)                   A tool <span class="keyword">for</span> performing various IntervalList manipulations</span><br><span class="line">    LiftOverIntervalList (Picard)                Lifts over an interval list from one reference build to another.</span><br><span class="line">    PreprocessIntervals                          Prepares bins <span class="keyword">for</span> coverage collection</span><br><span class="line">    SplitIntervals                               Split intervals into sub-interval files.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Metagenomics:                                    Tools that perform metagenomic analysis, e.g. microbial community composition and pathogen detection</span><br><span class="line">    PathSeqBuildKmers                            Builds <span class="built_in">set</span> of host reference k-mers</span><br><span class="line">    PathSeqBuildReferenceTaxonomy                Builds a taxonomy datafile of the microbe reference</span><br><span class="line">    PathSeqBwaSpark                              Step 2: Aligns reads to the microbe reference</span><br><span class="line">    PathSeqFilterSpark                           Step 1: Filters low quality, low complexity, duplicate, and host reads</span><br><span class="line">    PathSeqPipelineSpark                         Combined tool that performs all steps: <span class="built_in">read</span> filtering, microbe reference alignment, and abundance scoring</span><br><span class="line">    PathSeqScoreSpark                            Step 3: Classifies pathogen-aligned reads and generates abundance scores</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Methylation-Specific Tools:                      Tools that perform methylation calling, processing bisulfite sequenced, methylation-aware aligned BAM</span><br><span class="line">    MethylationTypeCaller                        (EXPERIMENTAL Tool) Identify methylated bases from bisulfite sequenced, methylation-aware BAMs</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Other:                                           Miscellaneous tools, e.g. those that aid <span class="keyword">in</span> data streaming</span><br><span class="line">    CreateHadoopBamSplittingIndex                (BETA Tool) Create a Hadoop BAM splitting index</span><br><span class="line">    FifoBuffer (Picard)                          Provides a large, FIFO buffer that can be used to buffer input and output streams between programs.</span><br><span class="line">    GatherBQSRReports                            Gathers scattered BQSR recalibration reports into a single file</span><br><span class="line">    GatherTranches                               (BETA Tool) Gathers scattered VQSLOD tranches into a single file</span><br><span class="line">    IndexFeatureFile                             Creates an index <span class="keyword">for</span> a feature file, e.g. VCF or BED file.</span><br><span class="line">    ParallelCopyGCSDirectoryIntoHDFSSpark        (BETA Tool) Parallel copy a file or directory from Google Cloud Storage into the HDFS file system used by Spark</span><br><span class="line">    PrintBGZFBlockInformation                    (EXPERIMENTAL Tool) Print information about the compressed blocks <span class="keyword">in</span> a BGZF format file</span><br><span class="line">    ReadAnonymizer                               (EXPERIMENTAL Tool) Replace bases <span class="keyword">in</span> reads with reference bases.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Read Data Manipulation:                          Tools that manipulate <span class="built_in">read</span> data <span class="keyword">in</span> SAM, BAM or CRAM format</span><br><span class="line">    AddCommentsToBam (Picard)                    Adds comments to the header of a BAM file.</span><br><span class="line">    AddOATag (Picard)                            Record current alignment information to OA tag.</span><br><span class="line">    AddOrReplaceReadGroups (Picard)              Assigns all the reads <span class="keyword">in</span> a file to a single new <span class="built_in">read</span>-group.</span><br><span class="line">    AddOriginalAlignmentTags                     (EXPERIMENTAL Tool) Adds Original Alignment tag and original mate contig tag</span><br><span class="line">    ApplyBQSR                                    Apply base quality score recalibration</span><br><span class="line">    ApplyBQSRSpark                               (BETA Tool) Apply base quality score recalibration on Spark</span><br><span class="line">    BQSRPipelineSpark                            (BETA Tool) Both steps of BQSR (BaseRecalibrator and ApplyBQSR) on Spark</span><br><span class="line">    BamToBfq (Picard)                            Converts a BAM file into a BFQ (binary fastq formatted) file</span><br><span class="line">    BaseRecalibrator                             Generates recalibration table <span class="keyword">for</span> Base Quality Score Recalibration (BQSR)</span><br><span class="line">    BaseRecalibratorSpark                        (BETA Tool) Generate recalibration table <span class="keyword">for</span> Base Quality Score Recalibration (BQSR) on Spark</span><br><span class="line">    BuildBamIndex (Picard)                       Generates a BAM index <span class="string">".bai"</span> file.</span><br><span class="line">    BwaAndMarkDuplicatesPipelineSpark            (BETA Tool) Takes name-sorted file and runs BWA and MarkDuplicates.</span><br><span class="line">    BwaSpark                                     (BETA Tool) Align reads to a given reference using BWA on Spark</span><br><span class="line">    CleanSam (Picard)                            Cleans the provided SAM/BAM, soft-clipping beyond-end-of-reference alignments and setting MAPQ to 0 <span class="keyword">for</span> unmapped reads</span><br><span class="line">    ClipReads                                    Clip reads <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    CollectDuplicateMetrics (Picard)             Collect Duplicate metrics from marked file.</span><br><span class="line">    ConvertHeaderlessHadoopBamShardToBam         (BETA Tool) Convert a headerless BAM shard into a readable BAM</span><br><span class="line">    DownsampleByDuplicateSet                     (BETA Tool) Discard a <span class="built_in">set</span> fraction of duplicate sets from a UMI-grouped bam</span><br><span class="line">    DownsampleSam (Picard)                       Downsample a SAM or BAM file.</span><br><span class="line">    ExtractOriginalAlignmentRecordsByNameSpark   (BETA Tool) Subsets reads by name</span><br><span class="line">    FastqToSam (Picard)                          Converts a FASTQ file to an unaligned BAM or SAM file</span><br><span class="line">    FilterSamReads (Picard)                      Subsets reads from a SAM or BAM file by applying one of several filters.</span><br><span class="line">    FixMateInformation (Picard)                  Verify mate-pair information between mates and fix <span class="keyword">if</span> needed.</span><br><span class="line">    FixMisencodedBaseQualityReads                Fix Illumina base quality scores <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    GatherBamFiles (Picard)                      Concatenate efficiently BAM files that resulted from a scattered parallel analysis</span><br><span class="line">    LeftAlignIndels                              Left-aligns indels from reads <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    MarkDuplicates (Picard)                      Identifies duplicate reads.</span><br><span class="line">    MarkDuplicatesSpark                          MarkDuplicates on Spark</span><br><span class="line">    MarkDuplicatesWithMateCigar (Picard)         Identifies duplicate reads, accounting <span class="keyword">for</span> mate CIGAR.</span><br><span class="line">    MergeBamAlignment (Picard)                   Merge alignment data from a SAM or BAM with data <span class="keyword">in</span> an unmapped BAM file.</span><br><span class="line">    MergeSamFiles (Picard)                       Merges multiple SAM and/or BAM files into a single file.</span><br><span class="line">    PositionBasedDownsampleSam (Picard)          Downsample a SAM or BAM file to retain a subset of the reads based on the reads location <span class="keyword">in</span> each tile <span class="keyword">in</span> the flowcell.</span><br><span class="line">    PrintReads                                   Print reads <span class="keyword">in</span> the SAM/BAM/CRAM file</span><br><span class="line">    PrintReadsHeader                             Print the header from a SAM/BAM/CRAM file</span><br><span class="line">    PrintReadsSpark                              PrintReads on Spark</span><br><span class="line">    ReorderSam (Picard)                          Reorders reads <span class="keyword">in</span> a SAM or BAM file to match ordering <span class="keyword">in</span> a second reference file.</span><br><span class="line">    ReplaceSamHeader (Picard)                    Replaces the SAMFileHeader <span class="keyword">in</span> a SAM or BAM file.</span><br><span class="line">    RevertBaseQualityScores                      Revert Quality Scores <span class="keyword">in</span> a SAM/BAM/CRAM file</span><br><span class="line">    RevertOriginalBaseQualitiesAndAddMateCigar (Picard)Reverts the original base qualities and adds the mate cigar tag to <span class="built_in">read</span>-group BAMs</span><br><span class="line">    RevertSam (Picard)                           Reverts SAM or BAM files to a previous state.</span><br><span class="line">    RevertSamSpark                               (BETA Tool) Reverts SAM, BAM or CRAM files to a previous state.</span><br><span class="line">    SamFormatConverter (Picard)                  Convert a BAM file to a SAM file, or a SAM to a BAM</span><br><span class="line">    SamToFastq (Picard)                          Converts a SAM or BAM file to FASTQ.</span><br><span class="line">    SamToFastqWithTags (Picard)                  Converts a SAM or BAM file to FASTQ alongside FASTQs created from tags.</span><br><span class="line">    SetNmAndUqTags (Picard)                      DEPRECATED: Use SetNmMdAndUqTags instead.</span><br><span class="line">    SetNmMdAndUqTags (Picard)                    Fixes the NM, MD, and UQ tags <span class="keyword">in</span> a SAM file</span><br><span class="line">    SimpleMarkDuplicatesWithMateCigar (Picard)   (EXPERIMENTAL Tool) Examines aligned records <span class="keyword">in</span> the supplied SAM or BAM file to locate duplicate molecules.</span><br><span class="line">    SortSam (Picard)                             Sorts a SAM or BAM file</span><br><span class="line">    SortSamSpark                                 (BETA Tool) SortSam on Spark (works on SAM/BAM/CRAM)</span><br><span class="line">    SplitNCigarReads                             Split Reads with N <span class="keyword">in</span> Cigar</span><br><span class="line">    SplitReads                                   Outputs reads from a SAM/BAM/CRAM by <span class="built_in">read</span> group, sample and library name</span><br><span class="line">    SplitSamByLibrary (Picard)                   Splits a SAM or BAM file into individual files by library</span><br><span class="line">    SplitSamByNumberOfReads (Picard)             Splits a SAM or BAM file to multiple BAMs.</span><br><span class="line">    UmiAwareMarkDuplicatesWithMateCigar (Picard) (EXPERIMENTAL Tool) Identifies duplicate reads using information from <span class="built_in">read</span> positions and UMIs.</span><br><span class="line">    UnmarkDuplicates                             Clears the 0x400 duplicate SAM flag</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Reference:                                       Tools that analyze and manipulate FASTA format references</span><br><span class="line">    BaitDesigner (Picard)                        Designs oligonucleotide baits <span class="keyword">for</span> hybrid selection reactions.</span><br><span class="line">    BwaMemIndexImageCreator                      Create a BWA-MEM index image file <span class="keyword">for</span> use with GATK BWA tools</span><br><span class="line">    CountBasesInReference                        Count the numbers of each base <span class="keyword">in</span> a reference file</span><br><span class="line">    CreateSequenceDictionary (Picard)            Creates a sequence dictionary <span class="keyword">for</span> a reference sequence.</span><br><span class="line">    ExtractSequences (Picard)                    Subsets intervals from a reference sequence to a new FASTA file.</span><br><span class="line">    FastaAlternateReferenceMaker                 Create an alternative reference by combining a fasta with a vcf.</span><br><span class="line">    FastaReferenceMaker                          Create snippets of a fasta file</span><br><span class="line">    FindBadGenomicKmersSpark                     (BETA Tool) Identifies sequences that occur at high frequency <span class="keyword">in</span> a reference</span><br><span class="line">    NonNFastaSize (Picard)                       Counts the number of non-N bases <span class="keyword">in</span> a fasta file.</span><br><span class="line">    NormalizeFasta (Picard)                      Normalizes lines of sequence <span class="keyword">in</span> a FASTA file to be of the same length.</span><br><span class="line">    ScatterIntervalsByNs (Picard)                Writes an interval list created by splitting a reference at Ns.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Short Variant Discovery:                         Tools that perform variant calling and genotyping <span class="keyword">for</span> short variants (SNPs, SNVs and Indels)</span><br><span class="line">    CombineGVCFs                                 Merges one or more HaplotypeCaller GVCF files into a single GVCF with appropriate annotations</span><br><span class="line">    GenomicsDBImport                             Import VCFs to GenomicsDB</span><br><span class="line">    GenotypeGVCFs                                Perform joint genotyping on one or more samples pre-called with HaplotypeCaller</span><br><span class="line">    GnarlyGenotyper                              (BETA Tool) Perform <span class="string">"quick and dirty"</span> joint genotyping on one or more samples pre-called with HaplotypeCaller</span><br><span class="line">    HaplotypeCaller                              Call germline SNPs and indels via <span class="built_in">local</span> re-assembly of haplotypes</span><br><span class="line">    HaplotypeCallerSpark                         (BETA Tool) HaplotypeCaller on Spark</span><br><span class="line">    LearnReadOrientationModel                    Get the maximum likelihood estimates of artifact prior probabilities <span class="keyword">in</span> the orientation bias mixture model filter</span><br><span class="line">    MergeMutectStats                             Merge the stats output by scatters of a single Mutect2 job</span><br><span class="line">    Mutect2                                      Call somatic SNVs and indels via <span class="built_in">local</span> assembly of haplotypes</span><br><span class="line">    ReadsPipelineSpark                           (BETA Tool) Runs BWA (<span class="keyword">if</span> specified), MarkDuplicates, BQSR, and HaplotypeCaller on unaligned or aligned reads to generate a VCF.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Structural Variant Discovery:                    Tools that detect structural variants</span><br><span class="line">    CpxVariantReInterpreterSpark                 (BETA Tool) (Internal) Tries to extract simple variants from a provided GATK-SV CPX.vcf</span><br><span class="line">    DiscoverVariantsFromContigAlignmentsSAMSpark (BETA Tool) (Internal) Examines aligned contigs from <span class="built_in">local</span> assemblies and calls structural variants</span><br><span class="line">    ExtractSVEvidenceSpark                       (BETA Tool) (Internal) Extracts evidence of structural variations from reads</span><br><span class="line">    FindBreakpointEvidenceSpark                  (BETA Tool) (Internal) Produces <span class="built_in">local</span> assemblies of genomic regions that may harbor structural variants</span><br><span class="line">    PairedEndAndSplitReadEvidenceCollection      (BETA Tool) Gathers paired-end and split <span class="built_in">read</span> evidence files <span class="keyword">for</span> use <span class="keyword">in</span> the GATK-SV pipeline.</span><br><span class="line">    StructuralVariantDiscoverer                  (BETA Tool) (Internal) Examines aligned contigs from <span class="built_in">local</span> assemblies and calls structural variants or their breakpoints</span><br><span class="line">    StructuralVariationDiscoveryPipelineSpark    (BETA Tool) Runs the structural variation discovery workflow on a single sample</span><br><span class="line">    SvDiscoverFromLocalAssemblyContigAlignmentsSpark    (BETA Tool) (Internal) Examines aligned contigs from <span class="built_in">local</span> assemblies and calls structural variants or their breakpoints</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">Variant Evaluation and Refinement:               Tools that evaluate and refine variant calls, e.g. with annotations not offered by the engine</span><br><span class="line">    AlleleFrequencyQC                            (BETA Tool) General-purpose tool <span class="keyword">for</span> variant evaluation (% <span class="keyword">in</span> dbSNP, genotype concordance, Ti/Tv ratios, and a lot more)</span><br><span class="line">    AnnotateVcfWithBamDepth                      (Internal) Annotate a vcf with a bam<span class="string">'s read depth at each variant locus</span></span><br><span class="line"><span class="string">    AnnotateVcfWithExpectedAlleleFraction        (Internal) Annotate a vcf with expected allele fractions in pooled sequencing</span></span><br><span class="line"><span class="string">    CalculateGenotypePosteriors                  Calculate genotype posterior probabilities given family and/or known population genotypes</span></span><br><span class="line"><span class="string">    CalculateMixingFractions                     (Internal) Calculate proportions of different samples in a pooled bam</span></span><br><span class="line"><span class="string">    Concordance                                  Evaluate concordance of an input VCF against a validated truth VCF</span></span><br><span class="line"><span class="string">    CountFalsePositives                          (BETA Tool) Count PASS variants</span></span><br><span class="line"><span class="string">    CountVariants                                Counts variant records in a VCF file, regardless of filter status.</span></span><br><span class="line"><span class="string">    CountVariantsSpark                           CountVariants on Spark</span></span><br><span class="line"><span class="string">    EvaluateInfoFieldConcordance                 (BETA Tool) Evaluate concordance of info fields in an input VCF against a validated truth VCF</span></span><br><span class="line"><span class="string">    FilterFuncotations                           (EXPERIMENTAL Tool) Filter variants based on clinically-significant Funcotations.</span></span><br><span class="line"><span class="string">    FindMendelianViolations (Picard)             Finds mendelian violations of all types within a VCF</span></span><br><span class="line"><span class="string">    FuncotateSegments                            (BETA Tool) Functional annotation for segment files.  The output formats are not well-defined and subject to change.</span></span><br><span class="line"><span class="string">    Funcotator                                   Functional Annotator</span></span><br><span class="line"><span class="string">    FuncotatorDataSourceDownloader               Data source downloader for Funcotator.</span></span><br><span class="line"><span class="string">    GenotypeConcordance (Picard)                 Calculates the concordance between genotype data of one sample in each of two VCFs - truth (or reference) vs. calls.</span></span><br><span class="line"><span class="string">    MergeMutect2CallsWithMC3                     (EXPERIMENTAL Tool) UNSUPPORTED.  FOR EVALUATION ONLY. Merge M2 calls with MC</span></span><br><span class="line"><span class="string">    ReferenceBlockConcordance                    Evaluate GVCF reference block concordance of an input GVCF against a truth GVCF</span></span><br><span class="line"><span class="string">    ValidateBasicSomaticShortMutations           (EXPERIMENTAL Tool) Check variants against tumor-normal bams representing the same samples, though not the ones from the actual calls.</span></span><br><span class="line"><span class="string">    ValidateVariants                             Validate VCF</span></span><br><span class="line"><span class="string">    VariantEval                                  (BETA Tool) General-purpose tool for variant evaluation (% in dbSNP, genotype concordance, Ti/Tv ratios, and a lot more)</span></span><br><span class="line"><span class="string">    VariantsToTable                              Extract fields from a VCF file to a tab-delimited table</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">Variant Filtering:                               Tools that filter variants by annotating the FILTER column</span></span><br><span class="line"><span class="string">    ApplyVQSR                                     Apply a score cutoff to filter variants based on a recalibration table</span></span><br><span class="line"><span class="string">    CNNScoreVariants                             Apply a Convolutional Neural Net to filter annotated variants</span></span><br><span class="line"><span class="string">    CNNVariantTrain                              (EXPERIMENTAL Tool) Train a CNN model for filtering variants</span></span><br><span class="line"><span class="string">    CNNVariantWriteTensors                       (EXPERIMENTAL Tool) Write variant tensors for training a CNN to filter variants</span></span><br><span class="line"><span class="string">    CreateSomaticPanelOfNormals                  (BETA Tool) Make a panel of normals for use with Mutect2</span></span><br><span class="line"><span class="string">    FilterAlignmentArtifacts                     (EXPERIMENTAL Tool) Filter alignment artifacts from a vcf callset.</span></span><br><span class="line"><span class="string">    FilterMutectCalls                            Filter somatic SNVs and indels called by Mutect2</span></span><br><span class="line"><span class="string">    FilterVariantTranches                        Apply tranche filtering</span></span><br><span class="line"><span class="string">    FilterVcf (Picard)                           Hard filters a VCF.</span></span><br><span class="line"><span class="string">    MTLowHeteroplasmyFilterTool                  If too many low het sites, filter all low het sites</span></span><br><span class="line"><span class="string">    NuMTFilterTool                               Uses the median autosomal coverage and the allele depth to determine whether the allele might be a NuMT</span></span><br><span class="line"><span class="string">    VariantFiltration                            Filter variant calls based on INFO and/or FORMAT annotations</span></span><br><span class="line"><span class="string">    VariantRecalibrator                          Build a recalibration model to score variant quality for filtering purposes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">Variant Manipulation:                            Tools that manipulate variant call format (VCF) data</span></span><br><span class="line"><span class="string">    FixVcfHeader (Picard)                        Replaces or fixes a VCF header.</span></span><br><span class="line"><span class="string">    GatherVcfs (Picard)                          Gathers multiple VCF files from a scatter operation into a single VCF file</span></span><br><span class="line"><span class="string">    GatherVcfsCloud                              (BETA Tool) Gathers multiple VCF files from a scatter operation into a single VCF file</span></span><br><span class="line"><span class="string">    LeftAlignAndTrimVariants                     Left align and trim vairants</span></span><br><span class="line"><span class="string">    LiftoverVcf (Picard)                         Lifts over a VCF file from one reference build to another.</span></span><br><span class="line"><span class="string">    MakeSitesOnlyVcf (Picard)                    Creates a VCF that contains all the site-level information for all records in the input VCF but no genotype information.</span></span><br><span class="line"><span class="string">    MakeVcfSampleNameMap (Picard)                Creates a TSV from sample name to VCF/GVCF path, with one line per input.</span></span><br><span class="line"><span class="string">    MergeVcfs (Picard)                           Combines multiple variant files into a single variant file</span></span><br><span class="line"><span class="string">    PrintVariantsSpark                           Prints out variants from the input VCF.</span></span><br><span class="line"><span class="string">    RemoveNearbyIndels                           (Internal) Remove indels from the VCF file that are close to each other.</span></span><br><span class="line"><span class="string">    RenameSampleInVcf (Picard)                   Renames a sample within a VCF or BCF.</span></span><br><span class="line"><span class="string">    SelectVariants                               Select a subset of variants from a VCF file</span></span><br><span class="line"><span class="string">    SortVcf (Picard)                             Sorts one or more VCF files.</span></span><br><span class="line"><span class="string">    SplitVcfs (Picard)                           Splits SNPs and INDELs into separate files.</span></span><br><span class="line"><span class="string">    UpdateVCFSequenceDictionary                  Updates the sequence dictionary in a variant file.</span></span><br><span class="line"><span class="string">    UpdateVcfSequenceDictionary (Picard)         Takes a VCF and a second file that contains a sequence dictionary and updates the VCF with the new sequence dictionary.</span></span><br><span class="line"><span class="string">    VariantAnnotator                             Tool for adding annotations to VCF files</span></span><br><span class="line"><span class="string">    VcfFormatConverter (Picard)                  Converts VCF to BCF or BCF to VCF.</span></span><br><span class="line"><span class="string">    VcfToIntervalList (Picard)                   Converts a VCF or BCF file to a Picard Interval List</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure><h3 id="6-2-挂载容器外的资源"><a href="#6-2-挂载容器外的资源" class="headerlink" title="6.2 挂载容器外的资源"></a>6.2 挂载容器外的资源</h3><p>DOCKER就好比一个独立的操作系统，容器外部的资源是无法直接调用的，需要将外部资源挂载在DOCKER中，作为一个盘符来调用，使用-V参数可以实现挂载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /mnt/d:/gatk/my_data -it broadinstitute/gatk:4.1.3.0</span><br><span class="line"><span class="comment"># 这个命令是将D盘挂载在DOCKER中，并命名为my_data，路径是/gatk/my_data</span></span><br></pre></td></tr></table></figure><h3 id="6-3-退出容器"><a href="#6-3-退出容器" class="headerlink" title="6.3 退出容器"></a>6.3 退出容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p>参考资料：</p><p>[1] <a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035889991--How-to-Run-GATK-in-a-Docker-container" target="_blank" rel="noopener">Run GATK in a Docker container</a><br>[2] <a href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener">Install Docker Engine</a><br>[3] <a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener">Install Docker Engine on Ubuntu</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;安装步骤参考官方&lt;a href=&quot;https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;安装指南&lt;/a&gt;&lt;/p&gt;
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="GATK" scheme="http://uteric.github.io/tags/GATK/"/>
    
  </entry>
  
  <entry>
    <title>使用CONDA构建环境</title>
    <link href="http://uteric.github.io/Linux/condaEnvs/"/>
    <id>http://uteric.github.io/Linux/condaEnvs/</id>
    <published>2020-11-09T21:01:22.000Z</published>
    <updated>2020-11-09T21:01:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>在LINUX中，虚拟环境是在特定环境下程序的集合，使用CONDA可以实现对环境的操作。</p><h2 id="一、创建环境"><a href="#一、创建环境" class="headerlink" title="一、创建环境"></a>一、创建环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create --name envirmentA packageB</span><br><span class="line"><span class="comment"># 创建名为envirmentA的环境，并在环境中安装packageB程序</span></span><br></pre></td></tr></table></figure><h2 id="二、激活环境"><a href="#二、激活环境" class="headerlink" title="二、激活环境"></a>二、激活环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda activate envirmentA</span><br><span class="line"><span class="comment"># 激活后，命令行首会显示(envirmentA)前缀</span></span><br></pre></td></tr></table></figure><h2 id="三、检查python版本"><a href="#三、检查python版本" class="headerlink" title="三、检查python版本"></a>三、检查python版本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python --version</span><br></pre></td></tr></table></figure><h2 id="四、退出环境"><a href="#四、退出环境" class="headerlink" title="四、退出环境"></a>四、退出环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda deactive</span><br><span class="line"><span class="comment"># 创建名为envirmentA的环境，并在环境中安装packageB程序</span></span><br></pre></td></tr></table></figure><h2 id="五、查看环境列表"><a href="#五、查看环境列表" class="headerlink" title="五、查看环境列表"></a>五、查看环境列表</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda info --envs</span><br><span class="line"><span class="comment"># 当前激活的环境前面会有一个星号*</span></span><br><span class="line">conda list</span><br><span class="line"><span class="comment"># 查看当前环境中的程序</span></span><br></pre></td></tr></table></figure><h2 id="六、删除环境"><a href="#六、删除环境" class="headerlink" title="六、删除环境"></a>六、删除环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda remove -n envirmentA --all</span><br><span class="line"><span class="comment"># 删除整个环境</span></span><br><span class="line">conda remove -n envirmentA packageB</span><br><span class="line"><span class="comment"># 删除环境中的程序</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在LINUX中，虚拟环境是在特定环境下程序的集合，使用CONDA可以实现对环境的操作。&lt;/p&gt;
&lt;h2 id=&quot;一、创建环境&quot;&gt;&lt;a href=&quot;#一、创建环境&quot; class=&quot;headerlink&quot; title=&quot;一、创建环境&quot;&gt;&lt;/a&gt;一、创建环境&lt;/h2&gt;&lt;figur
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="CONDA" scheme="http://uteric.github.io/tags/CONDA/"/>
    
  </entry>
  
  <entry>
    <title>外显子测序分析二</title>
    <link href="http://uteric.github.io/WES/wes02/"/>
    <id>http://uteric.github.io/WES/wes02/</id>
    <published>2020-11-06T20:47:26.000Z</published>
    <updated>2020-11-06T20:47:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035535932-Germline-short-variant-discovery-SNPs-Indels-" target="_blank" rel="noopener">Germline short variant discovery (SNPs + Indels)</a></p><p>下面这张图是单样本种系突变的主要分析步骤（Main steps for Germline Single-Sample Data）</p><p><img src="/images/LINUX/gatk01.png" alt></p><h2 id="一、数据质控"><a href="#一、数据质控" class="headerlink" title="一、数据质控"></a>一、数据质控</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">fastp -i /mnt/d/wes/sample/fastq/sam01_1.fastq -I /mnt/d/wes/sample/fastq/sam01_2.fastq -o /mnt/d/wes/sample/qc/clean_sam01_1.fastq -O /mnt/d/wes/sample/qc/clean_sam01_2.fastq</span><br><span class="line"></span><br><span class="line"><span class="comment"># 耗时30秒</span></span><br><span class="line">Read1 before filtering:</span><br><span class="line">total reads: 1582559</span><br><span class="line">total bases: 238966409</span><br><span class="line">Q20 bases: 234035553(97.9366%)</span><br><span class="line">Q30 bases: 225671450(94.4365%)</span><br><span class="line"></span><br><span class="line">Read2 before filtering:</span><br><span class="line">total reads: 1582559</span><br><span class="line">total bases: 238966409</span><br><span class="line">Q20 bases: 232564639(97.3211%)</span><br><span class="line">Q30 bases: 222663993(93.1779%)</span><br><span class="line"></span><br><span class="line">Read1 after filtering:</span><br><span class="line">total reads: 1564770</span><br><span class="line">total bases: 233787024</span><br><span class="line">Q20 bases: 229439315(98.1403%)</span><br><span class="line">Q30 bases: 221439194(94.7183%)</span><br><span class="line"></span><br><span class="line">Read2 aftering filtering:</span><br><span class="line">total reads: 1564770</span><br><span class="line">total bases: 233787024</span><br><span class="line">Q20 bases: 228711758(97.8291%)</span><br><span class="line">Q30 bases: 219341614(93.8211%)</span><br><span class="line"></span><br><span class="line">Filtering result:</span><br><span class="line">reads passed filter: 3129540</span><br><span class="line">reads failed due to low quality: 35106</span><br><span class="line">reads failed due to too many N: 472</span><br><span class="line">reads failed due to too short: 0</span><br><span class="line">reads with adapter trimmed: 339368</span><br><span class="line">bases trimmed due to adapters: 4994344</span><br><span class="line"></span><br><span class="line">Duplication rate: 0.84949%</span><br><span class="line"></span><br><span class="line">Insert size peak (evaluated by paired-end reads): 190</span><br><span class="line"></span><br><span class="line">JSON report: fastp.json</span><br><span class="line">HTML report: fastp.html</span><br><span class="line"></span><br><span class="line">fastp -i /mnt/d/wes/sample/fastq/sam01_1.fastq -I /mnt/d/wes/sample/fastq/sam01_2.fastq -o /mnt/d/wes/sample/qc/clean_sam01_1.fastq -O /mnt/d/wes/sample/qc/clean_sam01_2.fastq</span><br><span class="line">fastp v0.20.1, time used: 30 seconds</span><br></pre></td></tr></table></figure><h2 id="二、比对至基因组"><a href="#二、比对至基因组" class="headerlink" title="二、比对至基因组"></a>二、比对至基因组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">bwa mem -t 4 -B 4 -R <span class="string">'@RG\tID:lane1\tSM:sample1\tLB:genome\tPL:ILLUMINA'</span> -M ~/ncbi/hg38/chroms/hg38.fa /mnt/d/wes/sample/qc/clean_sam01_1.fastq /mnt/d/wes/sample/qc/clean_sam01_2.fastq | samtools view -q4 -bS -o - - | samtools sort -@4 -o /mnt/d/wes/sample/bam/clean_sam01.bam -</span><br><span class="line"><span class="comment"># 比对耗时30分钟</span></span><br><span class="line">[M::bwa_idx_load_from_disk] <span class="built_in">read</span> 0 ALT contigs</span><br><span class="line">[M::process] <span class="built_in">read</span> 267772 sequences (40000138 bp)...</span><br><span class="line">[M::process] <span class="built_in">read</span> 267742 sequences (40000164 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (0, 90228, 1, 2)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.01, 45.34)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267772 reads <span class="keyword">in</span> 272.156 CPU sec, 11919.176 real sec</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (2, 90153, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.42, 45.38)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267742 reads <span class="keyword">in</span> 144.141 CPU sec, 120.016 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267734 sequences (40000200 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (1, 90334, 1, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 232)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (43, 358)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.52, 45.61)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 421)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::process] <span class="built_in">read</span> 267748 sequences (40000292 bp)...</span><br><span class="line">[M::mem_process_seqs] Processed 267734 reads <span class="keyword">in</span> 151.547 CPU sec, 143.398 real sec</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (1, 90216, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.43, 45.49)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267748 reads <span class="keyword">in</span> 146.859 CPU sec, 111.532 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267744 sequences (40000056 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (4, 90236, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.11, 45.29)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267744 reads <span class="keyword">in</span> 123.953 CPU sec, 90.588 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267718 sequences (40000024 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (1, 90313, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.03, 45.17)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267718 reads <span class="keyword">in</span> 141.703 CPU sec, 111.135 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267686 sequences (40000084 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (2, 90081, 1, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.38, 45.37)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267686 reads <span class="keyword">in</span> 134.469 CPU sec, 95.876 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267726 sequences (40000068 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (3, 90134, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.15, 45.43)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267726 reads <span class="keyword">in</span> 134.438 CPU sec, 100.282 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267692 sequences (40000016 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (1, 90379, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (170, 198, 232)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (46, 356)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.61, 45.49)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 418)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267692 reads <span class="keyword">in</span> 134.969 CPU sec, 100.242 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 267726 sequences (40000064 bp)...</span><br><span class="line"> [M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (2, 90356, 0, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.19, 45.30)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::process] <span class="built_in">read</span> 267698 sequences (40000206 bp)...</span><br><span class="line">[M::mem_process_seqs] Processed 267726 reads <span class="keyword">in</span> 141.531 CPU sec, 116.261 real sec</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (2, 90064, 1, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.27, 45.37)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267698 reads <span class="keyword">in</span> 149.391 CPU sec, 125.276 real sec</span><br><span class="line">[M::process] <span class="built_in">read</span> 184554 sequences (27572736 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (0, 62039, 1, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 197, 231)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (45, 355)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (201.96, 45.23)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 417)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 184554 reads <span class="keyword">in</span> 102.375 CPU sec, 77.923 real sec</span><br><span class="line">[main] Version: 0.7.17-r1188</span><br><span class="line">[main] CMD: bwa mem -t 4 -B 4 -R @RG\tID:lane1\tSM:sample1\tLB:genome\tPL:ILLUMINA -M /home/eric/ncbi/hg38/chroms/hg38.fa /mnt/d/wes/sample/qc/clean_sam01_1.fastq /mnt/d/wes/sample/qc/clean_sam01_2.fastq</span><br><span class="line">[main] Real time: 13158.133 sec; CPU: 1804.688 sec</span><br><span class="line">[bam_sort_core] merging from 0 files and 4 <span class="keyword">in</span>-memory blocks...</span><br><span class="line"><span class="comment"># 加上索引文件</span></span><br><span class="line">samtools index /mnt/d/wes/sample/bam/clean_sam01.bam</span><br><span class="line"><span class="comment"># 查看文件大小</span></span><br><span class="line">total 159M</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 155M Nov  6 18:45 clean_sam01.bam</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 3.1M Nov  6 19:12 clean_sam01.bam.bai</span><br></pre></td></tr></table></figure><h2 id="三、PCR去重"><a href="#三、PCR去重" class="headerlink" title="三、PCR去重"></a>三、PCR去重</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">gatk MarkDuplicates -I /mnt/d/wes/sample/bam/clean_sam01.bam -O /mnt/d/wes/sample/nodup/nodup_sam01.bam -M /mnt/d/wes/sample/nodup/metrics_sam01.txt --REMOVE_DUPLICATES <span class="literal">true</span> --ASSUME_SORTED <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">Using GATK jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar</span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar MarkDuplicates -I /mnt/d/wes/sample/bam/clean_sam01.bam -O /mnt/d/wes/sample/nodup/nodup_sam01.bam -M /mnt/d/wes/sample/nodup/metrics_sam01.txt --REMOVE_DUPLICATES <span class="literal">true</span> --ASSUME_SORTED <span class="literal">true</span></span><br><span class="line">19:17:37.667 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">[Fri Nov 06 19:17:37 CST 2020] MarkDuplicates --INPUT /mnt/d/wes/sample/bam/clean_sam01.bam --OUTPUT /mnt/d/wes/sample/nodup/nodup_sam01.bam --METRICS_FILE /mnt/d/wes/sample/nodup/metrics_sam01.txt --REMOVE_DUPLICATES <span class="literal">true</span> --ASSUME_SORTED <span class="literal">true</span> --MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP 50000 --MAX_FILE_HANDLES_FOR_READ_ENDS_MAP 8000 --SORTING_COLLECTION_SIZE_RATIO 0.25 --TAG_DUPLICATE_SET_MEMBERS <span class="literal">false</span> --REMOVE_SEQUENCING_DUPLICATES <span class="literal">false</span> --TAGGING_POLICY DontTag --CLEAR_DT <span class="literal">true</span> --DUPLEX_UMI <span class="literal">false</span> --ADD_PG_TAG_TO_READS <span class="literal">true</span> --DUPLICATE_SCORING_STRATEGY SUM_OF_BASE_QUALITIES --PROGRAM_RECORD_ID MarkDuplicates --PROGRAM_GROUP_NAME MarkDuplicates --READ_NAME_REGEX &lt;optimized capture of last three <span class="string">':'</span> separated fields as numeric values&gt; --OPTICAL_DUPLICATE_PIXEL_DISTANCE 100 --MAX_OPTICAL_DUPLICATE_SET_SIZE 300000 --VERBOSITY INFO --QUIET <span class="literal">false</span> --VALIDATION_STRINGENCY STRICT --COMPRESSION_LEVEL 2 --MAX_RECORDS_IN_RAM 500000 --CREATE_INDEX <span class="literal">false</span> --CREATE_MD5_FILE <span class="literal">false</span> --GA4GH_CLIENT_SECRETS client_secrets.json --<span class="built_in">help</span> <span class="literal">false</span> --version <span class="literal">false</span> --showHidden <span class="literal">false</span> --USE_JDK_DEFLATER <span class="literal">false</span> --USE_JDK_INFLATER <span class="literal">false</span></span><br><span class="line">Nov 06, 2020 7:17:38 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">[Fri Nov 06 19:17:38 CST 2020] Executing as eric@LAPTOP-90TPP2NM on Linux 4.4.0-18362-Microsoft amd64; OpenJDK 64-Bit Server VM 1.8.0_152-release-1056-b12; Deflater: Intel; Inflater: Intel; Provider GCS is available; Picard version: Version:4.1.9.0</span><br><span class="line">INFO    2020-11-06 19:17:38     MarkDuplicates  Start of doWork freeMemory: 430727552; totalMemory: 446169088; maxMemory: 1883242496</span><br><span class="line">INFO    2020-11-06 19:17:38     MarkDuplicates  Reading input file and constructing <span class="built_in">read</span> end information.</span><br><span class="line">INFO    2020-11-06 19:17:38     MarkDuplicates  Will retain up to 6823342 data points before spilling to disk.</span><br><span class="line">WARNING 2020-11-06 19:17:38     AbstractOpticalDuplicateFinderCommandLineProgram        A field field parsed out of a <span class="built_in">read</span> name was expected to contain an <span class="built_in">integer</span> and did not. Read name: SRR12846241.10302161. Cause: String <span class="string">'SRR12846241.10302161'</span> did not start with a parsable number.</span><br><span class="line">INFO    2020-11-06 19:17:49     MarkDuplicates  Read     1,000,000 records.  Elapsed time: 00:00:10s.  Time <span class="keyword">for</span> last 1,000,000:   10s.  Last <span class="built_in">read</span> position: chr17:17,169,090</span><br><span class="line">INFO    2020-11-06 19:17:49     MarkDuplicates  Tracking 2670 as yet unmatched pairs. 78 records <span class="keyword">in</span> RAM.</span><br><span class="line">INFO    2020-11-06 19:17:58     MarkDuplicates  Read     2,000,000 records.  Elapsed time: 00:00:19s.  Time <span class="keyword">for</span> last 1,000,000:    8s.  Last <span class="built_in">read</span> position: chr5:170,878,110</span><br><span class="line">INFO    2020-11-06 19:17:58     MarkDuplicates  Tracking 3897 as yet unmatched pairs. 134 records <span class="keyword">in</span> RAM.</span><br><span class="line">INFO    2020-11-06 19:18:02     MarkDuplicates  Read 2540180 records. 4018 pairs never matched.</span><br><span class="line">INFO    2020-11-06 19:18:03     MarkDuplicates  After buildSortedReadEndLists freeMemory: 720026592; totalMemory: 1068498944; maxMemory: 1883242496</span><br><span class="line">INFO    2020-11-06 19:18:03     MarkDuplicates  Will retain up to 58851328 duplicate indices before spilling to disk.</span><br><span class="line">INFO    2020-11-06 19:18:03     MarkDuplicates  Traversing <span class="built_in">read</span> pair information and detecting duplicates.</span><br><span class="line">INFO    2020-11-06 19:18:04     MarkDuplicates  Traversing fragment information and detecting duplicates.</span><br><span class="line">INFO    2020-11-06 19:18:04     MarkDuplicates  Sorting list of duplicate records.</span><br><span class="line">INFO    2020-11-06 19:18:05     MarkDuplicates  After generateDuplicateIndexes freeMemory: 1016276296; totalMemory: 1506803712; maxMemory: 1883242496</span><br><span class="line">INFO    2020-11-06 19:18:05     MarkDuplicates  Marking 22740 records as duplicates.</span><br><span class="line">INFO    2020-11-06 19:18:05     MarkDuplicates  Found 0 optical duplicate clusters.</span><br><span class="line">INFO    2020-11-06 19:18:05     MarkDuplicates  Reads are assumed to be ordered by: coordinate</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  Writing complete. Closing input iterator.</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  Duplicate Index cleanup.</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  Getting Memory Stats.</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  Before output close freeMemory: 1489644800; totalMemory: 1512046592; maxMemory: 1883242496</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  Closed outputs. Getting more Memory Stats.</span><br><span class="line">INFO    2020-11-06 19:18:23     MarkDuplicates  After output close freeMemory: 1519717896; totalMemory: 1537736704; maxMemory: 1883242496</span><br><span class="line">[Fri Nov 06 19:18:23 CST 2020] picard.sam.markduplicates.MarkDuplicates <span class="keyword">done</span>. Elapsed time: 0.77 minutes.</span><br><span class="line">Runtime.totalMemory()=1537736704</span><br><span class="line">Tool returned:</span><br><span class="line">0</span><br><span class="line"><span class="comment"># 加上索引文件</span></span><br><span class="line">samtools index /mnt/d/wes/sample/nodup/nodup_sam01.bam</span><br><span class="line"><span class="comment"># 查看文件大小</span></span><br><span class="line">total 216M</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 3.5K Nov  6 19:18 metrics_sam01.txt</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 216M Nov  6 19:18 nodup_sam01.bam</span><br></pre></td></tr></table></figure><h2 id="四、BQSR"><a href="#四、BQSR" class="headerlink" title="四、BQSR"></a>四、BQSR</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一步</span></span><br><span class="line">gatk BaseRecalibrator -I /mnt/d/wes/sample/nodup/nodup_sam01.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --known-sites /home/eric/ncbi/hg38/vcf/dbsnp_138.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/1000G_phase1.snps.high_confidence.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz -L /home/eric/ncbi/hg38/vcf/hg38_v0_HybSelOligos_whole_exome_illumina_coding_v1_whole_exome_illumina_coding_v1.Homo_sapiens_assembly38.targets.interval_list -O /mnt/d/wes/sample/bqsr/recal.table</span><br><span class="line"></span><br><span class="line">Using GATK jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar</span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar BaseRecalibrator -I /mnt/d/wes/sample/nodup/nodup_sam01.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --known-sites /home/eric/ncbi/hg38/vcf/dbsnp_138.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/1000G_phase1.snps.high_confidence.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz -L /home/eric/ncbi/hg38/vcf/hg38_v0_HybSelOligos_whole_exome_illumina_coding_v1_whole_exome_illumina_coding_v1.Homo_sapiens_assembly38.targets.interval_list -O /mnt/d/wes/sample/bqsr/recal.table</span><br><span class="line">19:30:17.520 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">Nov 06, 2020 7:30:18 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">19:30:18.041 INFO  BaseRecalibrator - ------------------------------------------------------------</span><br><span class="line">19:30:18.042 INFO  BaseRecalibrator - The Genome Analysis Toolkit (GATK) v4.1.9.0</span><br><span class="line">19:30:18.044 INFO  BaseRecalibrator - For support and documentation go to https://software.broadinstitute.org/gatk/</span><br><span class="line">19:30:18.046 INFO  BaseRecalibrator - Executing as eric@LAPTOP-90TPP2NM on Linux v4.4.0-18362-Microsoft amd64</span><br><span class="line">19:30:18.048 INFO  BaseRecalibrator - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12</span><br><span class="line">19:30:18.050 INFO  BaseRecalibrator - Start Date/Time: November 6, 2020 7:30:17 PM CST</span><br><span class="line">19:30:18.052 INFO  BaseRecalibrator - ------------------------------------------------------------</span><br><span class="line">19:30:18.053 INFO  BaseRecalibrator - ------------------------------------------------------------</span><br><span class="line">19:30:18.057 INFO  BaseRecalibrator - HTSJDK Version: 2.23.0</span><br><span class="line">19:30:18.058 INFO  BaseRecalibrator - Picard Version: 2.23.3</span><br><span class="line">19:30:18.060 INFO  BaseRecalibrator - HTSJDK Defaults.COMPRESSION_LEVEL : 2</span><br><span class="line">19:30:18.061 INFO  BaseRecalibrator - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="literal">false</span></span><br><span class="line">19:30:18.063 INFO  BaseRecalibrator - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="literal">true</span></span><br><span class="line">19:30:18.064 INFO  BaseRecalibrator - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="literal">false</span></span><br><span class="line">19:30:18.067 INFO  BaseRecalibrator - Deflater: IntelDeflater</span><br><span class="line">19:30:18.069 INFO  BaseRecalibrator - Inflater: IntelInflater</span><br><span class="line">19:30:18.071 INFO  BaseRecalibrator - GCS max retries/reopens: 20</span><br><span class="line">19:30:18.073 INFO  BaseRecalibrator - Requester pays: disabled</span><br><span class="line">19:30:18.074 INFO  BaseRecalibrator - Initializing engine</span><br><span class="line">19:30:18.976 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///home/eric/ncbi/hg38/vcf/dbsnp_138.hg38.vcf.gz</span><br><span class="line">19:30:19.256 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///home/eric/ncbi/hg38/vcf/1000G_phase1.snps.high_confidence.hg38.vcf.gz</span><br><span class="line">19:30:19.439 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///home/eric/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz</span><br><span class="line">19:30:19.691 INFO  FeatureManager - Using codec IntervalListCodec to <span class="built_in">read</span> file file:///home/eric/ncbi/hg38/vcf/hg38_v0_HybSelOligos_whole_exome_illumina_coding_v1_whole_exome_illumina_coding_v1.Homo_sapiens_assembly38.targets.interval_list</span><br><span class="line">19:30:24.305 INFO  IntervalArgumentCollection - Processing 38692858 bp from intervals</span><br><span class="line">19:30:24.465 INFO  BaseRecalibrator - Done initializing engine</span><br><span class="line">19:30:24.491 INFO  BaseRecalibrationEngine - The covariates being used here:</span><br><span class="line">19:30:24.493 INFO  BaseRecalibrationEngine -    ReadGroupCovariate</span><br><span class="line">19:30:24.496 INFO  BaseRecalibrationEngine -    QualityScoreCovariate</span><br><span class="line">19:30:24.497 INFO  BaseRecalibrationEngine -    ContextCovariate</span><br><span class="line">19:30:24.499 INFO  BaseRecalibrationEngine -    CycleCovariate</span><br><span class="line">19:30:24.520 INFO  ProgressMeter - Starting traversal</span><br><span class="line">19:30:24.524 INFO  ProgressMeter -        Current Locus  Elapsed Minutes       Reads Processed     Reads/Minute</span><br><span class="line">19:30:34.676 INFO  ProgressMeter -        chr1:37721636              0.2                 45000         266009.9</span><br><span class="line">19:30:44.837 INFO  ProgressMeter -       chr1:153937400              0.3                108000         319023.2</span><br><span class="line">19:30:54.949 INFO  ProgressMeter -       chr1:232471505              0.5                164000         323428.9</span><br><span class="line">19:31:05.042 INFO  ProgressMeter -       chr10:96206871              0.7                224000         331712.6</span><br><span class="line">19:31:15.085 INFO  ProgressMeter -       chr11:57300855              0.8                282000         334651.9</span><br><span class="line">19:31:25.278 INFO  ProgressMeter -        chr12:2688514              1.0                343000         338748.7</span><br><span class="line">19:31:35.402 INFO  ProgressMeter -      chr12:100262225              1.2                402000         340307.9</span><br><span class="line">19:31:45.512 INFO  ProgressMeter -      chr13:111202974              1.3                456000         337832.0</span><br><span class="line">19:31:55.612 INFO  ProgressMeter -       chr15:28228255              1.5                514000         338581.1</span><br><span class="line">19:32:05.652 INFO  ProgressMeter -        chr16:1495337              1.7                572000         339375.2</span><br><span class="line">19:32:15.750 INFO  ProgressMeter -       chr16:88639021              1.9                634000         342012.5</span><br><span class="line">19:32:25.807 INFO  ProgressMeter -       chr17:58316342              2.0                700000         346300.4</span><br><span class="line">19:32:35.823 INFO  ProgressMeter -       chr18:79451785              2.2                756000         345473.7</span><br><span class="line">19:32:45.892 INFO  ProgressMeter -       chr19:40938908              2.4                822000         348881.6</span><br><span class="line">19:32:56.008 INFO  ProgressMeter -        chr2:46623835              2.5                884000         350138.3</span><br><span class="line">19:33:06.010 INFO  ProgressMeter -       chr2:169735426              2.7                946000         351489.9</span><br><span class="line">19:33:16.139 INFO  ProgressMeter -       chr20:20047689              2.9               1003000         350670.7</span><br><span class="line">19:33:26.142 INFO  ProgressMeter -       chr22:23061695              3.0               1058000         349526.8</span><br><span class="line">19:33:36.257 INFO  ProgressMeter -        chr3:48672416              3.2               1113000         348300.5</span><br><span class="line">19:33:46.412 INFO  ProgressMeter -       chr3:171093877              3.4               1168000         347126.6</span><br><span class="line">19:33:56.453 INFO  ProgressMeter -        chr4:99342797              3.5               1220000         345400.3</span><br><span class="line">19:34:06.491 INFO  ProgressMeter -        chr5:79030744              3.7               1273000         344106.8</span><br><span class="line">19:34:16.538 INFO  ProgressMeter -        chr6:10898046              3.9               1327000         343170.4</span><br><span class="line">19:34:26.588 INFO  ProgressMeter -       chr6:136558746              4.0               1379000         341811.8</span><br><span class="line">19:34:36.722 INFO  ProgressMeter -        chr7:87836098              4.2               1434000         341161.9</span><br><span class="line">19:34:46.961 INFO  ProgressMeter -        chr8:24321118              4.4               1490000         340654.5</span><br><span class="line">19:34:57.099 INFO  ProgressMeter -         chr9:5811124              4.5               1536000         338110.0</span><br><span class="line">19:35:07.197 INFO  ProgressMeter -       chr9:132014280              4.7               1593000         338130.4</span><br><span class="line">19:35:16.870 INFO  BaseRecalibrator - 0 <span class="built_in">read</span>(s) filtered by: MappingQualityNotZeroReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: MappingQualityAvailableReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: MappedReadFilter</span><br><span class="line">425 <span class="built_in">read</span>(s) filtered by: NotSecondaryAlignmentReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: NotDuplicateReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: PassesVendorQualityCheckReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: WellformedReadFilter</span><br><span class="line">425 total reads filtered</span><br><span class="line">19:35:16.886 INFO  ProgressMeter -        chrY:13260230              4.9               1646850         337976.0</span><br><span class="line">19:35:16.888 INFO  ProgressMeter - Traversal complete. Processed 1646850 total reads <span class="keyword">in</span> 4.9 minutes.</span><br><span class="line">19:35:17.006 INFO  BaseRecalibrator - Calculating quantized quality scores...</span><br><span class="line">19:35:17.053 INFO  BaseRecalibrator - Writing recalibration report...</span><br><span class="line">19:35:17.663 INFO  BaseRecalibrator - ...<span class="keyword">done</span>!</span><br><span class="line">19:35:17.712 INFO  BaseRecalibrator - BaseRecalibrator was able to recalibrate 1646850 reads</span><br><span class="line">19:35:17.753 INFO  BaseRecalibrator - Shutting down engine</span><br><span class="line">[November 6, 2020 7:35:17 PM CST] org.broadinstitute.hellbender.tools.walkers.bqsr.BaseRecalibrator <span class="keyword">done</span>. Elapsed time: 5.01 minutes.</span><br><span class="line">Runtime.totalMemory()=876609536</span><br><span class="line">Tool returned:</span><br><span class="line">SUCCESS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二步</span></span><br><span class="line">gatk ApplyBQSR -I /mnt/d/wes/sample/nodup/nodup_sam01.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --bqsr-recal-file /mnt/d/wes/sample/bqsr/recal.table -O /mnt/d/wes/sample/bqsr/bqsr_sam01.bam</span><br><span class="line"></span><br><span class="line">Using GATK jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar</span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar ApplyBQSR -I /mnt/d/wes/sample/nodup/nodup_sam01.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --bqsr-recal-file /mnt/d/wes/sample/bqsr/recal.table -O /mnt/d/wes/sample/bqsr/bqsr_sam01.bam</span><br><span class="line">19:38:44.345 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">Nov 06, 2020 7:38:44 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">19:38:44.928 INFO  ApplyBQSR - ------------------------------------------------------------</span><br><span class="line">19:38:44.929 INFO  ApplyBQSR - The Genome Analysis Toolkit (GATK) v4.1.9.0</span><br><span class="line">19:38:44.931 INFO  ApplyBQSR - For support and documentation go to https://software.broadinstitute.org/gatk/</span><br><span class="line">19:38:44.934 INFO  ApplyBQSR - Executing as eric@LAPTOP-90TPP2NM on Linux v4.4.0-18362-Microsoft amd64</span><br><span class="line">19:38:44.936 INFO  ApplyBQSR - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12</span><br><span class="line">19:38:44.938 INFO  ApplyBQSR - Start Date/Time: November 6, 2020 7:38:44 PM CST</span><br><span class="line">19:38:44.939 INFO  ApplyBQSR - ------------------------------------------------------------</span><br><span class="line">19:38:44.942 INFO  ApplyBQSR - ------------------------------------------------------------</span><br><span class="line">19:38:44.949 INFO  ApplyBQSR - HTSJDK Version: 2.23.0</span><br><span class="line">19:38:44.950 INFO  ApplyBQSR - Picard Version: 2.23.3</span><br><span class="line">19:38:44.957 INFO  ApplyBQSR - HTSJDK Defaults.COMPRESSION_LEVEL : 2</span><br><span class="line">19:38:44.959 INFO  ApplyBQSR - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="literal">false</span></span><br><span class="line">19:38:44.961 INFO  ApplyBQSR - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="literal">true</span></span><br><span class="line">19:38:44.962 INFO  ApplyBQSR - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="literal">false</span></span><br><span class="line">19:38:44.963 INFO  ApplyBQSR - Deflater: IntelDeflater</span><br><span class="line">19:38:44.965 INFO  ApplyBQSR - Inflater: IntelInflater</span><br><span class="line">19:38:44.967 INFO  ApplyBQSR - GCS max retries/reopens: 20</span><br><span class="line">19:38:44.972 INFO  ApplyBQSR - Requester pays: disabled</span><br><span class="line">19:38:44.973 INFO  ApplyBQSR - Initializing engine</span><br><span class="line">19:38:45.850 INFO  ApplyBQSR - Done initializing engine</span><br><span class="line">19:38:45.930 INFO  ProgressMeter - Starting traversal</span><br><span class="line">19:38:45.937 INFO  ProgressMeter -        Current Locus  Elapsed Minutes       Reads Processed     Reads/Minute</span><br><span class="line">19:38:55.958 INFO  ProgressMeter -       chr1:235328572              0.2                249000        1491315.6</span><br><span class="line">19:39:05.958 INFO  ProgressMeter -       chr12:96684881              0.3                597000        1789300.2</span><br><span class="line">19:39:15.963 INFO  ProgressMeter -        chr17:4901462              0.5                969000        1936450.8</span><br><span class="line">19:39:25.972 INFO  ProgressMeter -        chr2:96187143              0.7               1348000        2020383.7</span><br><span class="line">19:39:35.978 INFO  ProgressMeter -       chr3:142790913              0.8               1735000        2080377.3</span><br><span class="line">19:39:45.992 INFO  ProgressMeter -        chr7:21588589              1.0               2123000        2121126.3</span><br><span class="line">19:39:55.994 INFO  ProgressMeter -       chrX:153961533              1.2               2509000        2148883.0</span><br><span class="line">19:39:56.224 INFO  ApplyBQSR - 0 <span class="built_in">read</span>(s) filtered by: WellformedReadFilter</span><br><span class="line"></span><br><span class="line">19:39:56.227 INFO  ProgressMeter -        chrY:25168958              1.2               2517440        2148964.3</span><br><span class="line">19:39:56.228 INFO  ProgressMeter - Traversal complete. Processed 2517440 total reads <span class="keyword">in</span> 1.2 minutes.</span><br><span class="line">19:39:56.277 INFO  ApplyBQSR - Shutting down engine</span><br><span class="line">[November 6, 2020 7:39:56 PM CST] org.broadinstitute.hellbender.tools.walkers.bqsr.ApplyBQSR <span class="keyword">done</span>. Elapsed time: 1.20 minutes.</span><br><span class="line">Runtime.totalMemory()=617086976</span><br><span class="line"><span class="comment"># 查看文件</span></span><br><span class="line">total 421M</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 3.8M Nov  6 19:39 bqsr_sam01.bai</span><br><span class="line">-rwxrwxrwx 1 xxx xxx 417M Nov  6 19:39 bqsr_sam01.bam</span><br><span class="line"><span class="comment"># 现在，BQSR完成后，就得到Analysis-Ready Reads</span></span><br></pre></td></tr></table></figure><h2 id="五、变异检测"><a href="#五、变异检测" class="headerlink" title="五、变异检测"></a>五、变异检测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">gatk HaplotypeCaller -R /home/eric/ncbi/hg38/chroms/hg38.fa -I /mnt/d/wes/sample/bqsr/bqsr_sam01.bam -O /mnt/d/wes/sample/<span class="built_in">caller</span>/output.g.vcf.gz -ERC GVCF</span><br><span class="line"><span class="comment"># 这一步比较耗时</span></span><br><span class="line">22:06:51.680 INFO  HaplotypeCaller - 17268 <span class="built_in">read</span>(s) filtered by: MappingQualityReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: MappingQualityAvailableReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: MappedReadFilter</span><br><span class="line">1538 <span class="built_in">read</span>(s) filtered by: NotSecondaryAlignmentReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: NotDuplicateReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: PassesVendorQualityCheckReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: NonZeroReferenceLengthAlignmentReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: GoodCigarReadFilter</span><br><span class="line">0 <span class="built_in">read</span>(s) filtered by: WellformedReadFilter</span><br><span class="line">18806 total reads filtered</span><br><span class="line">22:06:51.872 INFO  ProgressMeter - chrY_KI270740v1_random:36001             86.3              10857084         125749.4</span><br><span class="line">22:06:51.881 INFO  ProgressMeter - Traversal complete. Processed 10857084 total regions <span class="keyword">in</span> 86.3 minutes.</span><br><span class="line">22:06:52.209 INFO  PairHMM - Total compute time <span class="keyword">in</span> PairHMM computeLogLikelihoods() : 298.5258293</span><br><span class="line">22:06:52.233 INFO  SmithWatermanAligner - Total compute time <span class="keyword">in</span> java Smith-Waterman : 131.45 sec</span><br><span class="line">22:06:52.234 INFO  HaplotypeCaller - Shutting down engine</span><br><span class="line">[November 6, 2020 10:06:52 PM CST] org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller <span class="keyword">done</span>. Elapsed time: 86.37 minutes.</span><br><span class="line">Runtime.totalMemory()=1270349824</span><br><span class="line"><span class="comment"># 下面转化为vcf.gz</span></span><br><span class="line">gatk GenotypeGVCFs -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/sample/<span class="built_in">caller</span>/output.g.vcf.gz -O /mnt/d/wes/sample/<span class="built_in">caller</span>/output.vcf.gz</span><br><span class="line"><span class="comment"># 这个过程很快</span></span><br><span class="line">Using GATK jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar</span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar GenotypeGVCFs -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/sample/<span class="built_in">caller</span>/output.g.vcf.gz -O /mnt/d/wes/sample/<span class="built_in">caller</span>/output.vcf.gz</span><br><span class="line">22:14:25.026 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/home/eric/miniconda3/share/gatk4-4.1.9.0-0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">Nov 06, 2020 10:14:25 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">22:14:25.679 INFO  GenotypeGVCFs - ------------------------------------------------------------</span><br><span class="line">22:14:25.687 INFO  GenotypeGVCFs - The Genome Analysis Toolkit (GATK) v4.1.9.0</span><br><span class="line">22:14:25.688 INFO  GenotypeGVCFs - For support and documentation go to https://software.broadinstitute.org/gatk/</span><br><span class="line">22:14:25.691 INFO  GenotypeGVCFs - Executing as eric@LAPTOP-90TPP2NM on Linux v4.4.0-18362-Microsoft amd64</span><br><span class="line">22:14:25.693 INFO  GenotypeGVCFs - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12</span><br><span class="line">22:14:25.697 INFO  GenotypeGVCFs - Start Date/Time: November 6, 2020 10:14:24 PM CST</span><br><span class="line">22:14:25.700 INFO  GenotypeGVCFs - ------------------------------------------------------------</span><br><span class="line">22:14:25.703 INFO  GenotypeGVCFs - ------------------------------------------------------------</span><br><span class="line">22:14:25.705 INFO  GenotypeGVCFs - HTSJDK Version: 2.23.0</span><br><span class="line">22:14:25.706 INFO  GenotypeGVCFs - Picard Version: 2.23.3</span><br><span class="line">22:14:25.709 INFO  GenotypeGVCFs - HTSJDK Defaults.COMPRESSION_LEVEL : 2</span><br><span class="line">22:14:25.711 INFO  GenotypeGVCFs - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="literal">false</span></span><br><span class="line">22:14:25.717 INFO  GenotypeGVCFs - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="literal">true</span></span><br><span class="line">22:14:25.720 INFO  GenotypeGVCFs - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="literal">false</span></span><br><span class="line">22:14:25.722 INFO  GenotypeGVCFs - Deflater: IntelDeflater</span><br><span class="line">22:14:25.724 INFO  GenotypeGVCFs - Inflater: IntelInflater</span><br><span class="line">22:14:25.728 INFO  GenotypeGVCFs - GCS max retries/reopens: 20</span><br><span class="line">22:14:25.729 INFO  GenotypeGVCFs - Requester pays: disabled</span><br><span class="line">22:14:25.734 INFO  GenotypeGVCFs - Initializing engine</span><br><span class="line">22:14:26.642 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///mnt/d/wes/sample/<span class="built_in">caller</span>/output.g.vcf.gz</span><br><span class="line">22:14:27.083 INFO  GenotypeGVCFs - Done initializing engine</span><br><span class="line">22:14:27.249 INFO  ProgressMeter - Starting traversal</span><br><span class="line">22:14:27.261 INFO  ProgressMeter -        Current Locus  Elapsed Minutes    Variants Processed  Variants/Minute</span><br><span class="line">22:14:27.459 WARN  ReferenceConfidenceVariantContextMerger - Detected invalid annotations: When trying to merge variant contexts at location chr1:14653 the annotation MLEAC=[0, 0] was not a numerical value and was ignored</span><br><span class="line">22:14:27.707 WARN  InbreedingCoeff - InbreedingCoeff will not be calculated; at least 10 samples must have called genotypes</span><br><span class="line">22:14:37.332 INFO  ProgressMeter -        chr1:19155008              0.2                 82000         488725.5</span><br><span class="line">22:14:47.369 INFO  ProgressMeter -        chr1:81936862              0.3                255000         761042.6</span><br><span class="line">22:14:57.397 INFO  ProgressMeter -       chr1:201005243              0.5                520000        1035478.4</span><br><span class="line">22:15:07.551 INFO  ProgressMeter -       chr10:48156213              0.7                728000        1084247.6</span><br><span class="line">22:15:17.572 INFO  ProgressMeter -       chr11:10800804              0.8                959000        1143777.2</span><br><span class="line">22:15:27.591 INFO  ProgressMeter -      chr11:129436951              1.0               1238000        1231330.3</span><br><span class="line">22:15:37.603 INFO  ProgressMeter -      chr12:125957935              1.2               1553000        1324746.2</span><br><span class="line">22:15:47.616 INFO  ProgressMeter -       chr14:80761356              1.3               1831000        1367251.2</span><br><span class="line">22:15:57.654 INFO  ProgressMeter -       chr16:10649222              1.5               2159000        1433139.0</span><br><span class="line">22:16:07.676 INFO  ProgressMeter -       chr17:21318468              1.7               2465000        1472946.2</span><br><span class="line">22:16:17.746 INFO  ProgressMeter -       chr18:31086752              1.8               2744000        1490211.0</span><br><span class="line">22:16:27.768 INFO  ProgressMeter -       chr19:46527144              2.0               3066000        1526601.0</span><br><span class="line">22:16:37.774 INFO  ProgressMeter -       chr2:100864558              2.2               3365000        1547019.7</span><br><span class="line">22:16:47.780 INFO  ProgressMeter -       chr21:10473621              2.3               3816000        1629434.6</span><br><span class="line">22:16:57.794 INFO  ProgressMeter -       chr3:151326235              2.5               4320000        1721927.3</span><br><span class="line">22:17:07.829 INFO  ProgressMeter -       chr5:108575621              2.7               4796000        1792182.6</span><br><span class="line">22:17:17.874 INFO  ProgressMeter -        chr7:17796878              2.8               5264000        1851250.5</span><br><span class="line">22:17:27.887 INFO  ProgressMeter -        chr8:47824115              3.0               5638000        1872861.6</span><br><span class="line">22:17:37.893 INFO  ProgressMeter -       chrX:130165728              3.2               6174000        1943261.2</span><br><span class="line">22:17:38.980 INFO  ProgressMeter -        chrY:56836134              3.2               6220164        1946690.9</span><br><span class="line">22:17:38.981 INFO  ProgressMeter - Traversal complete. Processed 6220164 total variants <span class="keyword">in</span> 3.2 minutes.</span><br><span class="line">22:17:39.095 INFO  GenotypeGVCFs - Shutting down engine</span><br><span class="line">[November 6, 2020 10:17:39 PM CST] org.broadinstitute.hellbender.tools.walkers.GenotypeGVCFs <span class="keyword">done</span>. Elapsed time: 3.24 minutes.</span><br><span class="line">Runtime.totalMemory()=534773760</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为理解下面的步骤，我们来看一下这个文件中的第一条记录：</span></span><br><span class="line">CHROM: chr1</span><br><span class="line">POS: 15903   </span><br><span class="line">ID: .     </span><br><span class="line">REF: G    </span><br><span class="line">ALT: GC    </span><br><span class="line">QUAL: 59.28   </span><br><span class="line">FILTER: . </span><br><span class="line">INFO: AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303   </span><br><span class="line">FORMAT: GT:AD:DP:GQ:PL </span><br><span class="line">sample1: 1/1:0,2:2:6:71,6,0</span><br></pre></td></tr></table></figure><h2 id="六、位点注释"><a href="#六、位点注释" class="headerlink" title="六、位点注释"></a>六、位点注释</h2><p>位点注释需要用到三个工具：<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360050815552-CNNScoreVariants" target="_blank" rel="noopener">CNNScoreVariants</a>和<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360051308071-FilterVariantTranches" target="_blank" rel="noopener">FilterVariantTranches</a>，以及<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360051304411-Funcotator" target="_blank" rel="noopener">Funcotator</a></p><p>CNNScoreVariants是指使用CNN (Convolutional Neural Network)的分数对VCF文件进行注释，这个工具需要调用PYTHON程序，因此，需要预先搭建环境，最简单不易出错的方法是使用Docker，关于Docker的搭建及测试会专门写一篇文章介绍。</p><h3 id="6-1-启动Docker"><a href="#6-1-启动Docker" class="headerlink" title="6.1 启动Docker"></a>6.1 启动Docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于在Docker内部无法调用外部文件，因此，需要将外部文件挂载在Docker中，如果把Docker看作是一个独立的操作系统，挂载后的外部文件即相当于Docker内部的一个盘符，方便调用，在此，使用-V参数将D盘挂载到Docker下，并命名为my_data目录，路径为"/gatk/my_data/"；同时，使用-it参数启动gatk。</span></span><br><span class="line">$ docker run -v /mnt/d:/gatk/my_data -it broadinstitute/gatk:4.1.3.0</span><br><span class="line"></span><br><span class="line">(gatk) root@9f0ac1b25dec:/gatk<span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="6-2-使用CNNScoreVariants进行评分"><a href="#6-2-使用CNNScoreVariants进行评分" class="headerlink" title="6.2 使用CNNScoreVariants进行评分"></a>6.2 使用CNNScoreVariants进行评分</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">gatk CNNScoreVariants -V /gatk/my_data/wes/sample/<span class="built_in">caller</span>/output.vcf.gz -R /gatk/my_data/ncbi/hg38/chroms/hg38.fa -O /gatk/my_data/wes/sample/annotate/annotated.vcf --<span class="built_in">disable</span>-avx-check <span class="literal">true</span></span><br><span class="line"><span class="comment"># --disable-avx-check true这个参数根据需要使用，如果系统中AVX的版本低于1.6，可以使用此参数跳过检查，否则会报错。</span></span><br><span class="line"></span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /gatk/gatk-package-4.1.3.0-local.jar CNNScoreVariants -V /gatk/my_data/wes/sample/<span class="built_in">caller</span>/output.vcf.gz -R /gatk/my_data/ncbi/hg38/chroms/hg38.fa -O /gatk/my_data/wes/sample/annotate/annotated.vcf --<span class="built_in">disable</span>-avx-check <span class="literal">true</span></span><br><span class="line">22:13:19.307 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/gatk/gatk-package-4.1.3.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">Nov 11, 2020 10:13:21 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">22:13:21.208 INFO  CNNScoreVariants - ------------------------------------------------------------</span><br><span class="line">22:13:21.209 INFO  CNNScoreVariants - The Genome Analysis Toolkit (GATK) v4.1.3.0</span><br><span class="line">22:13:21.209 INFO  CNNScoreVariants - For support and documentation go to https://software.broadinstitute.org/gatk/</span><br><span class="line">22:13:21.212 INFO  CNNScoreVariants - Executing as root@9f0ac1b25dec on Linux v4.19.128-microsoft-standard amd64</span><br><span class="line">22:13:21.213 INFO  CNNScoreVariants - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_191-8u191-b12-0ubuntu0.16.04.1-b12</span><br><span class="line">22:13:21.213 INFO  CNNScoreVariants - Start Date/Time: November 11, 2020 10:13:19 PM UTC</span><br><span class="line">22:13:21.214 INFO  CNNScoreVariants - ------------------------------------------------------------</span><br><span class="line">22:13:21.214 INFO  CNNScoreVariants - ------------------------------------------------------------</span><br><span class="line">22:13:21.217 INFO  CNNScoreVariants - HTSJDK Version: 2.20.1</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - Picard Version: 2.20.5</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - HTSJDK Defaults.COMPRESSION_LEVEL : 2</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="literal">false</span></span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="literal">true</span></span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="literal">false</span></span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - Deflater: IntelDeflater</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - Inflater: IntelInflater</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - GCS max retries/reopens: 20</span><br><span class="line">22:13:21.220 INFO  CNNScoreVariants - Requester pays: disabled</span><br><span class="line">22:13:21.221 INFO  CNNScoreVariants - Initializing engine</span><br><span class="line">22:13:22.011 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///gatk/my_data/wes/sample/<span class="built_in">caller</span>/output.vcf.gz</span><br><span class="line">22:13:22.334 INFO  CNNScoreVariants - Done initializing engine</span><br><span class="line">22:13:37.467 INFO  CNNScoreVariants - Using key:CNN_1D <span class="keyword">for</span> CNN architecture:/tmp/1d_cnn_mix_train_full_bn.4399861944292417098.json and weights:/tmp/1d_cnn_mix_train_full_bn.6480348361258943885.hd5</span><br><span class="line">22:13:42.239 INFO  ProgressMeter - Starting traversal</span><br><span class="line">22:13:42.239 INFO  ProgressMeter -        Current Locus  Elapsed Minutes    Variants Processed  Variants/Minute</span><br><span class="line">22:13:42.247 INFO  CNNScoreVariants - Starting pass 0 through the variants</span><br><span class="line">22:14:02.248 INFO  ProgressMeter -        chr1:87045715              0.3                  3000           9000.0</span><br><span class="line">22:14:13.936 INFO  ProgressMeter -       chr1:147029254              0.5                  4000           7571.9</span><br><span class="line">22:14:25.604 INFO  ProgressMeter -       chr1:169397278              0.7                  5000           6918.2</span><br><span class="line">22:14:38.391 INFO  ProgressMeter -       chr1:214663767              0.9                  6000           6411.3</span><br><span class="line">22:14:49.750 INFO  ProgressMeter -        chr10:3082324              1.1                  7000           6221.3</span><br><span class="line">22:15:02.307 INFO  ProgressMeter -       chr10:45759533              1.3                  8000           5995.1</span><br><span class="line">22:15:15.155 INFO  ProgressMeter -       chr10:93404283              1.5                  9000           5811.8</span><br><span class="line">22:15:26.166 INFO  ProgressMeter -      chr10:133168333              1.7                 10000           5773.3</span><br><span class="line">22:15:37.367 INFO  ProgressMeter -       chr11:18255670              1.9                 11000           5732.8</span><br><span class="line">22:15:49.865 INFO  ProgressMeter -       chr11:63490944              2.1                 12000           5641.5</span><br><span class="line">22:16:02.650 INFO  ProgressMeter -      chr11:101593990              2.3                 13000           5555.2</span><br><span class="line">22:16:13.848 INFO  ProgressMeter -        chr12:2786919              2.5                 14000           5540.6</span><br><span class="line">22:16:25.342 INFO  ProgressMeter -       chr12:31102025              2.7                 15000           5518.0</span><br><span class="line">22:16:41.195 INFO  ProgressMeter -       chr12:71769943              3.0                 16000           5364.5</span><br><span class="line">22:16:53.911 INFO  ProgressMeter -      chr12:122986425              3.2                 17000           5321.6</span><br><span class="line">22:17:05.693 INFO  ProgressMeter -       chr13:35044829              3.4                 18000           5308.4</span><br><span class="line">22:17:17.926 INFO  ProgressMeter -       chr14:18656315              3.6                 19000           5285.5</span><br><span class="line">22:17:29.413 INFO  ProgressMeter -       chr14:61865740              3.8                 20000           5282.3</span><br><span class="line">22:17:40.900 INFO  ProgressMeter - chr14_GL000225v1_random:23601              4.0                 21000           5279.5</span><br><span class="line">22:17:52.338 INFO  ProgressMeter -       chr15:51215311              4.2                 22000           5277.9</span><br><span class="line">22:18:03.518 INFO  ProgressMeter -       chr15:78796665              4.4                 23000           5281.7</span><br><span class="line">22:18:14.921 INFO  ProgressMeter -        chr16:3483577              4.5                 24000           5280.9</span><br><span class="line">22:18:26.399 INFO  ProgressMeter -       chr16:34594921              4.7                 25000           5278.7</span><br><span class="line">22:18:40.819 INFO  ProgressMeter -       chr16:84976364              5.0                 26000           5224.7</span><br><span class="line">22:18:57.583 INFO  ProgressMeter -       chr17:10640146              5.3                 27000           5137.3</span><br><span class="line">22:19:09.159 INFO  ProgressMeter -       chr17:40023414              5.4                 28000           5138.9</span><br><span class="line">22:19:20.628 INFO  ProgressMeter -       chr17:70095791              5.6                 29000           5142.0</span><br><span class="line">22:19:35.491 INFO  ProgressMeter -       chr18:11639357              5.9                 30000           5095.5</span><br><span class="line">01:21:13.590 INFO  ProgressMeter -         chr19:966458            187.5                 31000            165.3</span><br><span class="line">01:21:28.856 INFO  ProgressMeter -       chr19:12440901            187.8                 32000            170.4</span><br><span class="line">01:21:41.329 INFO  ProgressMeter -       chr19:38505335            188.0                 33000            175.5</span><br><span class="line">01:21:52.685 INFO  ProgressMeter -       chr19:51594208            188.2                 34000            180.7</span><br><span class="line">01:22:04.454 INFO  ProgressMeter -        chr2:23887741            188.4                 35000            185.8</span><br><span class="line">01:22:16.139 INFO  ProgressMeter -        chr2:72465143            188.6                 36000            190.9</span><br><span class="line">01:22:27.642 INFO  ProgressMeter -       chr2:112531455            188.8                 37000            196.0</span><br><span class="line">01:22:39.186 INFO  ProgressMeter -       chr2:165155693            188.9                 38000            201.1</span><br><span class="line">01:22:50.654 INFO  ProgressMeter -       chr2:208338389            189.1                 39000            206.2</span><br><span class="line">01:23:02.084 INFO  ProgressMeter -        chr20:1578455            189.3                 40000            211.3</span><br><span class="line">01:23:13.819 INFO  ProgressMeter -       chr20:38000451            189.5                 41000            216.3</span><br><span class="line">01:23:25.157 INFO  ProgressMeter -       chr21:14304122            189.7                 42000            221.4</span><br><span class="line">01:23:37.058 INFO  ProgressMeter -       chr22:36261582            189.9                 44000            231.7</span><br><span class="line">01:23:48.698 INFO  ProgressMeter -        chr3:15475403            190.1                 45000            236.7</span><br><span class="line">01:24:00.525 INFO  ProgressMeter -        chr3:57577393            190.3                 46000            241.7</span><br><span class="line">01:24:12.212 INFO  ProgressMeter -       chr3:117027527            190.5                 47000            246.7</span><br><span class="line">01:24:23.981 INFO  ProgressMeter -       chr3:171792652            190.7                 48000            251.7</span><br><span class="line">01:24:35.067 INFO  ProgressMeter -         chr4:7025314            190.9                 49000            256.7</span><br><span class="line">01:24:47.070 INFO  ProgressMeter -        chr4:68063022            191.1                 50000            261.7</span><br><span class="line">01:24:58.504 INFO  ProgressMeter -       chr4:125476979            191.3                 51000            266.6</span><br><span class="line">01:25:13.077 INFO  ProgressMeter -         chr5:6611870            191.5                 52000            271.5</span><br><span class="line">01:25:25.667 INFO  ProgressMeter -        chr5:79730716            191.7                 53000            276.4</span><br><span class="line">01:25:50.363 INFO  ProgressMeter -       chr5:149028538            192.1                 54000            281.1</span><br><span class="line">01:26:03.247 INFO  ProgressMeter -        chr6:10047168            192.4                 55000            285.9</span><br><span class="line">01:26:16.475 INFO  ProgressMeter -        chr6:52813539            192.6                 56000            290.8</span><br><span class="line">01:26:28.586 INFO  ProgressMeter -       chr6:131950089            192.8                 57000            295.7</span><br><span class="line">01:26:40.160 INFO  ProgressMeter -         chr7:2278738            193.0                 58000            300.6</span><br><span class="line">01:26:51.860 INFO  ProgressMeter -        chr7:47885733            193.2                 59000            305.4</span><br><span class="line">01:27:03.179 INFO  ProgressMeter -        chr7:88163268            193.3                 60000            310.3</span><br><span class="line">01:27:14.805 INFO  ProgressMeter -       chr7:129734366            193.5                 61000            315.2</span><br><span class="line">01:27:26.079 INFO  ProgressMeter -         chr8:8217007            193.7                 62000            320.0</span><br><span class="line">01:27:37.491 INFO  ProgressMeter -        chr8:43510803            193.9                 63000            324.9</span><br><span class="line">01:27:49.555 INFO  ProgressMeter -       chr8:136245034            194.1                 64000            329.7</span><br><span class="line">01:28:01.077 INFO  ProgressMeter -        chr9:39809861            194.3                 65000            334.5</span><br><span class="line">01:28:12.564 INFO  ProgressMeter -        chr9:93613446            194.5                 66000            339.3</span><br><span class="line">01:28:23.919 INFO  ProgressMeter -       chr9:131070323            194.7                 67000            344.1</span><br><span class="line">01:28:35.122 INFO  ProgressMeter - chrUn_KI270754v1:33254            194.9                 68000            348.9</span><br><span class="line">01:28:47.983 INFO  ProgressMeter -       chrX:145716091            195.1                 69000            353.7</span><br><span class="line">01:28:48.562 INFO  CNNScoreVariants - Finished pass 0 through the variants</span><br><span class="line">01:29:06.929 INFO  CNNScoreVariants - Starting pass 1 through the variants</span><br><span class="line">01:29:07.160 INFO  ProgressMeter -        chr1:13198782            195.4                 70000            358.2</span><br><span class="line">01:29:11.852 INFO  CNNScoreVariants - Finished pass 1 through the variants</span><br><span class="line">01:29:11.853 INFO  CNNScoreVariants - No variants filtered by: AllowAllVariantsVariantFilter</span><br><span class="line">01:29:11.856 INFO  CNNScoreVariants - No reads filtered by: AllowAllReadsReadFilter</span><br><span class="line">01:29:11.861 INFO  ProgressMeter -       chrX:101883466            195.5                138600            709.0</span><br><span class="line">01:29:11.862 INFO  ProgressMeter - Traversal complete. Processed 138600 total variants <span class="keyword">in</span> 195.5 minutes.</span><br><span class="line">01:29:11.863 INFO  CNNScoreVariants - Done scoring variants with CNN.</span><br><span class="line">01:29:12.315 INFO  CNNScoreVariants - Shutting down engine</span><br><span class="line">[November 12, 2020 1:29:12 AM UTC] org.broadinstitute.hellbender.tools.walkers.vqsr.CNNScoreVariants <span class="keyword">done</span>. Elapsed time: 195.88 minutes.</span><br><span class="line">Runtime.totalMemory()=241696768</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此步生成的annotated.vcf作为下一步的输入文件，这个注释过的文件是在INFO字段中加入CNN_1D的评分，如"CNN_1D=-0.800"</span></span><br><span class="line"><span class="comment"># 跟输入的文件作个对比看看：</span></span><br><span class="line">CHROM: chr1</span><br><span class="line">POS: 15903   </span><br><span class="line">ID: .     </span><br><span class="line">REF: G    </span><br><span class="line">ALT: GC    </span><br><span class="line">QUAL: 59.28   </span><br><span class="line">FILTER: . </span><br><span class="line">INFO(输入): AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303</span><br><span class="line">INFO(输出): AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303;*CNN_1D=-0.800;*   </span><br><span class="line">FORMAT: GT:AD:DP:GQ:PL </span><br><span class="line">sample1: 1/1:0,2:2:6:71,6,0</span><br><span class="line"><span class="comment"># 两个文件的区别在于，输出文件在INFO字段加上CNN_1D评分，下一步将以此评分进行过滤</span></span><br></pre></td></tr></table></figure><h3 id="6-3-使用FilterVariantTranches过滤"><a href="#6-3-使用FilterVariantTranches过滤" class="headerlink" title="6.3 使用FilterVariantTranches过滤"></a>6.3 使用FilterVariantTranches过滤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个工具根据注释后的VCF中的INFO字段的分数进行过滤，注释可以是CNNScoreVariants(CNNLOD)或VQSR (VQSLOD)</span></span><br><span class="line"></span><br><span class="line">gatk FilterVariantTranches \</span><br><span class="line">   -V input.vcf.gz \</span><br><span class="line">   --resource hapmap.vcf \</span><br><span class="line">   --resource mills.vcf \</span><br><span class="line">   --info-key CNN_1D \</span><br><span class="line">   --snp-tranche 99.95 \</span><br><span class="line">   --indel-tranche 99.4 \</span><br><span class="line">   -O filtered.vcf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Docker中运行</span></span><br><span class="line"></span><br><span class="line">gatk FilterVariantTranches -V /gatk/my_data/wes/sample/annotate/annotated.vcf --resource /gatk/my_data/ncbi/hg38/vcf/hapmap_3.3.hg38.vcf.gz --resource /gatk/my_data/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz --info-key CNN_1D --snp-tranche 99.95 --indel-tranche 99.4 -O /gatk/my_data/wes/sample/annotate/annotated.filtered.vcf</span><br><span class="line"></span><br><span class="line">Running:</span><br><span class="line">    java -Dsamjdk.use_async_io_read_samtools=<span class="literal">false</span> -Dsamjdk.use_async_io_write_samtools=<span class="literal">true</span> -Dsamjdk.use_async_io_write_tribble=<span class="literal">false</span> -Dsamjdk.compression_level=2 -jar /gatk/gatk-package-4.1.3.0-local.jar FilterVariantTranches -V /gatk/my_data/wes/sample/annotate/annotated.vcf --resource /gatk/my_data/ncbi/hg38/vcf/hapmap_3.3.hg38.vcf.gz --resource /gatk/my_data/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz --info-key CNN_1D --snp-tranche 99.95 --indel-tranche 99.4 -O /gatk/my_data/wes/sample/annotate/annotated.filtered.vcf</span><br><span class="line">01:40:26.170 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/gatk/gatk-package-4.1.3.0-local.jar!/com/intel/gkl/native/libgkl_compression.so</span><br><span class="line">Nov 12, 2020 1:40:28 AM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine</span><br><span class="line">INFO: Failed to detect whether we are running on Google Compute Engine.</span><br><span class="line">01:40:28.454 INFO  FilterVariantTranches - ------------------------------------------------------------</span><br><span class="line">01:40:28.455 INFO  FilterVariantTranches - The Genome Analysis Toolkit (GATK) v4.1.3.0</span><br><span class="line">01:40:28.455 INFO  FilterVariantTranches - For support and documentation go to https://software.broadinstitute.org/gatk/</span><br><span class="line">01:40:28.456 INFO  FilterVariantTranches - Executing as root@9f0ac1b25dec on Linux v4.19.128-microsoft-standard amd64</span><br><span class="line">01:40:28.456 INFO  FilterVariantTranches - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_191-8u191-b12-0ubuntu0.16.04.1-b12</span><br><span class="line">01:40:28.456 INFO  FilterVariantTranches - Start Date/Time: November 12, 2020 1:40:26 AM UTC</span><br><span class="line">01:40:28.457 INFO  FilterVariantTranches - ------------------------------------------------------------</span><br><span class="line">01:40:28.457 INFO  FilterVariantTranches - ------------------------------------------------------------</span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - HTSJDK Version: 2.20.1</span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - Picard Version: 2.20.5</span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - HTSJDK Defaults.COMPRESSION_LEVEL : 2</span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="literal">false</span></span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="literal">true</span></span><br><span class="line">01:40:28.458 INFO  FilterVariantTranches - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="literal">false</span></span><br><span class="line">01:40:28.459 INFO  FilterVariantTranches - Deflater: IntelDeflater</span><br><span class="line">01:40:28.459 INFO  FilterVariantTranches - Inflater: IntelInflater</span><br><span class="line">01:40:28.459 INFO  FilterVariantTranches - GCS max retries/reopens: 20</span><br><span class="line">01:40:28.459 INFO  FilterVariantTranches - Requester pays: disabled</span><br><span class="line">01:40:28.459 INFO  FilterVariantTranches - Initializing engine</span><br><span class="line">01:40:29.423 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///gatk/my_data/ncbi/hg38/vcf/hapmap_3.3.hg38.vcf.gz</span><br><span class="line">01:40:30.099 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///gatk/my_data/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz</span><br><span class="line">01:40:30.362 INFO  FeatureManager - Using codec VCFCodec to <span class="built_in">read</span> file file:///gatk/my_data/wes/sample/annotate/annotated.vcf</span><br><span class="line">01:40:30.630 INFO  FilterVariantTranches - Done initializing engine</span><br><span class="line">01:40:30.796 INFO  ProgressMeter - Starting traversal</span><br><span class="line">01:40:30.797 INFO  ProgressMeter -        Current Locus  Elapsed Minutes    Variants Processed  Variants/Minute</span><br><span class="line">01:40:30.801 INFO  FilterVariantTranches - Starting pass 0 through the variants</span><br><span class="line">01:40:40.840 INFO  ProgressMeter -       chr17:40023414              0.2                 28000         167330.7</span><br><span class="line">01:40:50.889 INFO  ProgressMeter -       chr9:131070323              0.3                 67000         200099.6</span><br><span class="line">01:40:51.287 INFO  FilterVariantTranches - Finished pass 0 through the variants</span><br><span class="line">01:40:51.287 INFO  FilterVariantTranches - Found 57803 SNPs and 11479 indels with INFO score key:CNN_1D.</span><br><span class="line">01:40:51.287 INFO  FilterVariantTranches - Found 26323 SNPs and 3646 indels <span class="keyword">in</span> the resources.</span><br><span class="line">01:40:51.324 INFO  FilterVariantTranches - Starting pass 1 through the variants</span><br><span class="line">01:40:54.831 INFO  FilterVariantTranches - Finished pass 1 through the variants</span><br><span class="line">01:40:54.834 INFO  FilterVariantTranches - No variants filtered by: AllowAllVariantsVariantFilter</span><br><span class="line">01:40:54.836 INFO  FilterVariantTranches - No reads filtered by: AllowAllReadsReadFilter</span><br><span class="line">01:40:54.837 INFO  ProgressMeter -       chrX:101883466              0.4                138600         345952.2</span><br><span class="line">01:40:54.838 INFO  ProgressMeter - Traversal complete. Processed 138600 total variants <span class="keyword">in</span> 0.4 minutes.</span><br><span class="line">01:40:54.839 INFO  FilterVariantTranches - Filtered 1760 SNPs out of 57803 and filtered 188 indels out of 11479 with INFO score: CNN_1D.</span><br><span class="line">01:40:55.436 INFO  FilterVariantTranches - Shutting down engine</span><br><span class="line">[November 12, 2020 1:40:55 AM UTC] org.broadinstitute.hellbender.tools.walkers.vqsr.FilterVariantTranches <span class="keyword">done</span>. Elapsed time: 0.49 minutes.</span><br><span class="line">Runtime.totalMemory()=663748608</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再看看输出文件的第一条记录，与前面的两条记录作对比：</span></span><br><span class="line">CHROM: chr1</span><br><span class="line">POS: 15903   </span><br><span class="line">ID: .     </span><br><span class="line">REF: G    </span><br><span class="line">ALT: GC    </span><br><span class="line">QUAL: 59.28   </span><br><span class="line">FILTER: PASS</span><br><span class="line">INFO(Step1): AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303</span><br><span class="line">INFO(输入): AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303;CNN_1D=-0.800; </span><br><span class="line">INFO(输出): AC=2;AF=1.00;AN=2;DP=3;ExcessHet=3.0103;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.13;QD=29.64;SOR=2.303;CNN_1D=-0.800;</span><br><span class="line">FORMAT: GT:AD:DP:GQ:PL </span><br><span class="line">sample1: 1/1:0,2:2:6:71,6,0</span><br><span class="line"><span class="comment"># INFO字段没有变化，但FILTER字段由"."变为"PASS"</span></span><br></pre></td></tr></table></figure><h3 id="6-4-使用Funcotator进行功能注释"><a href="#6-4-使用Funcotator进行功能注释" class="headerlink" title="6.4 使用Funcotator进行功能注释"></a>6.4 使用Funcotator进行功能注释</h3><p>在使用Funcotator进行功能注释前，需要下载Data Sources。GATK有两套预封装数据源，分别对应germline和somatic，可以使用gatk FuncotatorDataSourceDownloader工具进行下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For somatic data sources: (29GB)</span></span><br><span class="line">gatk FuncotatorDataSourceDownloader --somatic --validate-integrity --extract-after-download</span><br><span class="line"><span class="comment"># For germline data sources:</span></span><br><span class="line">gatk FuncotatorDataSourceDownloader --germline --validate-integrity --extract-after-download</span><br></pre></td></tr></table></figure><p>数据源下载完成后即可进行分析，语法示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./gatk Funcotator \</span><br><span class="line">   -R reference.fasta \</span><br><span class="line">   -V input.vcf \</span><br><span class="line">   -O outputFile \</span><br><span class="line">   --output-file-format MAF \ <span class="comment">#可以选择VCF或MAF</span></span><br><span class="line">   --data-sources-path dataSourcesFolder/ \</span><br><span class="line">   --ref-version hg19</span><br></pre></td></tr></table></figure><p>在本例中，使用如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Germline Mutation</span></span><br><span class="line">gatk Funcotator -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/sample/annotate/annotated.filtered.vcf -O /mnt/d/wes/sample/annotate/annotated.filtered.funcotator.germline.vcf --output-file-format VCF --data-sources-path /mnt/d/ncbi/funcotator/funcotator_dataSources.v1.7.20200521g/ --ref-version hg38</span><br><span class="line"></span><br><span class="line"><span class="comment"># Somatic Mutation</span></span><br><span class="line">gatk Funcotator -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/sample/annotate/annotated.filtered.vcf -O /mnt/d/wes/sample/annotate/annotated.filtered.funcotator.somatic.vcf --output-file-format VCF --data-sources-path /mnt/d/ncbi/funcotator/funcotator_dataSources.v1.7.20200521s/ --ref-version hg38</span><br></pre></td></tr></table></figure><p>至此，我们得到了注释好的VCF文件，下面，就可以进行后续的功能分析了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;参考资料：&lt;a href=&quot;https://gatk.broadinstitute.org/hc/en-us/articles/360035535932-Germline-short-variant-discovery-SNPs-Indels-&quot; target=&quot;_blan
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="WES" scheme="http://uteric.github.io/tags/WES/"/>
    
  </entry>
  
  <entry>
    <title>使用SEQKIT拆分FASTQ文件</title>
    <link href="http://uteric.github.io/Linux/seqkit/"/>
    <id>http://uteric.github.io/Linux/seqkit/</id>
    <published>2020-11-03T17:52:15.000Z</published>
    <updated>2020-11-03T17:52:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>在学习数据分析的过程中，原始文件往往很大，这会导致反馈时间极长，比如比对过程，对于普通配置的个人电脑，一个FASTQ文件可能耗时数小时，这会极大地影响对错误的排查过程，增加学习成本。考虑到这一点，我们可以将要分析的FASTQ文件拆分成多个小文件，只取其中一个文件进行比对，为实现这一功能，可以使用SEQKIT。可选程序有两个，一个是seqkit split，这个主要针对FASTA文件，第二个是seqkit split2，这个可以处理单端或双端FASTQ文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">seqkit split2 -h <span class="comment"># 查看帮助</span></span><br><span class="line"></span><br><span class="line">split sequences into files by part size or number of parts <span class="comment"># 按大小或数目分割文件</span></span><br><span class="line"></span><br><span class="line">This <span class="built_in">command</span> supports FASTA and paired- or single-end FASTQ with low memory occupation and fast speed. <span class="comment"># 支持FASTA，单端或双端FASTQ</span></span><br><span class="line"></span><br><span class="line">The file extensions of output are automatically detected and created according to the input files. <span class="comment"># 输出文件是根据输入文件自动命名的</span></span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  seqkit split2 [flags]</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">  -l, --by-length string   split sequences into chunks of N bases, supports K/M/G suffix </span><br><span class="line">  -p, --by-part int        split sequences into N parts <span class="comment"># 按数目分割</span></span><br><span class="line">  -s, --by-size int        split sequences into multi parts with N sequences <span class="comment"># 按大小分割</span></span><br><span class="line">  -f, --force              overwrite output directory</span><br><span class="line">  -h, --<span class="built_in">help</span>               <span class="built_in">help</span> <span class="keyword">for</span> split2</span><br><span class="line">  -O, --out-dir string     output directory (default value is <span class="variable">$infile</span>.split) <span class="comment"># 输出目录</span></span><br><span class="line">  -1, --read1 string       (gzipped) read1 file <span class="comment"># 双端测序第一个文件</span></span><br><span class="line">  -2, --read2 string       (gzipped) read2 file <span class="comment"># 双端测序第二个文件</span></span><br><span class="line"></span><br><span class="line">Global Flags:</span><br><span class="line">      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on <span class="built_in">which</span> seqkit guesses the sequence <span class="built_in">type</span> (0 <span class="keyword">for</span> whole seq) (default 10000)</span><br><span class="line">      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...</span><br><span class="line">      --id-regexp string                regular expression <span class="keyword">for</span> parsing ID (default <span class="string">"^(\\S+)\\s?"</span>)</span><br><span class="line">      --infile-list string              file of input files list (one file per line), <span class="keyword">if</span> given, they are appended to files from cli arguments</span><br><span class="line">  -w, --line-width int                  line width when outputing FASTA format (0 <span class="keyword">for</span> no wrap) (default 60)</span><br><span class="line">  -o, --out-file string                 out file (<span class="string">"-"</span> <span class="keyword">for</span> stdout, suffix .gz <span class="keyword">for</span> gzipped out) (default <span class="string">"-"</span>)</span><br><span class="line">      --quiet                           be quiet and <span class="keyword">do</span> not show extra information</span><br><span class="line">  -t, --seq-type string                 sequence <span class="built_in">type</span> (dna|rna|protein|<span class="built_in">unlimit</span>|auto) (<span class="keyword">for</span> auto, it automatically detect by the first sequence) (default <span class="string">"auto"</span>)</span><br><span class="line">  -j, --threads int                     number of CPUs. (default value: 1 <span class="keyword">for</span> single-CPU PC, 2 <span class="keyword">for</span> others. can also <span class="built_in">set</span> with environment variable SEQKIT_THREADS) (default 2) <span class="comment"># 线程数</span></span><br></pre></td></tr></table></figure><p>对于给定的双端测序文件，使用参数如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">seqkit split2 -1 SRR12846241_1.fastq -2 SRR12846241_2.fastq -p 20 <span class="comment"># 拆分为20个文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出文件至文件夹中：SRR12846241_1.fastq.split/</span></span><br><span class="line">SRR12846241_1.part_001.fastq  SRR12846241_1.part_011.fastq  SRR12846241_2.part_001.fastq  SRR12846241_2.part_011.fastq</span><br><span class="line">SRR12846241_1.part_002.fastq  SRR12846241_1.part_012.fastq  SRR12846241_2.part_002.fastq  SRR12846241_2.part_012.fastq</span><br><span class="line">SRR12846241_1.part_003.fastq  SRR12846241_1.part_013.fastq  SRR12846241_2.part_003.fastq  SRR12846241_2.part_013.fastq</span><br><span class="line">SRR12846241_1.part_004.fastq  SRR12846241_1.part_014.fastq  SRR12846241_2.part_004.fastq  SRR12846241_2.part_014.fastq</span><br><span class="line">SRR12846241_1.part_005.fastq  SRR12846241_1.part_015.fastq  SRR12846241_2.part_005.fastq  SRR12846241_2.part_015.fastq</span><br><span class="line">SRR12846241_1.part_006.fastq  SRR12846241_1.part_016.fastq  SRR12846241_2.part_006.fastq  SRR12846241_2.part_016.fastq</span><br><span class="line">SRR12846241_1.part_007.fastq  SRR12846241_1.part_017.fastq  SRR12846241_2.part_007.fastq  SRR12846241_2.part_017.fastq</span><br><span class="line">SRR12846241_1.part_008.fastq  SRR12846241_1.part_018.fastq  SRR12846241_2.part_008.fastq  SRR12846241_2.part_018.fastq</span><br><span class="line">SRR12846241_1.part_009.fastq  SRR12846241_1.part_019.fastq  SRR12846241_2.part_009.fastq  SRR12846241_2.part_019.fastq</span><br><span class="line">SRR12846241_1.part_010.fastq  SRR12846241_1.part_020.fastq  SRR12846241_2.part_010.fastq  SRR12846241_2.part_020.fastq</span><br><span class="line"><span class="comment"># 共产生20个文件，每个文件约55M，进行下面的分析时可以比较轻松完成。</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在学习数据分析的过程中，原始文件往往很大，这会导致反馈时间极长，比如比对过程，对于普通配置的个人电脑，一个FASTQ文件可能耗时数小时，这会极大地影响对错误的排查过程，增加学习成本。考虑到这一点，我们可以将要分析的FASTQ文件拆分成多个小文件，只取其中一个文件进行比对，为
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="FASTQ" scheme="http://uteric.github.io/tags/FASTQ/"/>
    
  </entry>
  
  <entry>
    <title>R基础命令：读取TSV文件</title>
    <link href="http://uteric.github.io/R/readTsv/"/>
    <id>http://uteric.github.io/R/readTsv/</id>
    <published>2020-10-30T02:17:34.000Z</published>
    <updated>2020-10-30T02:17:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，可以使用read.table()来读取.tsv文件，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; data &lt;- read.table(<span class="string">"file.tsv"</span>, header=T, sep=<span class="string">"\t"</span>)</span><br></pre></td></tr></table></figure><p>但是，若原文件中有缺失值，可能会报错，可以使用fill=TRUE对缺失值进行填充，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; data &lt;- read.table(<span class="string">"file.tsv"</span>, header=T, sep=<span class="string">"\t"</span>,fill=TRUE)</span><br></pre></td></tr></table></figure><p>然而，由于这种填充方式是自动将有值的单元格向前移动，并将后面的缺失值填充为NA，因此，可能会引入新的错误，即串行的问题，为解决这个问题，可以使用data.table中的fread命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; require(data.table)</span><br><span class="line">&gt; data&lt;-as.data.frame(fread(<span class="string">"file.tsv"</span>))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，可以使用read.table()来读取.tsv文件，&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>使用MAFTOOLS分析肿瘤变异数据</title>
    <link href="http://uteric.github.io/R/maltools/"/>
    <id>http://uteric.github.io/R/maltools/</id>
    <published>2020-10-27T18:57:39.000Z</published>
    <updated>2020-10-27T18:57:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>我们以TCGA-KIRC数据为例，来介绍肿瘤突变数据与临床数据的下载方法、预处理及可视化</p><h1 id="一、数据下载与处理"><a href="#一、数据下载与处理" class="headerlink" title="一、数据下载与处理"></a>一、数据下载与处理</h1><p>在<a href="https://portal.gdc.cancer.gov/" target="_blank" rel="noopener">TCGA-GDC</a>官网，在CASES选项下，选择CTGA-KIRC，这里共包含537个CASE，回到FILES选项下，选择Data Category[simple nucleotide variation]+Data Type[Masked Somatic Mutation]+Workflow Type[MuTect2 Variant Aggregation and Masking]，至此，数据选择就完成了，点击Add Files to Cart，回到Cart，FILE=1，CASES=339，FILE SIZE=7.12 MB。下载Clinical/TSV文件，下载Download/Cart文件，前一个文件包含临床数据，后一个文件包含突变数据。</p><p>将这两个文件移至R的工作目录之下，使用命令对这两个tat.gz文件进行解压，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf clinical.cart.2020-10-27.tar.gz <span class="comment"># 解压后，得到三个文件：clinical.tsv，family_history.tsv，exposure.tsv</span></span><br><span class="line">tar -zxvf gdc_download_20201027_190832.301544.tar.gz <span class="comment"># 解压后，得到maf.gz文件，再使用gzip -d filename.gz进行解压，得到我们需要的.maf文件，重命名为mutect.maf</span></span><br></pre></td></tr></table></figure><p>在下一步操作之前，我们需要对下载好的数据作预处理，以使临床数据与突变数据能够通过Tumor_Sample_Barcode联系起来，分两步进行：</p><p>第一、打开clinical.tsv，将第二列“case_submitter_id”修改为“Tumor_Sample_Barcode”；<br>第二、打开mutect.maf，将“Tumor_Sample_Barcode”这一列中的内容修改为与clinical.tsv中的”Tumor_Sample_Barcode”一致，即只保留前12个字符，在EXCEL中可以新建一列，并使用[LEFT(text,12)]这个函数进行操作，操作完成后，使用CTRL+SHIFT+DOWN向下选择，再使用CTRL+D快速填充，填充完毕，将新列命名为”Tumor_Sample_Barcode”，并将旧的”Tumor_Sample_Barcode”删除，保存退出。</p><p>至此，数据下载与预处理就完成了，后面的过程会比较简单。</p><h1 id="二、读取MAF文件并进行统计"><a href="#二、读取MAF文件并进行统计" class="headerlink" title="二、读取MAF文件并进行统计"></a>二、读取MAF文件并进行统计</h1><h2 id="2-1-MAF文件读取"><a href="#2-1-MAF文件读取" class="headerlink" title="2.1 MAF文件读取"></a>2.1 MAF文件读取</h2><p>下面的操作都将在RStudio/R中进行，代码如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; setwd(<span class="string">"D:/mutation/KIRC/mutect"</span>) <span class="comment"># 切换至工作目录下</span></span><br><span class="line">&gt; library(maftools) <span class="comment"># 加载maftools</span></span><br><span class="line">&gt; kirc &lt;- read.maf(maf=<span class="string">"mutect.maf"</span>, clinicalData=<span class="string">"clinical.tsv"</span>)</span><br></pre></td></tr></table></figure><p>文件读取过程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-Reading</span><br><span class="line">|--------------------------------------------------|</span><br><span class="line">|==================================================|</span><br><span class="line">|--------------------------------------------------|</span><br><span class="line">|==================================================|</span><br><span class="line">-Validating</span><br><span class="line">--Removed 1021876 duplicated variants</span><br><span class="line">--Found  1  variants with no Gene Symbols</span><br><span class="line">--Annotating them as <span class="string">'UnknownGene'</span> <span class="keyword">for</span> convenience</span><br><span class="line">--Non MAF specific values <span class="keyword">in</span> Variant_Classification column:</span><br><span class="line">  </span><br><span class="line">--Non MAF specific values <span class="keyword">in</span> Variant_Type column:</span><br><span class="line">  </span><br><span class="line">-Silent variants: 8384 </span><br><span class="line">-Summarizing</span><br><span class="line">--Mutiple centers found</span><br><span class="line">BI;BCM--Possible FLAGS among top ten genes:</span><br><span class="line">  TTN</span><br><span class="line">  MUC16</span><br><span class="line">  HMCN1</span><br><span class="line">-Processing clinical data</span><br><span class="line">--Annotation missing <span class="keyword">for</span> below samples <span class="keyword">in</span> MAF:</span><br><span class="line">  </span><br><span class="line">-Finished <span class="keyword">in</span> 39.7s elapsed (16.7s cpu)</span><br></pre></td></tr></table></figure><h2 id="2-2-MAF文件统计"><a href="#2-2-MAF文件统计" class="headerlink" title="2.2 MAF文件统计"></a>2.2 MAF文件统计</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; kirc <span class="comment"># 查看MAF文件基本信息</span></span><br><span class="line">An object of class  MAF </span><br><span class="line">                        ID summary   Mean Median</span><br><span class="line"> 1:             NCBI_Build  GRCh38     NA     NA</span><br><span class="line"> 2:                 Center  BI;BCM     NA     NA</span><br><span class="line"> 3:                Samples     337     NA     NA</span><br><span class="line"> 4:                 nGenes    9444     NA     NA</span><br><span class="line"> 5:        Frame_Shift_Del    1732  5.155      4</span><br><span class="line"> 6:        Frame_Shift_Ins    1201  3.574      1</span><br><span class="line"> 7:           In_Frame_Del     238  0.708      0</span><br><span class="line"> 8:           In_Frame_Ins     350  1.042      0</span><br><span class="line"> 9:      Missense_Mutation   12997 38.682     36</span><br><span class="line">10:      Nonsense_Mutation    1259  3.747      2</span><br><span class="line">11:       Nonstop_Mutation      18  0.054      0</span><br><span class="line">12:            Splice_Site     490  1.458      1</span><br><span class="line">13: Translation_Start_Site      25  0.074      0</span><br><span class="line">14:                  total   18310 54.494     47</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; getSampleSummary(kirc) <span class="comment"># 对每一个样本的情况进行统计（336个样本）</span></span><br><span class="line">     Tumor_Sample_Barcode Frame_Shift_Del Frame_Shift_Ins In_Frame_Del</span><br><span class="line">  1:         TCGA-B8-4143              39             721           13</span><br><span class="line">  2:         TCGA-B0-5098              88              25            5</span><br><span class="line">  3:         TCGA-A3-A8OV               7               3            1</span><br><span class="line">  4:         TCGA-CJ-4920              16               4            0</span><br><span class="line">  5:         TCGA-CZ-5468               4               2            0</span><br><span class="line"> ---                                                                  </span><br><span class="line">332:         TCGA-B0-5117               0               1            0</span><br><span class="line">333:         TCGA-BP-4760               1               0            0</span><br><span class="line">334:         TCGA-DV-5576               0               0            0</span><br><span class="line">335:         TCGA-B8-5546               0               0            0</span><br><span class="line">336:         TCGA-DV-A4VZ               1               0            0</span><br><span class="line">     In_Frame_Ins Missense_Mutation Nonsense_Mutation Nonstop_Mutation</span><br><span class="line">  1:          305               201               320                1</span><br><span class="line">  2:            1               390                20                0</span><br><span class="line">  3:            0                99                 7                0</span><br><span class="line">  4:            0                87                 6                0</span><br><span class="line">  5:            0                91                 4                0</span><br><span class="line"> ---                                                                  </span><br><span class="line">332:            0                 7                 0                0</span><br><span class="line">333:            0                 7                 0                0</span><br><span class="line">334:            0                 7                 1                0</span><br><span class="line">335:            0                 7                 0                0</span><br><span class="line">336:            0                 4                 0                0</span><br><span class="line">     Splice_Site Translation_Start_Site total</span><br><span class="line">  1:          11                      0  1611</span><br><span class="line">  2:          20                      1   550</span><br><span class="line">  3:           3                      0   120</span><br><span class="line">  4:           2                      2   117</span><br><span class="line">  5:           1                      0   102</span><br><span class="line"> ---                                         </span><br><span class="line">332:           0                      0     8</span><br><span class="line">333:           0                      0     8</span><br><span class="line">334:           0                      0     8</span><br><span class="line">335:           0                      0     7</span><br><span class="line">336:           0                      0     5</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; getGeneSummary(kirc) <span class="comment"># 对每一个基因进行统计（9444个基因）</span></span><br><span class="line">      Hugo_Symbol Frame_Shift_Del Frame_Shift_Ins In_Frame_Del In_Frame_Ins</span><br><span class="line">   1:         VHL              41              22            2            0</span><br><span class="line">   2:       PBRM1              64              12            1            1</span><br><span class="line">   3:         TTN               4               4            0            1</span><br><span class="line">   4:       SETD2              12               2            0            0</span><br><span class="line">   5:        BAP1              13               1            0            0</span><br><span class="line">  ---                                                                      </span><br><span class="line">9440:       ZWINT               0               0            0            0</span><br><span class="line">9441:        ZXDA               0               0            0            0</span><br><span class="line">9442:        ZXDB               0               0            0            0</span><br><span class="line">9443:        ZXDC               0               0            0            0</span><br><span class="line">9444:         ZYX               0               0            0            0</span><br><span class="line">      Missense_Mutation Nonsense_Mutation Nonstop_Mutation Splice_Site</span><br><span class="line">   1:                60                27                1          16</span><br><span class="line">   2:                19                38                0          13</span><br><span class="line">   3:                58                 9                0           1</span><br><span class="line">   4:                10                18                0           4</span><br><span class="line">   5:                 8                 8                0           4</span><br><span class="line">  ---                                                                 </span><br><span class="line">9440:                 1                 0                0           0</span><br><span class="line">9441:                 1                 0                0           0</span><br><span class="line">9442:                 0                 1                0           0</span><br><span class="line">9443:                 0                 1                0           0</span><br><span class="line">9444:                 1                 0                0           0</span><br><span class="line">      Translation_Start_Site total MutatedSamples AlteredSamples</span><br><span class="line">   1:                      0   169            166            166</span><br><span class="line">   2:                      0   148            141            141</span><br><span class="line">   3:                      0    77             59             59</span><br><span class="line">   4:                      0    46             42             42</span><br><span class="line">   5:                      3    37             35             35</span><br><span class="line">  ---                                                           </span><br><span class="line">9440:                      0     1              1              1</span><br><span class="line">9441:                      0     1              1              1</span><br><span class="line">9442:                      0     1              1              1</span><br><span class="line">9443:                      0     1              1              1</span><br><span class="line">9444:                      0     1              1              1</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; getClinicalData(kirc) <span class="comment"># 临床信息，即clinical.tsv文件中的内容，相同的case_id会输出一行，内容很长，不展示</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&gt; getFields(kirc) <span class="comment"># 显示MAF文件中的所有字段，第16列就是我们预先修改过的"Tumor_Sample_Barcode"</span></span><br><span class="line">  [1] <span class="string">"Hugo_Symbol"</span>                   <span class="string">"Entrez_Gene_Id"</span>               </span><br><span class="line">  [3] <span class="string">"Center"</span>                        <span class="string">"NCBI_Build"</span>                   </span><br><span class="line">  [5] <span class="string">"Chromosome"</span>                    <span class="string">"Start_Position"</span>               </span><br><span class="line">  [7] <span class="string">"End_Position"</span>                  <span class="string">"Strand"</span>                       </span><br><span class="line">  [9] <span class="string">"Variant_Classification"</span>        <span class="string">"Variant_Type"</span>                 </span><br><span class="line"> [11] <span class="string">"Reference_Allele"</span>              <span class="string">"Tumor_Seq_Allele1"</span>            </span><br><span class="line"> [13] <span class="string">"Tumor_Seq_Allele2"</span>             <span class="string">"dbSNP_RS"</span>                     </span><br><span class="line"> [15] <span class="string">"dbSNP_Val_Status"</span>              <span class="string">"Tumor_Sample_Barcode"</span>         </span><br><span class="line"> [17] <span class="string">"Matched_Norm_Sample_Barcode"</span>   <span class="string">"Match_Norm_Seq_Allele1"</span>       </span><br><span class="line"> [19] <span class="string">"Match_Norm_Seq_Allele2"</span>        <span class="string">"Tumor_Validation_Allele1"</span>     </span><br><span class="line"> [21] <span class="string">"Tumor_Validation_Allele2"</span>      <span class="string">"Match_Norm_Validation_Allele1"</span></span><br><span class="line"> [23] <span class="string">"Match_Norm_Validation_Allele2"</span> <span class="string">"Verification_Status"</span>          </span><br><span class="line"> [25] <span class="string">"Validation_Status"</span>             <span class="string">"Mutation_Status"</span>              </span><br><span class="line"> [27] <span class="string">"Sequencing_Phase"</span>              <span class="string">"Sequence_Source"</span>              </span><br><span class="line"> [29] <span class="string">"Validation_Method"</span>             <span class="string">"Score"</span>                        </span><br><span class="line"> [31] <span class="string">"BAM_File"</span>                      <span class="string">"Sequencer"</span>                    </span><br><span class="line"> [33] <span class="string">"Tumor_Sample_UUID"</span>             <span class="string">"Matched_Norm_Sample_UUID"</span>     </span><br><span class="line"> [35] <span class="string">"HGVSc"</span>                         <span class="string">"HGVSp"</span>                        </span><br><span class="line"> [37] <span class="string">"HGVSp_Short"</span>                   <span class="string">"Transcript_ID"</span>                </span><br><span class="line"> [39] <span class="string">"Exon_Number"</span>                   <span class="string">"t_depth"</span>                      </span><br><span class="line"> [41] <span class="string">"t_ref_count"</span>                   <span class="string">"t_alt_count"</span>                  </span><br><span class="line"> [43] <span class="string">"n_depth"</span>                       <span class="string">"n_ref_count"</span>                  </span><br><span class="line"> [45] <span class="string">"n_alt_count"</span>                   <span class="string">"all_effects"</span>                  </span><br><span class="line"> [47] <span class="string">"Allele"</span>                        <span class="string">"Gene"</span>                         </span><br><span class="line"> [49] <span class="string">"Feature"</span>                       <span class="string">"Feature_type"</span>                 </span><br><span class="line"> [51] <span class="string">"One_Consequence"</span>               <span class="string">"Consequence"</span>                  </span><br><span class="line"> [53] <span class="string">"cDNA_position"</span>                 <span class="string">"CDS_position"</span>                 </span><br><span class="line"> [55] <span class="string">"Protein_position"</span>              <span class="string">"Amino_acids"</span>                  </span><br><span class="line"> [57] <span class="string">"Codons"</span>                        <span class="string">"Existing_variation"</span>           </span><br><span class="line"> [59] <span class="string">"ALLELE_NUM"</span>                    <span class="string">"DISTANCE"</span>                     </span><br><span class="line"> [61] <span class="string">"TRANSCRIPT_STRAND"</span>             <span class="string">"SYMBOL"</span>                       </span><br><span class="line"> [63] <span class="string">"SYMBOL_SOURCE"</span>                 <span class="string">"HGNC_ID"</span>                      </span><br><span class="line"> [65] <span class="string">"BIOTYPE"</span>                       <span class="string">"CANONICAL"</span>                    </span><br><span class="line"> [67] <span class="string">"CCDS"</span>                          <span class="string">"ENSP"</span>                         </span><br><span class="line"> [69] <span class="string">"SWISSPROT"</span>                     <span class="string">"TREMBL"</span>                       </span><br><span class="line"> [71] <span class="string">"UNIPARC"</span>                       <span class="string">"RefSeq"</span>                       </span><br><span class="line"> [73] <span class="string">"SIFT"</span>                          <span class="string">"PolyPhen"</span>                     </span><br><span class="line"> [75] <span class="string">"EXON"</span>                          <span class="string">"INTRON"</span>                       </span><br><span class="line"> [77] <span class="string">"DOMAINS"</span>                       <span class="string">"GMAF"</span>                         </span><br><span class="line"> [79] <span class="string">"AFR_MAF"</span>                       <span class="string">"AMR_MAF"</span>                      </span><br><span class="line"> [81] <span class="string">"ASN_MAF"</span>                       <span class="string">"EAS_MAF"</span>                      </span><br><span class="line"> [83] <span class="string">"EUR_MAF"</span>                       <span class="string">"SAS_MAF"</span>                      </span><br><span class="line"> [85] <span class="string">"AA_MAF"</span>                        <span class="string">"EA_MAF"</span>                       </span><br><span class="line"> [87] <span class="string">"CLIN_SIG"</span>                      <span class="string">"SOMATIC"</span>                      </span><br><span class="line"> [89] <span class="string">"PUBMED"</span>                        <span class="string">"MOTIF_NAME"</span>                   </span><br><span class="line"> [91] <span class="string">"MOTIF_POS"</span>                     <span class="string">"HIGH_INF_POS"</span>                 </span><br><span class="line"> [93] <span class="string">"MOTIF_SCORE_CHANGE"</span>            <span class="string">"IMPACT"</span>                       </span><br><span class="line"> [95] <span class="string">"PICK"</span>                          <span class="string">"VARIANT_CLASS"</span>                </span><br><span class="line"> [97] <span class="string">"TSL"</span>                           <span class="string">"HGVS_OFFSET"</span>                  </span><br><span class="line"> [99] <span class="string">"PHENO"</span>                         <span class="string">"MINIMISED"</span>                    </span><br><span class="line">[101] <span class="string">"ExAC_AF"</span>                       <span class="string">"ExAC_AF_Adj"</span>                  </span><br><span class="line">[103] <span class="string">"ExAC_AF_AFR"</span>                   <span class="string">"ExAC_AF_AMR"</span>                  </span><br><span class="line">[105] <span class="string">"ExAC_AF_EAS"</span>                   <span class="string">"ExAC_AF_FIN"</span>                  </span><br><span class="line">[107] <span class="string">"ExAC_AF_NFE"</span>                   <span class="string">"ExAC_AF_OTH"</span>                  </span><br><span class="line">[109] <span class="string">"ExAC_AF_SAS"</span>                   <span class="string">"GENE_PHENO"</span>                   </span><br><span class="line">[111] <span class="string">"FILTER"</span>                        <span class="string">"CONTEXT"</span>                      </span><br><span class="line">[113] <span class="string">"src_vcf_id"</span>                    <span class="string">"tumor_bam_uuid"</span>               </span><br><span class="line">[115] <span class="string">"normal_bam_uuid"</span>               <span class="string">"case_id"</span>                      </span><br><span class="line">[117] <span class="string">"GDC_FILTER"</span>                    <span class="string">"COSMIC"</span>                       </span><br><span class="line">[119] <span class="string">"MC3_Overlap"</span>                   <span class="string">"GDC_Validation_Status"</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; write.mafSummary(maf=kirc, basename=<span class="string">"kirc"</span>) <span class="comment"># 输出一个kirc_sampleSummary.txt文件，内容就是getSampleSummary()输出的内容</span></span><br></pre></td></tr></table></figure><h1 id="三、突变的可视化"><a href="#三、突变的可视化" class="headerlink" title="三、突变的可视化"></a>三、突变的可视化</h1><h2 id="3-1-MAF文件汇总统计图"><a href="#3-1-MAF文件汇总统计图" class="headerlink" title="3.1 MAF文件汇总统计图"></a>3.1 MAF文件汇总统计图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; plotmafSummary(maf=kirc, rmOutlier=FALSE, addStat=<span class="string">"median"</span>, dashboard=TRUE, titvRaw = FALSE)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc01.png" alt></p><h2 id="3-2-ONCOPLOT（瀑布图）"><a href="#3-2-ONCOPLOT（瀑布图）" class="headerlink" title="3.2 ONCOPLOT（瀑布图）"></a>3.2 ONCOPLOT（瀑布图）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oncoplot(maf=kirc,top=10,fontSize = 0.6,showTumorSampleBarcodes = F)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc02.png" alt></p><p>若对某些基因感兴趣，则使用genes参数指定基因，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oncoplot(maf=kirc,genes=c(<span class="string">"VHL"</span>,<span class="string">"PBRM1"</span>,<span class="string">"SETD2"</span>,<span class="string">"BAP1"</span>,<span class="string">"KDM5C"</span>,<span class="string">"TP53"</span>,<span class="string">"ATM"</span>,<span class="string">"ARID1A"</span>,<span class="string">"PTEN"</span>,<span class="string">"TSC1"</span>,<span class="string">"NF2"</span>,<span class="string">"CDKN2A"</span>,<span class="string">"CDKN2B"</span>),fontSize = 0.6,showTumorSampleBarcodes = F)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc03.png" alt></p><h2 id="3-3-基因突变共存与排斥"><a href="#3-3-基因突变共存与排斥" class="headerlink" title="3.3 基因突变共存与排斥"></a>3.3 基因突变共存与排斥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&gt; somaticInteractions(maf=kirc,top=10,pvalue = c(0.01,0.05),fontSize = 0.5)</span><br><span class="line">    gene1 gene2       pValue oddsRatio  00 11  01  10              Event</span><br><span class="line"> 1:   VHL PBRM1 0.0006345551 2.1499701 115 85  56  81       Co_Occurence</span><br><span class="line"> 2: SETD2 PBRM1 0.0069684692 2.5362176 180 26 115  16       Co_Occurence</span><br><span class="line"> 3:  BAP1 MUC16 0.0177253442 3.6761737 286  6  16  29       Co_Occurence</span><br><span class="line"> 4:   TTN HMCN1 0.0231208832 3.2520719 267  7  11  52       Co_Occurence</span><br><span class="line"> 5:  MTOR   TTN 0.0811830227 2.3527658 263  7  52  15       Co_Occurence</span><br><span class="line"> 6: DNAH9  BAP1 0.0869868888 2.8556913 289  4  31  13       Co_Occurence</span><br><span class="line"> 7: DNAH9  MTOR 0.0902657408 3.3752125 301  3  19  14       Co_Occurence</span><br><span class="line"> 8:   TTN  BAP1 0.0963286074 2.0600380 253 10  25  49       Co_Occurence</span><br><span class="line"> 9:   TTN SETD2 0.1287443528 1.8222905 247 11  31  48       Co_Occurence</span><br><span class="line">10: MUC16  MTOR 0.1649934265 2.4505615 296  3  19  19       Co_Occurence</span><br><span class="line">11: DNAH9   TTN 0.1924226420 2.0471964 266  5  54  12       Co_Occurence</span><br><span class="line">12:  BAP1 PBRM1 0.2090438361 0.6072762 172 11 130  24 Mutually_Exclusive</span><br><span class="line">13: MUC16   TTN 0.2426284078 1.8496958 262  6  53  16       Co_Occurence</span><br><span class="line">14: KDM5C  BAP1 0.2453372474 0.0000000 282  0  35  20 Mutually_Exclusive</span><br><span class="line">15: DNAH9 SETD2 0.2460022133 2.2760862 282  4  38  13       Co_Occurence</span><br><span class="line">16: HMCN1 SETD2 0.2586292953 2.1068377 281  4  38  14       Co_Occurence</span><br><span class="line">17:   VHL SETD2 0.3232858924 1.4350657 153 24  18 142       Co_Occurence</span><br><span class="line">18:  MTOR HMCN1 0.3314867116 1.8644128 299  2  16  20       Co_Occurence</span><br><span class="line">19: MUC16 HMCN1 0.3314867116 1.8644128 299  2  16  20       Co_Occurence</span><br><span class="line">20: KDM5C   TTN 0.3647966906 1.6207908 263  5  54  15       Co_Occurence</span><br><span class="line">21: MUC16 KDM5C 0.3814379116 1.6470297 297  2  18  20       Co_Occurence</span><br><span class="line">22: SETD2  BAP1 0.4145364481 1.5265571 266  6  29  36       Co_Occurence</span><br><span class="line">23: HMCN1  BAP1 0.4153981852 1.7899322 287  3  32  15       Co_Occurence</span><br><span class="line">24: PBRM1 DNAH9 0.4501215062 1.5999432 188  9   8 132       Co_Occurence</span><br><span class="line">25:  BAP1  MTOR 0.4880885198 1.3948288 283  3  19  32       Co_Occurence</span><br><span class="line">26: KDM5C SETD2 0.4881372857 0.3550657 276  1  41  19 Mutually_Exclusive</span><br><span class="line">27: DNAH9   VHL 0.6206385050 0.7095260 161  7 159  10 Mutually_Exclusive</span><br><span class="line">28:   TTN PBRM1 0.6649326479 0.8666566 160 23 118  36 Mutually_Exclusive</span><br><span class="line">29: MUC16 SETD2 0.7451002458 1.1170630 276  3  39  19       Co_Occurence</span><br><span class="line">30: HMCN1   VHL 0.8097726647 0.8156840 161  8 158  10 Mutually_Exclusive</span><br><span class="line">31: PBRM1 HMCN1 0.8113574779 1.1184198 186  8  10 133       Co_Occurence</span><br><span class="line">32:  MTOR PBRM1 0.8239686926 1.1699269 184 10 131  12       Co_Occurence</span><br><span class="line">33: MUC16 PBRM1 0.8239686926 1.1699269 184 10 131  12       Co_Occurence</span><br><span class="line">34:  MTOR   VHL 0.8264941510 0.8497706 159 10 156  12 Mutually_Exclusive</span><br><span class="line">35:   TTN   VHL 1.0000000000 0.9949054 141 29 137  30 Mutually_Exclusive</span><br><span class="line">36:  BAP1   VHL 1.0000000000 0.9698796 153 17 149  18 Mutually_Exclusive</span><br><span class="line">37: MUC16   VHL 1.0000000000 1.0321697 160 11 155  11       Co_Occurence</span><br><span class="line">38: KDM5C   VHL 1.0000000000 1.0319633 161 10 156  10       Co_Occurence</span><br><span class="line">39: KDM5C PBRM1 1.0000000000 0.9225070 184  8 133  12 Mutually_Exclusive</span><br><span class="line">40:  MTOR SETD2 1.0000000000 0.6881771 275  2  40  20 Mutually_Exclusive</span><br><span class="line">41: KDM5C  MTOR 1.0000000000 0.7424513 296  1  21  19 Mutually_Exclusive</span><br><span class="line">42: DNAH9 MUC16 1.0000000000 0.8901653 299  1  21  16 Mutually_Exclusive</span><br><span class="line">43: HMCN1 KDM5C 1.0000000000 0.9289862 300  1  19  17 Mutually_Exclusive</span><br><span class="line">44: DNAH9 KDM5C 1.0000000000 0.9901605 301  1  19  16 Mutually_Exclusive</span><br><span class="line">45: DNAH9 HMCN1 1.0000000000 1.1135821 303  1  17  16       Co_Occurence</span><br><span class="line">    gene1 gene2       pValue oddsRatio  00 11  01  10              Event</span><br><span class="line">            pair event_ratio</span><br><span class="line"> 1:   PBRM1, VHL      85/137</span><br><span class="line"> 2: PBRM1, SETD2      26/131</span><br><span class="line"> 3:  BAP1, MUC16        6/45</span><br><span class="line"> 4:   HMCN1, TTN        7/63</span><br><span class="line"> 5:    MTOR, TTN        7/67</span><br><span class="line"> 6:  BAP1, DNAH9        4/44</span><br><span class="line"> 7:  DNAH9, MTOR        3/33</span><br><span class="line"> 8:    BAP1, TTN       10/74</span><br><span class="line"> 9:   SETD2, TTN       11/79</span><br><span class="line">10:  MTOR, MUC16        3/38</span><br><span class="line">11:   DNAH9, TTN        5/66</span><br><span class="line">12:  BAP1, PBRM1      11/154</span><br><span class="line">13:   MUC16, TTN        6/69</span><br><span class="line">14:  BAP1, KDM5C        0/55</span><br><span class="line">15: DNAH9, SETD2        4/51</span><br><span class="line">16: HMCN1, SETD2        4/52</span><br><span class="line">17:   SETD2, VHL      24/160</span><br><span class="line">18:  HMCN1, MTOR        2/36</span><br><span class="line">19: HMCN1, MUC16        2/36</span><br><span class="line">20:   KDM5C, TTN        5/69</span><br><span class="line">21: KDM5C, MUC16        2/38</span><br><span class="line">22:  BAP1, SETD2        6/65</span><br><span class="line">23:  BAP1, HMCN1        3/47</span><br><span class="line">24: DNAH9, PBRM1       9/140</span><br><span class="line">25:   BAP1, MTOR        3/51</span><br><span class="line">26: KDM5C, SETD2        1/60</span><br><span class="line">27:   DNAH9, VHL       7/169</span><br><span class="line">28:   PBRM1, TTN      23/154</span><br><span class="line">29: MUC16, SETD2        3/58</span><br><span class="line">30:   HMCN1, VHL       8/168</span><br><span class="line">31: HMCN1, PBRM1       8/143</span><br><span class="line">32:  MTOR, PBRM1      10/143</span><br><span class="line">33: MUC16, PBRM1      10/143</span><br><span class="line">34:    MTOR, VHL      10/168</span><br><span class="line">35:     TTN, VHL      29/167</span><br><span class="line">36:    BAP1, VHL      17/167</span><br><span class="line">37:   MUC16, VHL      11/166</span><br><span class="line">38:   KDM5C, VHL      10/166</span><br><span class="line">39: KDM5C, PBRM1       8/145</span><br><span class="line">40:  MTOR, SETD2        2/60</span><br><span class="line">41:  KDM5C, MTOR        1/40</span><br><span class="line">42: DNAH9, MUC16        1/37</span><br><span class="line">43: HMCN1, KDM5C        1/36</span><br><span class="line">44: DNAH9, KDM5C        1/35</span><br><span class="line">45: DNAH9, HMCN1        1/33</span><br><span class="line">            pair event_ratio</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc04.png" alt></p><p>同理，也可以指定感兴趣的基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">&gt; somaticInteractions(maf=kirc,genes=c(<span class="string">"VHL"</span>,<span class="string">"PBRM1"</span>,<span class="string">"SETD2"</span>,<span class="string">"BAP1"</span>,<span class="string">"KDM5C"</span>,<span class="string">"TP53"</span>,<span class="string">"ATM"</span>,<span class="string">"ARID1A"</span>,<span class="string">"PTEN"</span>,<span class="string">"TSC1"</span>,<span class="string">"NF2"</span>,<span class="string">"CDKN2A"</span>,<span class="string">"CDKN2B"</span>),pvalue = c(0.01,0.05),fontSize = 0.5)</span><br><span class="line">     gene1  gene2       pValue  oddsRatio  00 11  01  10              Event</span><br><span class="line"> 1:    VHL  PBRM1 0.0006345551  2.1499701 115 85  56  81       Co_Occurence</span><br><span class="line"> 2:  SETD2  PBRM1 0.0069684692  2.5362176 180 26 115  16       Co_Occurence</span><br><span class="line"> 3:  PBRM1    ATM 0.0358546719  3.2210326 191 11   5 130       Co_Occurence</span><br><span class="line"> 4:    NF2    VHL 0.0607849993  0.0000000 166  0 166   5 Mutually_Exclusive</span><br><span class="line"> 5:   TP53    VHL 0.0673114551  0.1426375 164  1 165   7 Mutually_Exclusive</span><br><span class="line"> 6:    NF2  PBRM1 0.0774205829  0.0000000 191  0 141   5 Mutually_Exclusive</span><br><span class="line"> 7:    VHL   PTEN 0.0826438335  3.1999405 168  9   3 157       Co_Occurence</span><br><span class="line"> 8:    NF2   TP53 0.1138366801 11.3372992 325  1   7   4       Co_Occurence</span><br><span class="line"> 9:   TP53  PBRM1 0.1457726032  0.1935716 189  1 140   7 Mutually_Exclusive</span><br><span class="line">10:    ATM   TSC1 0.1775445900  6.9716044 318  1   3  15       Co_Occurence</span><br><span class="line">11:   PTEN  SETD2 0.1778634395  2.4357280 286  3  39   9       Co_Occurence</span><br><span class="line">12:   BAP1  PBRM1 0.2090438361  0.6072762 172 11 130  24 Mutually_Exclusive</span><br><span class="line">13:  KDM5C   BAP1 0.2453372474  0.0000000 282  0  35  20 Mutually_Exclusive</span><br><span class="line">14:   TP53   PTEN 0.2541098432  4.0970807 318  1  11   7       Co_Occurence</span><br><span class="line">15:    VHL ARID1A 0.2853701129  1.8996157 166  9   5 157       Co_Occurence</span><br><span class="line">16:    ATM    VHL 0.3144443178  1.7598874 165 10 156   6       Co_Occurence</span><br><span class="line">17:    VHL  SETD2 0.3232858924  1.4350657 153 24  18 142       Co_Occurence</span><br><span class="line">18:   TSC1  SETD2 0.4143213860  2.3659439 292  1  41   3       Co_Occurence</span><br><span class="line">19:  SETD2   BAP1 0.4145364481  1.5265571 266  6  29  36       Co_Occurence</span><br><span class="line">20:  KDM5C  SETD2 0.4881372857  0.3550657 276  1  41  19 Mutually_Exclusive</span><br><span class="line">21:  SETD2    NF2 0.4881907608  1.7706936 291  1   4  41       Co_Occurence</span><br><span class="line">22:  KDM5C   PTEN 0.5261326770  1.4621664 306  1  11  19       Co_Occurence</span><br><span class="line">23:   PTEN  PBRM1 0.5665516486  1.4059303 190  6 135   6       Co_Occurence</span><br><span class="line">24: ARID1A  PBRM1 0.5860353120  1.4089576 189  7 134   7       Co_Occurence</span><br><span class="line">25:    ATM  KDM5C 0.6110121591  0.0000000 301  0  20  16 Mutually_Exclusive</span><br><span class="line">26:   TSC1    VHL 0.6229248936  0.3403639 168  1 165   3 Mutually_Exclusive</span><br><span class="line">27: ARID1A   BAP1 0.6463374918  1.4627394 290  2  33  12       Co_Occurence</span><br><span class="line">28:    ATM   BAP1 0.6765457171  1.2458698 288  2  33  14       Co_Occurence</span><br><span class="line">29:  SETD2 ARID1A 0.6890948911  1.1785374 283  2  12  40       Co_Occurence</span><br><span class="line">30:    ATM  SETD2 0.7037518548  0.4560963 280  1  41  15 Mutually_Exclusive</span><br><span class="line">31:   TSC1   BAP1 1.0000000000  0.0000000 298  0  35   4 Mutually_Exclusive</span><br><span class="line">32:   TP53   BAP1 1.0000000000  0.0000000 294  0  35   8 Mutually_Exclusive</span><br><span class="line">33: ARID1A  KDM5C 1.0000000000  0.0000000 303  0  20  14 Mutually_Exclusive</span><br><span class="line">34:   TSC1  KDM5C 1.0000000000  0.0000000 313  0  20   4 Mutually_Exclusive</span><br><span class="line">35:   TP53    ATM 1.0000000000  0.0000000 313  0  16   8 Mutually_Exclusive</span><br><span class="line">36:   TP53 ARID1A 1.0000000000  0.0000000 315  0  14   8 Mutually_Exclusive</span><br><span class="line">37:    NF2 ARID1A 1.0000000000  0.0000000 318  0  14   5 Mutually_Exclusive</span><br><span class="line">38:   BAP1    NF2 1.0000000000  0.0000000 297  0   5  35 Mutually_Exclusive</span><br><span class="line">39:  KDM5C    NF2 1.0000000000  0.0000000 312  0   5  20 Mutually_Exclusive</span><br><span class="line">40:   PTEN    NF2 1.0000000000  0.0000000 320  0   5  12 Mutually_Exclusive</span><br><span class="line">41:   PTEN   TSC1 1.0000000000  0.0000000 321  0   4  12 Mutually_Exclusive</span><br><span class="line">42:   TP53   TSC1 1.0000000000  0.0000000 325  0   4   8 Mutually_Exclusive</span><br><span class="line">43:   BAP1    VHL 1.0000000000  0.9698796 153 17 149  18 Mutually_Exclusive</span><br><span class="line">44:  KDM5C    VHL 1.0000000000  1.0319633 161 10 156  10       Co_Occurence</span><br><span class="line">45:  KDM5C  PBRM1 1.0000000000  0.9225070 184  8 133  12 Mutually_Exclusive</span><br><span class="line">46:   TSC1  PBRM1 1.0000000000  1.3942563 194  2 139   2       Co_Occurence</span><br><span class="line">47:   TP53  SETD2 1.0000000000  1.0034740 288  1  41   7       Co_Occurence</span><br><span class="line">48:   PTEN   BAP1 1.0000000000  0.7786031 291  1  34  11 Mutually_Exclusive</span><br><span class="line">49:   TP53  KDM5C 1.0000000000  0.0000000 309  0  20   8 Mutually_Exclusive</span><br><span class="line">50: ARID1A    ATM 1.0000000000  0.0000000 307  0  16  14 Mutually_Exclusive</span><br><span class="line">51:   PTEN    ATM 1.0000000000  0.0000000 309  0  16  12 Mutually_Exclusive</span><br><span class="line">52:    NF2    ATM 1.0000000000  0.0000000 316  0  16   5 Mutually_Exclusive</span><br><span class="line">53:   PTEN ARID1A 1.0000000000  0.0000000 311  0  14  12 Mutually_Exclusive</span><br><span class="line">54:   TSC1 ARID1A 1.0000000000  0.0000000 319  0  14   4 Mutually_Exclusive</span><br><span class="line">55:   TSC1    NF2 1.0000000000  0.0000000 328  0   5   4 Mutually_Exclusive</span><br><span class="line">     gene1  gene2       pValue  oddsRatio  00 11  01  10              Event</span><br><span class="line">             pair event_ratio</span><br><span class="line"> 1:    PBRM1, VHL      85/137</span><br><span class="line"> 2:  PBRM1, SETD2      26/131</span><br><span class="line"> 3:    ATM, PBRM1      11/135</span><br><span class="line"> 4:      NF2, VHL       0/171</span><br><span class="line"> 5:     TP53, VHL       1/172</span><br><span class="line"> 6:    NF2, PBRM1       0/146</span><br><span class="line"> 7:     PTEN, VHL       9/160</span><br><span class="line"> 8:     NF2, TP53        1/11</span><br><span class="line"> 9:   PBRM1, TP53       1/147</span><br><span class="line">10:     ATM, TSC1        1/18</span><br><span class="line">11:   PTEN, SETD2        3/48</span><br><span class="line">12:   BAP1, PBRM1      11/154</span><br><span class="line">13:   BAP1, KDM5C        0/55</span><br><span class="line">14:    PTEN, TP53        1/18</span><br><span class="line">15:   ARID1A, VHL       9/162</span><br><span class="line">16:      ATM, VHL      10/162</span><br><span class="line">17:    SETD2, VHL      24/160</span><br><span class="line">18:   SETD2, TSC1        1/44</span><br><span class="line">19:   BAP1, SETD2        6/65</span><br><span class="line">20:  KDM5C, SETD2        1/60</span><br><span class="line">21:    NF2, SETD2        1/45</span><br><span class="line">22:   KDM5C, PTEN        1/30</span><br><span class="line">23:   PBRM1, PTEN       6/141</span><br><span class="line">24: ARID1A, PBRM1       7/141</span><br><span class="line">25:    ATM, KDM5C        0/36</span><br><span class="line">26:     TSC1, VHL       1/168</span><br><span class="line">27:  ARID1A, BAP1        2/45</span><br><span class="line">28:     ATM, BAP1        2/47</span><br><span class="line">29: ARID1A, SETD2        2/52</span><br><span class="line">30:    ATM, SETD2        1/56</span><br><span class="line">31:    BAP1, TSC1        0/39</span><br><span class="line">32:    BAP1, TP53        0/43</span><br><span class="line">33: ARID1A, KDM5C        0/34</span><br><span class="line">34:   KDM5C, TSC1        0/24</span><br><span class="line">35:     ATM, TP53        0/24</span><br><span class="line">36:  ARID1A, TP53        0/22</span><br><span class="line">37:   ARID1A, NF2        0/19</span><br><span class="line">38:     BAP1, NF2        0/40</span><br><span class="line">39:    KDM5C, NF2        0/25</span><br><span class="line">40:     NF2, PTEN        0/17</span><br><span class="line">41:    PTEN, TSC1        0/16</span><br><span class="line">42:    TP53, TSC1        0/12</span><br><span class="line">43:     BAP1, VHL      17/167</span><br><span class="line">44:    KDM5C, VHL      10/166</span><br><span class="line">45:  KDM5C, PBRM1       8/145</span><br><span class="line">46:   PBRM1, TSC1       2/141</span><br><span class="line">47:   SETD2, TP53        1/48</span><br><span class="line">48:    BAP1, PTEN        1/45</span><br><span class="line">49:   KDM5C, TP53        0/28</span><br><span class="line">50:   ARID1A, ATM        0/30</span><br><span class="line">51:     ATM, PTEN        0/28</span><br><span class="line">52:      ATM, NF2        0/21</span><br><span class="line">53:  ARID1A, PTEN        0/26</span><br><span class="line">54:  ARID1A, TSC1        0/18</span><br><span class="line">55:     NF2, TSC1         0/9</span><br><span class="line">             pair event_ratio</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc05.png" alt></p><h2 id="3-4-文字云"><a href="#3-4-文字云" class="headerlink" title="3.4 文字云"></a>3.4 文字云</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; geneCloud(input=kirc,top=10)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc06.png" alt></p><h2 id="3-5-ONCOSTRIP"><a href="#3-5-ONCOSTRIP" class="headerlink" title="3.5 ONCOSTRIP"></a>3.5 ONCOSTRIP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; oncostrip(maf=kirc,top=10) <span class="comment"># oncostrip与oncoplot非常相似，但没有右侧的统计结果，按需选择吧</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc07.png" alt></p><p>或按一组基因作图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oncostrip(maf=kirc,genes=c(<span class="string">"VHL"</span>,<span class="string">"PBRM1"</span>,<span class="string">"SETD2"</span>,<span class="string">"BAP1"</span>,<span class="string">"KDM5C"</span>,<span class="string">"TP53"</span>,<span class="string">"ATM"</span>,<span class="string">"ARID1A"</span>,<span class="string">"PTEN"</span>,<span class="string">"TSC1"</span>,<span class="string">"NF2"</span>,<span class="string">"CDKN2A"</span>,<span class="string">"CDKN2B"</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc08.png" alt></p><h2 id="3-6-转换（transition）和颠换（transversion）"><a href="#3-6-转换（transition）和颠换（transversion）" class="headerlink" title="3.6 转换（transition）和颠换（transversion）"></a>3.6 转换（transition）和颠换（transversion）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; titv(maf=kirc, plot=TRUE, useSyn=TRUE) <span class="comment"># titv函数的结果是对SNV_Class的另外一种诠释</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc09.png" alt></p><h2 id="3-7-LOLLIPOPPLOT"><a href="#3-7-LOLLIPOPPLOT" class="headerlink" title="3.7 LOLLIPOPPLOT"></a>3.7 LOLLIPOPPLOT</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; lollipopPlot(maf=kirc, gene=<span class="string">"TP53"</span>, AACol=<span class="string">"HGVSp_Short"</span>, showMutationRate=TRUE)</span><br><span class="line">8 transcripts available. Use arguments refSeqID or proteinID to manually specify tx name.</span><br><span class="line">   HGNC    refseq.ID   protein.ID aa.length</span><br><span class="line">1: TP53    NM_000546    NP_000537       393</span><br><span class="line">2: TP53 NM_001126112 NP_001119584       393</span><br><span class="line">3: TP53 NM_001126118 NP_001119590       354</span><br><span class="line">4: TP53 NM_001126115 NP_001119587       261</span><br><span class="line">5: TP53 NM_001126113 NP_001119585       346</span><br><span class="line">6: TP53 NM_001126117 NP_001119589       214</span><br><span class="line">7: TP53 NM_001126114 NP_001119586       341</span><br><span class="line">8: TP53 NM_001126116 NP_001119588       209</span><br><span class="line">Using longer transcript NM_000546 <span class="keyword">for</span> now.</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc10.png" alt></p><p>上面提示有报错信息，原因是TP53这个基因有8个已知的转录本，程序自动选择了最长的转录本，即NM_000546，我们可以通过refSeqID或proteinID手动指定转录本，如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lollipopPlot(maf=kirc, gene=<span class="string">"TP53"</span>,refSeqID=<span class="string">"NM_001126115"</span>, AACol=<span class="string">"HGVSp_Short"</span>, showMutationRate=TRUE)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc11.png" alt></p><h2 id="3-8-RAINFALLPLOT（降雨图）"><a href="#3-8-RAINFALLPLOT（降雨图）" class="headerlink" title="3.8 RAINFALLPLOT（降雨图）"></a>3.8 RAINFALLPLOT（降雨图）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rainfallPlot(maf=kirc, detectChangePoints=TRUE, pointSize=0.6) <span class="comment"># 通过绘制染色体尺度的突变间距来展示hyper mutated genomic region</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc12.png" alt></p><h2 id="3-9-TMB（肿瘤突变负荷）"><a href="#3-9-TMB（肿瘤突变负荷）" class="headerlink" title="3.9 TMB（肿瘤突变负荷）"></a>3.9 TMB（肿瘤突变负荷）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcgaCompare(maf=kirc, cohortName=<span class="string">"kirc"</span>) <span class="comment"># cohortName是自定义的名称</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc13.png" alt></p><h2 id="3-10-VAF（Variant-Allele-Frequency，变异等位基因频率）"><a href="#3-10-VAF（Variant-Allele-Frequency，变异等位基因频率）" class="headerlink" title="3.10 VAF（Variant Allele Frequency，变异等位基因频率）"></a>3.10 VAF（Variant Allele Frequency，变异等位基因频率）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plotVaf(maf=kirc,top=10) <span class="comment"># 默认top=10，可以手动指定，也可以使用genes指定基因名称</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc14.png" alt></p><h1 id="四、生存分析"><a href="#四、生存分析" class="headerlink" title="四、生存分析"></a>四、生存分析</h1><p>生存分析是基于MAF文件中给定基因或样本的突变状态进行预测，可以通过参数genes指定一个或一组基因，可以通过参数samples指定样本，参数中的status需要特别注意，我这里使用的是”vital_status”，这个参数必须是“TRUE”/“FALSE”或者”1”/“0”，因此，需要在clinical.tsv中对相应的列进行修改，具体到不同的分析软件这一列的名称会大不相同。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; mafSurvival(maf=kirc, genes=c(<span class="string">"VHL"</span>), time=<span class="string">"days_to_last_follow_up"</span>, Status=<span class="string">"vital_status"</span>, isTCGA=TRUE)</span><br><span class="line">Looking <span class="keyword">for</span> clinical data <span class="keyword">in</span> annoatation slot of MAF..</span><br><span class="line">Number of mutated samples <span class="keyword">for</span> given genes: </span><br><span class="line">VHL </span><br><span class="line">166 </span><br><span class="line">Removed 69 samples with NA<span class="string">'s</span></span><br><span class="line"><span class="string">Median survival..</span></span><br><span class="line"><span class="string">    Group medianTime   N</span></span><br><span class="line"><span class="string">1: Mutant     1261.5 130</span></span><br><span class="line"><span class="string">2:     WT     1217.0 137</span></span><br><span class="line"><span class="string">Warning messages:</span></span><br><span class="line"><span class="string">1: In survival::Surv(time = Time, event = Status) :</span></span><br><span class="line"><span class="string">  Invalid status value, converted to NA</span></span><br><span class="line"><span class="string">2: In survival::Surv(time = Time, event = Status) :</span></span><br><span class="line"><span class="string">  Invalid status value, converted to NA</span></span><br><span class="line"><span class="string">3: In survival::Surv(time = Time, event = Status) :</span></span><br><span class="line"><span class="string">  Invalid status value, converted to NA</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc15.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">&gt; mafSurvGroup(maf=kirc,geneSet=c(<span class="string">"SETD2"</span>,<span class="string">"PBRM1"</span>), time=<span class="string">"days_to_last_follow_up"</span>, Status=<span class="string">"vital_status"</span>)</span><br><span class="line">Looking <span class="keyword">for</span> clinical data <span class="keyword">in</span> annoatation slot of MAF..</span><br><span class="line">Removed 69 samples with NA<span class="string">'s</span></span><br><span class="line"><span class="string">Median survival..</span></span><br><span class="line"><span class="string">    Group medianTime   N</span></span><br><span class="line"><span class="string">1: Mutant       2231  19</span></span><br><span class="line"><span class="string">2:     WT       1176 248</span></span><br><span class="line"><span class="string">&gt; prog_geneset = survGroup(maf = kirc, top = 20, minSamples=5,geneSetSize = 2, time = "days_to_last_follow_up", Status="vital_status", verbose = TRUE)</span></span><br><span class="line"><span class="string">------------------</span></span><br><span class="line"><span class="string">genes: 20</span></span><br><span class="line"><span class="string">geneset size: 2</span></span><br><span class="line"><span class="string">190 combinations</span></span><br><span class="line"><span class="string">Looking for clinical data in annoatation slot of MAF..</span></span><br><span class="line"><span class="string">Removed 69 samples with NA'</span>s</span><br><span class="line">Geneset:  VHL,PBRM1 [N= 85 ]</span><br><span class="line">Geneset:  VHL,TTN [N= 29 ]</span><br><span class="line">Geneset:  VHL,SETD2 [N= 24 ]</span><br><span class="line">Geneset:  VHL,BAP1 [N= 17 ]</span><br><span class="line">Geneset:  VHL,MUC16 [N= 11 ]</span><br><span class="line">Geneset:  VHL,MTOR [N= 10 ]</span><br><span class="line">Geneset:  VHL,KDM5C [N= 10 ]</span><br><span class="line">Geneset:  VHL,HMCN1 [N= 8 ]</span><br><span class="line">Geneset:  VHL,DNAH9 [N= 7 ]</span><br><span class="line">Geneset:  VHL,LRP2 [N= 7 ]</span><br><span class="line">Geneset:  VHL,ATM [N= 10 ]</span><br><span class="line">Geneset:  VHL,ARID1A [N= 9 ]</span><br><span class="line">Geneset:  VHL,CSMD3 [N= 8 ]</span><br><span class="line">Geneset:  VHL,DST [N= 6 ]</span><br><span class="line">Geneset:  VHL,KMT2C [N= 7 ]</span><br><span class="line">Geneset:  VHL,ERBB4 [N= 7 ]</span><br><span class="line">Geneset:  VHL,SMARCA4 [N= 6 ]</span><br><span class="line">Geneset:  VHL,USH2A [N= 10 ]</span><br><span class="line">Geneset:  VHL,PCLO [N= 5 ]</span><br><span class="line">Geneset:  PBRM1,TTN [N= 23 ]</span><br><span class="line">Geneset:  PBRM1,SETD2 [N= 26 ]</span><br><span class="line">Geneset:  PBRM1,BAP1 [N= 11 ]</span><br><span class="line">Geneset:  PBRM1,MUC16 [N= 10 ]</span><br><span class="line">Geneset:  PBRM1,MTOR [N= 10 ]</span><br><span class="line">Geneset:  PBRM1,KDM5C [N= 8 ]</span><br><span class="line">Geneset:  PBRM1,HMCN1 [N= 8 ]</span><br><span class="line">Geneset:  PBRM1,DNAH9 [N= 9 ]</span><br><span class="line">Geneset:  PBRM1,LRP2 [N= 11 ]</span><br><span class="line">Geneset:  PBRM1,ATM [N= 11 ]</span><br><span class="line">Geneset:  PBRM1,ARID1A [N= 7 ]</span><br><span class="line">Geneset:  PBRM1,CSMD3 [N= 8 ]</span><br><span class="line">Geneset:  PBRM1,KMT2C [N= 7 ]</span><br><span class="line">Geneset:  PBRM1,ERBB4 [N= 6 ]</span><br><span class="line">Geneset:  PBRM1,SMARCA4 [N= 6 ]</span><br><span class="line">Geneset:  PBRM1,USH2A [N= 10 ]</span><br><span class="line">Geneset:  PBRM1,PCLO [N= 5 ]</span><br><span class="line">Geneset:  TTN,SETD2 [N= 11 ]</span><br><span class="line">Geneset:  TTN,BAP1 [N= 10 ]</span><br><span class="line">Geneset:  TTN,MUC16 [N= 6 ]</span><br><span class="line">Geneset:  TTN,MTOR [N= 7 ]</span><br><span class="line">Geneset:  TTN,KDM5C [N= 5 ]</span><br><span class="line">Geneset:  TTN,HMCN1 [N= 7 ]</span><br><span class="line">Geneset:  TTN,DNAH9 [N= 5 ]</span><br><span class="line">Geneset:  TTN,USH2A [N= 5 ]</span><br><span class="line">Geneset:  SETD2,BAP1 [N= 6 ]</span><br><span class="line">Geneset:  SETD2,LRP2 [N= 5 ]</span><br><span class="line">Geneset:  BAP1,MUC16 [N= 6 ]</span><br><span class="line">There were 34 warnings (use warnings() to see them)</span><br><span class="line">&gt; <span class="built_in">print</span>(prog_geneset)</span><br><span class="line">    Gene_combination  P_value       hr  WT Mutant</span><br><span class="line"> 1:        VHL_USH2A 0.000465 9.42e+00 259      8</span><br><span class="line"> 2:        TTN_USH2A 0.001190 1.36e+01 264      3</span><br><span class="line"> 3:      PBRM1_USH2A 0.001380 8.17e+00 259      8</span><br><span class="line"> 4:        VHL_KMT2C 0.026500 7.30e+00 263      4</span><br><span class="line"> 5:      PBRM1_ERBB4 0.029000 7.12e+00 263      4</span><br><span class="line"> 6:        VHL_PBRM1 0.046000 3.14e+00 198     69</span><br><span class="line"> 7:        VHL_ERBB4 0.065300 5.58e+00 261      6</span><br><span class="line"> 8:       PBRM1_MTOR 0.085400 5.11e+00 261      6</span><br><span class="line"> 9:         VHL_MTOR 0.156000 3.97e+00 261      6</span><br><span class="line">10:       VHL_ARID1A 0.523000 3.89e-08 260      7</span><br><span class="line">11:      PBRM1_MUC16 0.556000 3.94e-08 258      9</span><br><span class="line">12:        PBRM1_ATM 0.558000 3.94e-08 258      9</span><br><span class="line">13:         TTN_BAP1 0.559000 3.92e-08 262      5</span><br><span class="line">14:          VHL_ATM 0.562000 3.93e-08 260      7</span><br><span class="line">15:     PBRM1_ARID1A 0.563000 3.93e-08 261      6</span><br><span class="line">16:        VHL_MUC16 0.568000 3.95e-08 260      7</span><br><span class="line">17:         VHL_BAP1 0.585000 1.08e-07 260      7</span><br><span class="line">18:       PBRM1_LRP2 0.596000 1.08e-07 259      8</span><br><span class="line">19:    PBRM1_SMARCA4 0.603000 1.08e-07 262      5</span><br><span class="line">20:        TTN_SETD2 0.608000 1.08e-07 260      7</span><br><span class="line">21:          VHL_DST 0.636000 1.09e-07 261      6</span><br><span class="line">22:       PBRM1_BAP1 0.637000 1.09e-07 262      5</span><br><span class="line">23:      PBRM1_CSMD3 0.643000 1.09e-07 261      6</span><br><span class="line">24:        TTN_MUC16 0.646000 1.09e-07 264      3</span><br><span class="line">25:      PBRM1_KMT2C 0.647000 1.09e-07 262      5</span><br><span class="line">26:        VHL_DNAH9 0.656000 1.09e-07 261      6</span><br><span class="line">27:        VHL_KDM5C 0.660000 1.09e-07 261      6</span><br><span class="line">28:        VHL_CSMD3 0.665000 1.09e-07 259      8</span><br><span class="line">29:         VHL_LRP2 0.666000 1.09e-07 262      5</span><br><span class="line">30:      PBRM1_KDM5C 0.671000 1.09e-07 262      5</span><br><span class="line">31:        VHL_SETD2 0.672000 1.55e+00 251     16</span><br><span class="line">32:      VHL_SMARCA4 0.672000 1.10e-07 263      4</span><br><span class="line">33:      PBRM1_DNAH9 0.683000 1.10e-07 260      7</span><br><span class="line">34:       SETD2_LRP2 0.684000 1.10e-07 264      3</span><br><span class="line">35:         VHL_PCLO 0.689000 1.10e-07 263      4</span><br><span class="line">36:       SETD2_BAP1 0.693000 1.10e-07 264      3</span><br><span class="line">37:         TTN_MTOR 0.697000 1.10e-07 263      4</span><br><span class="line">38:        VHL_HMCN1 0.715000 1.10e-07 263      4</span><br><span class="line">39:        TTN_DNAH9 0.724000 1.10e-07 264      3</span><br><span class="line">40:       PBRM1_PCLO 0.727000 1.10e-07 263      4</span><br><span class="line">41:        TTN_KDM5C 0.727000 1.10e-07 264      3</span><br><span class="line">42:        TTN_HMCN1 0.743000 3.01e-07 263      4</span><br><span class="line">43:        PBRM1_TTN 0.751000 1.39e+00 250     17</span><br><span class="line">44:       BAP1_MUC16 0.793000 3.02e-07 266      1</span><br><span class="line">45:      PBRM1_HMCN1 0.898000 8.26e-07 265      2</span><br><span class="line">46:          VHL_TTN 0.913000 1.12e+00 246     21</span><br><span class="line">47:      PBRM1_SETD2 0.955000 1.06e+00 248     19</span><br><span class="line">    Gene_combination  P_value       hr  WT Mutant</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接着，可以使用mafSurvGroup进行作图</span></span><br><span class="line"></span><br><span class="line">mafSurvGroup(maf=kirc,geneSet=c(<span class="string">"VHL"</span>,<span class="string">"USH2A"</span>), time=<span class="string">"days_to_last_follow_up"</span>, Status=<span class="string">"vital_status"</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc16.png" alt></p><h1 id="五、对比两个MAF文件"><a href="#五、对比两个MAF文件" class="headerlink" title="五、对比两个MAF文件"></a>五、对比两个MAF文件</h1><p>这一功能使得我们可以通过对临床数据进行分类而比较其差异，比如同一疾病中不同性别是否有显著差异，比如不同种族是否有显著差异，或者不同年龄阶段是否有显著差异，等等。下面，我们以性别将KIRC分为两类，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kirc &lt;- read.maf(maf=<span class="string">"mutect.maf"</span>)</span><br><span class="line">require(data.table)</span><br><span class="line"></span><br><span class="line">clin&lt;-as.data.frame(fread(<span class="string">"clinical.tsv"</span>))</span><br><span class="line">clin.female &lt;- subset(clin, gender==<span class="string">"female"</span>)<span class="variable">$Tumor_Sample_Barcode</span></span><br><span class="line">clin.male &lt;- subset(clin, gender==<span class="string">"male"</span>)<span class="variable">$Tumor_Sample_Barcode</span></span><br><span class="line"></span><br><span class="line">kirc.male &lt;- subsetMaf(maf=kirc, tsb=clin.male, isTCGA=TRUE)</span><br><span class="line">kirc.female &lt;- subsetMaf(maf=kirc, tsb=clin.female, isTCGA=TRUE)</span><br></pre></td></tr></table></figure><p>至此，基于性别分类的两个MAF文件就准备好了，下面可以对这两组数据进行作图，</p><h2 id="5-1-FORESTPLOT（森林图）"><a href="#5-1-FORESTPLOT（森林图）" class="headerlink" title="5.1 FORESTPLOT（森林图）"></a>5.1 FORESTPLOT（森林图）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">comp &lt;- mafCompare(m1=kirc.male, m2=kirc.female, m1Name=<span class="string">"Male"</span>, m2Name=<span class="string">"Female"</span>, minMut=5)</span><br><span class="line">forestPlot(mafCompareRes=comp, pVal=0.05, color=c(<span class="string">"maroon"</span>, <span class="string">"royalblue"</span>), geneFontSize=0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc17.png" alt></p><h2 id="5-2-ONCOPLOT（双MAF瀑布图）"><a href="#5-2-ONCOPLOT（双MAF瀑布图）" class="headerlink" title="5.2 ONCOPLOT（双MAF瀑布图）"></a>5.2 ONCOPLOT（双MAF瀑布图）</h2><p>oncoplot中基因的选择，可根据mafCompare()的结果，选择有显著差异的基因，进行作图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">genes &lt;- c(<span class="string">"ZFHX4"</span>, <span class="string">"ERBB4"</span>, <span class="string">"TGM5"</span>, <span class="string">"TENM1"</span>, <span class="string">"BRWD3"</span>, <span class="string">"ARID1A"</span>, <span class="string">"KDM5C"</span>)</span><br><span class="line">coOncoplot(m1=kirc.female, m2=kirc.male, m1Name=<span class="string">"Female"</span>, m2Name=<span class="string">"male"</span>, genes=genes)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc18.png" alt></p><h2 id="5-3-LOLLIPOPOLOT2（双MAF棒棒糖图）"><a href="#5-3-LOLLIPOPOLOT2（双MAF棒棒糖图）" class="headerlink" title="5.3 LOLLIPOPOLOT2（双MAF棒棒糖图）"></a>5.3 LOLLIPOPOLOT2（双MAF棒棒糖图）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lollipopPlot2(m1=luad.female, m2=luad.male, m1_name=<span class="string">"Female"</span>, m2_name=<span class="string">"Male"</span>, gene=<span class="string">"IQGAP2"</span>, AACol1 = <span class="string">"HGVSp_Short"</span>, AACol2 = <span class="string">"HGVSp_Short"</span>)</span><br><span class="line"><span class="comment"># 同前面的棒棒糖图一样，直接运行会提示有多个转录本，可以通过refSeqID/ proteinID来手动指定转录本进行绘图</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc19.png" alt></p><h1 id="六、信号通路富集"><a href="#六、信号通路富集" class="headerlink" title="六、信号通路富集"></a>六、信号通路富集</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; OncogenicPathways(maf = laml)</span><br><span class="line"><span class="comment"># 这个功能可说得上是简单粗暴，没有可选参数，只需要一个INPUT即可</span></span><br><span class="line">Pathway alteration fractions</span><br><span class="line">       Pathway  N n_affected_genes fraction_affected</span><br><span class="line"> 1:    RTK-RAS 85               60         0.7058824</span><br><span class="line"> 2:      NOTCH 71               43         0.6056338</span><br><span class="line"> 3:        WNT 68               38         0.5588235</span><br><span class="line"> 4:      Hippo 38               25         0.6578947</span><br><span class="line"> 5:       PI3K 29               21         0.7241379</span><br><span class="line"> 6:        MYC 13                7         0.5384615</span><br><span class="line"> 7:       TP53  6                5         0.8333333</span><br><span class="line"> 8: Cell_Cycle 15                5         0.3333333</span><br><span class="line"> 9:       NRF2  3                3         1.0000000</span><br><span class="line">10:   TGF-Beta  7                3         0.4285714</span><br><span class="line"><span class="comment"># 同时绘制图形</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc20.png" alt></p><p>从上面输出的统计结果，可以选择感兴趣的信号通路进行作图，注意，图中的红色表示抑癌基因，蓝色表示致癌基因。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; PlotOncogenicPathways(maf=kirc, pathways = <span class="string">"RTK-RAS"</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc21.png" alt></p><h1 id="七、临床富集分析"><a href="#七、临床富集分析" class="headerlink" title="七、临床富集分析"></a>七、临床富集分析</h1><p>clinicalEnrichment可以对指定的临床特征进行富集分析，比如指定”ajcc_pathologic_stage”，命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt; stage = clinicalEnrichment(maf=kirc, clinicalFeature = <span class="string">'ajcc_pathologic_stage'</span>)</span><br><span class="line"></span><br><span class="line">Sample size per factor <span class="keyword">in</span> ajcc_pathologic_stage:</span><br><span class="line"></span><br><span class="line">      <span class="string">'--   Stage I  Stage II Stage III  Stage IV </span></span><br><span class="line"><span class="string">        2       192        33        68        41</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 查看符合p_value &lt; 0.01时的富集情况</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; stage$groupwise_comparision[p_value &lt; 0.01]</span></span><br><span class="line"><span class="string">   Hugo_Symbol    Group1 Group2 n_mutated_group1 n_mutated_group2</span></span><br><span class="line"><span class="string">1:       SETD2  Stage IV   Rest         13 of 41        29 of 295</span></span><br><span class="line"><span class="string">2:       CSMD3 Stage III   Rest          8 of 68         6 of 268</span></span><br><span class="line"><span class="string">3:      COL1A2  Stage II   Rest          4 of 33         3 of 303</span></span><br><span class="line"><span class="string">4:     PKHD1L1  Stage IV   Rest          5 of 41         5 of 295</span></span><br><span class="line"><span class="string">5:      ANKS1B  Stage IV   Rest          4 of 41         3 of 295</span></span><br><span class="line"><span class="string">6:       STAG2 Stage III   Rest          6 of 68         4 of 268</span></span><br><span class="line"><span class="string">7:       PRKDC  Stage IV   Rest          4 of 41         4 of 295</span></span><br><span class="line"><span class="string">        p_value OR_low   OR_high       fdr</span></span><br><span class="line"><span class="string">1: 0.0004091851      0 0.4862509 0.4828384</span></span><br><span class="line"><span class="string">2: 0.0020655103      0 0.4967966 0.8691319</span></span><br><span class="line"><span class="string">3: 0.0022096573      0 0.3539644 0.8691319</span></span><br><span class="line"><span class="string">4: 0.0033918860      0 0.4593002 1.0000000</span></span><br><span class="line"><span class="string">5: 0.0051372257      0 0.4581794 1.0000000</span></span><br><span class="line"><span class="string">6: 0.0059701059      0 0.5596025 1.0000000</span></span><br><span class="line"><span class="string">7: 0.0093632230      0 0.5595471 1.0000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 通过函数plotEnrichmentResults来作图</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; plotEnrichmentResults(enrich_res=stage, pVal = 0.01)</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc22.png" alt></p><p>同理，也可对其他临床特征进行富集分析，比如性别</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; gender = clinicalEnrichment(maf=kirc, clinicalFeature = <span class="string">'gender'</span>)</span><br><span class="line">Sample size per factor <span class="keyword">in</span> gender:</span><br><span class="line"></span><br><span class="line">female   male </span><br><span class="line">   120    216 </span><br><span class="line">&gt; gender<span class="variable">$groupwise_comparision</span>[p_value &lt; 0.01]</span><br><span class="line">   Hugo_Symbol Group1 Group2 n_mutated_group1 n_mutated_group2     p_value</span><br><span class="line">1:      ARID1A female   Rest        11 of 120         3 of 216 0.001073289</span><br><span class="line">2:     DYNC2H1 female   Rest         7 of 120         1 of 216 0.003695386</span><br><span class="line">3:       KDM5C   male   Rest        18 of 216         2 of 120 0.008638251</span><br><span class="line">4:   KIAA1549L female   Rest         6 of 120         1 of 216 0.009419279</span><br><span class="line">5:       TENM1 female   Rest         6 of 120         1 of 216 0.009419279</span><br><span class="line">   OR_low   OR_high       fdr</span><br><span class="line">1:      0 0.4594307 0.5065922</span><br><span class="line">2:      0 0.4787417 0.8721112</span><br><span class="line">3:      0 0.6794989 0.8891799</span><br><span class="line">4:      0 0.5892996 0.8891799</span><br><span class="line">5:      0 0.5892996 0.8891799</span><br><span class="line">&gt; plotEnrichmentResults(enrich_res=gender, pVal = 0.01)</span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc23.png" alt></p><h1 id="八、肿瘤异质性分析"><a href="#八、肿瘤异质性分析" class="headerlink" title="八、肿瘤异质性分析"></a>八、肿瘤异质性分析</h1><p>一般而言，肿瘤是异质的，包含不同的亚型的细胞，可以通过inferHeterogeneity来对VAF进行评估以推断肿瘤异质性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&gt; inferHeterogeneity(maf=kirc)</span><br><span class="line">t_vaf field is missing, but found t_ref_count &amp; t_alt_count columns. Estimating vaf..</span><br><span class="line">Processing TCGA-B8-4143..</span><br><span class="line">Processing TCGA-B0-5098..</span><br><span class="line">Processing TCGA-A3-A8OV..</span><br><span class="line">Processing TCGA-CJ-4920..</span><br><span class="line">Processing TCGA-CZ-5468..</span><br><span class="line"><span class="variable">$clusterData</span></span><br><span class="line">      Hugo_Symbol Chromosome Start_Position End_Position</span><br><span class="line">   1:      CDK11B          1        1638569      1638569</span><br><span class="line">   2:      CDK11B          1        1638570      1638570</span><br><span class="line">   3:       PLOD1          1       11949869     11949869</span><br><span class="line">   4:       PLOD1          1       11949870     11949871</span><br><span class="line">   5:     DNAJC16          1       15565965     15565966</span><br><span class="line">  ---                                                   </span><br><span class="line">2495:       UBOX5         20        3122571      3122571</span><br><span class="line">2496:       PHF20         20       35871808     35871808</span><br><span class="line">2497:        LIPI         21       14206820     14206820</span><br><span class="line">2498:        MARS         12       57488179     57488179</span><br><span class="line">2499:       MXRA5          X        3317692      3317692</span><br><span class="line">      Tumor_Sample_Barcode      t_vaf cluster     MATH</span><br><span class="line">   1:         TCGA-B8-4143 0.07500000       1 41.61684</span><br><span class="line">   2:         TCGA-B8-4143 0.07500000       1 41.61684</span><br><span class="line">   3:         TCGA-B8-4143 0.07500000       1 41.61684</span><br><span class="line">   4:         TCGA-B8-4143 0.07692308       1 41.61684</span><br><span class="line">   5:         TCGA-B8-4143 0.06217617       1 41.61684</span><br><span class="line">  ---                                                 </span><br><span class="line">2495:         TCGA-CZ-5468 0.18994413       1 54.05899</span><br><span class="line">2496:         TCGA-CZ-5468 0.08011869       1 54.05899</span><br><span class="line">2497:         TCGA-CZ-5468 0.11620795       1 54.05899</span><br><span class="line">2498:         TCGA-CZ-5468 0.78947368 outlier 54.05899</span><br><span class="line">2499:         TCGA-CZ-5468 0.71794872 outlier 54.05899</span><br><span class="line">      MedianAbsoluteDeviation</span><br><span class="line">   1:                1.538092</span><br><span class="line">   2:                1.538092</span><br><span class="line">   3:                1.538092</span><br><span class="line">   4:                1.538092</span><br><span class="line">   5:                1.538092</span><br><span class="line">  ---                        </span><br><span class="line">2495:               10.526316</span><br><span class="line">2496:               10.526316</span><br><span class="line">2497:               10.526316</span><br><span class="line">2498:               10.526316</span><br><span class="line">2499:               10.526316</span><br><span class="line"></span><br><span class="line"><span class="variable">$clusterMeans</span></span><br><span class="line">    Tumor_Sample_Barcode cluster    meanVaf</span><br><span class="line"> 1:         TCGA-B8-4143       1 0.05095599</span><br><span class="line"> 2:         TCGA-B8-4143       2 0.11837474</span><br><span class="line"> 3:         TCGA-B8-4143       3 0.30865454</span><br><span class="line"> 4:         TCGA-B8-4143 outlier 0.60606061</span><br><span class="line"> 5:         TCGA-B0-5098       3 0.53075245</span><br><span class="line"> 6:         TCGA-B0-5098       1 0.10022037</span><br><span class="line"> 7:         TCGA-B0-5098       2 0.32285970</span><br><span class="line"> 8:         TCGA-B0-5098 outlier 0.64120134</span><br><span class="line"> 9:         TCGA-A3-A8OV       2 0.37256626</span><br><span class="line">10:         TCGA-A3-A8OV       1 0.06902849</span><br><span class="line">11:         TCGA-A3-A8OV       3 0.71787855</span><br><span class="line">12:         TCGA-A3-A8OV outlier 0.58955224</span><br><span class="line">13:         TCGA-CJ-4920       2 0.27004853</span><br><span class="line">14:         TCGA-CJ-4920       1 0.06939873</span><br><span class="line">15:         TCGA-CJ-4920       3 0.43948759</span><br><span class="line">16:         TCGA-CJ-4920 outlier 0.13793103</span><br><span class="line">17:         TCGA-CZ-5468       2 0.35860649</span><br><span class="line">18:         TCGA-CZ-5468       1 0.14729743</span><br><span class="line">19:         TCGA-CZ-5468 outlier 0.75371120</span><br></pre></td></tr></table></figure><p>上面，对5个barcode进行了整体分析，下面，可以指定某一个Barcode来具体看一下，比如指定”TCGA-B8-4143”</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; barcode1 &lt;- inferHeterogeneity(maf=kirc, tsb=<span class="string">"TCGA-B8-4143"</span>)</span><br><span class="line">t_vaf field is missing, but found t_ref_count &amp; t_alt_count columns. Estimating vaf..</span><br><span class="line">Processing TCGA-B8-4143..</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过$clusterMeans来查看聚类情况与VAF均值，或通过$clusterData来查看基因的详细信息</span></span><br><span class="line">&gt; barcode1<span class="variable">$clusterMeans</span></span><br><span class="line">   Tumor_Sample_Barcode cluster    meanVaf</span><br><span class="line">1:         TCGA-B8-4143       1 0.05095599</span><br><span class="line">2:         TCGA-B8-4143       2 0.11837474</span><br><span class="line">3:         TCGA-B8-4143       3 0.30865454</span><br><span class="line">4:         TCGA-B8-4143 outlier 0.60606061</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用plotClusters来作图</span></span><br><span class="line">&gt; plotClusters(clusters=barcode1)</span><br><span class="line"><span class="comment"># 这个肿瘤异质性聚类结果是比较差的，一方面主峰的频率只有5%，另一方面MATH scores太高，分数越高结果越差</span></span><br></pre></td></tr></table></figure><p><img src="/images/R/kirc24.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;我们以TCGA-KIRC数据为例，来介绍肿瘤突变数据与临床数据的下载方法、预处理及可视化&lt;/p&gt;
&lt;h1 id=&quot;一、数据下载与处理&quot;&gt;&lt;a href=&quot;#一、数据下载与处理&quot; class=&quot;headerlink&quot; title=&quot;一、数据下载与处理&quot;&gt;&lt;/a&gt;一、数据下载与
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="MAFTOOLS" scheme="http://uteric.github.io/tags/MAFTOOLS/"/>
    
  </entry>
  
  <entry>
    <title>外显子测序分析教程</title>
    <link href="http://uteric.github.io/WES/wes01/"/>
    <id>http://uteric.github.io/WES/wes01/</id>
    <published>2020-10-21T18:08:00.000Z</published>
    <updated>2020-10-21T18:08:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>一、原始数据下载</strong></p><p>如果是从测序公司拿到数据，一般会得到处理过的fastq格式，而我们在此以SRA为数据源获得原始数据。以<a href="https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP287563&amp;o=bytes_l%3Aa" target="_blank" rel="noopener">PRJNA669198</a>这个项目为例，我们下载<em>SRR12846241</em>，原始数据2.76Gb，样本来自31岁的男性colon，患有林奇综合征（Lynch syndrome，或称HNPCC,遗传性非息肉性大肠癌），测序平台是Illumina，双端测序，以上是基本信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prefetch SRR12846241</span><br></pre></td></tr></table></figure><p>注：prefetch是sratoolkit中的一个程序，用于从SRA数据库下载测序数据，以上是下载单个文件，若要下载多个文件，可以在SRA数据库的原始数据页面获取Accession List (SRR_Acc_List.txt)，批量下载命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prefetch --option-file SRR_Acc_List.txt</span><br></pre></td></tr></table></figure><p>使用prefetch命令下载，数据将默认储存在~/ncbi/public/sra/目录下。</p><p><strong>二、原始数据转换</strong></p><p>下载完成后，我们获得的原始数据是SRA格式（SRR12846241.sra），需要首先使用sratoolkit转换为fastq格式。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fastq-dump --split-3 ./SRR12846241.sra</span><br><span class="line"><span class="comment">#Read 31651170 spots for ./SRR12846241.sra</span></span><br><span class="line"><span class="comment">#Written 31651170 spots for ./SRR12846241.sra</span></span><br><span class="line"><span class="comment">#生成两个文件</span></span><br><span class="line"><span class="comment">#SRR12846241_1.fastq  SRR12846241_2.fastq</span></span><br></pre></td></tr></table></figure><p>解释一下，对于双端测序，使用–split-3参数，将生成1.fastq和2.fastq两个文件；对于单端测序，需要去掉该参数，只生成一个.fastq文件。</p><p><strong>三、测序数据质控</strong></p><p>在进行下一步之前，我们先建立一些必要的目录，以便对后续的数据进行分类</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#123;fastq,qc,bam,nodup&#125;</span><br><span class="line"><span class="comment">#将生成的.fastq文件移至目录fastq下</span></span><br></pre></td></tr></table></figure><p>如要查看数据质量，我们可以使用经典的程序fastqc，语法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fastqc -o ./qc -t 4 ./fastq/*.fastq</span><br><span class="line"><span class="comment"># -o，指定输出目录；-t 线程数；后面是输入文件</span></span><br><span class="line"><span class="comment"># 这个分析过程很快，而且显示进程</span></span><br><span class="line">Started analysis of SRR12846241_1.fastq</span><br><span class="line">Started analysis of SRR12846241_2.fastq</span><br><span class="line">Approx 5% complete <span class="keyword">for</span> SRR12846241_1.fastq</span><br><span class="line">Approx 5% complete <span class="keyword">for</span> SRR12846241_2.fastq</span><br><span class="line">Approx 10% complete <span class="keyword">for</span> SRR12846241_1.fastq</span><br><span class="line">Approx 10% complete <span class="keyword">for</span> SRR12846241_2.fastq</span><br><span class="line">...</span><br><span class="line">Analysis complete <span class="keyword">for</span> SRR12846241_1.fastq</span><br><span class="line">Analysis complete <span class="keyword">for</span> SRR12846241_2.fastq</span><br><span class="line"><span class="comment"># 运行完成后会生成如下文件</span></span><br><span class="line">SRR12846241_1_fastqc.html  SRR12846241_1_fastqc.zip  SRR12846241_2_fastqc.html  SRR12846241_2_fastqc.zip</span><br></pre></td></tr></table></figure><p>fastqc是用于查看数据质量的，打开生成的.html文件可以看到，这个数据的质量是相当好的，这得益于近年来测序技术的巨大进步。</p><p>数据质控的部分我们可以使用fastp，这个程序可以进行过滤（去除低质量序列，较多N的序列），去掉接头，进行碱基校正，输出质控报告等。</p><p>对于单端测序，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastp -i input.fastq -o output.fastq</span><br></pre></td></tr></table></figure><p>对于双端测序，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastp -i input.1.fastq -I input.2.fastq -o output.1.fastq -O output.2.fastq</span><br></pre></td></tr></table></figure><p>这个程序的多数功能是默认开启的，不需额外设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">fastp -i ./fastq/SRR12846241_1.fastq -I ./fastq/SRR12846241_2.fastq -o ./qc/cleaned_1.fastq -O ./qc/cleaned_2.fastq -w 4</span><br><span class="line"><span class="comment"># --adapter_sequence read1接头序列，如不指定则自动检测;</span></span><br><span class="line"><span class="comment"># --adapter_sequence_r2 read1接头序列，如不指定则自动检测;</span></span><br><span class="line"><span class="comment"># -c 适用于双端测序，对碱基进行校正，通过查找每一对read的重合区，然后对mismatch的碱基进行校正，方法是使用高质量的read取代低质量的read;</span></span><br><span class="line"><span class="comment"># -q 设置低质量的标准，默认值15；</span></span><br><span class="line"><span class="comment"># -u 允许不合格碱基的百分比，默认值40%；</span></span><br><span class="line"><span class="comment"># -n 若read中的N碱基数据大于此值，则该对reads将被丢弃，默认值5；</span></span><br><span class="line"><span class="comment"># -w 线程数，默认值2，根据自己电脑的CPU来确定；</span></span><br><span class="line"><span class="comment"># -5/-3 滑窗裁剪，需要指定threshold,-5 滑窗从5'向3'移动，-3滑窗从3'向5'移动；</span></span><br><span class="line"><span class="comment"># 结果如下</span></span><br><span class="line">Read1 before filtering:</span><br><span class="line">total reads: 31651170</span><br><span class="line">total bases: 4779326670</span><br><span class="line">Q20 bases: 4680761815(97.9377%)</span><br><span class="line">Q30 bases: 4513495612(94.4379%)</span><br><span class="line"></span><br><span class="line">Read2 before filtering:</span><br><span class="line">total reads: 31651170</span><br><span class="line">total bases: 4779326670</span><br><span class="line">Q20 bases: 4651248152(97.3202%)</span><br><span class="line">Q30 bases: 4453204808(93.1764%)</span><br><span class="line"></span><br><span class="line">Read1 after filtering:</span><br><span class="line">total reads: 31297805</span><br><span class="line">total bases: 4676179403</span><br><span class="line">Q20 bases: 4589169104(98.1393%)</span><br><span class="line">Q30 bases: 4429126929(94.7168%)</span><br><span class="line"></span><br><span class="line">Read2 aftering filtering:</span><br><span class="line">total reads: 31297805</span><br><span class="line">total bases: 4676179403</span><br><span class="line">Q20 bases: 4574607381(97.8279%)</span><br><span class="line">Q30 bases: 4387146408(93.819%)</span><br><span class="line"></span><br><span class="line">Filtering result:</span><br><span class="line">reads passed filter: 62595610</span><br><span class="line">reads failed due to low quality: 696646</span><br><span class="line">reads failed due to too many N: 10084</span><br><span class="line">reads failed due to too short: 0</span><br><span class="line">reads with adapter trimmed: 6762458</span><br><span class="line">bases trimmed due to adapters: 99756614</span><br><span class="line"></span><br><span class="line">Duplication rate: 14.5952%</span><br><span class="line"></span><br><span class="line">Insert size peak (evaluated by paired-end reads): 189</span><br><span class="line"></span><br><span class="line">JSON report: fastp.json</span><br><span class="line">HTML report: fastp.html</span><br><span class="line"></span><br><span class="line">fastp -i ./fastq/SRR12846241_1.fastq -I ./fastq/SRR12846241_2.fastq -o ./qc/cleaned_1.fastq -O ./qc/cleaned_2.fastq -w 4</span><br><span class="line">fastp v0.20.1, time used: 642 seconds</span><br></pre></td></tr></table></figure><p><strong>四、比对至基因组</strong></p><p>对于DNA的比对，使用BWA这个程序，使用之前，需要为BWA生成索引文件，命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">bwa index hg38.fa</span><br><span class="line"><span class="comment"># 过程如下，耗时约100分钟</span></span><br><span class="line">[bwa_index] Pack FASTA... 45.94 sec</span><br><span class="line">[bwa_index] Construct BWT <span class="keyword">for</span> the packed sequence...</span><br><span class="line">[BWTIncCreate] textLength=6418572210, availableWord=463634060</span><br><span class="line">[BWTIncConstructFromPacked] 10 iterations <span class="keyword">done</span>. 99999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 20 iterations <span class="keyword">done</span>. 199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 30 iterations <span class="keyword">done</span>. 299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 40 iterations <span class="keyword">done</span>. 399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 50 iterations <span class="keyword">done</span>. 499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 60 iterations <span class="keyword">done</span>. 599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 70 iterations <span class="keyword">done</span>. 699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 80 iterations <span class="keyword">done</span>. 799999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 90 iterations <span class="keyword">done</span>. 899999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 100 iterations <span class="keyword">done</span>. 999999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 110 iterations <span class="keyword">done</span>. 1099999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 120 iterations <span class="keyword">done</span>. 1199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 130 iterations <span class="keyword">done</span>. 1299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 140 iterations <span class="keyword">done</span>. 1399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 150 iterations <span class="keyword">done</span>. 1499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 160 iterations <span class="keyword">done</span>. 1599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 170 iterations <span class="keyword">done</span>. 1699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 180 iterations <span class="keyword">done</span>. 1799999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 190 iterations <span class="keyword">done</span>. 1899999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 200 iterations <span class="keyword">done</span>. 1999999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 210 iterations <span class="keyword">done</span>. 2099999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 220 iterations <span class="keyword">done</span>. 2199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 230 iterations <span class="keyword">done</span>. 2299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 240 iterations <span class="keyword">done</span>. 2399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 250 iterations <span class="keyword">done</span>. 2499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 260 iterations <span class="keyword">done</span>. 2599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 270 iterations <span class="keyword">done</span>. 2699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 280 iterations <span class="keyword">done</span>. 2799999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 290 iterations <span class="keyword">done</span>. 2899999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 300 iterations <span class="keyword">done</span>. 2999999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 310 iterations <span class="keyword">done</span>. 3099999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 320 iterations <span class="keyword">done</span>. 3199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 330 iterations <span class="keyword">done</span>. 3299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 340 iterations <span class="keyword">done</span>. 3399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 350 iterations <span class="keyword">done</span>. 3499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 360 iterations <span class="keyword">done</span>. 3599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 370 iterations <span class="keyword">done</span>. 3699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 380 iterations <span class="keyword">done</span>. 3799999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 390 iterations <span class="keyword">done</span>. 3899999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 400 iterations <span class="keyword">done</span>. 3999999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 410 iterations <span class="keyword">done</span>. 4099999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 420 iterations <span class="keyword">done</span>. 4199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 430 iterations <span class="keyword">done</span>. 4299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 440 iterations <span class="keyword">done</span>. 4399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 450 iterations <span class="keyword">done</span>. 4499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 460 iterations <span class="keyword">done</span>. 4599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 470 iterations <span class="keyword">done</span>. 4699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 480 iterations <span class="keyword">done</span>. 4799999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 490 iterations <span class="keyword">done</span>. 4899999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 500 iterations <span class="keyword">done</span>. 4999999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 510 iterations <span class="keyword">done</span>. 5099999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 520 iterations <span class="keyword">done</span>. 5199999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 530 iterations <span class="keyword">done</span>. 5299999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 540 iterations <span class="keyword">done</span>. 5399999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 550 iterations <span class="keyword">done</span>. 5499999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 560 iterations <span class="keyword">done</span>. 5599999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 570 iterations <span class="keyword">done</span>. 5699999986 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 580 iterations <span class="keyword">done</span>. 5798165394 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 590 iterations <span class="keyword">done</span>. 5886412978 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 600 iterations <span class="keyword">done</span>. 5964843650 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 610 iterations <span class="keyword">done</span>. 6034549010 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 620 iterations <span class="keyword">done</span>. 6096499330 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 630 iterations <span class="keyword">done</span>. 6151556914 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 640 iterations <span class="keyword">done</span>. 6200488210 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 650 iterations <span class="keyword">done</span>. 6243974434 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 660 iterations <span class="keyword">done</span>. 6282621122 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 670 iterations <span class="keyword">done</span>. 6316966322 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 680 iterations <span class="keyword">done</span>. 6347488418 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 690 iterations <span class="keyword">done</span>. 6374612482 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 700 iterations <span class="keyword">done</span>. 6398716386 characters processed.</span><br><span class="line">[BWTIncConstructFromPacked] 710 iterations <span class="keyword">done</span>. 6418572210 characters processed.</span><br><span class="line">[bwt_gen] Finished constructing BWT <span class="keyword">in</span> 710 iterations.</span><br><span class="line">[bwa_index] 4475.92 seconds elapse.</span><br><span class="line">[bwa_index] Update BWT... 34.89 sec</span><br><span class="line">[bwa_index] Pack forward-only FASTA... 30.80 sec</span><br><span class="line">[bwa_index] Construct SA from BWT and Occ...  1760.91 sec</span><br><span class="line">[main] Version: 0.7.17-r1188</span><br><span class="line">[main] CMD: bwa index hg38.fa</span><br><span class="line">[main] Real time: 6467.646 sec; CPU: 6348.453 sec</span><br><span class="line"><span class="comment"># 运行完成后，生成如下文件</span></span><br><span class="line">hg38.fa.amb  hg38.fa.ann  hg38.fa.bwt  hg38.fa.fai  hg38.fa.pac  hg38.fa.sa</span><br><span class="line"><span class="comment"># 若没有这些索引文件，则会在运行时报错，提示找不到参考基因组</span></span><br></pre></td></tr></table></figure><p>下面，使用BWA进行MAPPING，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#    bwa mem\</span></span><br><span class="line"><span class="comment">#       -t $NUM_THREADS\ 线程数</span></span><br><span class="line"><span class="comment">#       -B $MISMATCH_PENALTY\ 空位罚分</span></span><br><span class="line"><span class="comment">#       -R '@RG\tID:lane1\tSM:sample1\tLB:genome\tPL:ILLUMINA'\ 设定头文件,必填，ID：通道名或样本名,通过这个信息分组，必须唯一；SM：样本名；LB：⽂库名；PL：测序平台信息[ILLUMINA, SOLID]</span></span><br><span class="line"><span class="comment">#       -M\ 将shorter split hits标记为次优，以兼容 Picard’s markDuplicates软件</span></span><br><span class="line"><span class="comment">#       $INDEX\ 指定参考基因组</span></span><br><span class="line"><span class="comment">#       ./$sample\_1.fastq\ 输入fastq</span></span><br><span class="line"><span class="comment">#       ./$sample\_2.fastq\ 输入fastq</span></span><br><span class="line"><span class="comment">#       | samtools view -q4 -bS -o - -\ 将上一步生成的SAM转为BAM</span></span><br><span class="line"><span class="comment">#       | samtools sort -@4 -o ./bam_files/$sample.bam - 排序并输出BAM</span></span><br><span class="line">bwa mem -t 4 -B 4 -M ~/ncbi/hg38/chroms/hg38.fa /mnt/d/wes/qc/cleaned_1.fastq /mnt/d/wes/qc/cleaned_2.fastq | samtools view -q4 -bS -o - - | samtools sort -@4 -o /mnt/d/wes/bam/clean.bam -</span><br><span class="line"><span class="comment"># 这个过程是非常漫长的，对于普通的电脑可能耗时10个小时，做生信分析配备一台超高性能的电脑是很必要的，否则时间都花在等待当中</span></span><br><span class="line"><span class="comment"># 下面这是一个典型的比对单元，整个过程是由数百个这样的单元组成</span></span><br><span class="line">[M::process] <span class="built_in">read</span> 267710 sequences (40000156 bp)...</span><br><span class="line">[M::mem_pestat] <span class="comment"># candidate unique pairs for (FF, FR, RF, RR): (0, 90279, 1, 0)</span></span><br><span class="line">[M::mem_pestat] skip orientation FF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] analyzing insert size distribution <span class="keyword">for</span> orientation FR...</span><br><span class="line">[M::mem_pestat] (25, 50, 75) percentile: (169, 198, 232)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> computing mean and std.dev: (43, 358)</span><br><span class="line">[M::mem_pestat] mean and std.dev: (202.73, 45.61)</span><br><span class="line">[M::mem_pestat] low and high boundaries <span class="keyword">for</span> proper pairs: (1, 421)</span><br><span class="line">[M::mem_pestat] skip orientation RF as there are not enough pairs</span><br><span class="line">[M::mem_pestat] skip orientation RR as there are not enough pairs</span><br><span class="line">[M::mem_process_seqs] Processed 267710 reads <span class="keyword">in</span> 105.719 CPU sec, 61.174 real sec</span><br><span class="line"><span class="comment"># 运行结束后，会生成一个clean.bam文件</span></span><br></pre></td></tr></table></figure><p><strong>五、加头文件</strong></p><p>这步是外加的，因为在使用BWA进行比对时没有加-R参数，因此缺少Read Group信息，可以通过picard tool中的AddOrReplaceReadGroups.jar加入RG信息，因为picard被整合在GATK中，因此，我们可以使用GATK来加RG</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gatk AddOrReplaceReadGroups -I /mnt/d/wes/bam/clean.bam -O /mnt/d/wes/bam/clean.RG.bam -LB genome -PL ILLUMINA -PU unit1 -SM sample1</span><br><span class="line"><span class="comment"># 参数解释</span></span><br><span class="line">--RGLB,-LB &lt;String&gt;           Read-Group library  Required.</span><br><span class="line">--RGPL,-PL &lt;String&gt;           Read-Group platform (e.g. ILLUMINA, SOLID)  Required.</span><br><span class="line">--RGPU,-PU &lt;String&gt;           Read-Group platform unit (eg. run barcode)  Required.</span><br><span class="line">--RGSM,-SM &lt;String&gt;           Read-Group sample name  Required.</span><br></pre></td></tr></table></figure><p><strong>六、PCR去重</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gatk MarkDuplicates -I /mnt/d/wes/bam/clean.RG.bam -O /mnt/d/wes/nodup/nodup.bam -M /mnt/d/wes/nodup/metrics.txt --REMOVE_DUPLICATES <span class="literal">true</span> --ASSUME_SORTED <span class="literal">true</span> </span><br><span class="line"><span class="comment"># 参数解释</span></span><br><span class="line">--METRICS_FILE,-M &lt;File&gt;  生成metrics的文件</span><br><span class="line">--REMOVE_DUPLICATES 默认为<span class="literal">false</span>，若为<span class="literal">true</span>，则在生成的文件中去掉duplicates</span><br><span class="line">--ASSUME_SORTED 默认为<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成索引文件</span></span><br><span class="line">samtools index /mnt/d/wes/nodup/nodup.bam</span><br></pre></td></tr></table></figure><p><strong>七、BQSR (Recalibration Base Quality Score)</strong></p><p>下面进行变异检测，首先，我们需要先为hg38.fa生成dict文件，这可以通过调用picard中的CreateSequenceDictonary模块来实现，也可以直接在GATK中调用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar /home/eric/picard/build/libs/picard.jar CreateSequenceDictionary R=hg38.fa O=hg38.dict</span><br><span class="line">gatk CreateSequenceDictionary -R hg38.fa -O hg38.dict &amp;&amp; <span class="built_in">echo</span> <span class="string">"** dict done **"</span> <span class="comment"># 这两个命令等价，&amp;&amp; echo "** dict done **"是提示dict完成，可以去掉</span></span><br></pre></td></tr></table></figure><p>另外，补充hg38.fa.fai文件的生成过程，可以调用samtool faidx来生成</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools faidx hg38.fa</span><br></pre></td></tr></table></figure><p>上面这两个文件的生成过程都很快，几秒钟就可以完成。</p><p>BQSR分两步进行，分别使用BaseRecalibrator与ApplyBQSR两个工具。</p><p>第一步：<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360036898312-BaseRecalibrator" target="_blank" rel="noopener">BaseRecalibrator</a>，此工具根据物种的known sites，生成一个校正质量值所需要的表格文件，基本用法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gatk BaseRecalibrator \</span><br><span class="line">   -I my_reads.bam \</span><br><span class="line">   -R reference.fasta \</span><br><span class="line">   --known-sites sites_of_variation.vcf \</span><br><span class="line">   --known-sites another/optional/setOfSitesToMask.vcf \</span><br><span class="line">   -O recal_data.table</span><br></pre></td></tr></table></figure><p>在本例中，执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk BaseRecalibrator -I /mnt/d/wes/nodup/nodup.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --known-sites /home/eric/ncbi/hg38/vcf/dbsnp_138.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/1000G_phase1.snps.high_confidence.hg38.vcf.gz --known-sites /home/eric/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz -L /home/eric/ncbi/hg38/vcf/hg38_v0_HybSelOligos_whole_exome_illumina_coding_v1_whole_exome_illumina_coding_v1.Homo_sapiens_assembly38.targets.interval_list -O /mnt/d/wes/bqsr/recal_data2.table</span><br></pre></td></tr></table></figure><p>第二步：<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360037055712-ApplyBQSR" target="_blank" rel="noopener">ApplyBQSR</a>，此工具执行BQSR的第二步，具体来说，它会根据第一步中BaseRecalibrator工具生成的重新校准表来重新校准输入的BAM的质量，并输出重新校准的BAM文件，基本用法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gatk ApplyBQSR \</span><br><span class="line">   -R reference.fasta \</span><br><span class="line">   -I input.bam \</span><br><span class="line">   --bqsr-recal-file recalibration.table \</span><br><span class="line">   -O output.bam</span><br></pre></td></tr></table></figure><p>在本例中，执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk ApplyBQSR -I /mnt/d/wes/nodup/nodup.bam -R /home/eric/ncbi/hg38/chroms/hg38.fa --bqsr-recal-file /mnt/d/wes/bqsr/recal_data2.table -O /mnt/d/wes/bqsr/bqsr.bam</span><br></pre></td></tr></table></figure><p>下面，可以对生成的BAM文件进行验证，使用<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360036854731-ValidateSamFile-Picard-" target="_blank" rel="noopener">ValidateSamFile</a>工具，若显示no errors found，就可以进行变异检测了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk ValidateSamFile -I /mnt/d/wes/bqsr/bqsr.bam</span><br></pre></td></tr></table></figure><p>如发现错误，则可以使用<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360036713471-FixMateInformation-Picard-" target="_blank" rel="noopener">FixMateInformation</a>工具进行修复</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk FixMateInformation -I /mnt/d/wes/bqsr/bqsr.bam -O /mnt/d/wes/bqsr/fixed_bqsr.bam</span><br></pre></td></tr></table></figure><p>变异检测，使用<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360037225632-HaplotypeCaller" target="_blank" rel="noopener">HaplotypeCaller</a>工具，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gatk HaplotypeCaller\</span><br><span class="line">   -R Homo_sapiens_assembly38.fasta \</span><br><span class="line">   -I input.bam \</span><br><span class="line">   -O output.g.vcf.gz \</span><br><span class="line">   -ERC GVCF</span><br></pre></td></tr></table></figure><p>在本例中，使用如下参数，此步极费时间，我这台低配电脑耗时10个小时</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk HaplotypeCaller -R /home/eric/ncbi/hg38/chroms/hg38.fa -I /mnt/d/wes/bqsr/bqsr.bam -O /mnt/d/wes/<span class="built_in">caller</span>/output.g.vcf.gz -ERC GVCF</span><br></pre></td></tr></table></figure><p>生成g.vcf.gz文件之后，就可以使用<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360036855131-GenotypeGVCFs" target="_blank" rel="noopener">GenotypeGVCFs</a>工具对多个样本执行joint genotyping，目的是将多个样本合成一个文件 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gatk GenotypeGVCFs</span><br><span class="line">    -R Homo_sapiens_assembly38.fasta \</span><br><span class="line">    -V input.g.vcf.gz \</span><br><span class="line">    -O output.vcf.gz </span><br><span class="line"></span><br><span class="line">gatk GenotypeGVCFs -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.g.vcf.gz -O /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz</span><br></pre></td></tr></table></figure><p>提取SNV，使用<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360040508071-SelectVariants" target="_blank" rel="noopener">SelectVariants</a>工具，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gatk SelectVariants \</span><br><span class="line">     -R Homo_sapiens_assembly38.fasta \</span><br><span class="line">     -V input.vcf \</span><br><span class="line">     --select-type-to-include SNP \ <span class="comment"># 可选以下参数：NO_VARIATION, SNP, MNP, INDEL, SYMBOLIC, MIXED</span></span><br><span class="line">     -O output.vcf</span><br></pre></td></tr></table></figure><p>在本例中，使用如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk SelectVariants -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz --select-type-to-include SNP -O /mnt/d/wes/<span class="built_in">caller</span>/snp.vcf</span><br></pre></td></tr></table></figure><p>这个过程极快，只需要几秒即可完成。下面，提取INDEL，仍然使用SelectVariants工具，只是参数选择INDEL，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk SelectVariants -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz --select-type-to-include INDEL -O /mnt/d/wes/<span class="built_in">caller</span>/indel.vcf</span><br></pre></td></tr></table></figure><p>突变位点质量值重矫正(VQSR)</p><p>这一步是对突变位点进行质控，原理是通过比对与已知变异位点的交集，评估各个突变位点的可信度。已知变异集包括：hapmap，omni，1000G，dbsnp。</p><p>第一步：SNP的VQSR的过滤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">gatk VariantRecalibrator \</span><br><span class="line">   -R Homo_sapiens_assembly38.fasta \</span><br><span class="line">   -V input.vcf.gz \</span><br><span class="line">   --resource hapmap,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">true</span>,prior=15.0:hapmap_3.3.hg38.sites.vcf.gz \</span><br><span class="line">   --resource omni,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">false</span>,prior=12.0:1000G_omni2.5.hg38.sites.vcf.gz \</span><br><span class="line">   --resource 1000G,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">false</span>,prior=10.0:1000G_phase1.snps.high_confidence.hg38.vcf.gz \</span><br><span class="line">   --resource dbsnp,known=<span class="literal">true</span>,training=<span class="literal">false</span>,truth=<span class="literal">false</span>,prior=2.0:Homo_sapiens_assembly38.dbsnp138.vcf.gz \</span><br><span class="line">   -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR \</span><br><span class="line">   -mode SNP \ <span class="comment"># 可选参数：SNP，INDEL，BOTH（仅用于测试目的）</span></span><br><span class="line">   -O output.recal \</span><br><span class="line">   --tranches-file output.tranches \</span><br><span class="line">   --rscript-file output.plots.R</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在本例中，命令如下：</span></span><br><span class="line">gatk VariantRecalibrator -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz --resource:hapmap,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">true</span>,prior=15.0 /home/eric/ncbi/hg38/vcf/hapmap_3.3.hg38.vcf.gz --resource:omni,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">false</span>,prior=12.0 /home/eric/ncbi/hg38/vcf/1000G_omni2.5.hg38.vcf.gz --resource:1000G,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">false</span>,prior=10.0 /home/eric/ncbi/hg38/vcf/1000G_phase1.snps.high_confidence.hg38.vcf.gz --resource:dbsnp,known=<span class="literal">true</span>,training=<span class="literal">false</span>,truth=<span class="literal">false</span>,prior=2.0 /home/eric/ncbi/hg38/vcf/dbsnp_138.hg38.vcf.gz -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -mode SNP -O /mnt/d/wes/<span class="built_in">caller</span>/output.snp.recal --tranches-file /mnt/d/wes/<span class="built_in">caller</span>/output.snp.tranches --rscript-file /mnt/d/wes/<span class="built_in">caller</span>/output.snp.plots.R</span><br></pre></td></tr></table></figure><p>INDEL的VQSR的过滤，参数有点变动，–resource也不同</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk VariantRecalibrator -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz --max-gaussians 4 --resource:mills,known=<span class="literal">false</span>,training=<span class="literal">true</span>,truth=<span class="literal">true</span>,prior=12.0 /home/eric/ncbi/hg38/vcf/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz --resource:dbsnp,known=<span class="literal">true</span>,training=<span class="literal">false</span>,truth=<span class="literal">false</span>,prior=2.0 /home/eric/ncbi/hg38/vcf/dbsnp_146.hg38.vcf.gz -an QD -an DP -an MQRankSum -an ReadPosRankSum -an FS -an SOR -mode INDEL -O /mnt/d/wes/<span class="built_in">caller</span>/output.indel.recal --tranches-file /mnt/d/wes/<span class="built_in">caller</span>/output.indel.tranches --rscript-file /mnt/d/wes/<span class="built_in">caller</span>/output.indel.plots.R</span><br></pre></td></tr></table></figure><p>第二步：ApplyVQSR to SNP（Apply a score cutoff to filter variants based on a recalibration table），即将第一步生成的阀值文件应用于vcf.gz，并生成新的vcf.gz文件，这个过程将阀值以下的突变去除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gatk ApplyVQSR \</span><br><span class="line">   -R Homo_sapiens_assembly38.fasta \</span><br><span class="line">   -V input.vcf.gz \ <span class="comment"># 输入文件是由GenotypeGVCFs生成的vcf.gz</span></span><br><span class="line">   -O output.vcf.gz \</span><br><span class="line">   --truth-sensitivity-filter-level 99.0 \</span><br><span class="line">   --tranches-file output.tranches \ <span class="comment"># VariantRecalibrator生成的snp.tranches文件</span></span><br><span class="line">   --recal-file output.recal \ <span class="comment"># VariantRecalibrator生成的snp.recal文件</span></span><br><span class="line">   -mode SNP <span class="comment"># 参数为SNP,INDEL，或BOTH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在本例中，命令如下：</span></span><br><span class="line">gatk ApplyVQSR -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz -O /mnt/d/wes/<span class="built_in">caller</span>/output.vqsr.snp.vcf.gz --truth-sensitivity-filter-level 99.0 --tranches-file /mnt/d/wes/<span class="built_in">caller</span>/output.snp.tranches --recal-file /mnt/d/wes/<span class="built_in">caller</span>/output.snp.recal -mode SNP</span><br></pre></td></tr></table></figure><p>INDEL也是如此，Applying recalibration to INDEL，命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatk ApplyVQSR -R /home/eric/ncbi/hg38/chroms/hg38.fa -V /mnt/d/wes/<span class="built_in">caller</span>/output.vcf.gz -O /mnt/d/wes/<span class="built_in">caller</span>/output.vqsr.indel.vcf.gz --truth-sensitivity-filter-level 99.0 --tranches-file /mnt/d/wes/<span class="built_in">caller</span>/output.indel.tranches --recal-file /mnt/d/wes/<span class="built_in">caller</span>/output.indel.recal -mode INDEL</span><br></pre></td></tr></table></figure><p>位点注释</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> gatk CNNScoreVariants \</span><br><span class="line">   -V vcf_to_annotate.vcf.gz \</span><br><span class="line">   -R reference.fasta \</span><br><span class="line">   -O annotated.vcf</span><br><span class="line"><span class="comment"># SNP文件注释</span></span><br><span class="line">gatk CNNScoreVariants -V /mnt/d/wes/<span class="built_in">caller</span>/output.vqsr.snp.vcf.gz -R /home/eric/ncbi/hg38/chroms/hg38.fa -O /mnt/d/wes/annotate/annotate.snp.vcf --<span class="built_in">disable</span>-avx-check <span class="literal">true</span></span><br><span class="line"><span class="comment"># INDEL文件注释</span></span><br><span class="line">gatk CNNScoreVariants -V /mnt/d/wes/<span class="built_in">caller</span>/output.vqsr.indel.vcf.gz -R /home/eric/ncbi/hg38/chroms/hg38.fa -O /mnt/d/wes/annotate/annotate.snp.vcf</span><br></pre></td></tr></table></figure><p>附：GATK参考文件下载地址：<a href="ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/hg38/" target="_blank" rel="noopener">gatk/bundle/hg38</a>，这些参考文件可以在多个地址下载，但是有些因为压缩格式的问题会报错，这个网站上的参考文件已经验证，可以使用。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;一、原始数据下载&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果是从测序公司拿到数据，一般会得到处理过的fastq格式，而我们在此以SRA为数据源获得原始数据。以&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/Traces/study/?a
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="WES" scheme="http://uteric.github.io/tags/WES/"/>
    
  </entry>
  
  <entry>
    <title>在R中拆分与合并数据</title>
    <link href="http://uteric.github.io/R/reshape/"/>
    <id>http://uteric.github.io/R/reshape/</id>
    <published>2020-10-15T21:06:02.000Z</published>
    <updated>2020-10-15T21:06:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>数据的拆分与合并可以使用reshape2这个包，主要使用两个命令：melt/cast（dcast返回数据框）</p><p>一、准备数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; A &lt;- c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>)</span><br><span class="line">&gt; B &lt;- c(1,2,3,4)</span><br><span class="line">&gt; C &lt;- c(<span class="string">"Apple"</span>,<span class="string">"Orange"</span>,<span class="string">"Pear"</span>,<span class="string">"Banana"</span>)</span><br><span class="line">&gt; D &lt;- c(<span class="string">"Sun"</span>,<span class="string">"Moon"</span>,<span class="string">"Earth"</span>,<span class="string">"Star"</span>)</span><br><span class="line">&gt; data &lt;- data.frame(A,B,C,D)</span><br><span class="line">&gt; data</span><br><span class="line">  A B      C     D</span><br><span class="line">1 A 1  Apple   Sun</span><br><span class="line">2 B 2 Orange  Moon</span><br><span class="line">3 C 3   Pear Earth</span><br><span class="line">4 D 4 Banana  Star</span><br></pre></td></tr></table></figure><p>二、数据拆分</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(reshape2)</span><br><span class="line"></span><br><span class="line">&gt; data2 &lt;- melt(data,id=c(<span class="string">"A"</span>,<span class="string">"B"</span>))</span><br><span class="line">&gt; data2</span><br><span class="line">  A B variable  value</span><br><span class="line">1 A 1        C  Apple</span><br><span class="line">2 B 2        C Orange</span><br><span class="line">3 C 3        C   Pear</span><br><span class="line">4 D 4        C Banana</span><br><span class="line">5 A 1        D    Sun</span><br><span class="line">6 B 2        D   Moon</span><br><span class="line">7 C 3        D  Earth</span><br><span class="line">8 D 4        D   Star</span><br></pre></td></tr></table></figure><p>三、数据合并</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; data3 &lt;- dcast(data2,A+B~variable)</span><br><span class="line">&gt; data3</span><br><span class="line">  A B      C     D</span><br><span class="line">1 A 1  Apple   Sun</span><br><span class="line">2 B 2 Orange  Moon</span><br><span class="line">3 C 3   Pear Earth</span><br><span class="line">4 D 4 Banana  Star</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;数据的拆分与合并可以使用reshape2这个包，主要使用两个命令：melt/cast（dcast返回数据框）&lt;/p&gt;
&lt;p&gt;一、准备数据&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>在R中移除包含NA的行</title>
    <link href="http://uteric.github.io/R/removeNA/"/>
    <id>http://uteric.github.io/R/removeNA/</id>
    <published>2020-10-13T20:42:17.000Z</published>
    <updated>2020-10-13T20:42:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中，如需去除包含NA的行，可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">na.omit(data)</span><br></pre></td></tr></table></figure><p>或者，可以在命令中加入na.rm=TRUE来避免NA造成干扰，</p><p>或者根据情况使用如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[!is.na(data<span class="variable">$V1</span>),]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在R中，如需去除包含NA的行，可以使用以下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R" scheme="http://uteric.github.io/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>LINUX下解压命令</title>
    <link href="http://uteric.github.io/Linux/unzip/"/>
    <id>http://uteric.github.io/Linux/unzip/</id>
    <published>2020-10-09T19:00:41.000Z</published>
    <updated>2020-10-09T19:00:41.000Z</updated>
    
    <content type="html"><![CDATA[<ol><li>tar.gz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf file.tar.gz</span><br></pre></td></tr></table></figure><p>参数的意义如下：</p><p>-z : 使用gzip命令解压<br>-x : 提取文件<br>-v : 显示操作过程</p><ol start="2"><li>.tgz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf file.tgz</span><br></pre></td></tr></table></figure><ol start="3"><li>.gz</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d file.gz</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;tar.gz&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c
      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="解压" scheme="http://uteric.github.io/tags/%E8%A7%A3%E5%8E%8B/"/>
    
  </entry>
  
  <entry>
    <title>查看CPU核心数与线程数</title>
    <link href="http://uteric.github.io/Linux/coresThreads/"/>
    <id>http://uteric.github.io/Linux/coresThreads/</id>
    <published>2020-10-06T22:54:31.000Z</published>
    <updated>2020-10-06T22:54:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>WINDOWS下查看CPU的核心数与线程数，打开CMD，输入wmic，再输入cup get，NumberOfCores为核数 NumberOfLogicalProcessors为线程数。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;WINDOWS下查看CPU的核心数与线程数，打开CMD，输入wmic，再输入cup get，NumberOfCores为核数 NumberOfLogicalProcessors为线程数。&lt;/p&gt;

      
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="CPU" scheme="http://uteric.github.io/tags/CPU/"/>
    
  </entry>
  
</feed>
