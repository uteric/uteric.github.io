<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2019-05-19T22:41:59.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>泳池设备维护</title>
    <link href="http://uteric.github.io/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB%E6%97%A5%E8%AE%B04/"/>
    <id>http://uteric.github.io/美国生活日记4/</id>
    <published>2019-05-19T22:41:59.000Z</published>
    <updated>2019-05-19T22:41:59.000Z</updated>
    
    <content type="html"><![CDATA[<p>1、撇渣器（Skimmer），泳池的出水口之一，也是池水的第一道过滤网，水从这里被吸进水泵时会被滤网拦下，因此，需要定期打开盖子，取下滤网，清理滤网中的树叶等漂浮杂物，建议每周一次；如果需要添加药物，一般也要投放在Skimmer中，比如Pool Shock，Algeacide等等。</p>
<p>2、水泵（Pump），水泵是第二道过滤网，旁边的透明盖子可以打开，需要定期清理滤网中的漂浮杂物。</p>
<p>3、过滤沙缸（Sand Filter），池水通过水泵后，会进入到Filter中进行过滤，Filter上有个压力表，如果压力高达35 psi，则说明Filter该清理了。</p>
<p>4、水底吸尘器（Pool Cleaner），放在池底，用于清理池底和池壁的尘土和藻类，使用时请根据需要调节流量，如果流量太低，吸尘器会趴在水底不能移动，如果太高，则会爬出水面，导致水泵大量吸入空气。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;1、撇渣器（Skimmer），泳池的出水口之一，也是池水的第一道过滤网，水从这里被吸进水泵时会被滤网拦下，因此，需要定期打开盖子，取下滤网，清理滤网中的树叶等漂浮杂物，建议每周一次；如果需要添加药物，一般也要投放在Skimmer中，比如Pool Shock，Algeacid
    
    </summary>
    
      <category term="美国生活" scheme="http://uteric.github.io/categories/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="美国" scheme="http://uteric.github.io/tags/%E7%BE%8E%E5%9B%BD/"/>
    
      <category term="泳池" scheme="http://uteric.github.io/tags/%E6%B3%B3%E6%B1%A0/"/>
    
      <category term="设备" scheme="http://uteric.github.io/tags/%E8%AE%BE%E5%A4%87/"/>
    
  </entry>
  
  <entry>
    <title>泳池水质检测</title>
    <link href="http://uteric.github.io/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB%E6%97%A5%E8%AE%B03/"/>
    <id>http://uteric.github.io/美国生活日记3/</id>
    <published>2019-05-19T22:40:04.000Z</published>
    <updated>2019-05-19T22:40:04.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、水质重要指标"><a href="#一、水质重要指标" class="headerlink" title="一、水质重要指标"></a>一、水质重要指标</h2><p><em>ppm，parts per million，百万分之一</em><br>| 指标 | 值 |<br>|:—: |:—: |<br>| 碱度（Alkalinity）| 80-100 ppm|<br>| 酸碱度（PH）| 7.2-7.8|<br>| 钙硬度（Calcium）|  200-500 ppm|<br>| 自由氯（Chlorine）| 1.0-3.0 ppm|<br>| 盐（Salt）| 3200 ppm|<br>| 氯稳定剂（Stabilizer）| 30-50 ppm| </p>
<h2 id="二、水的平衡顺序"><a href="#二、水的平衡顺序" class="headerlink" title="二、水的平衡顺序"></a>二、水的平衡顺序</h2><p>关于水的平衡，最重要的四个指标依次是碱度，酸碱度，钙硬度，自由氯。</p>
<p>1、碱度（Alkalinity），碱度是水体中碱的含量，影响水体的缓冲能力。碱度的合适范围是80-100 ppm。如果太低，就加Alkalinity Increaser，其实就是碳酸氢钠（NaHCO₃），俗名叫小苏打；如果太高，就加Alkalinity Decreaser，其实就是盐酸（Muriatic Acid）。</p>
<p>$\underline{提示：碱度是最先要调节的，否则影响后面的所有过程。}$</p>
<p>2、酸碱度（PH），范围是7.2-7.8之间，适合人的皮肤直接接触，低加碱，高加酸。</p>
<p>3、钙硬度（Calcium Hardness），反映化学试剂在水中的溶解度，合适范围为200-500 ppm。如果偏低，加Calcium Hardness Increaser即可；如果太高，则只能将池水放出一部分，加入新水来稀释。</p>
<p>4、自由氯（Free Chlorine，FC），氯是强氧化剂，可对池水进行消毒，合适范围是1.0-3.0 ppm。如果太低，需加Pool Shock，如果太高，不用担心，晒几天太阳就降下来了，只是暂时不要游泳。一般来说，一周加1磅shock即可（<em>1LB Shock week/p to pool, No swim 4-6 hr</em>）。此外还有一个概念，叫结合氯（Combined Chlorine，CC），CC仍在水中，但是消毒能力大大减弱，CC要低于0.2 ppm；FC+CC=TC（总氯，Total Chlorine）。</p>
<p>关于Pool Shock，详见<strong>“三、氯和氯稳定剂”</strong>。</p>
<p>5、Algeacide，用来抑制藻类（Algae）生长，如果没有藻类生长也可以不加。</p>
<h2 id="三、氯和氯稳定剂"><a href="#三、氯和氯稳定剂" class="headerlink" title="三、氯和氯稳定剂"></a>三、氯和氯稳定剂</h2><p>在美国，最常见的泳池杀菌药物是TCCA（三氯异氰尿酸，国内商品名叫“强氯精”，trichloroisocyanuric acid或trichloro-s-triazinetrione，TCCA，分子式为C3N3O3Cl3)，TCCA具有多种优点，如杀菌范围广、有效氯含量高、维持时间长，且可灭藻、除臭、净水、漂白，因此，其在池水消毒方面被广泛使用。</p>
<p>TCCA在消毒的过程中能产生氰尿酸（Cyanuric Acid，CYA），CYA是一种次氯酸的稳定剂，它能使水中的次氯酸浓度维持稳定，从而产生持久的消毒效果。然而，CYA不易分解和去除，因此很容易在水中集聚，当其浓度增高到一定程度时，反而会严重抑制次氯酸的消毒效果，并对人体健康产生危害。</p>
<p>因此，我们平时也需要检测泳池中CYA的浓度。CYA的浓度应当维持在30-50 ppm，既能稳定次氯酸，又不至于对人体产生危害。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、水质重要指标&quot;&gt;&lt;a href=&quot;#一、水质重要指标&quot; class=&quot;headerlink&quot; title=&quot;一、水质重要指标&quot;&gt;&lt;/a&gt;一、水质重要指标&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ppm，parts per million，百万分之一&lt;/em&gt;&lt;br&gt;| 指标 |
    
    </summary>
    
      <category term="美国生活" scheme="http://uteric.github.io/categories/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="美国" scheme="http://uteric.github.io/tags/%E7%BE%8E%E5%9B%BD/"/>
    
      <category term="泳池" scheme="http://uteric.github.io/tags/%E6%B3%B3%E6%B1%A0/"/>
    
      <category term="水质" scheme="http://uteric.github.io/tags/%E6%B0%B4%E8%B4%A8/"/>
    
  </entry>
  
  <entry>
    <title>美国家庭电费</title>
    <link href="http://uteric.github.io/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB%E6%97%A5%E8%AE%B02/"/>
    <id>http://uteric.github.io/美国生活日记2/</id>
    <published>2019-05-19T22:36:18.000Z</published>
    <updated>2019-05-19T22:36:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>搬新家时，朋友推荐我用RELIANT ENERGY的Reliant Truly Free Nights 12 plan，原因是这个Plan从晚上8:00至早晨6:00免费，我们两口子白天都上班，晚上回家才有时间煮肉炖菜，觉得这个计划比较合适，于是果断加入。</p>
<p>电费的计算规则如下：</p>
<table>
<thead>
<tr>
<th style="text-align:left">Reliant Charges</th>
<th style="text-align:left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Daytime Energy Charge</td>
<td style="text-align:left">+ 16.8311¢ per kWh</td>
</tr>
<tr>
<td style="text-align:left">Nighttime Energy Charge</td>
<td style="text-align:left">+ $0.00 per kWh</td>
</tr>
<tr>
<td style="text-align:left">Base Charge</td>
<td style="text-align:left">+ $0.00 per month</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>TDSP/Utility (ONCOR) Charges</strong></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Monthly Charge</td>
<td style="text-align:left">+ $3.42 per month</td>
</tr>
<tr>
<td style="text-align:left">Daytime Delivery Charges</td>
<td style="text-align:left">+ 3.1350¢ per kWh</td>
</tr>
<tr>
<td style="text-align:left">Nighttime Delivery Charges</td>
<td style="text-align:left">+ $0.00 per kWh</td>
</tr>
</tbody>
</table>
<p>用了一个星期，收到RELIANT的电费周报，我们一周居然花了25.63刀的电费，吓了一跳，因为我们白天基本不在家，晚上回家就简单做点饭，因为是春天，空调也很少开，觉得非常奇怪。看了一下报告单，说我们晚上用电20度，白天用电110度，开始还以为是电力公司搞错了，后来才发现原来泳池定时在每天上午10：00开始循环，傍晚自动关闭，而当我们回到家时已经停止循环了，因此我们都没发现。发现问题后，把泳池的定时器重设了一下，晚上循环，白天停止，电费一下子就从之前每天2.8刀降到每天0.4刀，整整七倍。</p>
<p>美国的制度有个好处，就是你可以用各种各样的方法合法规避你的花销，关键看你愿不愿意投入时间和精力去了解它的运行规则。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;搬新家时，朋友推荐我用RELIANT ENERGY的Reliant Truly Free Nights 12 plan，原因是这个Plan从晚上8:00至早晨6:00免费，我们两口子白天都上班，晚上回家才有时间煮肉炖菜，觉得这个计划比较合适，于是果断加入。&lt;/p&gt;
&lt;p&gt;电
    
    </summary>
    
      <category term="美国生活" scheme="http://uteric.github.io/categories/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="美国" scheme="http://uteric.github.io/tags/%E7%BE%8E%E5%9B%BD/"/>
    
      <category term="电费" scheme="http://uteric.github.io/tags/%E7%94%B5%E8%B4%B9/"/>
    
  </entry>
  
  <entry>
    <title>美国家庭天燃气收费</title>
    <link href="http://uteric.github.io/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB%E6%97%A5%E8%AE%B01/"/>
    <id>http://uteric.github.io/美国生活日记1/</id>
    <published>2019-05-19T22:26:51.000Z</published>
    <updated>2019-05-19T22:26:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>美国的天燃气收费原则有点像国内的固话费，只要你开通这个服务，不管你用不用，基本费用必不可免，这叫做Customer Service Charge（CSC）或者Customer Charge（CC），真的是百分百的霸王条款。</p>
<p>下面是一个虚拟的<strong>GAS BILL</strong>，由四部分组成。</p>
<table>
<thead>
<tr>
<th style="text-align:left">CURRENT GAS CHARGE TOTAL</th>
<th style="text-align:center">20.79</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Customer Charge</td>
<td style="text-align:center">18.88</td>
</tr>
<tr>
<td style="text-align:left">Consump Chrg 4.000 @ 0.14846</td>
<td style="text-align:center">0.59</td>
</tr>
<tr>
<td style="text-align:left">Rider GCR 4.000 @ 0.3297</td>
<td style="text-align:center">1.32</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:left"><strong>TAX/FEE CHARGE TOTAL</strong></td>
<td style="text-align:center"><strong>1.99</strong></td>
</tr>
<tr>
<td style="text-align:left">Rider FF @0.06323</td>
<td style="text-align:center">1.31</td>
</tr>
<tr>
<td style="text-align:left">Reimbursement of MGRT</td>
<td style="text-align:center">0.45</td>
</tr>
<tr>
<td style="text-align:left">City Sales Tax</td>
<td style="text-align:center">0.23</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:left"><strong>OTHER CHARGE TOTAL</strong></td>
<td style="text-align:center"><strong>19.00</strong></td>
</tr>
<tr>
<td style="text-align:left">Meter Read Fee</td>
<td style="text-align:center">19.00</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:left"><strong>CURRENT CHARGES</strong></td>
<td style="text-align:center"><strong>41.76</strong></td>
</tr>
</tbody>
</table>
<p><strong>一、客户服务费</strong>，每月$18.88，哪怕你不吃不喝不动，一个月下来也要至少交这么多钱。</p>
<p><strong>二、消费记录</strong>，由两项组成：<br>1、CONSUMPTION CHARGE，是指公司为你提供供气服务所收取的费用，在本账单中每CCF收取0.14846刀；<br>2、Rider GCR（GAS COST RECOVERY），是天燃气公司向天燃气供货商支付的成本和运输费用，在本账单中每CCF收取0.3297刀，合计0.47816刀/CCF。由此可见，随着天燃气市场价格的波动，你的账单可能也会有较大幅度的变化。</p>
<p><strong>三、税收</strong>，由三项组成：<br>1、FRANCHISE FEE（RIDER FF），这是市政当局征收的特许经营费；<br>2、Reimbursement of MGRT(Miscellaneous Gross Receipts Tax)，收入税报销；<br>3、City Sales Tax，市销售税。</p>
<p><strong>四、其他收费</strong>，在本账单中，叫Meter Read Fee，只在开通服务时一次性收取。</p>
<p><strong>友情提示</strong>：在CC部分，我用了个限定词<strong>“至少”</strong>，说明还有其他的隐性费用，这部分是<strong>Pilot Light</strong>。</p>
<p><strong>Pilot Light</strong>，是加热器的火焰指示灯，在旧式的加热器中保持常开，作为加热器的点火源（ignition source），每个月也要消耗5CCF的天燃气。现在，新式的加热器只有在启动时才点火，不会有这个隐性费用。</p>
<p>尽管这是个虚拟账单，但却是根据真实的账单而产生的，因此比较能反映现在的天燃气计价方式。具体的账单，里面的内容可能叫法不同，但是一个母牛生的犊，大同小异，基本都由这几项构成。美国的天燃气消耗是日常支出中的大项，但是好在美国在上世纪末已对天燃气解除管制，尽管有令人无可奈何的霸王条款，但是总得来说价格还算合理。</p>
<hr>
<h2 id="附：天燃气计价单位"><a href="#附：天燃气计价单位" class="headerlink" title="附：天燃气计价单位"></a>附：天燃气计价单位</h2><p><strong>一、常用的天燃气单位</strong></p>
<p><em>Btu  (British Thermal Unit)</em>，英国热量单位，把1磅水从39°F加热到40°F所消耗的热量（英制单位是历史遗留产物，主要特点就是别扭，尽管英国人都改公制了，但美国人还在用，原因是错过了最佳历史机遇，现在想要更改成本太高，国家和人民都承受不起）。</p>
<p><em>Therm</em>，千卡，=100,000 Btu，热量单位。<br><em>CCF</em>，100立方英尺，2.83立方米，是体积单位，最为常见。<br><em>MCF</em>，1000立方英尺，体积单位。</p>
<p><strong>二、换算方法</strong></p>
<p>Therms to Btu:therms × 100,000 = Btu<br>Therms to CCF:therms × 1.037 = CCF<br>Therms to MCF:therms × 10.37 = MCF<br>CCF to Btu:CCF × 103,700 = Btu<br>CCF to Therms:CCF ÷ 1.037 = Therms<br>CCF to MCF:CCF × 10 = MCF<br>MCF to Btu:MCF × 1,037,000 = Btu<br>MCF to Therms:MCF ÷ 10.37 = Therms<br>MCF to CCF:MCF ÷ 10 = CCF</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;美国的天燃气收费原则有点像国内的固话费，只要你开通这个服务，不管你用不用，基本费用必不可免，这叫做Customer Service Charge（CSC）或者Customer Charge（CC），真的是百分百的霸王条款。&lt;/p&gt;
&lt;p&gt;下面是一个虚拟的&lt;strong&gt;GA
    
    </summary>
    
      <category term="美国生活" scheme="http://uteric.github.io/categories/%E7%BE%8E%E5%9B%BD%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="美国" scheme="http://uteric.github.io/tags/%E7%BE%8E%E5%9B%BD/"/>
    
      <category term="天然气" scheme="http://uteric.github.io/tags/%E5%A4%A9%E7%84%B6%E6%B0%94/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记11-R自带数据集</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B011/"/>
    <id>http://uteric.github.io/R语言学习笔记11/</id>
    <published>2018-10-11T04:18:48.000Z</published>
    <updated>2018-10-11T04:18:48.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data() <span class="comment"># 列出已载入的包中的所有数据集。</span></div></pre></td></tr></table></figure>
<p>Data sets in package ‘datasets’:</p>
<p>AirPassengers—Monthly Airline Passenger Numbers 1949-1960<br>BJsales—Sales Data with Leading Indicator<br>BJsales.lead (BJsales)—Sales Data with Leading Indicator<br>BOD—Biochemical Oxygen Demand<br>CO2—Carbon Dioxide Uptake in Grass Plants<br>ChickWeight—Weight versus age of chicks on different diets<br>DNase—Elisa assay of DNase<br>EuStockMarkets—Daily Closing Prices of Major European Stock Indices, 1991-1998<br>Formaldehyde—Determination of Formaldehyde<br>HairEyeColor—Hair and Eye Color of Statistics Students<br>Harman23.cor—Harman Example 2.3<br>Harman74.cor—Harman Example 7.4<br>Indometh—Pharmacokinetics of Indomethacin<br>InsectSprays—Effectiveness of Insect Sprays<br>JohnsonJohnson—Quarterly Earnings per Johnson &amp; Johnson Share<br>LakeHuron—Level of Lake Huron 1875-1972<br>LifeCycleSavings—Intercountry Life-Cycle Savings Data<br>Loblolly—Growth of Loblolly pine trees<br>Nile—Flow of the River Nile<br>Orange—Growth of Orange Trees<br>OrchardSprays—Potency of Orchard Sprays<br>PlantGrowth—Results from an Experiment on Plant Growth<br>Puromycin—Reaction Velocity of an Enzymatic Reaction<br>Seatbelts—Road Casualties in Great Britain 1969-84<br>Theoph—Pharmacokinetics of Theophylline<br>Titanic—Survival of passengers on the Titanic<br>ToothGrowth—The Effect of Vitamin C on Tooth Growth in Guinea Pigs<br>UCBAdmissions—Student Admissions at UC Berkeley<br>UKDriverDeaths—Road Casualties in Great Britain 1969-84<br>UKgas—UK Quarterly Gas Consumption<br>USAccDeaths—Accidental Deaths in the US 1973-1978<br>USArrests—Violent Crime Rates by US State<br>USJudgeRatings—Lawyers’ Ratings of State Judges in the US Superior Court<br>USPersonalExpenditure—Personal Expenditure Data<br>UScitiesD—Distances Between European Cities and Between US Cities<br>VADeaths—Death Rates in Virginia (1940)<br>WWWusage—Internet Usage per Minute<br>WorldPhones—The World’s Telephones<br>ability.cov—Ability and Intelligence Tests<br>airmiles—Passenger Miles on Commercial US Airlines,1937-1960<br>airquality—New York Air Quality Measurements<br>anscombe—Anscombe’s Quartet of ‘Identical’ Simple Linear Regressions<br>attenu—The Joyner-Boore Attenuation Data<br>attitude—The Chatterjee-Price Attitude Data<br>austres—Quarterly Time Series of the Number of Australian Residents<br>beaver1 (beavers)—Body Temperature Series of Two Beavers<br>beaver2 (beavers)—Body Temperature Series of Two Beavers<br>cars—Speed and Stopping Distances of Cars<br>chickwts—Chicken Weights by Feed Type<br>co2—Mauna Loa Atmospheric CO2 Concentration<br>crimtab—Student’s 3000 Criminals Data<br>discoveries—Yearly Numbers of Important Discoveries<br>esoph—Smoking, Alcohol and (O)esophageal Cancer<br>euro—Conversion Rates of Euro Currencies<br>euro.cross (euro)—Conversion Rates of Euro Currencies<br>eurodist—Distances Between European Cities and Between US Cities<br>faithful—Old Faithful Geyser Data<br>fdeaths (UKLungDeaths)—Monthly Deaths from Lung Diseases in the UK<br>freeny—Freeny’s Revenue Data<br>freeny.x (freeny)—Freeny’s Revenue Data<br>freeny.y (freeny)—Freeny’s Revenue Data<br>infert—Infertility after Spontaneous and Induced Abortion<br>iris—Edgar Anderson’s Iris Data<br>iris3—Edgar Anderson’s Iris Data<br>islands —Areas of the World’s Major Landmasses<br>ldeaths (UKLungDeaths) —Monthly Deaths from Lung Diseases in the UK<br>lh—Luteinizing Hormone in Blood Samples<br>longley—Longley’s Economic Regression Data<br>lynx—Annual Canadian Lynx trappings 1821-1934<br>mdeaths (UKLungDeaths)— Monthly Deaths from Lung Diseases in the UK<br>morley—Michelson Speed of Light Data<br>mtcars—Motor Trend Car Road Tests<br>nhtemp—Average Yearly Temperatures in New Haven<br>nottem—Average Monthly Temperatures at Nottingham,1920-1939<br>npk—Classical N, P, K Factorial Experiment<br>occupationalStatus—Occupational Status of Fathers and their Sons<br>precip—Annual Precipitation in US Cities<br>presidents—Quarterly Approval Ratings of US Presidents<br>pressure —Vapor Pressure of Mercury as a Function of Temperature<br>quakes— Locations of Earthquakes off Fiji<br>randu—Random Numbers from Congruential Generato RANDU<br>rivers—Lengths of Major North American Rivers<br>rock—Measurements on Petroleum Rock Samples<br>sleep—Student’s Sleep Data<br>stack.loss (stackloss)—Brownlee’s Stack Loss Plant Data<br>stack.x (stackloss)—Brownlee’s Stack Loss Plant Data<br>stackloss—Brownlee’s Stack Loss Plant Data<br>state.abb (state)—US State Facts and Figures<br>state.area (state)—US State Facts and Figures<br>state.center (state)—US State Facts and Figures<br>state.division (state)—US State Facts and Figures<br>state.name (state)—US State Facts and Figures<br>state.region (state)—US State Facts and Figures<br>state.x77 (state)—US State Facts and Figures<br>sunspot.month —Monthly Sunspot Data, from 1749 to “Present”<br>sunspot.year—Yearly Sunspot Data, 1700-1988<br>sunspots—Monthly Sunspot Numbers, 1749-1983<br>swiss—Swiss Fertility and Socioeconomic Indicators(1888) Data<br>treering —Yearly Treering Data, -6000-1979<br>trees—Girth, Height and Volume for Black Cherry Trees<br>uspop —Populations Recorded by the US Census<br>volcano—Topographic Information on Auckland’s Maunga Whau Volcano<br>warpbreaks—The Number of Breaks in Yarn during Weaving<br>women—Average Heights and Weights for American Women</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data(package = .packages(all.available = TRUE)) <span class="comment"># 列出已安装的包中的所有数据集。</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记10-基础绘图函数plot</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010/"/>
    <id>http://uteric.github.io/R语言学习笔记10/</id>
    <published>2018-10-11T03:58:23.000Z</published>
    <updated>2018-10-11T03:58:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>R中有个默认的数据叫euro（欧元汇率，长度为11），以euro为例来看一下如何使用绘图函数plot。</p>
<p>plot基本语法：<strong>plot(x,y,xlab,ylab,main=,sub)</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">plot(euro) <span class="comment"># 作图</span></div><div class="line">lines(lowess(euro)) <span class="comment"># 添加一条平滑曲线</span></div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-14241f65cb0b564b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><strong>type</strong>用于指定图形的类型：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; par(mfrow=c(3,3)) <span class="comment"># 使用par函数，参数mfrow指定图形排布3X3</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"p"</span>) <span class="comment"># 同plot(euro)，"p" for points</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"l"</span>) <span class="comment"># "l" for lines</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"b"</span>) <span class="comment"># "b" for both</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"c"</span>) <span class="comment"># "c" for the lines part alone of "b"</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"o"</span>) <span class="comment"># "o" for both ‘overplotted’</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"h"</span>) <span class="comment"># "h" for ‘histogram’ </span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"s"</span>) <span class="comment"># "s" for stair steps</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"S"</span>) <span class="comment"># "S" for other steps</span></div><div class="line">&gt; plot(euro,<span class="built_in">type</span>=<span class="string">"n"</span>) <span class="comment"># "n" for no plotting</span></div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-8d2b6ededb6ec974.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><strong>pch</strong>，用于指定图形样式，共25种，默认为1，如果pch=x，则每个点的样式都不同；<br><strong>col</strong>，用于指定颜色，共657种，可以使用colors()查看；<br><strong>lwd</strong>，用于指定宽度</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lot(euro,pch=1:11,col=1:11,<span class="built_in">type</span>=<span class="string">"h"</span>,lwd=15)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-1ec8c2908df18c94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;R中有个默认的数据叫euro（欧元汇率，长度为11），以euro为例来看一下如何使用绘图函数plot。&lt;/p&gt;
&lt;p&gt;plot基本语法：&lt;strong&gt;plot(x,y,xlab,ylab,main=,sub)&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;hig
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记9-绘制barplot</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B09/"/>
    <id>http://uteric.github.io/R语言学习笔记9/</id>
    <published>2018-10-08T16:33:11.000Z</published>
    <updated>2018-10-08T16:33:11.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、条形图"><a href="#一、条形图" class="headerlink" title="一、条形图"></a>一、条形图</h2><p>barplot基本语法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(H,xlab,ylab,main, names.arg,col,horiz=FALSE,density,las)</div></pre></td></tr></table></figure>
<p>H - 用于创建柱状图的矢量或矩阵<br>xlab - X轴标签<br>ylab - Y轴标签<br>main - 柱状图的标题<br>names.arg - 每个柱的名称<br>col - 柱的颜色<br>horiz - 默认为FALSE，即竖直方向<br>density - 条纹密度<br>las - 坐标轴字体方向，las=1为水平方向，las=2为垂直方向</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data &lt;- c(3,5,7) <span class="comment"># 创建数据</span></div><div class="line">barplot(data,main=<span class="string">"Expression"</span>,ylab=<span class="string">"gene"</span>,xlab=<span class="string">"relative expresstion level"</span>,names.arg=c(<span class="string">"gene1"</span>,<span class="string">"gene2"</span>,<span class="string">"gene3"</span>),horiz=TRUE,col=<span class="string">"green"</span>,border=<span class="string">"red"</span>,density=c(5,10,15))</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-c43d30e6b6c0c8f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="二、堆叠图"><a href="#二、堆叠图" class="headerlink" title="二、堆叠图"></a>二、堆叠图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data &lt;- matrix(c(2,9,3,11,9,4,8,7,3,12,5,2,8,10,11),nrow=3,ncol=5,byrow=TRUE) <span class="comment"># 创建3行5列的向量</span></div><div class="line">barplot(data,col=c(<span class="string">"green"</span>,<span class="string">"red"</span>,<span class="string">"blue"</span>),names.arg=c(<span class="string">"J"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"A"</span>,<span class="string">"S"</span>)) <span class="comment"># 堆叠图</span></div><div class="line">kinds &lt;- c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>)</div><div class="line">legend(<span class="string">"topleft"</span>,kinds,cex=0.8,fill=c(<span class="string">"green"</span>,<span class="string">"red"</span>,<span class="string">"blue"</span>)) <span class="comment"># 添加图例</span></div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-e89a28945243083a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="三、分组图"><a href="#三、分组图" class="headerlink" title="三、分组图"></a>三、分组图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">barplot(data,col=c(<span class="string">"green"</span>,<span class="string">"red"</span>,<span class="string">"blue"</span>),names.arg=c(<span class="string">"J"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"A"</span>,<span class="string">"S"</span>),beside=TRUE) <span class="comment"># 添加beside=TRUE即为分组图</span></div><div class="line">kinds &lt;- c(<span class="string">"D"</span>,<span class="string">"E"</span>,<span class="string">"F"</span>)</div><div class="line">legend(<span class="string">"topleft"</span>,kinds,cex=0.8,fill=c(<span class="string">"green"</span>,<span class="string">"red"</span>,<span class="string">"blue"</span>)) <span class="comment"># 添加图例</span></div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-2744ba74ff446af4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、条形图&quot;&gt;&lt;a href=&quot;#一、条形图&quot; class=&quot;headerlink&quot; title=&quot;一、条形图&quot;&gt;&lt;/a&gt;一、条形图&lt;/h2&gt;&lt;p&gt;barplot基本语法：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记8-集合运算</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/"/>
    <id>http://uteric.github.io/R语言学习笔记8/</id>
    <published>2018-10-06T04:22:07.000Z</published>
    <updated>2018-10-06T04:22:07.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、交集"><a href="#一、交集" class="headerlink" title="一、交集"></a>一、交集</h2><p>使用intersect计算两个向量的交集：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x=1:10</div><div class="line">y=3:15</div><div class="line">z=5:9</div><div class="line"><span class="comment"># 定义x, y, z三个向量</span></div><div class="line">intersect(x,y)</div><div class="line"><span class="comment"># 3  4  5  6  7  8  9 10</span></div><div class="line">intersect(x,y,z)</div><div class="line"><span class="comment"># Error in intersect(x, y, z) : 参数没有用(z) #若使用intersect计算三个向量的交集，则会报错</span></div></pre></td></tr></table></figure>
<p>使用intersect计算两个以上向量的交集：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">A &lt;- Reduce(intersect,list(x,y,z)) <span class="comment"># 求x, y, z三个向量的交集</span></div><div class="line">5 6 7 8 9</div></pre></td></tr></table></figure>
<h2 id="二、并集"><a href="#二、并集" class="headerlink" title="二、并集"></a>二、并集</h2><p>两个向量求并集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">union(x,y)</div><div class="line"><span class="comment"># 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<p>多个向量求并集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b &lt;- Reduce(union,list(x,y,z))</div><div class="line"><span class="comment"># 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<h2 id="三、差集"><a href="#三、差集" class="headerlink" title="三、差集"></a>三、差集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">setdiff(x,y) <span class="comment"># x-y的差集，即x中存在但在y中不存在的元素</span></div><div class="line"><span class="comment"># 1 2</span></div><div class="line">setdiff(y,x) <span class="comment"># y-x的差集，即y中存在但在x中不存在的元素</span></div><div class="line"><span class="comment"># 11 12 13 14 15</span></div></pre></td></tr></table></figure>
<h2 id="四、检验集合是否相同"><a href="#四、检验集合是否相同" class="headerlink" title="四、检验集合是否相同"></a>四、检验集合是否相同</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setequal(x,y)</div><div class="line"><span class="comment"># FALSE</span></div></pre></td></tr></table></figure>
<h2 id="五、检验元素是否属于集合"><a href="#五、检验元素是否属于集合" class="headerlink" title="五、检验元素是否属于集合"></a>五、检验元素是否属于集合</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">is.element(5,x)</div><div class="line"><span class="comment"># TRUE</span></div><div class="line">&gt; is.element(15,x)</div><div class="line"><span class="comment"># FALSE</span></div></pre></td></tr></table></figure>
<h2 id="六、检验集合B是否包含于集合A"><a href="#六、检验集合B是否包含于集合A" class="headerlink" title="六、检验集合B是否包含于集合A"></a>六、检验集合B是否包含于集合A</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">all(x%<span class="keyword">in</span>%y)</div><div class="line"><span class="comment"># FALSE</span></div><div class="line">all(z%<span class="keyword">in</span>%x)</div><div class="line"><span class="comment"># TRUE</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、交集&quot;&gt;&lt;a href=&quot;#一、交集&quot; class=&quot;headerlink&quot; title=&quot;一、交集&quot;&gt;&lt;/a&gt;一、交集&lt;/h2&gt;&lt;p&gt;使用intersect计算两个向量的交集：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;tabl
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记10-差异分析与绘制热图（命令集合）</title>
    <link href="http://uteric.github.io/RNASEQ%20%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90%E4%B8%8E%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE/"/>
    <id>http://uteric.github.io/RNASEQ 差异分析与绘制热图/</id>
    <published>2018-10-06T04:19:13.000Z</published>
    <updated>2018-10-06T04:19:13.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、差异分析"><a href="#一、差异分析" class="headerlink" title="一、差异分析"></a>一、差异分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">"E:/R/My Analysis/"</span>) <span class="comment"># 设置工作目录</span></div><div class="line">getwd() <span class="comment"># 查看当前工作目录</span></div><div class="line">dir() <span class="comment"># 查看工作目录下的文件</span></div><div class="line"></div><div class="line">library(DESeq2) <span class="comment"># 载入DESeq2</span></div><div class="line"></div><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>,header=T,row.names=1) <span class="comment"># 从剪贴板载入要分析的数据</span></div><div class="line"></div><div class="line">countData &lt;- data</div><div class="line">condition &lt;- factor(c(<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>)) <span class="comment"># 定义condition，根据具体情况作相应改变</span></div><div class="line">colData &lt;- data.frame(row.names=colnames(countData),condition)</div><div class="line">condition <span class="comment"># 查看condition</span></div><div class="line">colData <span class="comment"># 查看colData是否与预期一致</span></div><div class="line"></div><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData,DataFrame(condition),design= ~ condition) <span class="comment"># 构建dds矩阵</span></div><div class="line">head(dds) <span class="comment"># 查看dds矩阵的前端</span></div><div class="line">dds2 &lt;- DESeq(dds) <span class="comment"># 对dds矩阵进行Normalize</span></div><div class="line"></div><div class="line">res &lt;- results(dds2) <span class="comment"># 使用results()函数获取结果，并赋值给res</span></div><div class="line">summary(res) <span class="comment"># 查看res矩阵的总结信息</span></div><div class="line">table(res<span class="variable">$padj</span>&lt;0.05) <span class="comment"># 取padj小于0.05的数据，作为第一个checkpoint</span></div><div class="line">res &lt;- res[order(res<span class="variable">$padj</span>),] <span class="comment"># 按照padj的大小将res重新排列</span></div><div class="line"></div><div class="line">diff &lt;- subset(res,padj &lt; 0.05 &amp; (log2FoldChange &gt;1 | log2FoldChange &lt; -1)) <span class="comment"># 获取padj小于0.05，表达倍数取以2为对数后绝对值大于1的差异表达基因</span></div><div class="line">nrow(diff) <span class="comment"># 查看行数，作为第二个checkpoint</span></div><div class="line"></div><div class="line">resdata &lt;- merge(as.data.frame(diff),as.data.frame(counts(dds,normalize=FALSE)),by=<span class="string">"row.names"</span>,sort=FALSE) <span class="comment"># 合并文件</span></div><div class="line"></div><div class="line">write.csv(resdata,file=<span class="string">"diff_SR.csv"</span>) <span class="comment"># 结果输出为.CSV文件</span></div></pre></td></tr></table></figure>
<h2 id="二、绘制热图"><a href="#二、绘制热图" class="headerlink" title="二、绘制热图"></a>二、绘制热图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>,header=T,row.names=1) <span class="comment"># 从剪贴板载入数据</span></div><div class="line"></div><div class="line">col_anno=data.frame(PT=c(<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"S"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>,<span class="string">"R"</span>),row.names=colnames(data)) <span class="comment"># 定义分组信息，具体情况具体设置，本例是对列进行分组，前12列为S，后11列为R</span></div><div class="line"></div><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,annotation_col=col_anno,color=colorRampPalette(c(<span class="string">"navy"</span>,<span class="string">"white"</span>,<span class="string">"firebrick3"</span>))(50)) <span class="comment"># 绘制热图</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、差异分析&quot;&gt;&lt;a href=&quot;#一、差异分析&quot; class=&quot;headerlink&quot; title=&quot;一、差异分析&quot;&gt;&lt;/a&gt;一、差异分析&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>EXCEL学习笔记1-AND与OR的用法</title>
    <link href="http://uteric.github.io/EXCEL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"/>
    <id>http://uteric.github.io/EXCEL学习笔记1/</id>
    <published>2018-10-06T04:16:43.000Z</published>
    <updated>2018-10-06T04:16:43.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">=IF(AND(AC2&lt;AD2,Y2&lt;AB2),<span class="string">"Y"</span>,<span class="string">"N"</span>) <span class="comment"># 套用IF语句，如果AC2&lt;AD2且Y2&lt;AB2，则判断为Y，否则为N，注意，Y或N要加引号，否则报错</span></div><div class="line">=IF(OR(AE2=<span class="string">"Y"</span>,AF2=<span class="string">"Y"</span>),<span class="string">"Y"</span>,<span class="string">"N"</span>) <span class="comment"># 套用IF语句，如果AE2="Y"或AF2="Y"，则判断为Y，否则为N</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;co
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="EXCEL" scheme="http://uteric.github.io/tags/EXCEL/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记7-最大整数问题</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B07/"/>
    <id>http://uteric.github.io/R语言学习笔记7/</id>
    <published>2018-09-27T04:16:58.000Z</published>
    <updated>2018-09-27T04:16:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在分析RNA-SEQ结果时，遇到一个问题，总是提示：</p>
<p><em>message: In mde(x) : NAs introduced by coercion to integer range </em></p>
<p>最开始时，我以为是原始数据中有NAs，但是检查了一遍发现没有，真正的原因是，原始数据中的整数太大，超出机器设定的最高限，因此才会报错。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.Machine<span class="variable">$integer</span>.max <span class="comment"># 查看最大整数</span></div><div class="line"><span class="comment"># [1] 2147483647</span></div><div class="line">x &lt;- as.interger(.Machine<span class="variable">$integer</span>.max)</div><div class="line">y&lt;- x+1</div><div class="line">as.integer(y)</div><div class="line"><span class="comment"># 猜猜会怎样？报错</span></div><div class="line"><span class="comment"># [1] NA</span></div><div class="line"><span class="comment"># Warning message: NAs introduced by coercion to integer range</span></div></pre></td></tr></table></figure>
<p>可见，最大整数不可以超过2147483647，当然，这不意味着系统不能对更大的数值进行计算，而是说，如果某函数中需要输入整数，则最大不可以超过此上限。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在分析RNA-SEQ结果时，遇到一个问题，总是提示：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;message: In mde(x) : NAs introduced by coercion to integer range &lt;/em&gt;&lt;/p&gt;
&lt;p&gt;最开始时，我以为是原始数据中有NAs，
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记6-基本命令</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B06/"/>
    <id>http://uteric.github.io/R语言学习笔记6/</id>
    <published>2018-09-27T04:15:28.000Z</published>
    <updated>2018-09-27T04:15:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>1、查看当前目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getwd() <span class="comment"># get working directory</span></div></pre></td></tr></table></figure>
<p>2、改变工作目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setwd()</div></pre></td></tr></table></figure>
<p>3、查看当前目录中的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dir()</div></pre></td></tr></table></figure>
<p>4、查看行数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nrow()</div></pre></td></tr></table></figure>
<p>5、排序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data &lt;- data[order(data<span class="variable">$row</span>,decreasing=FALSE),] <span class="comment"># decreasing=FALSE为默认升序排列</span></div></pre></td></tr></table></figure>
<p>6、查看文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">head() <span class="comment"># 查看前6行</span></div><div class="line">tail() <span class="comment"># 查看最后6行</span></div></pre></td></tr></table></figure>
<p>7、查看类型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class()</div></pre></td></tr></table></figure>
<p>8、载入文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">read.csv() <span class="comment"># 载入逗号分隔的CSV文档</span></div><div class="line">read.csv2() <span class="comment"># 载入分号分隔的CSV文档</span></div><div class="line">read.delim() <span class="comment"># 载入TAB键分隔的文档</span></div></pre></td></tr></table></figure>
<p>9、输出文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">write.csv() <span class="comment"># 输出逗号分隔的CSV文档</span></div><div class="line">write.csv2() <span class="comment"># 输出分号分隔的CSV文档</span></div></pre></td></tr></table></figure>
<p>10、数据筛选</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subset() <span class="comment"># 筛选特定子集</span></div></pre></td></tr></table></figure>
<p>11、绝对值函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">abs()</div></pre></td></tr></table></figure>
<p>12、开根号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sqrt()</div></pre></td></tr></table></figure>
<p>13、判断正负</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sign()</div></pre></td></tr></table></figure>
<p>14、自然指数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exp() <span class="comment"># e的指数</span></div></pre></td></tr></table></figure>
<p>15、对数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">log</span>(x,base)</div></pre></td></tr></table></figure>
<p>16、四舍五入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">round(x,n) <span class="comment"># 将x四舍五入到第n位</span></div></pre></td></tr></table></figure>
<p>17、取整数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">trunc()</div></pre></td></tr></table></figure>
<p>18、最大值与最小值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">max()</div><div class="line">min()</div></pre></td></tr></table></figure>
<p>19、求和</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">colSums() <span class="comment"># 按列求和</span></div><div class="line">rowSums() <span class="comment"># 按行求和</span></div></pre></td></tr></table></figure>
<p>20、平均值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">colMeans()</div><div class="line">rowMeans()</div></pre></td></tr></table></figure>
<p>21、缺失值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">na.fail() <span class="comment"># 检测是否有缺失值，若有则报错并停止</span></div><div class="line">na.omit() <span class="comment"># 去除缺失值</span></div><div class="line">na.exclude() <span class="comment"># 去除缺失值</span></div><div class="line">is.na() <span class="comment"># 判断是否是缺失值</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;1、查看当前目录&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记10-clusterProfiler富集分析</title>
    <link href="http://uteric.github.io/RNASEQ%20clusterProfiler%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/"/>
    <id>http://uteric.github.io/RNASEQ clusterProfiler富集分析/</id>
    <published>2018-09-25T02:11:12.000Z</published>
    <updated>2018-09-25T02:11:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、安装clusterProfiler"><a href="#一、安装clusterProfiler" class="headerlink" title="一、安装clusterProfiler"></a>一、安装clusterProfiler</h2><blockquote>
<p>source(“<a href="https://bioconductor.org/biocLite.R" target="_blank" rel="external">https://bioconductor.org/biocLite.R</a>“) # 如果报错，请尝试http://<br>biocLite(“clusterProfiler”)<br>library(clusterProfiler) # 载入包，测试是否安装成功，如果提示找不到某个包，则安装相关的包即可，比如我的电脑提示“<strong>不存在叫‘rvcheck’这个名字的程辑包</strong>”，则使用如下语法安装“rvcheck”，如缺乏其他包，也是同理。<br>install.packages(“rvcheck”)</p>
</blockquote>
<h2 id="二、安装基因组注释数据"><a href="#二、安装基因组注释数据" class="headerlink" title="二、安装基因组注释数据"></a>二、安装基因组注释数据</h2><p>目前，<a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb" target="_blank" rel="external">Bioconductor</a>官网支持19种生物的注释数据，可以直接安装：</p>
<blockquote>
<p>biocLite(“org.Hs.eg.db”) # 安装人类的注释数据<br>library(org.Hs.eg.db) # 测试，载入人类的注释数据<br>biocLite(“org.Mm.eg.db”) # 安装小鼠的注释数据<br>library(org.Mm.eg.db) # 测试，载入小鼠的注释数据</p>
</blockquote>
<h2 id="三、载入基因列表"><a href="#三、载入基因列表" class="headerlink" title="三、载入基因列表"></a>三、载入基因列表</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data &lt;- read.csv(<span class="string">"top50.csv"</span>) <span class="comment"># 从文件中载入数据，并赋值给data</span></div><div class="line"><span class="comment"># 我们需要的是第二列的基因列表，因此，只筛选第二列即可</span></div><div class="line">gene &lt;- data[,2] <span class="comment"># 抽取第二列，赋值给gene</span></div><div class="line">gene &lt;- bitr(gene,fromType=<span class="string">"SYMBOL"</span>,toType=<span class="string">"ENTREZID"</span>,OrgDb=org.Hs.eg.db) <span class="comment"># groupGO默认使用"ENTREZID"作为输入数据，因此首先将“SYMBOL”转化为“ENTREZID”，以防出错</span></div><div class="line">gene &lt;- gene[,2] <span class="comment"># 抽取第二列作为input</span></div></pre></td></tr></table></figure>
<h2 id="四、groupGO分析"><a href="#四、groupGO分析" class="headerlink" title="四、groupGO分析"></a>四、groupGO分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"BP"</span>,level=3,readable=TRUE)</div><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"CC"</span>,level=3,readable=TRUE)</div><div class="line">ggo &lt;- groupGO(gene=gene,OrgDb=org.Hs.eg.db,ont=<span class="string">"MF"</span>,level=3,readable=TRUE)</div></pre></td></tr></table></figure>
<p>groupGO命令的格式为：<em>groupGO(gene,OrgDb,ont,level,readable)</em></p>
<p><strong>gene</strong>，指定前景基因文件，即要分析的基因集合，默认为”ENTREZID”格式；<br><strong>OrgDb</strong>，指定基因组注释数据；<br><strong>ont</strong>，即ontology，参数有三个，分别为CC，BP和MF，对应：细胞组分（cellular component，CC），生物过程（biological process，BP），分子功能（molecular function，MF）；<br><strong>level</strong>，指定分析的GO水平；<br><strong>readable</strong>，逻辑值，TRUE或FALSE；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(as.data.frame(ggo)) <span class="comment"># 查看前六行，结果是六行五列的数据</span></div></pre></td></tr></table></figure>
<p>ID                              Description Count<br>GO:0019953 GO:0019953                      sexual reproduction     7<br>GO:0019954 GO:0019954                     asexual reproduction     0<br>GO:0022414 GO:0022414                     reproductive process    26<br>GO:0032504 GO:0032504      multicellular organism reproduction     9<br>GO:0032505 GO:0032505 reproduction of a single-celled organism     0<br>GO:0061887 GO:0061887         reproduction of symbiont in host     0<br>GeneRatio<br>GO:0019953     7/298<br>GO:0019954     0/298<br>GO:0022414    26/298<br>GO:0032504     9/298<br>GO:0032505     0/298<br>GO:0061887     0/298<br>geneID<br>GO:0019953                                                                                                                 APOB/ABAT/ANG/AR/AVPR1A/LEPR/ACOX1<br>GO:0019954<br>GO:0022414 APOB/AGT/AMBP/RBP4/ABAT/SERPINF1/ANG/HNF4A/AR/AVPR1A/ARG1/LEPR/GJB1/BOK/DHODH/SLC38A3/PDGFRA/TBX3/ADGRG1/IGFBP2/TTPA/ACOX1/DBH/ETNK2/NAMPT/HSD17B2<br>GO:0032504                                                                                                  APOB/SERPINF1/ANG/AR/AVPR1A/ARG1/PDGFRA/ACOX1/DBH<br>GO:0032505<br>GO:0061887                                                                                           </p>
<h2 id="五、groupGo结果可视化"><a href="#五、groupGo结果可视化" class="headerlink" title="五、groupGo结果可视化"></a>五、groupGo结果可视化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(ggo,drop=TRUE,showCategory=20)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-f92d7ebc27bfe4e3.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggo barplot.jpeg"></p>
<h2 id="六、enrichGO分析"><a href="#六、enrichGO分析" class="headerlink" title="六、enrichGO分析"></a>六、enrichGO分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"BP"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"CC"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div><div class="line">ego &lt;- enrichGO(gene=gene,universe=names(geneList),OrgDb=org.Hs.eg.db,ont=<span class="string">"MF"</span>,pvalueCutoff=0.01,qvalueCutoff=0.05,readable=TRUE)</div></pre></td></tr></table></figure>
<p>enrichGO命令语法：<em>enrichGO(gene,universe,OrgDb,ont,pvalueCutoff,qvalueCutoff,readable)</em></p>
<p>universe，背景基因文件，可以使用默认值；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(as.data.frame(ego))</div></pre></td></tr></table></figure>
<p>ID                                   Description<br>GO:0072562 GO:0072562                           blood microparticle<br>GO:0042627 GO:0042627                                   chylomicron<br>GO:0031093 GO:0031093                  platelet alpha granule lumen<br>GO:0005788 GO:0005788                   endoplasmic reticulum lumen<br>GO:0034361 GO:0034361         very-low-density lipoprotein particle<br>GO:0034385 GO:0034385 triglyceride-rich plasma lipoprotein particle<br>GeneRatio   BgRatio       pvalue     p.adjust       qvalue<br>GO:0072562    33/288 101/11817 9.367691e-29 2.519909e-26 2.336992e-26<br>GO:0042627     8/288  11/11817 1.750866e-11 2.354915e-09 2.183975e-09<br>GO:0031093    14/288  62/11817 1.938754e-10 1.738416e-08 1.612227e-08<br>GO:0005788    26/288 247/11817 3.097572e-10 2.083117e-08 1.931907e-08<br>GO:0034361     8/288  16/11817 1.227828e-09 5.504763e-08 5.105180e-08<br>GO:0034385     8/288  16/11817 1.227828e-09 5.504763e-08 5.105180e-08<br>geneID<br>GO:0072562 ITIH4/ALB/FGB/FGA/FGG/ORM1/HPX/HP/VTN/APOA2/AGT/AMBP/SERPINC1/F2/C3/C9/SERPING1/HRG/ITIH1/SERPINA3/AHSG/GC/APOA4/PLG/KNG1/TF/C4BPA/C8G/C8A/APOA1/HPR/ITIH2/C1S<br>GO:0042627                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>GO:0031093                                                                                       ALB/FGB/FGA/FGG/ORM1/SERPINA1/SERPING1/HRG/SERPINA3/AHSG/F5/PLG/KNG1/VWF<br>GO:0005788                           APOB/ALB/FGA/FGG/SERPINA1/VTN/APOA2/SERPINC1/F2/C3/IGFBP1/AHSG/F5/SERPIND1/APOA4/KNG1/TF/PROC/APOA1/F9/ITIH2/MTTP/F10/CES2/H6PD/CDH2<br>GO:0034361                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>GO:0034385                                                                                                                    APOB/APOC3/APOA2/APOA4/APOH/APOA1/LSR/APOC1<br>Count<br>GO:0072562    33<br>GO:0042627     8<br>GO:0031093    14<br>GO:0005788    26<br>GO:0034361     8<br>GO:0034385     8</p>
<h2 id="七、enrichGO可视化"><a href="#七、enrichGO可视化" class="headerlink" title="七、enrichGO可视化"></a>七、enrichGO可视化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(ego,drop=TRUE,showCategory=20)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-74b5709dbbde256d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ego barplot.jpeg"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dotplot(ego,title=<span class="string">"enrichGo CC dotplot"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-d804a07f00df5610.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ego cc dotplot.jpeg"></p>
<p>此外，还可以作enrichMap或cnetplot，命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">enrichMap(ego, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)</div><div class="line">cnetplot(ego, foldChange=geneList)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、安装clusterProfiler&quot;&gt;&lt;a href=&quot;#一、安装clusterProfiler&quot; class=&quot;headerlink&quot; title=&quot;一、安装clusterProfiler&quot;&gt;&lt;/a&gt;一、安装clusterProfiler&lt;/h2&gt;&lt;bloc
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记5-第1列作为行名</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05/"/>
    <id>http://uteric.github.io/R语言学习笔记5/</id>
    <published>2018-09-20T04:48:04.000Z</published>
    <updated>2018-09-20T04:48:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>比如一个名为diff的数据，我们来看一下最后五行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail (diff, n=5) <span class="comment"># 查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>48816 ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>48817 ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>48818 ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>48819 ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>48820 ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
<p>这个表格的行名是：48816，48817，48818，48819，48820，然而，有的时候，我们需要把文件中的第一列作为行名，如何操作呢？</p>
<p><strong>首先把第一列指定为行名，然后，再把第一列删掉即可。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rownames(diff) &lt;- diff[,1] <span class="comment"># 指定第一列为行名</span></div><div class="line">tail (diff,n=5) <span class="comment"># 查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>ENSMUSG00000110418 ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110420 ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110421 ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>ENSMUSG00000110422 ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>ENSMUSG00000110423 ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">diff2 &lt;- diff[,-1] <span class="comment"># 删掉第一列</span></div><div class="line">tail (diff2,n=5) <span class="comment"># 再次查看最后五行</span></div></pre></td></tr></table></figure>
<p>control1 control2      rep1      rep2<br>ENSMUSG00000110418 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110420 0.000000        0 0.0000000 0.0000000<br>ENSMUSG00000110421 0.000000        0 0.0000000 0.9451464<br>ENSMUSG00000110422 1.247384        0 0.7586195 1.8902928<br>ENSMUSG00000110423 0.000000        0 0.0000000 0.0000000</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;比如一个名为diff的数据，我们来看一下最后五行：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记9-使用pheatmap绘制热图</title>
    <link href="http://uteric.github.io/RNASEQ%20%E4%BD%BF%E7%94%A8pheatmap%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE/"/>
    <id>http://uteric.github.io/RNASEQ 使用pheatmap绘制热图/</id>
    <published>2018-09-19T05:14:41.000Z</published>
    <updated>2018-09-19T05:14:41.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、安装pheatmap"><a href="#一、安装pheatmap" class="headerlink" title="一、安装pheatmap"></a>一、安装pheatmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment">#调入安装工具</span></div><div class="line">biocLite(<span class="string">"pheatmap"</span>) <span class="comment"># 安装pheatmap</span></div><div class="line">library(pheatmap) <span class="comment"># 检测是否安装成功</span></div></pre></td></tr></table></figure>
<h2 id="二、读取数据"><a href="#二、读取数据" class="headerlink" title="二、读取数据"></a>二、读取数据</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">"E:/R"</span>) <span class="comment"># 设置工作路径，本例是在E盘下的R文件夹，如果要查询当前工作路径，则使用getwd()命令，其中，wd=working directory</span></div><div class="line">data &lt;- read.delim(<span class="string">"clipboard"</span>, header = T, sep = <span class="string">"\t"</span>, row.names = 1) <span class="comment"># read.delim意思是读取delimited text files，即分隔符分隔的文件</span></div></pre></td></tr></table></figure>
<p>read.delim这个命令有必要详细解释一下，其格式为：read.delim(file, header=TRUE, sep=”\t”)</p>
<p>其中，第一个参数是文件的位置，本例中直接使用剪贴板的数据，也可以写文件名；header=T，表示第一行是列名；sep = “\t”指定分隔符类型为制表符，sep = “,”表示分隔符为逗号，sep = “ “表示制表符为空格；row.names=1，表示第一列包含行名。</p>
<h2 id="三、绘制热图"><a href="#三、绘制热图" class="headerlink" title="三、绘制热图"></a>三、绘制热图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,color=colorRampPalette(c(<span class="string">"navy"</span>,<span class="string">"white"</span>,<span class="string">"firebrick3"</span>))(50),fontsize_row=3,fontsize_col=10)</div></pre></td></tr></table></figure>
<p>scale # 对矩阵进行标准化，这一步是必要的，尤其是数据之间差异较大时效果非常明显，scale=”row”，对行进行标准化；scale=”column“，对列进行标准化；默认为none；<br>color # 指定小格的颜色；<br>fontsize_row，指定行字号；fontsize_col，指定列字号；</p>
<h2 id="四、参数设置"><a href="#四、参数设置" class="headerlink" title="四、参数设置"></a>四、参数设置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">display_numbers=TRUE <span class="comment"># 在热图格子中展示文本</span></div><div class="line">number_format = <span class="string">"%.2f"</span> <span class="comment"># 热图中文本保留小数点后两位</span></div><div class="line">number_format = <span class="string">"%.1e"</span> <span class="comment"># 热图中文本使用科学计数法</span></div><div class="line">number_color=<span class="string">"purple"</span> <span class="comment"># 热图中文本的颜色</span></div><div class="line">cluster_cols=F <span class="comment"># 不要对列进行聚类，默认是T</span></div><div class="line">cluster_rows=F <span class="comment"># 不要对行进行聚类，默认是T </span></div><div class="line">pheatmap(data,scale=<span class="string">"row"</span>,cellwidth=15,cellheight=12,main=<span class="string">"example heatmap"</span>,fontsize=8,filename=<span class="string">"test.pdf"</span>)</div><div class="line"><span class="comment"># cellwidth，设置格子宽度；cellheight，设置格子高度</span></div><div class="line"><span class="comment"># main，设置标题；fontsize，标题字体</span></div><div class="line"><span class="comment"># filename，直接指定保存为文件，支持格式png, pdf, tiff, bmp, jpeg</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一、安装pheatmap&quot;&gt;&lt;a href=&quot;#一、安装pheatmap&quot; class=&quot;headerlink&quot; title=&quot;一、安装pheatmap&quot;&gt;&lt;/a&gt;一、安装pheatmap&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;t
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ学习流程</title>
    <link href="http://uteric.github.io/RNASEQ%E5%AD%A6%E4%B9%A0%E6%B5%81%E7%A8%8B/"/>
    <id>http://uteric.github.io/RNASEQ学习流程/</id>
    <published>2018-05-22T04:33:04.000Z</published>
    <updated>2018-05-22T04:33:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考文献：<a href="https://link.jianshu.com/?t=http://www.nature.com/nprot/journal/v11/n9/full/nprot.2016.095.html" target="_blank" rel="external">Transcript-level expression analysis of RNA-seq experiments with HISAT, StringTie and Ballgown</a></p>
<hr>
<h2 id="一、下载数据并解压"><a href="#一、下载数据并解压" class="headerlink" title="一、下载数据并解压"></a>一、下载数据并解压</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/RNAseq_protocol/chrX_data.tar.gz <span class="comment"># 下载原始数据</span></div><div class="line">tar zxvf chrX_data.tar.gz <span class="comment"># 解压</span></div></pre></td></tr></table></figure>
<p>解压后在当前目录下生成新文件夹chrX_data，里面包含如下文件：</p>
<p>drwxr-xr-x   3 xiuliliu  staff  102 Jul 12  2016 genes<br>drwxr-xr-x   3 xiuliliu  staff  102 Jan 14  2016 genome<br>-rw-r–r–   1 xiuliliu  staff  337 Jan 14  2016 geuvadis_phenodata.csv<br>drwxr-xr-x  10 xiuliliu  staff  340 Jan 14  2016 indexes<br>-rw-r–r–   1 xiuliliu  staff  228 Jan 14  2016 mergelist.txt<br>drwxr-xr-x  26 xiuliliu  staff  884 Jan 14  2016 samples</p>
<p>其中，samples中包含24个.fastq.gz文件，分为12对，从GBR和YRI两地各取6个样，男女各3个，构成基本的生物学重复。</p>
<p>-rw-r–r–  1 xiuliliu  staff   91425269 Jan 14  2016 ERR188044_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   91314392 Jan 14  2016 ERR188044_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   87664981 Jan 14  2016 ERR188104_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   88268450 Jan 14  2016 ERR188104_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff  112984506 Jan 14  2016 ERR188234_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff  114271070 Jan 14  2016 ERR188234_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   61157734 Jan 14  2016 ERR188245_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   62378428 Jan 14  2016 ERR188245_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   67433106 Jan 14  2016 ERR188257_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   68213815 Jan 14  2016 ERR188257_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   39876761 Jan 14  2016 ERR188273_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   40639110 Jan 14  2016 ERR188273_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   91600737 Jan 14  2016 ERR188337_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   92210453 Jan 14  2016 ERR188337_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   66033878 Jan 14  2016 ERR188383_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   65623043 Jan 14  2016 ERR188383_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   90165491 Jan 14  2016 ERR188401_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   90548373 Jan 14  2016 ERR188401_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   57960187 Jan 14  2016 ERR188428_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   58159176 Jan 14  2016 ERR188428_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   73187016 Jan 14  2016 ERR188454_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   72904430 Jan 14  2016 ERR188454_chrX_2.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   77647967 Jan 14  2016 ERR204916_chrX_1.fastq.gz<br>-rw-r–r–  1 xiuliliu  staff   78167352 Jan 14  2016 ERR204916_chrX_2.fastq.gz</p>
<hr>
<h2 id="二、比对读段到基因组上-Align-the-RNA-seq-reads-to-the-genome"><a href="#二、比对读段到基因组上-Align-the-RNA-seq-reads-to-the-genome" class="headerlink" title="二、比对读段到基因组上 (Align the RNA-seq reads to the genome)"></a>二、比对读段到基因组上 (Align the RNA-seq reads to the genome)</h2><h3 id="1-Map-the-reads-for-each-sample-to-the-reference-genome"><a href="#1-Map-the-reads-for-each-sample-to-the-reference-genome" class="headerlink" title="1 | Map the reads for each sample to the reference genome"></a>1 | Map the reads for each sample to the reference genome</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR204916_chrX_1.fastq.gz -2 chrX_data/samples/ERR204916_chrX_2.fastq.gz -S ERR204916_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188454_chrX_1.fastq.gz -2 chrX_data/samples/ERR188454_chrX_2.fastq.gz -S ERR188454_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188428_chrX_1.fastq.gz -2 chrX_data/samples/ERR188428_chrX_2.fastq.gz -S ERR188428_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188401_chrX_1.fastq.gz -2 chrX_data/samples/ERR188401_chrX_2.fastq.gz -S ERR188401_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188383_chrX_1.fastq.gz -2 chrX_data/samples/ERR188383_chrX_2.fastq.gz -S ERR188383_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188337_chrX_1.fastq.gz -2 chrX_data/samples/ERR188337_chrX_2.fastq.gz -S ERR188337_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188273_chrX_1.fastq.gz -2 chrX_data/samples/ERR188273_chrX_2.fastq.gz -S ERR188273_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188257_chrX_1.fastq.gz -2 chrX_data/samples/ERR188257_chrX_2.fastq.gz -S ERR188257_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188245_chrX_1.fastq.gz -2 chrX_data/samples/ERR188245_chrX_2.fastq.gz -S ERR188245_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188234_chrX_1.fastq.gz -2 chrX_data/samples/ERR188234_chrX_2.fastq.gz -S ERR188234_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188104_chrX_1.fastq.gz -2 chrX_data/samples/ERR188104_chrX_2.fastq.gz -S ERR188104_chrX.sam</div><div class="line">&gt; hisat2 -p 8 --dta -x chrX_data/indexes/chrX_tran -1 chrX_data/samples/ERR188044_chrX_1.fastq.gz -2 chrX_data/samples/ERR188044_chrX_2.fastq.gz -S ERR188044_chrX.sam</div></pre></td></tr></table></figure>
<p>以ERR188044为例，比对结果如下：</p>
<p>1321477 reads; of these:<br>1321477 (100.00%) were paired; of these:<br>121769 (9.21%) aligned concordantly 0 times<br>1183443 (89.55%) aligned concordantly exactly 1 time</p>
<h2 id="16265-1-23-aligned-concordantly-gt-1-times"><a href="#16265-1-23-aligned-concordantly-gt-1-times" class="headerlink" title="16265 (1.23%) aligned concordantly &gt;1 times"></a>16265 (1.23%) aligned concordantly &gt;1 times</h2><p>121769 pairs aligned concordantly 0 times; of these:</p>
<h2 id="4200-3-45-aligned-discordantly-1-time"><a href="#4200-3-45-aligned-discordantly-1-time" class="headerlink" title="4200 (3.45%) aligned discordantly 1 time"></a>4200 (3.45%) aligned discordantly 1 time</h2><p>117569 pairs aligned 0 times concordantly or discordantly; of these:<br>235138 mates make up the pairs; of these:<br>119859 (50.97%) aligned 0 times<br>112782 (47.96%) aligned exactly 1 time<br>2497 (1.06%) aligned &gt;1 times<br>95.46% overall alignment rate</p>
<p>比对完成后生成如下SAM文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff   774297504 May  1 22:25 ERR188044_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   751836403 May  1 22:33 ERR188104_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   917023342 May  1 22:36 ERR188234_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   502043631 May  1 22:37 ERR188245_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   558972026 May  1 22:39 ERR188257_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   335808493 May  1 22:41 ERR188273_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   748130535 May  1 22:43 ERR188337_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   561738897 May  1 22:44 ERR188383_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   769125833 May  1 22:46 ERR188401_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   490343972 May  1 22:47 ERR188428_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   611111154 May  1 22:49 ERR188454_chrX.sam<br>-rw-r–r–  1 xiuliliu  staff   640234529 May  1 22:50 ERR204916_chrX.sam</p>
<hr>
<h3 id="2-Sort-and-convert-the-SAM-files-to-BAM"><a href="#2-Sort-and-convert-the-SAM-files-to-BAM" class="headerlink" title="2 | Sort and convert the SAM files to BAM"></a>2 | Sort and convert the SAM files to BAM</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">samtools sort -@ 8 -o ERR188104_chrX.bam ERR188104_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188234_chrX.bam ERR188234_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188245_chrX.bam ERR188245_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188257_chrX.bam ERR188257_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188273_chrX.bam ERR188273_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188337_chrX.bam ERR188337_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188383_chrX.bam ERR188383_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188401_chrX.bam ERR188401_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188428_chrX.bam ERR188428_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR188454_chrX.bam ERR188454_chrX.sam</div><div class="line">samtools sort -@ 8 -o ERR204916_chrX.bam ERR204916_chrX.sam</div></pre></td></tr></table></figure>
<p>运行完成后，生成对应的BAM文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff   149690318 May  1 23:25 ERR188044_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   144503638 May  1 23:26 ERR188104_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   192550220 May  1 23:27 ERR188234_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   105587796 May  1 23:28 ERR188245_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   117630914 May  1 23:29 ERR188257_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff    69857742 May  1 23:30 ERR188273_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   157532931 May  1 23:31 ERR188337_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   108256114 May  1 23:32 ERR188383_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   151150838 May  1 23:32 ERR188401_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff    97383432 May  1 23:33 ERR188428_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   121850605 May  1 23:34 ERR188454_chrX.bam<br>-rw-r–r–  1 xiuliliu  staff   131891473 May  1 23:34 ERR204916_chrX.bam</p>
<hr>
<h3 id="3-Assemble-transcripts-for-each-sample"><a href="#3-Assemble-transcripts-for-each-sample" class="headerlink" title="3 | Assemble transcripts for each sample"></a>3 | Assemble transcripts for each sample</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">conda install stringtie <span class="comment"># 安装stringtie</span></div><div class="line"><span class="comment"># [-p 8]：8个线程运行；[-G]：注释文件；[-o]：输出目录；[-l]：指定输出转录本的前缀；</span></div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188044_chrX.gtf -l ERR188044 ERR188044_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188104_chrX.gtf -l ERR188104 ERR188104_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188234_chrX.gtf -l ERR188234 ERR188234_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188245_chrX.gtf -l ERR188245 ERR188245_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188337_chrX.gtf -l ERR188337 ERR188337_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188257_chrX.gtf -l ERR188257 ERR188257_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188273_chrX.gtf -l ERR188273 ERR188273_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188383_chrX.gtf -l ERR188383 ERR188383_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188401_chrX.gtf -l ERR188401 ERR188401_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188428_chrX.gtf -l ERR188428 ERR188428_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR188454_chrX.gtf -l ERR188454 ERR188454_chrX.bam</div><div class="line">stringtie -p 8 -G chrX_data/genes/chrX.gtf -o ERR204916_chrX.gtf -l ERR204916 ERR204916_chrX.bam</div></pre></td></tr></table></figure>
<p>运行完成后，生成如下文件：</p>
<p>-rw-r–r–  1 xiuliliu  staff     1911015 May  2 22:09 ERR188044_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1905249 May  2 22:12 ERR188104_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1914897 May  2 22:13 ERR188234_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1750782 May  2 22:14 ERR188245_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1705229 May  2 22:19 ERR188257_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1487570 May  2 22:19 ERR188273_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1928401 May  2 22:17 ERR188337_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1744763 May  2 22:20 ERR188383_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1936094 May  2 22:20 ERR188401_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1617807 May  2 22:21 ERR188428_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1773237 May  2 22:21 ERR188454_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff     1818351 May  2 22:22 ERR204916_chrX.gtf</p>
<hr>
<h3 id="4-Merge-transcripts-from-all-samples"><a href="#4-Merge-transcripts-from-all-samples" class="headerlink" title="4 | Merge transcripts from all samples"></a>4 | Merge transcripts from all samples</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># [-p]：线程数；[-G]：注释文件；[-o]：输出目录</span></div><div class="line">stringtie --merge -p 8 -G chrX_data/genes/chrX.gtf -o stringtie_merged.gtf chrX_data/mergelist.txt</div></pre></td></tr></table></figure>
<p>运行完成后，生成一个新的文件：</p>
<p>stringtie_merged.gtf</p>
<hr>
<h3 id="5-Examine-how-the-transcripts-compare-with-the-reference-annotation"><a href="#5-Examine-how-the-transcripts-compare-with-the-reference-annotation" class="headerlink" title="5 | Examine how the transcripts compare with the reference annotation"></a>5 | Examine how the transcripts compare with the reference annotation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda install gffcompare <span class="comment"># 安装gffcompare</span></div><div class="line">ffcompare -r chrX_data/genes/chrX.gtf -G -o merged stringtie_merged.gtf</div></pre></td></tr></table></figure>
<p>运行完成后，生成多个文件：</p>
<p>merged.annotated.gtf<br>merged.loci<br>merged.stats<br>merged.stringtie_merged.gtf.refmap<br>merged.stringtie_merged.gtf.tmap<br>merged.tracking</p>
<hr>
<h3 id="6-Estimate-transcript-abundances-and-create-table-counts-for-Ballgown"><a href="#6-Estimate-transcript-abundances-and-create-table-counts-for-Ballgown" class="headerlink" title="6 | Estimate transcript abundances and create table counts for Ballgown"></a>6 | Estimate transcript abundances and create table counts for Ballgown</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188044/ERR188044_chrX.gtf ERR188044_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188104/ERR188104_chrX.gtf ERR188104_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188234/ERR188234_chrX.gtf ERR188234_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188245/ERR188245_chrX.gtf ERR188245_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188257/ERR188257_chrX.gtf ERR188257_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188273/ERR188273_chrX.gtf ERR188273_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188337/ERR188337_chrX.gtf ERR188337_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188383/ERR188383_chrX.gtf ERR188383_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188401/ERR188401_chrX.gtf ERR188401_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188428/ERR188428_chrX.gtf ERR188428_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR188454/ERR188454_chrX.gtf ERR188454_chrX.bam</div><div class="line">stringtie -e -B -p 8 -G stringtie_merged.gtf -o ballgown/ERR204916/ERR204916_chrX.gtf ERR204916_chrX.bam</div></pre></td></tr></table></figure>
<p>运行完成后，将生成ballgown文件夹，</p>
<p>drwxr-xr-x  8 xiuliliu  staff  272 May  2 22:58 ERR188044<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:00 ERR188104<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:01 ERR188234<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:01 ERR188245<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:02 ERR188257<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:02 ERR188273<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:03 ERR188337<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:03 ERR188383<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:04 ERR188401<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:04 ERR188428<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:05 ERR188454<br>drwxr-xr-x  8 xiuliliu  staff  272 May  2 23:06 ERR204916</p>
<p>以ERR188044为例，包含：</p>
<p>-rw-r–r–  1 xiuliliu  staff  4737232 May  2 22:58 ERR188044_chrX.gtf<br>-rw-r–r–  1 xiuliliu  staff   279338 May  2 22:58 e2t.ctab<br>-rw-r–r–  1 xiuliliu  staff   767920 May  2 22:58 e_data.ctab<br>-rw-r–r–  1 xiuliliu  staff   244338 May  2 22:58 i2t.ctab<br>-rw-r–r–  1 xiuliliu  staff   358966 May  2 22:58 i_data.ctab<br>-rw-r–r–  1 xiuliliu  staff   288682 May  2 22:58 t_data.ctab</p>
<hr>
<h2 id="三、差异分析（Differential-Expression-Analysis）"><a href="#三、差异分析（Differential-Expression-Analysis）" class="headerlink" title="三、差异分析（Differential Expression Analysis）"></a>三、差异分析（Differential Expression Analysis）</h2><h3 id="7-Load-relevant-R-packages"><a href="#7-Load-relevant-R-packages" class="headerlink" title="7 | Load relevant R packages"></a>7 | Load relevant R packages</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; R</div><div class="line">&gt; <span class="built_in">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>)</div><div class="line">&gt; biocLite(<span class="string">"ballgown"</span>)</div><div class="line">&gt; biocLite(<span class="string">"dplyr"</span>)</div><div class="line">&gt; biocLite(<span class="string">"devtools"</span>)</div><div class="line">&gt; biocLite(<span class="string">"RSkittleBrewer"</span>) <span class="comment"># 安装RSkittleBrewer，如果不行，尝试如下方法：</span></div><div class="line">&gt; devtools::install_github(<span class="string">'RSkittleBrewer'</span>, <span class="string">'alyssafrazee'</span>)</div><div class="line"><span class="comment"># 安装完成后，加载相关R包</span></div><div class="line">&gt; library(ballgown) <span class="comment"># 分析转录组差异表达</span></div><div class="line">&gt; library(RSkittleBrewer) <span class="comment"># 设置颜色</span></div><div class="line">&gt; library(genefilter) <span class="comment"># 快速计算均值和方差（means &amp; variances）</span></div><div class="line">&gt; library(dplyr) <span class="comment"># 对结果进行分类排序</span></div><div class="line">&gt; library(devtools) <span class="comment"># 安装R包</span></div></pre></td></tr></table></figure>
<h3 id="8-Load-the-phenotype-data-for-the-samples"><a href="#8-Load-the-phenotype-data-for-the-samples" class="headerlink" title="8 | Load the phenotype data for the samples"></a>8 | Load the phenotype data for the samples</h3><p>chrX_data/geuvadis_phenodata.csv中包含样品的表型数据，<strong>行为样品，列为变量。</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; pheno_data = read.csv(<span class="string">"chrX_data/geuvadis_phenodata.csv"</span>)</div></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:center">“ids”</th>
<th style="text-align:center">“sex”</th>
<th style="text-align:center">“population”</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">“ERR188044”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188104”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188234”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188245”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188257”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188273”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188337”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188383”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188401”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188428”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“GBR”</td>
</tr>
<tr>
<td style="text-align:center">“ERR188454”</td>
<td style="text-align:center">“male”</td>
<td style="text-align:center">“YRI”</td>
</tr>
<tr>
<td style="text-align:center">“ERR204916”</td>
<td style="text-align:center">“female”</td>
<td style="text-align:center">“YRI”</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="9-Read-in-expression-data"><a href="#9-Read-in-expression-data" class="headerlink" title="9 | Read in expression data"></a>9 | Read in expression data</h3><p>ballgown包含三个参数：<br><strong>dataDir，</strong>数据存储目录，本例中命名为ballgown；<br><strong>samplePattern，</strong>样本名称的特征模式，本例中为ERR；<br><strong>pData，</strong>上一步加载的表型数据；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; bg_chrX = ballgown(dataDir = <span class="string">"ballgown"</span>, samplePattern = <span class="string">"ERR"</span>, pData=pheno_data)</div></pre></td></tr></table></figure>
<h3 id="10-Filter-to-remove-low-abundance-genes"><a href="#10-Filter-to-remove-low-abundance-genes" class="headerlink" title="10 | Filter to remove low-abundance genes"></a>10 | Filter to remove low-abundance genes</h3><p>使用方差过滤掉低丰度的基因，即去掉所有样本中方差小于1的基因。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; bg_chrX_filt = subset (bg_chrX, <span class="string">"rowVars(texpr(bg_chrX)) &gt;1"</span>, genomesubset=TRUE) </div><div class="line"><span class="comment"># texpr()，在ballgown中用于提取基因表达水平；</span></div><div class="line"><span class="comment"># rowVars()，计算数组中每一行的方差；</span></div><div class="line"><span class="comment"># rowVars(texpr(bg_chrX)) &gt;1，代表提取每一行的表达数据，计算方差，并保留方差大于1的基因作为形构成子集的条件；</span></div><div class="line"><span class="comment"># subset (x, cond, genomesubset=TRUE)，x，抽取子集的对象；cond，子集的条件；genomesubset=TRUE（对象为特定基因组），FALSE（对象为特定样品）</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="11-Identify-transcripts-that-show-statistically-significant-differences-between-groups"><a href="#11-Identify-transcripts-that-show-statistically-significant-differences-between-groups" class="headerlink" title="11 | Identify transcripts that show statistically significant differences between groups"></a>11 | Identify transcripts that show statistically significant differences between groups</h3><p>识别组间有显著差异的转录本：在此特别说明，我们需要考虑由其他变量引起的表达变化。在本例中，有两个变量，即sex &amp; population，在计算男女性别（sex）之间的差异时，需要考虑族群（population）这一变量对结果的影响，即需要修正由族群引起的表达差异。因此，需要使用stattest这个功能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = stattest(bg_chrX_filt, feature=<span class="string">"transcript"</span>, covariate=<span class="string">"sex"</span>, adjustvars = c(<span class="string">"population"</span>), getFC=TRUE, meas=<span class="string">"FPKM"</span>) </div><div class="line"><span class="comment"># stattest基本语法：stattest(gown = NULL, gowntable = NULL, pData = NULL, mod = NULL, mod0 = NULL, feature = c("gene", "exon", "intron", "transcript"), meas = c("cov", "FPKM", "rcount", "ucount", "mrcount", "mcov"), timecourse = FALSE, covariate = NULL, adjustvars = NULL, gexpr = NULL, df = 4, getFC = FALSE, libadjust = NULL, log = TRUE)</span></div><div class="line"><span class="comment"># feature，申明基因特征的类型，如"gene"/"transcript"/"exon"/"intron"</span></div><div class="line"><span class="comment"># covariate，协变量，感兴趣的协变量</span></div><div class="line"><span class="comment"># adjustvars，混杂因子</span></div><div class="line"><span class="comment"># getFC=TRUE，返回针对文库规模和混杂因子进行调整后的表达倍数变化</span></div><div class="line"><span class="comment"># meas，即measurement，包括"cov"/"FPKM"/"rcount"/"ucount"/"mrcount"/"mcov"</span></div><div class="line">&gt; head (results_transcripts) <span class="comment"># 显示前6行</span></div><div class="line">&gt; tail (results_transcripts) <span class="comment"># 显示后6行</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.9705279</td>
<td style="text-align:center">0.8702505</td>
<td style="text-align:center">0.9680215</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1.8315567</td>
<td style="text-align:center">0.5824978</td>
<td style="text-align:center">0.9194471</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2.2376558</td>
<td style="text-align:center">0.5410260</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">4</td>
<td style="text-align:center">0.1745325</td>
<td style="text-align:center">0.2063035</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">5</td>
<td style="text-align:center">0.6220551</td>
<td style="text-align:center">0.2836476</td>
<td style="text-align:center">0.8997697</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">6</td>
<td style="text-align:center">0.6956666</td>
<td style="text-align:center">0.3957555</td>
<td style="text-align:center">0.8997697</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">2193</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3444</td>
<td style="text-align:center">1.5894619</td>
<td style="text-align:center">0.5488017</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2194</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3445</td>
<td style="text-align:center">1.3396594</td>
<td style="text-align:center">0.8246823</td>
<td style="text-align:center">0.9661891</td>
</tr>
<tr>
<td style="text-align:center">2195</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3446</td>
<td style="text-align:center">0.4460239</td>
<td style="text-align:center">0.5313140</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2196</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3447</td>
<td style="text-align:center">3.7182648</td>
<td style="text-align:center">0.2045574</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">2197</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.5894432</td>
<td style="text-align:center">0.5519984</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">2198</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3449</td>
<td style="text-align:center">0.9296388</td>
<td style="text-align:center">0.8386784</td>
<td style="text-align:center">0.9662358</td>
</tr>
</tbody>
</table>
<p>我们看到，results_transcripts是一个2198x5的矩阵，即在男女两组间有显著差异的转录本共2198个。</p>
<hr>
<h3 id="12-Identify-genes-that-show-statistically-significant-differences-between-groups"><a href="#12-Identify-genes-that-show-statistically-significant-differences-between-groups" class="headerlink" title="12 | Identify genes that show statistically significant differences between groups"></a>12 | Identify genes that show statistically significant differences between groups</h3><p>识别组间有显著差异的基因：同样，再次使用stattest命令，但要设置feature=”gene”，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; results_genes = stattest(bg_chrX_filt, feature=<span class="string">"gene"</span>, covariate=<span class="string">"sex"</span>, adjustvars = c(<span class="string">"population"</span>), getFC=TRUE, meas=<span class="string">"FPKM"</span>)</div><div class="line">&gt; head (results_genes) </div><div class="line">&gt; tail (results_genes)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.1</td>
<td style="text-align:center">1.0842110</td>
<td style="text-align:center">0.6894045</td>
<td style="text-align:center">0.9108614</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.10</td>
<td style="text-align:center">0.5255349</td>
<td style="text-align:center">0.2155227</td>
<td style="text-align:center">0.7052821</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.100</td>
<td style="text-align:center">1.1078716</td>
<td style="text-align:center">0.8361049</td>
<td style="text-align:center">0.9714996</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">983</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_110830</td>
<td style="text-align:center">1.2138007</td>
<td style="text-align:center">0.5460477</td>
<td style="text-align:center">0.8687917</td>
</tr>
<tr>
<td style="text-align:center">984</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_131236</td>
<td style="text-align:center">2.0266878</td>
<td style="text-align:center">0.1630176</td>
<td style="text-align:center">0.6591538</td>
</tr>
<tr>
<td style="text-align:center">985</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">NR_131237</td>
<td style="text-align:center">0.8019495</td>
<td style="text-align:center">0.6388593</td>
<td style="text-align:center">0.9074799</td>
</tr>
</tbody>
</table>
<p>总计发现985个在男女两组间有显著差异的基因。</p>
<hr>
<h3 id="13-Add-gene-names-and-gene-IDs-to-the-results-transcripts-data-frame"><a href="#13-Add-gene-names-and-gene-IDs-to-the-results-transcripts-data-frame" class="headerlink" title="13 | Add gene names and gene IDs to the results_transcripts data frame"></a>13 | Add gene names and gene IDs to the <em>results_transcripts</em> data frame</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = data.frame (geneNames=ballgown::geneNames(bg_chrX_filt), geneIDs=ballgown::geneIDs(bg_chrX_filt), results_transcripts)</div><div class="line"><span class="comment"># ballgown::geneNames，代表使用ballgown包中的geneNames函数</span></div><div class="line"><span class="comment"># ballgown::geneIDs，代表使用ballgown包中的geneIDs函数</span></div><div class="line">&gt; head (results_transcripts)</div><div class="line">&gt; tail (results_transcripts)</div></pre></td></tr></table></figure>
<p>输出如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.9705279</td>
<td style="text-align:center">0.8702505</td>
<td style="text-align:center">0.9680215</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">PLCXD1</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1.8315567</td>
<td style="text-align:center">0.5824978</td>
<td style="text-align:center">0.9194471</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.2</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2.2376558</td>
<td style="text-align:center">0.5410260</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">3447</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.1033</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3447</td>
<td style="text-align:center">3.7182648</td>
<td style="text-align:center">0.2045574</td>
<td style="text-align:center">0.8959691</td>
</tr>
<tr>
<td style="text-align:center">3448</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.1033</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.5894432</td>
<td style="text-align:center">0.5519984</td>
<td style="text-align:center">0.9174339</td>
</tr>
<tr>
<td style="text-align:center">3449</td>
<td style="text-align:center">DDX11L16</td>
<td style="text-align:center">MSTRG.1034</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">3449</td>
<td style="text-align:center">0.9296388</td>
<td style="text-align:center">0.8386784</td>
<td style="text-align:center">0.9662358</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="14-Sort-the-results-from-the-smallest-P-value-to-the-largest"><a href="#14-Sort-the-results-from-the-smallest-P-value-to-the-largest" class="headerlink" title="14 | Sort the results from the smallest P value to the largest"></a>14 | Sort the results from the smallest <em>P value</em> to the largest</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; results_transcripts = arrange(results_transcripts, pval)</div><div class="line"><span class="comment"># arrange()，是dplyr下的函数，默认状态下，按指定的列对行进行升序排列</span></div><div class="line">&gt; results_genes = arrange(results_genes, pval)</div></pre></td></tr></table></figure>
<p>排序后的results_transcripts如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1623</td>
<td style="text-align:center">0.031022135</td>
<td style="text-align:center">1.600243e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1621</td>
<td style="text-align:center">0.016352577</td>
<td style="text-align:center">3.101146e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">XIST</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1622</td>
<td style="text-align:center">0.003107383</td>
<td style="text-align:center">3.598430e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">2196</td>
<td style="text-align:center">ARMCX5</td>
<td style="text-align:center">MSTRG.650</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1990</td>
<td style="text-align:center">1.0009910</td>
<td style="text-align:center">0.9991690</td>
<td style="text-align:center">0.9994574</td>
</tr>
<tr>
<td style="text-align:center">2197</td>
<td style="text-align:center">MAP7D3</td>
<td style="text-align:center">MSTRG.888</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2848</td>
<td style="text-align:center">1.0005197</td>
<td style="text-align:center">0.9991786</td>
<td style="text-align:center">0.9994574</td>
</tr>
<tr>
<td style="text-align:center">2198</td>
<td style="text-align:center">FHL1</td>
<td style="text-align:center">MSTRG.887</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2844</td>
<td style="text-align:center">0.9993523</td>
<td style="text-align:center">0.9994574</td>
<td style="text-align:center">0.9994574</td>
</tr>
</tbody>
</table>
<p>排序后的results_genes如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">0.002374652</td>
<td style="text-align:center">2.081024e-11</td>
<td style="text-align:center">2.049809e-08</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">0.082721440</td>
<td style="text-align:center">7.853611e-06</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">3.103423470</td>
<td style="text-align:center">1.032255e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">983</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.388</td>
<td style="text-align:center">0.9989017</td>
<td style="text-align:center">0.9977412</td>
<td style="text-align:center">0.9996474</td>
</tr>
<tr>
<td style="text-align:center">984</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.86</td>
<td style="text-align:center">1.0003031</td>
<td style="text-align:center">0.9995072</td>
<td style="text-align:center">0.9996474</td>
</tr>
<tr>
<td style="text-align:center">985</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.933</td>
<td style="text-align:center">1.0002451</td>
<td style="text-align:center">0.9996474</td>
<td style="text-align:center">0.9996474</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="15-Write-the-results-to-a-csv-file-that-can-be-shared-and-distributed"><a href="#15-Write-the-results-to-a-csv-file-that-can-be-shared-and-distributed" class="headerlink" title="15 | Write the results to a csv file that can be shared and distributed"></a>15 | Write the results to a csv file that can be shared and distributed</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; write.csv(results_transcripts, <span class="string">"chrX_transcripts_results.csv"</span>, row.names=FALSE)</div><div class="line">&gt; write.csv (results_genes, <span class="string">"chrX_gene_results.csv"</span>, row.names=FALSE)</div></pre></td></tr></table></figure>
<hr>
<h3 id="16-Identify-transcripts-and-genes-with-a-q-value-lt-0-05"><a href="#16-Identify-transcripts-and-genes-with-a-q-value-lt-0-05" class="headerlink" title="16 | Identify transcripts and genes with a q value &lt;0.05"></a>16 | Identify transcripts and genes with a q value &lt;0.05</h3><p>subset(x, …)，返回向量、矩阵或数据框中满足条件的子集，x代表被子集的对象，…代表补充条件；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; subset (results_transcripts, results_transcripts<span class="variable">$qval</span> &lt; 0.05) <span class="comment"># results_transcripts$qval，代表results_transcripts数据框中的变量qval</span></div><div class="line">&gt; subset (results_genes, results_genes<span class="variable">$qval</span>&lt;0.05)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">geneNames</th>
<th style="text-align:center">geneIDs</th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1623</td>
<td style="text-align:center">0.031022135</td>
<td style="text-align:center">1.600243e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1621</td>
<td style="text-align:center">0.016352577</td>
<td style="text-align:center">3.101146e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">XIST</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1622</td>
<td style="text-align:center">0.003107383</td>
<td style="text-align:center">3.598430e-10</td>
<td style="text-align:center">2.636450e-07</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1624</td>
<td style="text-align:center">0.028430569</td>
<td style="text-align:center">4.552122e-08</td>
<td style="text-align:center">2.501391e-05</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">TSIX</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1620</td>
<td style="text-align:center">0.080804059</td>
<td style="text-align:center">2.230664e-06</td>
<td style="text-align:center">9.806001e-04</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.585</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1812</td>
<td style="text-align:center">7.403215751</td>
<td style="text-align:center">1.083185e-05</td>
<td style="text-align:center">3.968068e-03</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.734</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">2296</td>
<td style="text-align:center">0.285432112</td>
<td style="text-align:center">4.293753e-05</td>
<td style="text-align:center">1.236355e-02</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.589</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">1816</td>
<td style="text-align:center">9.079691942</td>
<td style="text-align:center">4.499928e-05</td>
<td style="text-align:center">1.236355e-02</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">.</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">415</td>
<td style="text-align:center">3.282982493</td>
<td style="text-align:center">9.861143e-05</td>
<td style="text-align:center">2.260472e-02</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">KDM6A</td>
<td style="text-align:center">MSTRG.242</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">721</td>
<td style="text-align:center">0.056618320</td>
<td style="text-align:center">1.028422e-04</td>
<td style="text-align:center">2.260472e-02</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">PNPLA4</td>
<td style="text-align:center">MSTRG.58</td>
<td style="text-align:center">transcript</td>
<td style="text-align:center">180</td>
<td style="text-align:center">0.592766066</td>
<td style="text-align:center">1.837704e-04</td>
<td style="text-align:center">3.672066e-02</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">feature</th>
<th style="text-align:center">id</th>
<th style="text-align:center">fc</th>
<th style="text-align:center">pval</th>
<th style="text-align:center">qval</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.503</td>
<td style="text-align:center">0.002374652</td>
<td style="text-align:center">2.081024e-11</td>
<td style="text-align:center">2.049809e-08</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.502</td>
<td style="text-align:center">0.082721440</td>
<td style="text-align:center">7.853611e-06</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.133</td>
<td style="text-align:center">3.103423470</td>
<td style="text-align:center">1.032255e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.585</td>
<td style="text-align:center">7.275640247</td>
<td style="text-align:center">1.132560e-05</td>
<td style="text-align:center">2.788929e-03</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.734</td>
<td style="text-align:center">0.274009446</td>
<td style="text-align:center">1.719431e-05</td>
<td style="text-align:center">3.387279e-03</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.589</td>
<td style="text-align:center">9.144287534</td>
<td style="text-align:center">4.825828e-05</td>
<td style="text-align:center">7.922401e-03</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.491</td>
<td style="text-align:center">0.638039877</td>
<td style="text-align:center">9.299543e-05</td>
<td style="text-align:center">1.308579e-02</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.58</td>
<td style="text-align:center">0.599529415</td>
<td style="text-align:center">1.561007e-04</td>
<td style="text-align:center">1.921990e-02</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.355</td>
<td style="text-align:center">0.628725310</td>
<td style="text-align:center">2.718713e-04</td>
<td style="text-align:center">2.975480e-02</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.590</td>
<td style="text-align:center">7.808856957</td>
<td style="text-align:center">3.827458e-04</td>
<td style="text-align:center">3.770046e-02</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">gene</td>
<td style="text-align:center">MSTRG.213</td>
<td style="text-align:center">1.409064890</td>
<td style="text-align:center">4.535347e-04</td>
<td style="text-align:center">4.061197e-02</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="四、绘图（Data-visualization）"><a href="#四、绘图（Data-visualization）" class="headerlink" title="四、绘图（Data visualization）"></a>四、绘图（Data visualization）</h2><h3 id="17-Make-the-plots-pretty"><a href="#17-Make-the-plots-pretty" class="headerlink" title="17 | Make the plots pretty"></a>17 | Make the plots pretty</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; tropical = c(<span class="string">'darkorange'</span>, <span class="string">'dodgerblue'</span>, <span class="string">'hotpink'</span>, <span class="string">'limegreen'</span>, <span class="string">'yellow'</span>) </div><div class="line">&gt; palette (tropical) <span class="comment">#定义调色板</span></div></pre></td></tr></table></figure>
<h3 id="18-Show-the-distribution-of-gene-abundances-across-samples-colored-by-sex"><a href="#18-Show-the-distribution-of-gene-abundances-across-samples-colored-by-sex" class="headerlink" title="18 | Show the distribution of gene abundances across samples, colored by sex"></a>18 | Show the distribution of gene abundances across samples, colored by sex</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; fpkm = texpr(bg_chrX, meas=<span class="string">"FPKM"</span>) <span class="comment"># texpr(x, meas = "FPKM")，从ballgown中抽取转录本的表达值</span></div><div class="line">&gt; fpkm = log2(fpkm+1) <span class="comment"># +1的原因是避免出现log2(0)</span></div><div class="line">&gt; boxplot(fpkm, col=as.numeric(pheno_data<span class="variable">$sex</span>), las=2, ylab=<span class="string">'log2(FPKM+1)'</span>)</div><div class="line"><span class="comment"># las=2，定义坐标轴标记为垂直，默认las=1，即水平；ylab，定义y轴；</span></div></pre></td></tr></table></figure>
<p>fpkm如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">FPKM.ERR188044</th>
<th style="text-align:center">FPKM.ERR188104</th>
<th style="text-align:center">FPKM.ERR188234</th>
<th style="text-align:center">FPKM.ERR188245</th>
<th style="text-align:center">FPKM.ERR188257</th>
<th style="text-align:center">FPKM.ERR188273</th>
<th style="text-align:center">FPKM.ERR188337</th>
<th style="text-align:center">FPKM.ERR188383</th>
<th style="text-align:center">FPKM.ERR188401</th>
<th style="text-align:center">FPKM.ERR188428</th>
<th style="text-align:center">FPKM.ERR188454</th>
<th style="text-align:center">FPKM.ERR204916</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.658196</td>
<td style="text-align:center">4.287118</td>
<td style="text-align:center">5.348706</td>
<td style="text-align:center">3.878832</td>
<td style="text-align:center">4.730237</td>
<td style="text-align:center">4.636182</td>
<td style="text-align:center">4.997749</td>
<td style="text-align:center">4.442006</td>
<td style="text-align:center">4.861568</td>
<td style="text-align:center">4.700369</td>
<td style="text-align:center">4.872868</td>
<td style="text-align:center">4.410593</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.849373</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.523984</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.747225</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.750170</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.121661</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">4.345735</td>
<td style="text-align:center">5.597809</td>
<td style="text-align:center">5.524776</td>
<td style="text-align:center">5.223788</td>
<td style="text-align:center">5.967379</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">3447</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">7.0420943</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">3.699866</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3448</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">5.2154062</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">6.646315</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
<tr>
<td style="text-align:center">3449</td>
<td style="text-align:center">1.007382</td>
<td style="text-align:center">1.979173</td>
<td style="text-align:center">1.7364404</td>
<td style="text-align:center">1.343544</td>
<td style="text-align:center">0.6354767</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">1.047157</td>
<td style="text-align:center">1.739338</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.0000000</td>
<td style="text-align:center">0.000000</td>
<td style="text-align:center">0.000000</td>
</tr>
</tbody>
</table>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-c5ff5c5b0ea9d2c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="19-Make-plots-of-individual-transcripts-across-samples"><a href="#19-Make-plots-of-individual-transcripts-across-samples" class="headerlink" title="19 | Make plots of individual transcripts across samples"></a>19 | Make plots of individual transcripts across samples</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; ballgown::transcriptNames(bg_chrX)[9] <span class="comment"># 第九个转录本的名称</span></div><div class="line"><span class="comment"># 9</span></div><div class="line"><span class="comment"># "NM_012227"</span></div><div class="line">&gt; ballgown::geneNames(bg_chrX)[9] <span class="comment"># 第九个基因的名称</span></div><div class="line"><span class="comment"># 9</span></div><div class="line"><span class="comment"># "GTPBP6"</span></div><div class="line">&gt; plot (fpkm[9,] ~ pheno_data<span class="variable">$sex</span>, border=c(1,2), main=paste(ballgown::geneNames(bg_chrX)[9],<span class="string">':'</span>,ballgown::transcriptNames(bg_chrX)[9]), pch=19, xlab=<span class="string">"Sex"</span>, ylab=<span class="string">'log2(FPKM+1)'</span>)</div><div class="line">&gt; points(fpkm[9,] ~ jitter(as.numeric(pheno_data<span class="variable">$sex</span>)), col=as.numeric(pheno_data<span class="variable">$sex</span>))</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-b64fa21011cd51e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="20-Plot-the-structure-and-expression-levels-in-a-sample-of-all-transcripts-that-share-the-same-gene-locus"><a href="#20-Plot-the-structure-and-expression-levels-in-a-sample-of-all-transcripts-that-share-the-same-gene-locus" class="headerlink" title="20 | Plot the structure and expression levels in a sample of all transcripts that share the same gene locus"></a>20 | Plot the structure and expression levels in a sample of all transcripts that share the same gene locus</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plotTranscripts(ballgown::geneIDs(bg_chrX)[1622], bg_chrX, main=c(<span class="string">'Gene XIST in sample ERR188234'</span>), sample=c(<span class="string">'ERR188234'</span>))</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-17b30d74aeb41597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="21-Plot-the-average-expression-levels-for-all-transcripts-of-a-gene-within-different-groups"><a href="#21-Plot-the-average-expression-levels-for-all-transcripts-of-a-gene-within-different-groups" class="headerlink" title="21 | Plot the average expression levels for all transcripts of a gene within different groups"></a>21 | Plot the average expression levels for all transcripts of a gene within different groups</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plotMeans (<span class="string">'MSTRG.56'</span>, bg_chrX_filt, groupvar=<span class="string">"sex"</span>, legend=FALSE)</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/4189810-db5a8b809b1ef072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;参考文献：&lt;a href=&quot;https://link.jianshu.com/?t=http://www.nature.com/nprot/journal/v11/n9/full/nprot.2016.095.html&quot; target=&quot;_blank&quot; rel=&quot;exter
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记4-随机数的产生</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/"/>
    <id>http://uteric.github.io/R语言学习笔记4/</id>
    <published>2018-04-10T04:05:30.000Z</published>
    <updated>2018-04-10T04:05:30.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、均匀分布随机数"><a href="#1、均匀分布随机数" class="headerlink" title="1、均匀分布随机数"></a>1、均匀分布随机数</h2><p>在R语言中，生成均匀分布随机数的函数是：runif()</p>
<p>基本语法：runif(n, min=0, max=1)，n表示生成的随机数的数量，min表示均匀分布的下限，max表示均匀分布的上限；在默认状态下，min=0，max=1，也可以指定。</p>
<p>例1：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; runif(10) <span class="comment"># 生成10个[0,1]上的均匀分布随机数</span></div><div class="line">[1] 0.22640211 0.44554231 0.51034146 0.43492569 0.02381349 0.16912671 0.56014004 0.67121007 0.99790301 0.72515818</div></pre></td></tr></table></figure>
<p>例2：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; runif(5,.5,3) <span class="comment"># 生成5个均匀分布随机数，并指定其分布区间[0.5,3]</span></div><div class="line">[1] 1.559970 2.113296 1.405775 2.280277 1.398960</div></pre></td></tr></table></figure>
<hr>
<h2 id="2、正态分布随机数"><a href="#2、正态分布随机数" class="headerlink" title="2、正态分布随机数"></a>2、正态分布随机数</h2><p>在R语言中，生成正态分布随机数的函数是：rnorm()</p>
<p>基本语法：rnorm(n,mean=0,sd=1)，其中，n表示随机数的数量，mean表示正太分布的均值，默认为0，sd表示正太分布的标准差，默认为1；</p>
<p>例3：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=rnorm(100) <span class="comment"># 生成100个均值为0，标准差为1的正态分布随机数</span></div><div class="line">&gt; hist(x,prob=T,main=<span class="string">"normal mu=0,sigma=1"</span>) <span class="comment"># 作概率直方图</span></div><div class="line">&gt; curve(dnorm(x),add=T) <span class="comment"># 添加正态分布的密度函数线</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="3、二项分布随机数"><a href="#3、二项分布随机数" class="headerlink" title="3、二项分布随机数"></a>3、二项分布随机数</h2><p>在R语言中，生成二项分布随机数的函数是：rbinom()</p>
<p>基本语法：rbinom(n,size,prob)，n表示生成的随机数的数量（代表试验成功的次数，涵义解释参见《<a href="https://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/">R语言学习笔记3-生成二项分布随机数</a>》），size表示进行伯努利试验的次数，prob表示一次伯努利试验成功的概率。</p>
<p>例4：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; rbinom(20,100,.5)</div><div class="line">[1] 52 53 45 52 43 53 56 47 53 51 53 51 50 51 48 51 48 48 51 52</div></pre></td></tr></table></figure>
<hr>
<h2 id="4、指数分布随机数"><a href="#4、指数分布随机数" class="headerlink" title="4、指数分布随机数"></a>4、指数分布随机数</h2><p>在R语言中，生成指数分布随机数的函数是rexp()</p>
<p>基本语法：rexp(n,lamda=1)，n表示生成的指数分布随机数的数量，lamda表示指数分布随机数的均值的倒数，即lamda=1/mean，默认为1，即默认生成均值为10的随机数。</p>
<p>例5：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=rexp(100) <span class="comment"># 生成100个均值为1的指数分布随机数</span></div><div class="line">&gt; mean(x) <span class="comment"># 查看均值，约为1</span></div><div class="line">[1] 1.1335</div></pre></td></tr></table></figure>
<p>例6：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; x=rexp(100,1/10) <span class="comment"># 生成100个均值为10的指数分布随机数</span></div><div class="line">&gt; mean(x)</div><div class="line">[1] 10.50919</div><div class="line">&gt; x=rexp(100,.1) <span class="comment"># .1同1/10</span></div><div class="line">&gt; mean(x)</div><div class="line">[1] 9.366332</div><div class="line">&gt; hist(x,prob=T,col=gray(.9),main=<span class="string">"mean=10"</span>) <span class="comment"># 作直方图</span></div><div class="line">&gt; curve(dexp(x,1/10),add=T) <span class="comment"># 添加指数分布密度线</span></div></pre></td></tr></table></figure>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、均匀分布随机数&quot;&gt;&lt;a href=&quot;#1、均匀分布随机数&quot; class=&quot;headerlink&quot; title=&quot;1、均匀分布随机数&quot;&gt;&lt;/a&gt;1、均匀分布随机数&lt;/h2&gt;&lt;p&gt;在R语言中，生成均匀分布随机数的函数是：runif()&lt;/p&gt;
&lt;p&gt;基本语法：ru
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记3-生成二项分布随机数</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/"/>
    <id>http://uteric.github.io/R语言学习笔记3/</id>
    <published>2018-04-07T23:31:44.000Z</published>
    <updated>2018-04-07T23:31:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="伯努利试验"><a href="#伯努利试验" class="headerlink" title="伯努利试验"></a>伯努利试验</h2><p>首先简单介绍一下<strong>伯努利试验（Bernoulli experiment）</strong>。</p>
<p>伯努利试验，是指在同样的条件下，重复地，相互独立地，进行的一种随机试验，该随机试验只有两种结果：<del>发生或不发生</del>。</p>
<p>假设：该项试验重复独立地进行了N次，则称为<strong>N重伯努利试验</strong>，N即为该试验的SIZE。</p>
<p><del>比如，连续抛N次硬币，每次抛硬币相互独立互不影响，结果只能是“正面”或者“反面”，得到正面的概率为0.5，每次抛硬币的试验即为伯努利试验。</del></p>
<hr>
<h2 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h2><p>多次伯努利试验的分布概率，即为二项分布；换句话说，当二项分布的试验次数为1时，符合伯努利试验。</p>
<hr>
<h2 id="生成二项分布随机数"><a href="#生成二项分布随机数" class="headerlink" title="生成二项分布随机数"></a>生成二项分布随机数</h2><p>在R语言中，生成二项分布随机数的函数是：<strong>rbinom()</strong></p>
<p>基本语法：rbinom(n,size,prob)，n表示生成的随机数的数量，size表示进行伯努利试验的次数，prob表示一次伯努利试验成功的概率。</p>
<p>仍以抛硬币为例，总共抛硬币100次（size=100），得到正面记为成功，即每次成功概率为0.5（prob=0.5），那么，n的含义是什么呢？现在，我们让计算机模拟30个随机数，看看这30个数字有何特点，据此来解释n的含义。</p>
<p>在本例中，n=30，size=100，prob=0.5，在R中输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rbinom(30,100,.5) <span class="comment"># 小数点前的0可以省略</span></div><div class="line">[1] 52 39 45 53 51 53 52 43 50 51 52 48 56 47 43 53 47 47 52 53 49 43 51 50 44 57 54 59 43 48</div></pre></td></tr></table></figure>
<p>仔细观察就会发现，生成的30个随机数都在50左右徘徊，这是为什么呢？因为每次伯努利试验（抛硬币）的成功概率是0.5，那么在理想状态下，模拟100次伯努利试验（抛100次硬币），成功的次数应为50次，由此可见，在函数rbinom()中，<strong>n的含义是伯努利试验成功的次数</strong>。</p>
<p>可以想见，如果模拟伯努利试验的次数减少，n值的偏差将会变大，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; rbinom(10,10,.5)</div><div class="line">[1] 5 6 6 4 4 4 3 5 6 8</div></pre></td></tr></table></figure>
<p>在本例中，单次试验的成功概率依旧为0.5，但是只模拟10次试验，并生成10个随机数，最大的数为8，远远偏离预期的5。</p>
<p>注意：在rbinom()函数中，n可以大于size，比如rbinom(100,10,.5)。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;伯努利试验&quot;&gt;&lt;a href=&quot;#伯努利试验&quot; class=&quot;headerlink&quot; title=&quot;伯努利试验&quot;&gt;&lt;/a&gt;伯努利试验&lt;/h2&gt;&lt;p&gt;首先简单介绍一下&lt;strong&gt;伯努利试验（Bernoulli experiment）&lt;/strong&gt;。&lt;/p&gt;

    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>R语言学习笔记2</title>
    <link href="http://uteric.github.io/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/"/>
    <id>http://uteric.github.io/R语言学习笔记2/</id>
    <published>2018-04-07T22:15:58.000Z</published>
    <updated>2018-04-07T22:15:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、数学运算（Arithmetic-Operators）"><a href="#1、数学运算（Arithmetic-Operators）" class="headerlink" title="1、数学运算（Arithmetic Operators）"></a>1、数学运算（Arithmetic Operators）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># BASIC ARITHMETIC OPERATORS</span></div><div class="line">&gt; 2-5+1 <span class="comment"># 加减法</span></div><div class="line">[1] -2</div><div class="line">&gt; 6/3*2 <span class="comment"># 乘除法</span></div><div class="line">[1] 4</div><div class="line">&gt; 3+2*5 <span class="comment"># 混合运算</span></div><div class="line">[1] 13</div><div class="line">&gt; 4^3 <span class="comment"># 4的3次方，^代表乘幂</span></div><div class="line">[1] 64</div><div class="line">&gt; exp(4) <span class="comment"># 自然常数e的乘幂，即e^4</span></div><div class="line">[1] 54.59815</div><div class="line">&gt; <span class="built_in">log</span>(2.742) <span class="comment"># 某数的自然对数</span></div><div class="line">[1] 1.008688</div><div class="line">&gt; log10(1000) <span class="comment"># 某数以10为底的对数</span></div><div class="line">[1] 3</div><div class="line">&gt; pi <span class="comment"># 圆周率π</span></div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="2、变量（Variables）"><a href="#2、变量（Variables）" class="headerlink" title="2、变量（Variables）"></a>2、变量（Variables）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VARIABLES</span></div><div class="line">x &lt;- 3 <span class="comment"># 将3储存到变量x</span></div><div class="line">x <span class="comment"># 输出x，也可以使用print(x)</span></div><div class="line">[1] 3</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根</span></div><div class="line">[1] 1.732051</div><div class="line">&gt; x^4 <span class="comment"># 指定次方</span></div><div class="line">[1] 81</div><div class="line">&gt; <span class="built_in">log</span>(x) <span class="comment"># 自然对数</span></div><div class="line">[1] 1.098612</div><div class="line">&gt; log10(x) <span class="comment"># 以10为底对数</span></div><div class="line">[1] 0.4771213</div><div class="line">&gt; exp(x) 自然常数的指定次方</div><div class="line">[1] 20.08554</div><div class="line">&gt; tan(x) <span class="comment"># tan</span></div><div class="line">[1] -0.1425465</div><div class="line">&gt; y &lt;- pi <span class="comment"># 将圆周率π的值储存为变量y</span></div><div class="line">&gt; y</div><div class="line">[1] 3.141593</div></pre></td></tr></table></figure>
<h2 id="3、向量（VECTORS）"><a href="#3、向量（VECTORS）" class="headerlink" title="3、向量（VECTORS）"></a>3、向量（VECTORS）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># VECTORS</span></div><div class="line">&gt; x &lt;- c(2,3,5,1,4,4) <span class="comment"># 创建向量x，值为（2,3,5,1,4,4) </span></div><div class="line">&gt; x</div><div class="line">[1] 2 3 5 1 4 4</div><div class="line">&gt; sum(x) <span class="comment"># 求和</span></div><div class="line">[1] 19</div><div class="line">&gt; mean(x) <span class="comment"># 平均值</span></div><div class="line">[1] 3.166667</div><div class="line">&gt; sd(x) <span class="comment"># 标准差</span></div><div class="line">[1] 1.47196</div><div class="line">&gt; median(x) <span class="comment"># 中位数</span></div><div class="line">[1] 3.5</div><div class="line">&gt; sqrt(x) <span class="comment"># 平方根 </span></div><div class="line">[1] 1.414214 1.732051 2.236068 1.000000 2.000000 2.000000</div><div class="line">&gt; x^2 <span class="comment"># 指定次方</span></div><div class="line">[1]  4  9 25  1 16 16</div><div class="line">&gt; seq(1,10) <span class="comment"># 创建向量，从1开始，每次增加1，至10结束；或者使用seq(1:10)</span></div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10</div><div class="line">&gt; seq(1,10,2) <span class="comment"># 创建向量，从1开始，每次增加2，至10结束；或者使用seq(1,10,by=2)</span></div><div class="line">[1] 1 3 5 7 9</div><div class="line">&gt; z &lt;- c(1:12,0,-6) <span class="comment"># 将值添加到向量中</span></div><div class="line">&gt; z</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12  0 -6</div><div class="line">------------------------------------------------------</div><div class="line">&gt; x &lt;- c(-5,0,7,-6,14,27) <span class="comment"># 创建向量</span></div><div class="line">&gt; x</div><div class="line">[1] -5  0  7 -6 14 27</div><div class="line">&gt; x[1] <span class="comment"># 输出第一个元素</span></div><div class="line">[1] -5</div><div class="line">&gt; x[7] <span class="comment"># 输出第七个元素，因为x向量一共6个元素，因此返回NA</span></div><div class="line">[1] NA</div><div class="line">&gt; length(x) <span class="comment"># x向量的元素个数</span></div><div class="line">[1] 6</div><div class="line">&gt; x[length(x)] <span class="comment"># 输出最后一个元素</span></div><div class="line">[1] 27</div><div class="line">&gt; x[-1] <span class="comment"># 输出除第一个以外的其他元素</span></div><div class="line">[1]  0  7 -6 14 27</div><div class="line">&gt; x <span class="comment"># 注意，上述操作并不改变x向量的组成</span></div><div class="line">[1] -5  0  7 -6 14 27 </div><div class="line">&gt; x[c(2,3)] <span class="comment"># 输出第二第三个元素</span></div><div class="line">[1] 0 7</div><div class="line">&gt; x[-c(2,3)] <span class="comment"># 输出除第二第三以外的其他元素</span></div><div class="line">[1] -5 -6 14 27</div><div class="line">&gt; x[2] &lt;- 5 <span class="comment"># 修改第二个元素为5</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27</div><div class="line">&gt; x[7] &lt;-3 <span class="comment"># 修改第七个元素为3，若不存在则添加</span></div><div class="line">&gt; x</div><div class="line">[1] -5  5  7 -6 14 27  3</div><div class="line">&gt; x[c(1,4)] &lt;- c(2,3) <span class="comment"># 同时修改多个元素</span></div><div class="line">&gt; x</div><div class="line">[1]  2  5  7  3 14 27  3</div><div class="line">&gt; x &lt;3 <span class="comment"># 给出逻辑判断</span></div><div class="line">[1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</div><div class="line">&gt; <span class="built_in">which</span>(x&lt;3) <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的位置</span></div><div class="line">[1] 1</div><div class="line">&gt; x[x&lt;3] <span class="comment"># 逻辑判断，并给出判定为TRUE的元素的值</span></div><div class="line">[1] 2</div></pre></td></tr></table></figure>
<h2 id="4、矩阵（MATRIX"><a href="#4、矩阵（MATRIX" class="headerlink" title="4、矩阵（MATRIX)"></a>4、矩阵（MATRIX)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># MATRIX</span></div><div class="line">&gt; matrix(1:20,nrow=4,ncol=5) <span class="comment"># 创建矩阵，从1到20，共20个元素，4行5列，按列填充</span></div><div class="line">[,1] [,2] [,3] [,4] [,5]</div><div class="line">[1,]    1    5    9   13   17</div><div class="line">[2,]    2    6   10   14   18</div><div class="line">[3,]    3    7   11   15   19</div><div class="line">[4,]    4    8   12   16   20</div><div class="line">&gt; matrix(1:30,5,6) <span class="comment"># 简化输入方式</span></div><div class="line">[,1] [,2] [,3] [,4] [,5] [,6]</div><div class="line">[1,]    1    6   11   16   21   26</div><div class="line">[2,]    2    7   12   17   22   27</div><div class="line">[3,]    3    8   13   18   23   28</div><div class="line">[4,]    4    9   14   19   24   29</div><div class="line">[5,]    5   10   15   20   25   30</div></pre></td></tr></table></figure>
<h2 id="5、作图（GRAPHING）"><a href="#5、作图（GRAPHING）" class="headerlink" title="5、作图（GRAPHING）"></a>5、作图（GRAPHING）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRAPHING</span></div><div class="line"><span class="comment"># 创建2个长度为29的向量x，y</span></div><div class="line">&gt; x &lt;- c(2,4,4,6,6,5,5,7,3,7,3,8,9,7,9,6,4,3,4,4,6,2,2,1,2,4,6,6,8)</div><div class="line">&gt; y &lt;- c(1:29)</div><div class="line">&gt; x</div><div class="line">[1] 2 4 4 6 6 5 5 7 3 7 3 8 9 7 9 6 4 3 4 4 6 2 2 1 2 4 6 6 8</div><div class="line">&gt; y</div><div class="line">[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29</div><div class="line">&gt; hist(x) <span class="comment"># x的直方图</span></div><div class="line">&gt; hist(y) <span class="comment"># y的直方图</span></div><div class="line">&gt; plot(x) <span class="comment"># 散点图</span></div><div class="line">&gt; plot(x,<span class="built_in">type</span>=<span class="string">"b"</span>) <span class="comment"># 带连线的散点图，指示顺序</span></div><div class="line">&gt; plot(x,y) <span class="comment"># 二维散点图</span></div><div class="line">&gt; boxplot(x) <span class="comment"># 箱线图</span></div><div class="line">&gt; boxplot(x,y) <span class="comment"># 两个向量的箱线图</span></div><div class="line">&gt; pie(x) <span class="comment"># 饼图</span></div><div class="line">&gt; y &lt;- rbinom(20,12,.4) <span class="comment"># rbinom可生成随机数，语法为rbinom(n, size, prob)，即产生n个b(size,prob)的二项分布随机数</span></div><div class="line">&gt; hist(y) <span class="comment"># 可以看到，生成的直方图不是经典的二项分布</span></div><div class="line">&gt; y &lt;- rbinom(200,12,.4) <span class="comment"># 生成200个随机数，符合二项分布</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、数学运算（Arithmetic-Operators）&quot;&gt;&lt;a href=&quot;#1、数学运算（Arithmetic-Operators）&quot; class=&quot;headerlink&quot; title=&quot;1、数学运算（Arithmetic Operators）&quot;&gt;&lt;/a&gt;1、
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="R语言" scheme="http://uteric.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>RNASEQ分析入门笔记8-使用DESeq2进行表达差异分析</title>
    <link href="http://uteric.github.io/RNASEQ%E4%BD%BF%E7%94%A8DESeq2%E8%BF%9B%E8%A1%8C%E8%A1%A8%E8%BE%BE%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90/"/>
    <id>http://uteric.github.io/RNASEQ使用DESeq2进行表达差异分析/</id>
    <published>2018-04-06T04:11:52.000Z</published>
    <updated>2018-04-06T04:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：</p>
<p><strong>1、在R中安装DESeq2软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> (<span class="string">"http://bioconductor.org/biocLite.R"</span>) <span class="comment"># 调入安装工具Bioconductor</span></div><div class="line">biocLite(<span class="string">"DESeq2"</span>) <span class="comment"># 安装DESeq2</span></div><div class="line">library(<span class="string">"DESeq2"</span>) <span class="comment"># 测试是否安装成功</span></div></pre></td></tr></table></figure>
<p>如果安装出错，请移步前文：《<a href="https://uteric.github.io/MAC%E5%AE%89%E8%A3%85DESeq2%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">MAC安装DESeq2报错及解决方案</a>》，作为一个生信小白，我花了3天时间才把安装DESeq2的问题解决，一路全是坑啊！</p>
<hr>
<p><strong>2、导入分析数据</strong></p>
<p>我们还是使用《<a href="https://uteric.github.io/RNASEQ%20HTSeq%E5%AE%9A%E9%87%8F%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/">RNASEQ分析入门笔记7-HTSeq定量基因表达水平</a>》中得到的数据进行分析，首先回顾一下：</p>
<p>上文中，我们得到了raw_count_filt2矩阵，格式如下（执行：tail (raw_count_filt2, n=5):</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ENSMUSG00000110420</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110421</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110422</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110423</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">ENSMUSG00000110424</td>
<td style="text-align:center">26</td>
<td style="text-align:center">20</td>
<td style="text-align:center">48</td>
<td style="text-align:center">24</td>
</tr>
</tbody>
</table>
<p>可以看到，该矩阵实际只有4列，是由整数组成的，而最前面的一列是行名，可以直接从保存的.csv文件中导入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt2 &lt;- read.csv (<span class="string">"raw_count_filt2.csv"</span>)  <span class="comment"># 从保存的.csv文件导入数据，并赋值给raw_count_filt2</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>3、加载DESeq2并设置样品信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(DESeq2) <span class="comment"># 加载DESeq2包</span></div><div class="line">countData &lt;- raw_count_filt2 <span class="comment"># 表达矩阵</span></div><div class="line">condition &lt;- factor(c(<span class="string">"control"</span>,<span class="string">"control"</span>,<span class="string">"KD"</span>,<span class="string">"KD"</span>)) <span class="comment"># 定义condition</span></div><div class="line">colData &lt;- data.frame(row.names=colnames(countData), condition) <span class="comment"># 样品信息矩阵</span></div></pre></td></tr></table></figure>
<p>condition：</p>
<blockquote>
<p>[1] control control KD      KD<br>Levels: KD control</p>
</blockquote>
<p>colData：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">condition</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">control1</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">control2</td>
<td style="text-align:center">control</td>
</tr>
<tr>
<td style="text-align:center">rep1</td>
<td style="text-align:center">KD</td>
</tr>
<tr>
<td style="text-align:center">rep2</td>
<td style="text-align:center">KD</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>4、构建dds矩阵</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData, DataFrame(condition), design= ~ condition ) <span class="comment"># 构建dds矩阵</span></div><div class="line">head(dds) <span class="comment"># 查看dds矩阵的前6行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>class: DESeqDataSet<br>dim: 6 4<br>metadata(1): version<br>assays(1): counts<br>rownames(6): ENSMUSG00000000001 ENSMUSG00000000003 …<br>ENSMUSG00000000037 ENSMUSG00000000049<br>rowData names(0):<br>colnames(4): control1 control2 rep1 rep2<br>colData names(1): condition</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dds2 &lt;- DESeq(dds) <span class="comment"># 对dds进行Normalize</span></div></pre></td></tr></table></figure>
<p>运行成功会有如下提示：</p>
<blockquote>
<p>estimating size factors<br>estimating dispersions<br>gene-wise dispersion estimates<br>mean-dispersion relationship<br>final dispersion estimates<br>fitting model and testing</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">resultsNames（dds) <span class="comment"># 查看结果的名称</span></div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “Intercept”               “condition_control_vs_KD”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res &lt;- results(dds) <span class="comment"># 使用results()函数获取结果，并赋值给res</span></div><div class="line">head (res, n=5) <span class="comment"># 查看res矩阵的前5行</span></div></pre></td></tr></table></figure>
<p>输出的res矩阵有6列，分别是：baseMean，log2FoldChange，lfcSE，pvalue，padj：</p>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..0001</td>
<td style="text-align:center">2359.75391</td>
<td style="text-align:center">-0.08461265</td>
<td style="text-align:center">0.2081281</td>
<td style="text-align:center">-0.4065413</td>
<td style="text-align:center">0.68434494</td>
<td style="text-align:center">0.9040654</td>
</tr>
<tr>
<td style="text-align:center">E..0003</td>
<td style="text-align:center">0.00000</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
<td style="text-align:center">NA</td>
</tr>
<tr>
<td style="text-align:center">E..0028</td>
<td style="text-align:center">1027.82363</td>
<td style="text-align:center">0.03638541</td>
<td style="text-align:center">0.2036829</td>
<td style="text-align:center">0.1786375</td>
<td style="text-align:center">0.85822232</td>
<td style="text-align:center">0.9618582</td>
</tr>
<tr>
<td style="text-align:center">E..0031</td>
<td style="text-align:center">65.37333</td>
<td style="text-align:center">0.94588315</td>
<td style="text-align:center">0.4428518</td>
<td style="text-align:center">2.1358912</td>
<td style="text-align:center">0.03268828</td>
<td style="text-align:center">0.2511131</td>
</tr>
<tr>
<td style="text-align:center">E..0037</td>
<td style="text-align:center">69.75843</td>
<td style="text-align:center">0.11587980</td>
<td style="text-align:center">0.4400431</td>
<td style="text-align:center">0.2633374</td>
<td style="text-align:center">0.79229054</td>
<td style="text-align:center">0.9422796</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mcols(res,use.names= TRUE) <span class="comment"># 查看res矩阵每一列的含义</span></div></pre></td></tr></table></figure>
<blockquote>
<p>DataFrame with 6 rows and 2 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">type</th>
<th style="text-align:center">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><character></character></td>
<td style="text-align:center"><character></character></td>
</tr>
<tr>
<td style="text-align:center">baseMean</td>
<td style="text-align:center">intermediate</td>
<td style="text-align:center">mean of normalized counts for all samples</td>
</tr>
<tr>
<td style="text-align:center">log2FoldChange</td>
<td style="text-align:center">results</td>
<td style="text-align:center">log2 fold change (MLE): condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">lfcSE</td>
<td style="text-align:center">results</td>
<td style="text-align:center">standard error: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">stat</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald statistic: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">pvalue</td>
<td style="text-align:center">results</td>
<td style="text-align:center">Wald test p-value: condition control vs KD</td>
</tr>
<tr>
<td style="text-align:center">padj</td>
<td style="text-align:center">results</td>
<td style="text-align:center">BH adjusted p-values</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary(res) <span class="comment"># 对res矩阵进行总结</span></div></pre></td></tr></table></figure>
<blockquote>
<p>out of 28335 with nonzero total read count<br>adjusted p-value &lt; 0.1<br>LFC &gt; 0 (up)     : 445, 1.6%<br>LFC &lt; 0 (down)   : 625, 2.2%<br>outliers [1]     : 0, 0%<br>low counts [2]   : 12683, 45%<br>(mean count &lt; 18)<br>[1] see ‘cooksCutoff’ argument of ?results<br>[2] see ‘independentFiltering’ argument of ?results</p>
</blockquote>
<p>其中，445个基因表达上调，625个基因表达下降，可靠程度是：p-value &lt; 0.1</p>
<hr>
<p><strong>5、提取差异分析结果</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">table(res<span class="variable">$padj</span>&lt;0.05) <span class="comment"># 取padj小于0.05的数据，得到743行</span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">FALSE</th>
<th style="text-align:center">TRUE</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">14909</td>
<td style="text-align:center">743</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res &lt;- res[order(res<span class="variable">$padj</span>),] <span class="comment"># 按照padj的大小将res重新排列</span></div><div class="line">diff_gene_deseq2 &lt;- subset(res,padj &lt; 0.05 &amp; (log2FoldChange &gt;1 | log2FoldChange &lt; -1)) <span class="comment"># 获取padj小于0.05，表达倍数取以2为对数后绝对值大于1的差异表达基因，赋值给diff_gene_deseq2</span></div><div class="line">head (diff_gene_deseq2, n=5) <span class="comment"># 查看diff_gene_deseq2矩阵的前5行</span></div></pre></td></tr></table></figure>
<blockquote>
<p>log2 fold change (MLE): condition control vs KD<br>Wald test p-value: condition control vs KD<br>DataFrame with 5 rows and 6 columns</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FoldChange</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
<td style="text-align:center"><numeric></numeric></td>
</tr>
<tr>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
</tr>
<tr>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
</tr>
<tr>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
</tr>
<tr>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
<tr>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">diff_gene_deseq2 &lt;- row.names(diff_gene_deseq2) <span class="comment"># 提取diff_gene_deseq2的行名</span></div><div class="line">head (diff_gene_deseq2, n=5)</div></pre></td></tr></table></figure>
<blockquote>
<p>[1] “ENSMUSG00000003309”<br>[2] “ENSMUSG00000046323”<br>[3] “ENSMUSG00000001123”<br>[4] “ENSMUSG00000018569”<br>[5] “ENSMUSG00000023906”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">resdata &lt;- merge (as.data.frame(res),as.data.frame(counts(dds,normalize=TRUE)),by=<span class="string">"row.names"</span>,sort=FALSE)</div><div class="line">head (resdata,n=5)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Row.names</th>
<th style="text-align:center">baseMean</th>
<th style="text-align:center">log2FC</th>
<th style="text-align:center">lfcSE</th>
<th style="text-align:center">stat</th>
<th style="text-align:center">pvalue</th>
<th style="text-align:center">padj</th>
<th style="text-align:center">control1</th>
<th style="text-align:center">control2</th>
<th style="text-align:center">rep1</th>
<th style="text-align:center">rep2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">E..3309</td>
<td style="text-align:center">548.1926</td>
<td style="text-align:center">3.231612</td>
<td style="text-align:center">0.2658125</td>
<td style="text-align:center">12.157487</td>
<td style="text-align:center">5.234431e-34</td>
<td style="text-align:center">8.192931e-30</td>
<td style="text-align:center">1073.9977</td>
<td style="text-align:center">908.7239</td>
<td style="text-align:center">125.93083</td>
<td style="text-align:center">84.11803</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">E..6323</td>
<td style="text-align:center">404.1894</td>
<td style="text-align:center">3.067051</td>
<td style="text-align:center">0.2628220</td>
<td style="text-align:center">11.669689</td>
<td style="text-align:center">1.820880e-31</td>
<td style="text-align:center">1.425021e-27</td>
<td style="text-align:center">723.4828</td>
<td style="text-align:center">721.5049</td>
<td style="text-align:center">97.10329</td>
<td style="text-align:center">74.66657</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">E..1123</td>
<td style="text-align:center">341.8542</td>
<td style="text-align:center">2.797485</td>
<td style="text-align:center">0.2766499</td>
<td style="text-align:center">10.112006</td>
<td style="text-align:center">4.887336e-24</td>
<td style="text-align:center">2.549886e-20</td>
<td style="text-align:center">679.8243</td>
<td style="text-align:center">515.6735</td>
<td style="text-align:center">84.96538</td>
<td style="text-align:center">86.95347</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">E..8569</td>
<td style="text-align:center">485.4839</td>
<td style="text-align:center">3.136032</td>
<td style="text-align:center">0.3312999</td>
<td style="text-align:center">9.465839</td>
<td style="text-align:center">2.912140e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1113.9140</td>
<td style="text-align:center">630.6325</td>
<td style="text-align:center">127.44807</td>
<td style="text-align:center">69.94083</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">E..3906</td>
<td style="text-align:center">951.9460</td>
<td style="text-align:center">2.382308</td>
<td style="text-align:center">0.2510718</td>
<td style="text-align:center">9.488553</td>
<td style="text-align:center">2.342631e-21</td>
<td style="text-align:center">9.116163e-18</td>
<td style="text-align:center">1862.3445</td>
<td style="text-align:center">1333.5250</td>
<td style="text-align:center">351.99943</td>
<td style="text-align:center">259.91526</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.csv(resdata, file=<span class="string">"control_vs_akap95.csv"</span>) <span class="comment"># 将结果写入control_vs_akap95.csv文件</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;基因的差异表达分析，通常使用R中的软件包，包括：DESeq2，edgeR，limma等，今天介绍DESeq2的分析流程：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1、在R中安装DESeq2软件包&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;
    
    </summary>
    
      <category term="编程语言" scheme="http://uteric.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="RNASEQ" scheme="http://uteric.github.io/tags/RNASEQ/"/>
    
  </entry>
  
</feed>
