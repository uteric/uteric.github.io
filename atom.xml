<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>诸子百家</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://uteric.github.io/"/>
  <updated>2020-08-02T18:45:10.000Z</updated>
  <id>http://uteric.github.io/</id>
  
  <author>
    <name>括囊无誉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>GEO学习笔记08-GSE40435</title>
    <link href="http://uteric.github.io/GEO/GEO08/"/>
    <id>http://uteric.github.io/GEO/GEO08/</id>
    <published>2020-08-02T18:45:10.000Z</published>
    <updated>2020-08-02T18:45:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE40435，来自捷克的101例配对样本，平台是GPL10558，包含48107个探针。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE40435'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),9),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),4),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),9),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),14),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),16),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),31),rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),4),</span><br><span class="line">                rep(c(<span class="string">'normal'</span>,<span class="string">'tumor'</span>),1),rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),8))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO52.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line"><span class="comment"># NO NEED NORMALIZATION</span></span><br><span class="line">library(limma) </span><br><span class="line"><span class="comment">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span></span><br><span class="line"><span class="comment">#boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL10558'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL10558.soft'</span>)</span><br><span class="line">GPL10558 &lt;- GEOquery::Table(gpl)</span><br><span class="line"><span class="comment">#probeset &lt;- rownames(exprSet)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- data.frame(probeset,symbol=GPL10558$ILMN_Gene,stringsAsFactors = F)</span></span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL10558<span class="variable">$ID</span>,symbol=GPL10558<span class="variable">$ILMN_Gene</span>)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=<span class="string">'probeset'</span>)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line"><span class="comment"># GENERATE PAIR INFO</span></span><br><span class="line">pair &lt;- data.frame(seq(1:101),seq(1:101))</span><br><span class="line">pair &lt;- data.frame(t(pair))</span><br><span class="line">pair &lt;- unlist(pair)</span><br><span class="line">pairinfo = factor(pair)</span><br><span class="line"></span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,UMOD,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'UMOD'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO53.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO54.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = F,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO55.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO56.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05166'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO57.png" alt></p><p><img src="/images/GEO/GEO58.png" alt></p><p><img src="/images/GEO/GEO59.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE40435，来自捷克的101例配对样本，平台是GPL10558，包含48107个探针。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记7</title>
    <link href="http://uteric.github.io/GEO/GEO07/"/>
    <id>http://uteric.github.io/GEO/GEO07/</id>
    <published>2020-08-02T04:12:41.000Z</published>
    <updated>2020-08-02T04:12:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE72922，23个样本，非配对，平台是GPL14951，然而，没有差异基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE72922'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,7),rep(<span class="string">'normal'</span>,4),rep(<span class="string">'tumor'</span>,2),rep(<span class="string">'normal'</span>,7),rep(<span class="string">'tumor'</span>,3))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO50.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"># NORMALIZATION ----</span><br><span class="line"># NO NEED NORMALIZATION</span><br><span class="line">library(limma) </span><br><span class="line">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">#boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br><span class="line"></span><br><span class="line"># LOG2 TRANSFORM ----</span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line">if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex) &#125;</span><br><span class="line">dim(exprSet)</span><br><span class="line"># ANNOTATION ----</span><br><span class="line">gpl &lt;- getGEO(&apos;GPL14951&apos;,destdir = &apos;./&apos;)</span><br><span class="line">gpl &lt;- getGEO(filename = &apos;./GPL14951.soft&apos;)</span><br><span class="line">GPL14951 &lt;- GEOquery::Table(gpl)</span><br><span class="line">#probeset &lt;- rownames(exprSet)</span><br><span class="line">#probe2symbol &lt;- data.frame(probeset,symbol=GPL14951$Symbol,stringsAsFactors = F)</span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL14951$ID,symbol=GPL14951$Symbol)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=&apos;probeset&apos;)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"># REMOVE NA ----</span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=&apos;probeset&apos;) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=&apos;probeset&apos;) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(&apos;GSM&apos;, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != &apos;NA&apos;) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = &apos;symbol&apos;)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"># DIFF EXPRESS ----</span><br><span class="line"># NO PAIRING</span><br><span class="line">design &lt;- model.matrix(~ group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf,p.value=0.05)</span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 0 0 # 没有差异基因，不必往下分析</span><br><span class="line"># PLOT ----</span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EEF1A1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=&apos;black&apos;, linetype=&apos;11&apos;) +</span><br><span class="line">  xlab(&apos;&apos;) +</span><br><span class="line">  ylab(paste(&apos;Expression of &apos;,&apos;EEF1A1&apos;))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = &apos;none&apos;)</span><br><span class="line"># COMBINE PLOT ----</span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=&apos;genesymbol&apos;) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange$genesymbol[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, function(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(&apos;pairinfo&apos;,&apos;group&apos;)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=&apos;black&apos;, linetype=&apos;11&apos;) +</span><br><span class="line">    xlab(&apos;&apos;) +</span><br><span class="line">    ylab(paste(&apos;Expression of &apos;,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = &apos;none&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br><span class="line"># HEATMAP ----</span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = &apos;row&apos;, </span><br><span class="line">         color =colorRampPalette(c(&apos;blue&apos;, &apos;white&apos;,&apos;red&apos;))(100))</span><br><span class="line"># VOLCANO PLOT ----</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=&apos;BH&apos;,coef=&apos;group_listnormal&apos;,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data$significant &lt;- as.factor(data$adj.P.Val&lt;0.05 &amp; abs(data$logFC) &gt; 1)</span><br><span class="line">data$gene &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=&apos;black&apos;)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=&apos;red&apos;)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=&apos;blue&apos;)+</span><br><span class="line">  labs(x=&apos;log2 (fold change)&apos;,y=&apos;-log10 (adj.P.Val)&apos;)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = &apos;black&apos;))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO51.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE72922，23个样本，非配对，平台是GPL14951，然而，没有差异基因&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/sp
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记6</title>
    <link href="http://uteric.github.io/GEO/GEO06/"/>
    <id>http://uteric.github.io/GEO/GEO06/</id>
    <published>2020-08-02T03:32:43.000Z</published>
    <updated>2020-08-02T03:32:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE105288，共88个样本，只选取其中的PRIMARY TUMOR与配对的正常样本，9对18个，平台是GPL10558，但是结果有些出乎意料，居然没有差异显著的基因。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE105288'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>,<span class="string">'tumor'</span>,<span class="string">'normal'</span>)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet[,-c(7:13,18:23,28:35,40:44)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO47.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line"><span class="comment"># NO NEED NORMALIZATION</span></span><br><span class="line">library(limma) </span><br><span class="line"><span class="comment">#exprSet &lt;- normalizeBetweenArrays(exprSet)</span></span><br><span class="line"><span class="comment">#boxplot(exprSet[,-c(7:13,18:23,28:35,40:44)],outline=FALSE,notch=T,col=group_list,las=2)</span></span><br><span class="line">exprSet &lt;- exprSet[,-c(7:13,18:23,28:35,40:44)]</span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL10558'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL10558.soft'</span>)</span><br><span class="line">GPL10558 &lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL10558<span class="variable">$ILMN_Gene</span>,stringsAsFactors = F)</span><br><span class="line"><span class="comment">#library(dplyr)</span></span><br><span class="line"><span class="comment">#x1 &lt;- data.frame(probeset=rownames(exprSet))</span></span><br><span class="line"><span class="comment">#x2 &lt;- data.frame(probeset=GPL6480$ID,symbol=GPL6480$GENE_SYMBOL)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- x1 %&gt;% inner_join(x2,by='probeset')</span></span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 0 0 <span class="comment"># 不用接着往下分析了，没有差异基因</span></span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EEF1A1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'EEF1A1'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO48.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">dim(data)</span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO49.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE105288，共88个样本，只选取其中的PRIMARY TUMOR与配对的正常样本，9对18个，平台是GPL10558，但是结果有些出乎意料，居然没有差异显著的基因。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;t
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记05</title>
    <link href="http://uteric.github.io/GEO/GEO05/"/>
    <id>http://uteric.github.io/GEO/GEO05/</id>
    <published>2020-08-01T22:35:05.000Z</published>
    <updated>2020-08-01T22:35:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE16449，共70个样本，选取前17对配对样本，平台是GPL6480</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE16449'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,17),rep(<span class="string">'normal'</span>,17))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet[,1:34],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO38.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet[,1:34],outline=FALSE,notch=T,col=group_list,las=2)</span><br><span class="line">exprSet &lt;- exprSet[,1:34]</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO39.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl &lt;- getGEO(<span class="string">'GPL6480'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl &lt;- getGEO(filename = <span class="string">'./GPL6480.soft'</span>)</span><br><span class="line">GPL6480 &lt;- GEOquery::Table(gpl)</span><br><span class="line"><span class="comment"># different row #, need selection</span></span><br><span class="line"><span class="comment">#probeset &lt;- rownames(exprSet)</span></span><br><span class="line"><span class="comment">#probe2symbol &lt;- data.frame(probeset,symbol=GPL6480$GENE_SYMBOL,stringsAsFactors = F)</span></span><br><span class="line">library(dplyr)</span><br><span class="line">x1 &lt;- data.frame(probeset=rownames(exprSet))</span><br><span class="line">x2 &lt;- data.frame(probeset=GPL6480<span class="variable">$ID</span>,symbol=GPL6480<span class="variable">$GENE_SYMBOL</span>)</span><br><span class="line">probe2symbol &lt;- x1 %&gt;% inner_join(x2,by=<span class="string">'probeset'</span>)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(rep(1:17,2))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,EGLN3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'EGLN3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO40.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO41.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">dim(allDiff_pair2)</span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO42.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO43.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO44.png" alt></p><p><img src="/images/GEO/GEO45.png" alt></p><p><img src="/images/GEO/GEO46.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE16449，共70个样本，选取前17对配对样本，平台是GPL6480&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记04</title>
    <link href="http://uteric.github.io/GEO/GEO04/"/>
    <id>http://uteric.github.io/GEO/GEO04/</id>
    <published>2020-08-01T22:34:54.000Z</published>
    <updated>2020-08-01T22:34:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE66271，样本共13对，平台是GPL570</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE66271'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),13)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO30.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO31.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line"><span class="comment">#ex &lt;- exprSet</span></span><br><span class="line"><span class="comment">#qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment">#LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment">#if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment">#exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment">#dim(exprSet)</span></span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL570'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL570.soft'</span>)</span><br><span class="line">GPL570&lt;- GEOquery::Table(gpl)</span><br><span class="line"></span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL570$`Gene Symbol`,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line">dim(allDiff_pair)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,TACC3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'TACC3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO32.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO33.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO34.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05169'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO35.png" alt></p><p><img src="/images/GEO/GEO36.png" alt></p><p><img src="/images/GEO/GEO37.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE66271，样本共13对，平台是GPL570&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cl
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记3</title>
    <link href="http://uteric.github.io/GEO/GEO03/"/>
    <id>http://uteric.github.io/GEO/GEO03/</id>
    <published>2020-08-01T16:55:19.000Z</published>
    <updated>2020-08-01T16:55:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析GSE66270，28个样本，14对，平台是GPL570，54675个探针。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE66270'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- rep(c(<span class="string">'tumor'</span>,<span class="string">'normal'</span>),14)</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO21.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO22.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ---- 已转化对数，略过此步</span></span><br><span class="line"><span class="comment"># ex &lt;- exprSet</span></span><br><span class="line"><span class="comment"># qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span></span><br><span class="line"><span class="comment"># LogC &lt;- (qx[5] &gt; 100) ||</span></span><br><span class="line"><span class="comment">#  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span></span><br><span class="line"><span class="comment">#  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span></span><br><span class="line"><span class="comment"># if (LogC) &#123; ex[which(ex &lt;= 0)] &lt;- NaN</span></span><br><span class="line"><span class="comment"># exprSet &lt;- log2(ex) &#125;</span></span><br><span class="line"><span class="comment"># dim(exprSet)</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL570'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL570.soft'</span>)</span><br><span class="line">GPL570&lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL570$`Gene Symbol`,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=pairinfo,</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,NDUFA4L2,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'NDUFA4L2'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO23.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO24.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">heat &lt;- na.omit(heatdata)</span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heat, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO25.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO26.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa05169'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO27.png" alt></p><p><img src="/images/GEO/GEO28.png" alt></p><p><img src="/images/GEO/GEO29.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析GSE66270，28个样本，14对，平台是GPL570，54675个探针。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记2</title>
    <link href="http://uteric.github.io/GEO/GEO02/"/>
    <id>http://uteric.github.io/GEO/GEO02/</id>
    <published>2020-07-31T03:14:58.000Z</published>
    <updated>2020-07-31T03:14:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>分析<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100666" target="_blank" rel="noopener">GSE100666</a>，6个配对样本，平台是GPL16951，分析过程如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">library(GEOquery)</span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE100666'</span>,destdir=<span class="string">"."</span>,getGPL=F)</span><br><span class="line">gset &lt;- gset[[1]]</span><br><span class="line">pdata &lt;- pData(gset)</span><br><span class="line">dim(pdata)</span><br><span class="line">group_list &lt;- c(rep(<span class="string">'tumor'</span>,3),rep(<span class="string">'normal'</span>,3))</span><br><span class="line">group_list &lt;-factor(group_list)</span><br><span class="line">group_list &lt;- relevel(group_list, ref=<span class="string">'tumor'</span>)</span><br><span class="line">group_list</span><br><span class="line">exprSet &lt;- exprs(gset)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO12.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NORMALIZATION ----</span></span><br><span class="line">library(limma)</span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet,outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO13.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line"><span class="keyword">if</span> (LogC) &#123; ex[<span class="built_in">which</span>(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex) &#125;</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># ANNOTATION ----</span></span><br><span class="line">gpl&lt;- getGEO(<span class="string">'GPL16951'</span>,destdir = <span class="string">'./'</span>)</span><br><span class="line">gpl&lt;- getGEO(filename = <span class="string">'./GPL16951.soft'</span>)</span><br><span class="line">GPL16951&lt;- GEOquery::Table(gpl)</span><br><span class="line">probeset &lt;- rownames(exprSet)</span><br><span class="line">probe2symbol &lt;- data.frame(probeset,symbol=GPL16951<span class="variable">$Gene_symbol</span>,stringsAsFactors = F)</span><br><span class="line">dim(probe2symbol)</span><br><span class="line">head(probe2symbol)</span><br><span class="line"><span class="comment"># REMOVE NA ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">exprSet &lt;- as.data.frame(exprSet)</span><br><span class="line">exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;% </span><br><span class="line">  select(-probeset) %&gt;% </span><br><span class="line">  select(symbol,everything()) %&gt;% </span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% </span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% </span><br><span class="line">  arrange(desc(rowMean)) %&gt;% </span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% </span><br><span class="line">  select(-rowMean) %&gt;% </span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>)</span><br><span class="line">exprSet &lt;- na.omit(exprSet)</span><br><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># DIFF EXPRESS ----</span></span><br><span class="line">pairinfo &lt;- factor(rep(1:3,2))</span><br><span class="line">design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line">fit &lt;- eBayes(fit) </span><br><span class="line">allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05)</span><br><span class="line"><span class="comment"># PLOT ----</span></span><br><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=rep(1:3,2),</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,ATP6V1G3,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'ATP6V1G3'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO14.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMBINE PLOT ----</span></span><br><span class="line">library(dplyr)</span><br><span class="line">library(tibble)</span><br><span class="line">allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% </span><br><span class="line">  arrange(desc(abs(logFC)))</span><br><span class="line">genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10]</span><br><span class="line">genes</span><br><span class="line">plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">library(cowplot)</span><br><span class="line">plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10])</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO15.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEATMAP ----</span></span><br><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf,p.value=0.05,lfc = 1) </span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line"><span class="comment">#heat &lt;- na.omit(heatdata)</span></span><br><span class="line">annotation_col &lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heatdata, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = F,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, </span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO16.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VOLCANO PLOT ----</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggrepel)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listnormal'</span>,number=Inf) </span><br><span class="line">data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 1)</span><br><span class="line">data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line"> </span><br><span class="line">ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">  geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &gt; 1),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">  geom_point(data=subset(data, logFC &lt; -1),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">  labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">  theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">  geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(panel.border = element_blank(),</span><br><span class="line">        panel.grid.major = element_blank(), </span><br><span class="line">        panel.grid.minor = element_blank(),   </span><br><span class="line">        axis.line = element_line(colour = <span class="string">'black'</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO17.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ENRICH </span></span><br><span class="line">library(clusterProfiler)</span><br><span class="line">gene &lt;- rownames(allDiff_pair)</span><br><span class="line">gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">library(ggplot2)</span><br><span class="line">dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO18.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">dotplot(EGG)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO19.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">browseKEGG(EGG, <span class="string">'hsa04151'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO20.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;分析&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100666&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GSE100666&lt;/a&gt;，6个配对样本，平台是GPL16951，
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>GEO学习笔记1</title>
    <link href="http://uteric.github.io/GEO/GEO01/"/>
    <id>http://uteric.github.io/GEO/GEO01/</id>
    <published>2020-07-25T21:14:01.000Z</published>
    <updated>2020-07-25T21:14:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文是学习过程，参考教程是《来完成你的生信作业，这是最有诚意的GEO数据库教程》，本文分析GSE32575，共36个配对样本，18个处理前，18个处理后。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt; setwd(<span class="string">"D:/GEO"</span>)</span><br><span class="line">&gt; library(GEOquery)</span><br><span class="line">&gt; gset &lt;- getGEO(<span class="string">'GSE32575'</span>,destdir=<span class="string">"."</span>,getGPL=F) <span class="comment"># 下载数据</span></span><br><span class="line">&gt; gset &lt;- gset[[1]] <span class="comment"># 获取表达矩阵与分组信息</span></span><br><span class="line">&gt; pdata &lt;- pData(gset) <span class="comment"># 分组信息</span></span><br><span class="line">&gt; dim(pdata)</span><br><span class="line">[1] 48 37 <span class="comment"># 48个样品，下面要删除前12个，仅用后36个</span></span><br><span class="line">&gt; group_list &lt;- c(rep(<span class="string">'before'</span>,18),rep(<span class="string">'after'</span>,18))</span><br><span class="line">&gt; group_list &lt;-factor(group_list) <span class="comment"># 设定level</span></span><br><span class="line">&gt; group_list</span><br><span class="line"> [1] before before before before before before before before before</span><br><span class="line">[10] before before before before before before before before before</span><br><span class="line">[19] after  after  after  after  after  after  after  after  after </span><br><span class="line">[28] after  after  after  after  after  after  after  after  after </span><br><span class="line">Levels: after before</span><br><span class="line">&gt; group_list &lt;- relevel(group_list, ref=<span class="string">'before'</span>) <span class="comment"># 限定level</span></span><br><span class="line">&gt; group_list</span><br><span class="line"> [1] before before before before before before before before before</span><br><span class="line">[10] before before before before before before before before before</span><br><span class="line">[19] after  after  after  after  after  after  after  after  after </span><br><span class="line">[28] after  after  after  after  after  after  after  after  after </span><br><span class="line">Levels: before after</span><br><span class="line">&gt; exprSet &lt;- exprs(gset) <span class="comment"># 获取表达矩阵</span></span><br><span class="line">&gt; boxplot(exprSet[,-c(1:12)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO01.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(limma) <span class="comment"># 使用limma进行Normalization</span></span><br><span class="line">exprSet &lt;- normalizeBetweenArrays(exprSet)</span><br><span class="line">boxplot(exprSet[,-c(1:12)],outline=FALSE,notch=T,col=group_list,las=2)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO02.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对数据进行LOG转换，否则数据太过分散</span></span><br><span class="line"><span class="comment"># LOG2 TRANSFORM ----</span></span><br><span class="line">ex &lt;- exprSet</span><br><span class="line">qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))</span><br><span class="line">LogC &lt;- (qx[5] &gt; 100) ||</span><br><span class="line">  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||</span><br><span class="line">  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)</span><br><span class="line"><span class="keyword">if</span> (LogC) &#123; ex[<span class="built_in">which</span>(ex &lt;= 0)] &lt;- NaN</span><br><span class="line">exprSet &lt;- log2(ex)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'log2 transform finished'</span>)&#125;<span class="keyword">else</span>&#123;<span class="built_in">print</span>(<span class="string">'log2 transform not needed'</span>)&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO03.png" alt></p><p>转换之后，行名是探针名称，需要先转换为基因名称</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt; index &lt;- gset@annotation</span><br><span class="line">&gt; index</span><br><span class="line">[1] <span class="string">"GPL6102"</span> <span class="comment"># 探针平台名称</span></span><br><span class="line">&gt; platformMap &lt;- data.table::fread(<span class="string">"platformMap.txt"</span>) <span class="comment"># 这个文件可在网上下载，对应着平台与R包之间的关系</span></span><br><span class="line">&gt; platformDB = paste0(platformMap<span class="variable">$bioc_package</span>[grep(index,platformMap<span class="variable">$gpl</span>)],<span class="string">'.db'</span>)</span><br><span class="line">&gt; platformDB</span><br><span class="line">[1] <span class="string">"illuminaHumanv2.db"</span> <span class="comment"># 我们需要这个R包的名称，或者直接在TXT文件中查找</span></span><br><span class="line">&gt; BiocManager::install(<span class="string">"illuminaHumanv2.db"</span>)</span><br><span class="line">&gt; library(illuminaHumanv2.db)</span><br><span class="line">&gt; probeset &lt;- rownames(exprSet)</span><br><span class="line">&gt; SYMBOL &lt;-  annotate::lookUp(probeset,<span class="string">'illuminaHumanv2.db'</span>, <span class="string">'SYMBOL'</span>)</span><br><span class="line">&gt; symbol &lt;- as.vector(unlist(SYMBOL))</span><br><span class="line">&gt; probe2symbol &lt;- data.frame(probeset,symbol,stringsAsFactors = F)</span><br><span class="line">&gt; dim(probe2symbol)</span><br><span class="line">[1] 48701     2</span><br><span class="line">&gt; head(probe2symbol)</span><br><span class="line">      probeset symbol</span><br><span class="line">1 ILMN_1343289   RPS9</span><br><span class="line">2 ILMN_1343290    UBC</span><br><span class="line">3 ILMN_1343291 EEF1A1</span><br><span class="line">4 ILMN_1343292 TUBB2A</span><br><span class="line">5 ILMN_1343293    TXN</span><br><span class="line">6 ILMN_1343294   ACTB</span><br></pre></td></tr></table></figure><p>其实，注释的过程中有些基因是没有名称的，会被标记为NA，另外也可能有重复的，即多个探针可能对应同一基因，因此，需要去掉重复与NA。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; exprSet &lt;- exprSet %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'probeset'</span>) %&gt;%  <span class="comment"># 把行名转化为第一列，原因是行名不可以有重复，不方便操作</span></span><br><span class="line">  inner_join(probe2symbol,by=<span class="string">'probeset'</span>) %&gt;%  <span class="comment"># 合并probe2symbol，即把symbol加到最后一列</span></span><br><span class="line">  select(-probeset) %&gt;% <span class="comment"># 去掉第一列，这是个过渡，用完就可以去掉</span></span><br><span class="line">  select(symbol,everything()) %&gt;% <span class="comment"># 重新排序，把symbol放在第一列</span></span><br><span class="line">  mutate(rowMean =rowMeans(.[grep(<span class="string">'GSM'</span>, names(.))])) %&gt;% <span class="comment"># 计算每行除symbol外的平均值</span></span><br><span class="line">  filter(symbol != <span class="string">'NA'</span>) %&gt;% <span class="comment"># 留下symbol不是NA的行，开始是48701行，筛选后剩下24459行</span></span><br><span class="line">  arrange(desc(rowMean)) %&gt;% <span class="comment"># 按行的平均值重新排列</span></span><br><span class="line">  distinct(symbol,.keep_all = T) %&gt;% <span class="comment"># 若symbol有重复，留下第一个，即rowMean最大的一个，筛选后剩下18954行；</span></span><br><span class="line">  select(-rowMean) %&gt;% <span class="comment"># 去掉rowMean列</span></span><br><span class="line">  column_to_rownames(var = <span class="string">'symbol'</span>) <span class="comment"># 把第一列转化为行名，操作结束</span></span><br><span class="line">&gt; dim(exprSet)</span><br><span class="line">[1] 18954    36</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO04.png" alt></p><p>到此，数据就准备好了，下面进行差异分析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt; pairinfo &lt;- factor(rep(1:18,2))</span><br><span class="line">&gt; pairinfo</span><br><span class="line"> [1] 1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 1  2  3  4 </span><br><span class="line">[23] 5  6  7  8  9  10 11 12 13 14 15 16 17 18</span><br><span class="line">Levels: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18</span><br><span class="line">&gt; design &lt;- model.matrix(~ pairinfo+group_list)</span><br><span class="line">&gt; fit &lt;- lmFit(exprSet,design)</span><br><span class="line">&gt; fit &lt;- eBayes(fit) </span><br><span class="line">&gt; allDiff_pair &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf,p.value=0.05) <span class="comment"># group_listafter是design中的一列</span></span><br><span class="line">&gt; dim(allDiff_pair)</span><br><span class="line">[1] 7649    6 <span class="comment"># 得到7649个差异基因</span></span><br><span class="line">&gt; head(allDiff_pair)</span><br><span class="line">            logFC   AveExpr         t      P.Value    adj.P.Val</span><br><span class="line">R3HCC1 -0.5120536  9.488934 -21.00187 2.017132e-15 3.823273e-11</span><br><span class="line">CHD9    0.9151318  9.456901  20.10559 4.773134e-15 4.523499e-11</span><br><span class="line">PIK3CG  0.7508626  8.864623  18.75847 1.864086e-14 9.249356e-11</span><br><span class="line">SCAND1 -0.6169805 10.540154 -18.69975 1.982044e-14 9.249356e-11</span><br><span class="line">ASAH1  -0.7523775  9.364233 -18.50207 2.439948e-14 9.249356e-11</span><br><span class="line">FAM76B  0.8384345  8.265115  17.90582 4.623183e-14 1.413263e-10</span><br><span class="line">              B</span><br><span class="line">R3HCC1 25.17464</span><br><span class="line">CHD9   24.38000</span><br><span class="line">PIK3CG 23.10821</span><br><span class="line">SCAND1 23.05052</span><br><span class="line">ASAH1  22.85487</span><br><span class="line">FAM76B 22.25094</span><br></pre></td></tr></table></figure><p>作图验证一下，作图之前需要对数据格式进行调整，以适应ggplot2对输入数据的要求，即行是样品，列是基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data_plot &lt;- as.data.frame(t(exprSet))</span><br><span class="line">data_plot &lt;- data.frame(pairinfo=rep(1:18,2),</span><br><span class="line">                       group=group_list,</span><br><span class="line">                       data_plot,stringsAsFactors = F)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data_plot, aes(group,R3HCC1,fill=group)) +</span><br><span class="line">  geom_boxplot() +</span><br><span class="line">  geom_point(size=2, alpha=0.5) +</span><br><span class="line">  geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">  xlab(<span class="string">''</span>) +</span><br><span class="line">  ylab(paste(<span class="string">'Expression of '</span>,<span class="string">'R3HCC1'</span>))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(legend.position = <span class="string">'none'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO05.png" alt></p><p>批量作图，挑差异最大的10个基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(dplyr)</span><br><span class="line">&gt; library(tibble)</span><br><span class="line">&gt; allDiff_arrange &lt;- allDiff_pair %&gt;% </span><br><span class="line">  rownames_to_column(var=<span class="string">'genesymbol'</span>) %&gt;% <span class="comment"># 行名转化为第一列</span></span><br><span class="line">  arrange(desc(abs(logFC))) <span class="comment"># 对logFC的绝对值进行降序排列</span></span><br><span class="line">&gt; genes &lt;- allDiff_arrange<span class="variable">$genesymbol</span>[1:10] <span class="comment"># 排名前10的基因</span></span><br><span class="line">&gt; genes</span><br><span class="line"> [1] <span class="string">"CH25H"</span>  <span class="string">"HOXA5"</span>  <span class="string">"ID1"</span>    <span class="string">"ZBTB16"</span> <span class="string">"IL1R2"</span>  <span class="string">"CA4"</span>    <span class="string">"SLC7A5"</span></span><br><span class="line"> [8] <span class="string">"DDIT4"</span>  <span class="string">"KLF9"</span>   <span class="string">"ACKR3"</span></span><br><span class="line">&gt; plotlist &lt;- lapply(genes, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  data =data.frame(data_plot[,c(<span class="string">'pairinfo'</span>,<span class="string">'group'</span>)],gene=data_plot[,x])</span><br><span class="line">  ggplot(data, aes(group,gene,fill=group)) +</span><br><span class="line">    geom_boxplot() +</span><br><span class="line">    geom_point(size=2, alpha=0.5) +</span><br><span class="line">    geom_line(aes(group=pairinfo), colour=<span class="string">'black'</span>, linetype=<span class="string">'11'</span>) +</span><br><span class="line">    xlab(<span class="string">''</span>) +</span><br><span class="line">    ylab(paste(<span class="string">'Expression of '</span>,x))+</span><br><span class="line">    theme_classic()+</span><br><span class="line">    theme(legend.position = <span class="string">'none'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">&gt; library(cowplot)</span><br><span class="line">&gt; plot_grid(plotlist=plotlist, ncol=5,labels = LETTERS[1:10]) <span class="comment"># 这个作图方法真是高明，感叹！</span></span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO06.png" alt></p><p>画热图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library(pheatmap)</span><br><span class="line">allDiff_pair2 &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf,p.value=0.05,lfc = 1) <span class="comment"># lfc=1，代表logFC绝对值大于1</span></span><br><span class="line">heatdata &lt;- exprSet[rownames(allDiff_pair2),]</span><br><span class="line">annotation_col&lt;- data.frame(group_list)</span><br><span class="line">rownames(annotation_col) &lt;- colnames(heatdata)</span><br><span class="line">pheatmap(heatdata, </span><br><span class="line">         cluster_rows = TRUE,</span><br><span class="line">         cluster_cols = TRUE,</span><br><span class="line">         annotation_col =annotation_col, </span><br><span class="line">         annotation_legend=TRUE, </span><br><span class="line">         show_rownames = T,</span><br><span class="line">         show_colnames = T,</span><br><span class="line">         scale = <span class="string">'row'</span>, <span class="comment"># scale一定选行，即在基因内标准化</span></span><br><span class="line">         color =colorRampPalette(c(<span class="string">'blue'</span>, <span class="string">'white'</span>,<span class="string">'red'</span>))(100))</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO07.png" alt></p><p>绘制火山图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; library(ggrepel)</span><br><span class="line">&gt; library(dplyr)</span><br><span class="line">&gt; data &lt;- topTable(fit,adjust=<span class="string">'BH'</span>,coef=<span class="string">'group_listafter'</span>,number=Inf) </span><br><span class="line">&gt; data<span class="variable">$significant</span> &lt;- as.factor(data<span class="variable">$adj</span>.P.Val&lt;0.05 &amp; abs(data<span class="variable">$logFC</span>) &gt; 0.6) <span class="comment">#以logFC=1.5为界</span></span><br><span class="line">&gt; data<span class="variable">$gene</span> &lt;- rownames(data)</span><br><span class="line">&gt; ggplot(data=data, aes(x=logFC, y =-log10(adj.P.Val),color=significant)) +</span><br><span class="line">+   geom_point(alpha=0.8, size=1.2,col=<span class="string">'black'</span>)+</span><br><span class="line">+   geom_point(data=subset(data, logFC &gt; 0.6),alpha=0.8, size=1.2,col=<span class="string">'red'</span>)+</span><br><span class="line">+   geom_point(data=subset(data, logFC &lt; -0.6),alpha=0.6, size=1.2,col=<span class="string">'blue'</span>)+</span><br><span class="line">+   labs(x=<span class="string">'log2 (fold change)'</span>,y=<span class="string">'-log10 (adj.P.Val)'</span>)+</span><br><span class="line">+   theme(plot.title = element_text(hjust = 0.4))+</span><br><span class="line">+   geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">+   geom_vline(xintercept = c(0.6,-0.6),lty=4,lwd=0.6,alpha=0.8)+</span><br><span class="line">+   theme_bw()+</span><br><span class="line">+   theme(panel.border = element_blank(),</span><br><span class="line">+         panel.grid.major = element_blank(), </span><br><span class="line">+         panel.grid.minor = element_blank(),   </span><br><span class="line">+         axis.line = element_line(colour = <span class="string">'black'</span>)) +</span><br><span class="line">+   geom_point(data=subset(data, abs(logFC) &gt; 1),alpha=0.8, size=3,col=<span class="string">'green'</span>)+</span><br><span class="line">+   geom_text_repel(data=subset(data, abs(logFC) &gt; 1), </span><br><span class="line">+                   aes(label=gene),col=<span class="string">'black'</span>,alpha = 0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO08.png" alt></p><p>富集分析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(clusterProfiler)</span><br><span class="line">&gt; gene &lt;- rownames(allDiff_pair) <span class="comment"># 只需要基因名</span></span><br><span class="line">&gt; gene &lt;- bitr(gene, fromType=<span class="string">'SYMBOL'</span>, toType=<span class="string">'ENTREZID'</span>, OrgDb=<span class="string">'org.Hs.eg.db'</span>)</span><br><span class="line">&gt; de &lt;- gene<span class="variable">$ENTREZID</span></span><br><span class="line">&gt; go &lt;- enrichGO(gene = de, OrgDb = <span class="string">'org.Hs.eg.db'</span>, ont=<span class="string">'all'</span>)</span><br><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; dotplot(go, split=<span class="string">'ONTOLOGY'</span>) +facet_grid(ONTOLOGY~., scale=<span class="string">'free'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO09.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; EGG &lt;- enrichKEGG(gene= gene<span class="variable">$ENTREZID</span>,</span><br><span class="line">                  organism     = <span class="string">'hsa'</span>,</span><br><span class="line">                  pvalueCutoff = 0.05)</span><br><span class="line">&gt; dotplot(EGG)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO10.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">test</span> &lt;- data.frame(EGG)</span><br><span class="line">&gt; head(<span class="built_in">test</span>)[,1:7]</span><br><span class="line">               ID                    Description GeneRatio  BgRatio</span><br><span class="line">hsa04120 hsa04120 Ubiquitin mediated proteolysis   88/3122 140/8048</span><br><span class="line">hsa04218 hsa04218            Cellular senescence   94/3122 156/8048</span><br><span class="line">hsa04210 hsa04210                      Apoptosis   84/3122 136/8048</span><br><span class="line">hsa04110 hsa04110                     Cell cycle   76/3122 124/8048</span><br><span class="line">hsa05220 hsa05220       Chronic myeloid leukemia   51/3122  76/8048</span><br><span class="line">hsa05131 hsa05131                    Shigellosis  130/3122 242/8048</span><br><span class="line">               pvalue     p.adjust       qvalue</span><br><span class="line">hsa04120 5.535090e-09 1.787834e-06 1.229373e-06</span><br><span class="line">hsa04218 3.626260e-08 4.287401e-06 2.948155e-06</span><br><span class="line">hsa04210 3.982106e-08 4.287401e-06 2.948155e-06</span><br><span class="line">hsa04110 2.770947e-07 2.237540e-05 1.538605e-05</span><br><span class="line">hsa05220 4.909519e-07 3.171549e-05 2.180860e-05</span><br><span class="line">hsa05131 1.268222e-06 6.827259e-05 4.694645e-05</span><br><span class="line">&gt; browseKEGG(EGG, <span class="string">'hsa04218'</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/GEO/GEO11.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本文是学习过程，参考教程是《来完成你的生信作业，这是最有诚意的GEO数据库教程》，本文分析GSE32575，共36个配对样本，18个处理前，18个处理后。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="GEO" scheme="http://uteric.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记14-基因集富集分析GSEA</title>
    <link href="http://uteric.github.io/TCGA/TCGA14GSEA/"/>
    <id>http://uteric.github.io/TCGA/TCGA14GSEA/</id>
    <published>2020-07-19T03:36:48.000Z</published>
    <updated>2020-07-19T03:36:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>GSEA（Gene Set Enrichment Analysis），是基因集富集分析，也是软件的名称，顾名思议，GSEA用于分析给定分组中差异表达的基因是否在给定的基因集中有富集。</p><p>下载<a href="https://www.gsea-msigdb.org/gsea/downloads.jsp" target="_blank" rel="noopener">GSEA</a>软件：根据操作系统下载相应的版本并安装</p><p>软件主界面如下图：</p><p><img src="/images/TCGA/TCGA22.png" alt></p><p>这个软件操作十分容易，简单明了，唯一的难度在于输入数据的准备，简单来说，有两个数据是必须提前准备好的，即表达数据与表型注释</p><p>表达数据格式：可以有多种输入格式，这里以TXT为例，我们先在R中将我们需要的数据提取并保存为CSV格式，处理完成后再保存为TXT即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 回顾一下前面的数据，差异表达筛选之后有4913个基因（result_select），注释后剩下4863个（result_select_annot）</span></span><br><span class="line">&gt; x1 &lt;- result_select_annot<span class="variable">$hgnc_symbol</span></span><br><span class="line">&gt; length(x1)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; tail(x1)</span><br><span class="line">[1] <span class="string">""</span>           <span class="string">"SLFNL1-AS1"</span> <span class="string">"HELLPAR"</span>    <span class="string">"SNHG4"</span>      <span class="string">"LINC01176"</span> </span><br><span class="line">[6] <span class="string">"CICP14"</span>    </span><br><span class="line">&gt; x1[x1==<span class="string">""</span>]=NA <span class="comment">#把""转换为NA，方便逻辑判断</span></span><br><span class="line">&gt; tail(x1)</span><br><span class="line">[1] NA           <span class="string">"SLFNL1-AS1"</span> <span class="string">"HELLPAR"</span>    <span class="string">"SNHG4"</span>      <span class="string">"LINC01176"</span> </span><br><span class="line">[6] <span class="string">"CICP14"</span> </span><br><span class="line">&gt; table(is.na(x1))</span><br><span class="line">FALSE  TRUE </span><br><span class="line"> 4259   604 <span class="comment">#4863个注释后的基因，居然只有4259个有名字，下面就取出这些基因的表达数据来做富集分析</span></span><br><span class="line"></span><br><span class="line">&gt; write.csv(result_select_annot,<span class="string">"result_select_annot.csv"</span>) <span class="comment"># 这是差异分析并注释过后的4863个基因</span></span><br><span class="line">&gt; <span class="comment"># Remove BLANKs in EXCEL, rename as "unique_annot.csv"</span></span><br><span class="line">&gt; unique_annot &lt;- read.csv(<span class="string">"unique_annot.csv"</span>)</span><br><span class="line">&gt; dim(unique_annot)</span><br><span class="line">[1] 4259    9 <span class="comment"># 把没有名字的在EXCEL中去掉，剩下4259个</span></span><br><span class="line">&gt; head(unique_annot)</span><br><span class="line">  ï.. ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1   1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2   2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3   3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4   4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5   5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6   6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">    pvalue     padj hgnc_symbol</span><br><span class="line">1 1.79e-51 2.15e-50         FGR</span><br><span class="line">2 7.05e-37 4.97e-36      SEMA3F</span><br><span class="line">3 6.83e-22 2.56e-21     CYP51A1</span><br><span class="line">4 1.01e-49 1.14e-48        CD99</span><br><span class="line">5 4.84e-62 8.09e-61       HECW1</span><br><span class="line">6 4.80e-24 1.98e-23    TMEM176A</span><br><span class="line">&gt; data_annot &lt;- data_select[match(unique_annot<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),] <span class="comment"># 提取表达数据</span></span><br><span class="line">&gt; dim(data_annot)</span><br><span class="line">[1] 4259  611</span><br><span class="line">&gt; head(data_annot)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000001617                     16862                     10888</span><br><span class="line">ENSG00000001630                       310                        77</span><br><span class="line">ENSG00000002586                     10729                      8611</span><br><span class="line">ENSG00000002746                         7                        37</span><br><span class="line">ENSG00000002933                     60355                     29448</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000000938                      1100</span><br><span class="line">ENSG00000001617                      9299</span><br><span class="line">ENSG00000001630                       305</span><br><span class="line">ENSG00000002586                      7618</span><br><span class="line">ENSG00000002746                         7</span><br><span class="line">ENSG00000002933                     47857</span><br><span class="line">&gt; data_annot<span class="variable">$symbol</span> &lt;- unique_annot<span class="variable">$hgnc_symbol</span> <span class="comment"># 加入基因名称</span></span><br><span class="line">&gt; dim(data_annot)</span><br><span class="line">[1] 4259  612</span><br><span class="line">&gt; head(data_annot)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000001617                     16862                     10888</span><br><span class="line">ENSG00000001630                       310                        77</span><br><span class="line">ENSG00000002586                     10729                      8611</span><br><span class="line">ENSG00000002746                         7                        37</span><br><span class="line">ENSG00000002933                     60355                     29448</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000000938                      1100</span><br><span class="line">ENSG00000001617                      9299</span><br><span class="line">ENSG00000001630                       305</span><br><span class="line">ENSG00000002586                      7618</span><br><span class="line">ENSG00000002746                         7</span><br><span class="line">ENSG00000002933                     47857</span><br><span class="line">&gt; data_annot2 &lt;- data_annot[,c(612,1:611)] <span class="comment"># 把基因名称放到第一列</span></span><br><span class="line">&gt; dim(data_annot2)</span><br><span class="line">[1] 4259  612</span><br><span class="line">&gt; head(data_annot2)[,1:3]</span><br><span class="line">                  symbol TCGA-CZ-5465-01A-01R-1503</span><br><span class="line">ENSG00000000938      FGR                       899</span><br><span class="line">ENSG00000001617   SEMA3F                     16862</span><br><span class="line">ENSG00000001630  CYP51A1                       310</span><br><span class="line">ENSG00000002586     CD99                     10729</span><br><span class="line">ENSG00000002746    HECW1                         7</span><br><span class="line">ENSG00000002933 TMEM176A                     60355</span><br><span class="line">                TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                      1211</span><br><span class="line">ENSG00000001617                     10888</span><br><span class="line">ENSG00000001630                        77</span><br><span class="line">ENSG00000002586                      8611</span><br><span class="line">ENSG00000002746                        37</span><br><span class="line">ENSG00000002933                     29448</span><br><span class="line">&gt; write.csv(data_annot2,<span class="string">"data_annot2.csv"</span>) <span class="comment"># 这个文件就是GSEA的表达文件，但是在输入GSEA前需要处理，第一列改为基因名称，新加第二列DESCRIPTION，内容为na即可；</span></span><br><span class="line">&gt; data_annot2<span class="variable">$symbol</span>[duplicated(data_annot2<span class="variable">$symbol</span>)] <span class="comment"># 检查一下基因名称是否有重复</span></span><br><span class="line">factor(0)</span><br><span class="line">4259 Levels: A4GNT AACSP1 AATBC AATK ABAT ABCA1 ABCA12 ... ZYG11A</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA23.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面准备表型文件</span></span><br><span class="line">&gt; phetype &lt;- data.frame(colnames(data_annot2)[2:612],group)</span><br><span class="line">&gt; dim(phetype)</span><br><span class="line">[1] 611   2</span><br><span class="line">&gt; head(phetype)</span><br><span class="line">  colnames.data_annot2..2.612.  group</span><br><span class="line">1    TCGA-CZ-5465-01A-01R-1503 cancer</span><br><span class="line">2    TCGA-BP-4355-01A-01R-1289 cancer</span><br><span class="line">3    TCGA-CZ-5451-01A-01R-1503 cancer</span><br><span class="line">4    TCGA-B0-5081-01A-01R-1334 cancer</span><br><span class="line">5    TCGA-CZ-5454-11A-01R-1503 normal</span><br><span class="line">6    TCGA-B0-5697-01A-11R-1541 cancer</span><br><span class="line">&gt; phetypeOrder &lt;- phetype[order(phetype<span class="variable">$group</span>),]</span><br><span class="line">&gt; head(phetypeOrder)</span><br><span class="line">   colnames.data_annot2..2.612.  group</span><br><span class="line">5     TCGA-CZ-5454-11A-01R-1503 normal</span><br><span class="line">10    TCGA-B0-5691-11A-01R-1541 normal</span><br><span class="line">21    TCGA-B0-5701-11A-01R-1541 normal</span><br><span class="line">41    TCGA-B2-5636-11A-01R-1541 normal</span><br><span class="line">44    TCGA-B0-5703-11A-01R-1541 normal</span><br><span class="line">45    TCGA-CZ-4864-11A-01R-1503 normal</span><br><span class="line">&gt; tail(phetypeOrder)</span><br><span class="line">    colnames.data_annot2..2.612.  group</span><br><span class="line">606    TCGA-BP-5200-01A-01R-1426 cancer</span><br><span class="line">607    TCGA-BP-4999-01A-01R-1334 cancer</span><br><span class="line">608    TCGA-GK-A6C7-01A-11R-A33J cancer</span><br><span class="line">609    TCGA-B0-5113-01A-01R-1420 cancer</span><br><span class="line">610    TCGA-CJ-4893-01A-01R-1305 cancer</span><br><span class="line">611    TCGA-CZ-4856-01A-02R-1426 cancer</span><br><span class="line">&gt; write.csv(phetypeOrder,<span class="string">"phetypeOrder.csv"</span>) <span class="comment"># 表型文件，排序是为方便在GSEA软件中输入</span></span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA24.png" alt></p><p>如上图，输入表达文件和表型文件，并且将下载好的基因集文件导入，就可以运行了，如果跑所有的基因集，需要耗费几分钟时间，运行完成后，生成一个网页，里面是对结果的描述。</p><p><img src="/images/TCGA/TCGA25.png" alt></p><p>程序共运行了12388个基因集，使用了4259个基因。那么，富集结果怎么读呢？一般认为，|NES|&gt;1，NOM p-val&lt;0.05，FDR q-val&lt;0.25的通路是显著富集的。</p><p>根据这个标准，富集结果并不理想，不论肿瘤或是正常组织中，都不存在符合以上标准的基因集。</p><p>当然，以上富集分析有一个硬伤，即只选取了差异表达的基因，并且由于注释的缘故，一部分基因被滤掉了，这可能导致富集结果出现偏差。我们也可以尝试使用所有的基因来做个分析。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(data_select)</span><br><span class="line">[1] 18129   611 <span class="comment"># 原始数据经筛选后留下18129个基因</span></span><br><span class="line">&gt; library(biomaRt)</span><br><span class="line">&gt; geneName_select2 &lt;- rownames(data_select)</span><br><span class="line">&gt; length(geneName_select2)</span><br><span class="line">[1] 18129</span><br><span class="line">ensemb &lt;- useDataset(<span class="string">"hsapiens_gene_ensembl"</span>,mart=useMart(<span class="string">"ensembl"</span>))</span><br><span class="line">ensemb</span><br><span class="line">annot2 &lt;- getBM(attributes = c(<span class="string">"ensembl_gene_id"</span>,<span class="string">"hgnc_symbol"</span>),</span><br><span class="line">               filters = <span class="string">"ensembl_gene_id"</span>,values = geneName_select2, mart=ensemb)</span><br><span class="line">class(annot2)</span><br><span class="line">&gt; dim(annot2)</span><br><span class="line">[1] 17972     2 <span class="comment"># 注释后剩下17192个基因</span></span><br><span class="line">&gt; head(annot2)</span><br><span class="line">  ensembl_gene_id hgnc_symbol</span><br><span class="line">1 ENSG00000000419        DPM1</span><br><span class="line">2 ENSG00000000457       SCYL3</span><br><span class="line">3 ENSG00000000460    C1orf112</span><br><span class="line">4 ENSG00000000938         FGR</span><br><span class="line">5 ENSG00000000971         CFH</span><br><span class="line">6 ENSG00000001036       FUCA2</span><br><span class="line">&gt; annot2<span class="variable">$hgnc_symbol</span>[duplicated(annot2<span class="variable">$hgnc_symbol</span>)]</span><br><span class="line">   [1] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [22] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [43] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [64] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line">  [85] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [106] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [127] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [148] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [169] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [190] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [211] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [232] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [253] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [274] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [295] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [316] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [337] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [358] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [379] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [400] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [421] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [442] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [463] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [484] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [505] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [526] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [547] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [568] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [589] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [610] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [631] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [652] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [673] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [694] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [715] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [736] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [757] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [778] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [799] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [820] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [841] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [862] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [883] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [904] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [925] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [946] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [967] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [988] <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span> <span class="string">""</span></span><br><span class="line"> [ reached getOption(<span class="string">"max.print"</span>) -- omitted 589 entries ] <span class="comment"># 查重，居然有1589个是""，这些需要去掉</span></span><br><span class="line">annot2_unique &lt;- annot2[match(unique(annot2<span class="variable">$hgnc_symbol</span>),annot2<span class="variable">$hgnc_symbol</span>),]</span><br><span class="line">&gt; dim(annot2_unique)</span><br><span class="line">[1] 16383     2 <span class="comment"># 去掉重复后剩下16383个基因，其实还有一行""剩下，需要去掉</span></span><br><span class="line">&gt; head(annot2_unique)</span><br><span class="line">  ensembl_gene_id hgnc_symbol</span><br><span class="line">1 ENSG00000000419        DPM1</span><br><span class="line">2 ENSG00000000457       SCYL3</span><br><span class="line">3 ENSG00000000460    C1orf112</span><br><span class="line">4 ENSG00000000938         FGR</span><br><span class="line">5 ENSG00000000971         CFH</span><br><span class="line">6 ENSG00000001036       FUCA2</span><br><span class="line">data_select_annot &lt;- data_select[match(annot2_unique<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),]</span><br><span class="line">&gt; dim(data_select_annot)</span><br><span class="line">[1] 16383   611 <span class="comment"># 其实应当是16382行，有一行是""，没有去掉</span></span><br><span class="line">head(data_select_annot)[,1:3]</span><br><span class="line">Descriptions &lt;- rep(<span class="string">"NA"</span>,16383) <span class="comment"># 加一列</span></span><br><span class="line">data_select_annot2 &lt;- cbind(symbol=annot2_unique<span class="variable">$hgnc_symbol</span>,Descriptions,data_select_annot)</span><br><span class="line">dim(data_select_annot2)</span><br><span class="line">head(data_select_annot2)[,1:3]</span><br><span class="line">write.csv(data_select_annot2,<span class="string">"data_select_annot2.csv"</span>)</span><br><span class="line"><span class="comment"># 在EXCEL中去掉""这一列，并保存为TXT文件</span></span><br><span class="line">&gt; data_select_annot2<span class="variable">$symbol</span>[duplicated(data_select_annot2<span class="variable">$symbol</span>)] <span class="comment"># 这回没有重复</span></span><br><span class="line">factor(0)</span><br><span class="line">16383 Levels:  A1BG-AS1 A1CF A2M A2M-AS1 A4GALT A4GNT AAAS ... ZZEF1</span><br><span class="line"><span class="comment"># 上面这个TXT文件即为表达文件</span></span><br><span class="line">phetype &lt;- data.frame(colnames(data_select_annot2)[3:613],group)</span><br><span class="line">dim(phetype)</span><br><span class="line">head(phetype)</span><br><span class="line">phetypeOrder &lt;- phetype[order(phetype<span class="variable">$group</span>),]</span><br><span class="line">head(phetypeOrder)</span><br><span class="line">tail(phetypeOrder)</span><br><span class="line">write.csv(phetypeOrder,<span class="string">"phetypeOrder.csv"</span>) <span class="comment"># 表型文件</span></span><br></pre></td></tr></table></figure><p>运行之后，结果是一致的，即没有显著富集的基因集。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;GSEA（Gene Set Enrichment Analysis），是基因集富集分析，也是软件的名称，顾名思议，GSEA用于分析给定分组中差异表达的基因是否在给定的基因集中有富集。&lt;/p&gt;
&lt;p&gt;下载&lt;a href=&quot;https://www.gsea-msigdb.org
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记13-对所有差异表达基因进行生存分析</title>
    <link href="http://uteric.github.io/TCGA/TCGA13Survival/"/>
    <id>http://uteric.github.io/TCGA/TCGA13Survival/</id>
    <published>2020-07-05T21:37:58.000Z</published>
    <updated>2020-07-05T21:37:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们以padj或FoldChange为依据筛选了TOP10基因，并进行了生存分析，但效果并不理想，原因很简单，因为不论是P值还是变化倍数，其实都与病例生存时间没有必然关联。这次，我们来对所有差异表达基因批量进行生存分析，看有多少基因影响病例生存，并且找找规律。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(result_select_annot) <span class="comment"># 注释后的4863个基因</span></span><br><span class="line">[1] 4863    8</span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A</span><br><span class="line"></span><br><span class="line">&gt; annot_symbol &lt;- result_select_annot<span class="variable">$hgnc_symbol</span></span><br><span class="line">&gt; length(annot_symbol)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; annot_id &lt;- result_select_annot<span class="variable">$ensembl_gene_id</span></span><br><span class="line">&gt; length(annot_id)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; annot_data &lt;- data_select[match(result_select_annot<span class="variable">$ensembl_gene_id</span>,rownames(data_select)),]</span><br><span class="line">&gt; colnames(annot_data) &lt;- substr(colnames(annot_data),1,15)</span><br><span class="line">&gt; head(annot_data)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000000938             899            1211            1100</span><br><span class="line">ENSG00000001617           16862           10888            9299</span><br><span class="line">ENSG00000001630             310              77             305</span><br><span class="line">ENSG00000002586           10729            8611            7618</span><br><span class="line">ENSG00000002746               7              37               7</span><br><span class="line">ENSG00000002933           60355           29448           47857</span><br><span class="line">&gt; dim(annot_data)</span><br><span class="line">[1] 4863  611 <span class="comment"># 数据准备就绪</span></span><br><span class="line"></span><br><span class="line">&gt; kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>)</span><br><span class="line">&gt; dim(kidney_clinic)</span><br><span class="line">[1] 530  14</span><br><span class="line">&gt; head(kidney_clinic)</span><br><span class="line">                      id classification_of_tumor tumor_stage gender</span><br><span class="line">1 TCGA-CZ-5986_diagnosis            not reported     stage i   male</span><br><span class="line">2 TCGA-CZ-4858_diagnosis            not reported    stage ii   male</span><br><span class="line">3 TCGA-B8-5551_diagnosis            not reported     stage i female</span><br><span class="line">4 TCGA-B0-4817_diagnosis            not reported   stage iii   male</span><br><span class="line">5 TCGA-BP-4325_diagnosis            not reported     stage i female</span><br><span class="line">6 TCGA-B0-4698_diagnosis            not reported    stage iv   male</span><br><span class="line">  year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">1          1945  not reported              2006  not reported  61</span><br><span class="line">2          1966  not reported              2005          2105  39</span><br><span class="line">3          1945  not reported              2010  not reported  65</span><br><span class="line">4          1921          2004              2002          1019  81</span><br><span class="line">5          1937  not reported              2001  not reported  64</span><br><span class="line">6          1928          2003              2003            42  75</span><br><span class="line">  deadORlive                      race      alcohol years_smoked</span><br><span class="line">1      Alive                     white Not Reported not reported</span><br><span class="line">2       Dead                     white Not Reported not reported</span><br><span class="line">3      Alive black or african american Not Reported not reported</span><br><span class="line">4       Dead                     white Not Reported not reported</span><br><span class="line">5      Alive                     white Not Reported not reported</span><br><span class="line">6       Dead                     white Not Reported not reported</span><br><span class="line">            newID</span><br><span class="line">1 TCGA-CZ-5986-01</span><br><span class="line">2 TCGA-CZ-4858-01</span><br><span class="line">3 TCGA-B8-5551-01</span><br><span class="line">4 TCGA-B0-4817-01</span><br><span class="line">5 TCGA-BP-4325-01</span><br><span class="line">6 TCGA-B0-4698-01</span><br><span class="line">&gt; km_plot &lt;- apply(annot_data,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;)</span><br><span class="line">&gt; dim(km_plot)</span><br><span class="line">[1]  611 4863</span><br><span class="line">&gt; head(km_plot)[,1:3]</span><br><span class="line">                ENSG00000000938 ENSG00000001617 ENSG00000001630</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>    </span><br><span class="line">&gt; km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),]</span><br><span class="line">&gt; dim(km_plot_cancer)</span><br><span class="line">[1]  538 4863</span><br><span class="line">&gt; head(km_plot_cancer)[,1:3]</span><br><span class="line">                ENSG00000000938 ENSG00000001617 ENSG00000001630</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>   </span><br><span class="line">&gt; kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">&gt; dim(kidney_clinic_km)</span><br><span class="line">[1] 538  14</span><br><span class="line">&gt; head(kidney_clinic_km)</span><br><span class="line">                        id classification_of_tumor tumor_stage gender</span><br><span class="line">274 TCGA-CZ-5465_diagnosis            not reported   stage iii female</span><br><span class="line">358 TCGA-BP-4355_diagnosis            not reported   stage iii female</span><br><span class="line">517 TCGA-CZ-5451_diagnosis            not reported    stage ii   male</span><br><span class="line">119 TCGA-B0-5081_diagnosis            not reported   stage iii female</span><br><span class="line">201 TCGA-B0-5697_diagnosis            not reported     stage i   male</span><br><span class="line">484 TCGA-A3-A8OV_diagnosis            not reported     stage i   male</span><br><span class="line">    year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">274          1931  not reported              2007          2564  76</span><br><span class="line">358          1949          2010              2008           953  59</span><br><span class="line">517          1932  not reported              2006  not reported  74</span><br><span class="line">119          1926          2005              2005           362  79</span><br><span class="line">201          1957  not reported              2007  not reported  50</span><br><span class="line">484          1936  not reported              2011  not reported  75</span><br><span class="line">    deadORlive                      race      alcohol years_smoked</span><br><span class="line">274       Dead              not reported Not Reported not reported</span><br><span class="line">358       Dead                     white Not Reported not reported</span><br><span class="line">517      Alive                     white Not Reported not reported</span><br><span class="line">119       Dead                     white Not Reported not reported</span><br><span class="line">201      Alive                     white Not Reported not reported</span><br><span class="line">484      Alive black or african american Not Reported           65</span><br><span class="line">              newID</span><br><span class="line">274 TCGA-CZ-5465-01</span><br><span class="line">358 TCGA-BP-4355-01</span><br><span class="line">517 TCGA-CZ-5451-01</span><br><span class="line">119 TCGA-B0-5081-01</span><br><span class="line">201 TCGA-B0-5697-01</span><br><span class="line">484 TCGA-A3-A8OV-01</span><br><span class="line">&gt; daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>))</span><br><span class="line">&gt; daysToDeath</span><br><span class="line">  [1] 2564  953   NA  362   NA   NA   62 1493   51   NA   NA   NA 1588</span><br><span class="line"> [14]   NA  885 2227  137   NA   NA 1432   NA   NA   NA   NA   NA   NA</span><br><span class="line"> [27] 1657   NA   18   NA 1964   NA  109   NA 1661   NA   NA   NA   NA</span><br><span class="line"> [40]   NA   NA   NA   NA 1315 1404  562  445   NA   NA   NA   NA 1238</span><br><span class="line"> [53]  182 1912   NA   NA   NA   NA 2454  344   NA 1913 1111   NA 1980</span><br><span class="line"> [66]   NA  600 1003   NA   NA   NA   NA 2105 1371  334   NA 1337   NA</span><br><span class="line"> [79]   NA   NA   NA   NA   NA   NA  727   NA   NA 2256   NA   NA   NA</span><br><span class="line"> [92]  782   NA   NA   NA   NA   NA   NA   NA 1625   NA   NA   NA   NA</span><br><span class="line">[105]   NA   NA  768   NA   NA   NA   NA   NA  563   NA 2145   NA   NA</span><br><span class="line">[118]   NA  561   NA   NA   NA   NA   NA   NA   NA   NA 1200   NA   NA</span><br><span class="line">[131]   NA   NA   NA   NA   NA   NA 1317   NA   NA   NA   NA   NA   NA</span><br><span class="line">[144]  329   NA   NA   NA   NA  242   NA   NA  646   NA   NA   NA   NA</span><br><span class="line">[157]  683  587  952    0   NA  320 1092   NA   NA   68  510   NA   NA</span><br><span class="line">[170]  245    2   NA  793   NA   NA   NA 2601   NA   NA   NA 1714   NA</span><br><span class="line">[183]   NA   NA 1230 1170 2386   NA  571  883 1912   NA   NA   NA 1986</span><br><span class="line">[196]   NA 1091   NA   NA   NA   NA   NA 1417   NA   NA   65   NA   NA</span><br><span class="line">[209]   NA   NA   NA   NA 1378   NA   NA   NA   NA   NA   NA   NA   NA</span><br><span class="line">[222]   NA   NA  679  866   NA   NA   NA   NA   NA  330   NA   NA  885</span><br><span class="line">[235]   NA  946   NA   NA  375   NA   NA   NA 1133   NA   NA  561   NA</span><br><span class="line">[248]  431   NA 2764   NA   NA   NA   NA 1696   NA   42   NA   59    0</span><br><span class="line">[261]   NA   NA   NA   NA   NA 1034 1270 1200 2241  333   NA   NA   NA</span><br><span class="line">[274]   NA  342   NA  722   NA   NA 1075   NA   NA   NA   NA  709   NA</span><br><span class="line">[287]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  164</span><br><span class="line">[300]   NA   NA   NA   NA   NA  701   69   NA   NA  574  106   NA   NA</span><br><span class="line">[313]   NA   NA  475 1019   NA   NA   NA  162  845   NA   NA  552  139</span><br><span class="line">[326]   NA   NA   NA   NA 1589   NA 1045  735   NA   NA   NA   NA   NA</span><br><span class="line">[339]   NA   NA 1972  459   NA 2299   NA   NA   NA  819 1463   NA   NA</span><br><span class="line">[352] 1724   NA   NA  313   NA   NA   NA  183   NA   NA   NA   NA   NA</span><br><span class="line">[365]   NA   NA 1626  822   NA  206  932 1097   NA   NA   NA   NA   NA</span><br><span class="line">[378]   NA   NA   NA  166  478   NA 1584   NA   NA   NA   NA  480   NA</span><br><span class="line">[391]   NA  311   NA   NA   NA   NA  202   NA  927 1343 1590  454   NA</span><br><span class="line">[404]  834   NA   NA   NA 2090 1598   NA 1639  878  992   NA   NA   NA</span><br><span class="line">[417]   NA   43   NA 2419   NA   NA   NA   NA 1121   NA   NA   NA   NA</span><br><span class="line">[430] 2343  485  110   NA   NA  313  204   NA   NA   NA  238   NA   NA</span><br><span class="line">[443]   NA   NA   NA   NA  480   NA  168   NA   73   NA   NA  101   NA</span><br><span class="line">[456]   NA   NA   NA  446 3615   NA  645   NA 1567   NA 3554   NA   NA</span><br><span class="line">[469]   NA   NA   NA  139   NA   NA   NA  841   NA   NA  336   NA   NA</span><br><span class="line">[482]   NA   99   NA   NA   NA   NA  637   NA   NA   NA   NA 1111   NA</span><br><span class="line">[495]   NA   NA   77  770   NA   NA   NA   NA  222   NA   NA   NA   NA</span><br><span class="line">[508]   41   NA   NA   NA   NA   NA   NA   NA   NA 1610  224   NA 1191</span><br><span class="line">[521]   NA   93   NA   NA  307   NA  211   NA   NA 1625   NA  578   NA</span><br><span class="line">[534]   NA   NA   NA   NA   NA</span><br><span class="line">&gt; daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath)</span><br><span class="line">&gt; daysToDeathN</span><br><span class="line">  [1] 2564  953 3615  362 3615 3615   62 1493   51 3615 3615 3615 1588</span><br><span class="line"> [14] 3615  885 2227  137 3615 3615 1432 3615 3615 3615 3615 3615 3615</span><br><span class="line"> [27] 1657 3615   18 3615 1964 3615  109 3615 1661 3615 3615 3615 3615</span><br><span class="line"> [40] 3615 3615 3615 3615 1315 1404  562  445 3615 3615 3615 3615 1238</span><br><span class="line"> [53]  182 1912 3615 3615 3615 3615 2454  344 3615 1913 1111 3615 1980</span><br><span class="line"> [66] 3615  600 1003 3615 3615 3615 3615 2105 1371  334 3615 1337 3615</span><br><span class="line"> [79] 3615 3615 3615 3615 3615 3615  727 3615 3615 2256 3615 3615 3615</span><br><span class="line"> [92]  782 3615 3615 3615 3615 3615 3615 3615 1625 3615 3615 3615 3615</span><br><span class="line">[105] 3615 3615  768 3615 3615 3615 3615 3615  563 3615 2145 3615 3615</span><br><span class="line">[118] 3615  561 3615 3615 3615 3615 3615 3615 3615 3615 1200 3615 3615</span><br><span class="line">[131] 3615 3615 3615 3615 3615 3615 1317 3615 3615 3615 3615 3615 3615</span><br><span class="line">[144]  329 3615 3615 3615 3615  242 3615 3615  646 3615 3615 3615 3615</span><br><span class="line">[157]  683  587  952    0 3615  320 1092 3615 3615   68  510 3615 3615</span><br><span class="line">[170]  245    2 3615  793 3615 3615 3615 2601 3615 3615 3615 1714 3615</span><br><span class="line">[183] 3615 3615 1230 1170 2386 3615  571  883 1912 3615 3615 3615 1986</span><br><span class="line">[196] 3615 1091 3615 3615 3615 3615 3615 1417 3615 3615   65 3615 3615</span><br><span class="line">[209] 3615 3615 3615 3615 1378 3615 3615 3615 3615 3615 3615 3615 3615</span><br><span class="line">[222] 3615 3615  679  866 3615 3615 3615 3615 3615  330 3615 3615  885</span><br><span class="line">[235] 3615  946 3615 3615  375 3615 3615 3615 1133 3615 3615  561 3615</span><br><span class="line">[248]  431 3615 2764 3615 3615 3615 3615 1696 3615   42 3615   59    0</span><br><span class="line">[261] 3615 3615 3615 3615 3615 1034 1270 1200 2241  333 3615 3615 3615</span><br><span class="line">[274] 3615  342 3615  722 3615 3615 1075 3615 3615 3615 3615  709 3615</span><br><span class="line">[287] 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615  164</span><br><span class="line">[300] 3615 3615 3615 3615 3615  701   69 3615 3615  574  106 3615 3615</span><br><span class="line">[313] 3615 3615  475 1019 3615 3615 3615  162  845 3615 3615  552  139</span><br><span class="line">[326] 3615 3615 3615 3615 1589 3615 1045  735 3615 3615 3615 3615 3615</span><br><span class="line">[339] 3615 3615 1972  459 3615 2299 3615 3615 3615  819 1463 3615 3615</span><br><span class="line">[352] 1724 3615 3615  313 3615 3615 3615  183 3615 3615 3615 3615 3615</span><br><span class="line">[365] 3615 3615 1626  822 3615  206  932 1097 3615 3615 3615 3615 3615</span><br><span class="line">[378] 3615 3615 3615  166  478 3615 1584 3615 3615 3615 3615  480 3615</span><br><span class="line">[391] 3615  311 3615 3615 3615 3615  202 3615  927 1343 1590  454 3615</span><br><span class="line">[404]  834 3615 3615 3615 2090 1598 3615 1639  878  992 3615 3615 3615</span><br><span class="line">[417] 3615   43 3615 2419 3615 3615 3615 3615 1121 3615 3615 3615 3615</span><br><span class="line">[430] 2343  485  110 3615 3615  313  204 3615 3615 3615  238 3615 3615</span><br><span class="line">[443] 3615 3615 3615 3615  480 3615  168 3615   73 3615 3615  101 3615</span><br><span class="line">[456] 3615 3615 3615  446 3615 3615  645 3615 1567 3615 3554 3615 3615</span><br><span class="line">[469] 3615 3615 3615  139 3615 3615 3615  841 3615 3615  336 3615 3615</span><br><span class="line">[482] 3615   99 3615 3615 3615 3615  637 3615 3615 3615 3615 1111 3615</span><br><span class="line">[495] 3615 3615   77  770 3615 3615 3615 3615  222 3615 3615 3615 3615</span><br><span class="line">[508]   41 3615 3615 3615 3615 3615 3615 3615 3615 1610  224 3615 1191</span><br><span class="line">[521] 3615   93 3615 3615  307 3615  211 3615 3615 1625 3615  578 3615</span><br><span class="line">[534] 3615 3615 3615 3615 3615</span><br><span class="line">&gt; fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">&gt; p &lt;- rep(0,length(annot_id)) <span class="comment"># 定义变量p，放p value</span></span><br><span class="line">&gt; s &lt;- rep(0,length(annot_id)) <span class="comment"># 定义变量s，放surv，即生存预期</span></span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(annot_id))&#123;</span><br><span class="line">+   m &lt;- survdiff(fit~km_plot_cancer[,i])</span><br><span class="line">+   p[i] &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">+   s[i] &lt;- ifelse(m<span class="variable">$obs</span>[1]/m<span class="variable">$n</span>[[1]] &gt; m<span class="variable">$obs</span>[2]/m<span class="variable">$n</span>[[2]],0,1) <span class="comment"># 0=低表达生存预期差，高表达生存预期好；1=低表达生存预期好，高表达生存预期差；</span></span><br><span class="line">+ &#125;</span><br><span class="line">&gt; class(p)</span><br><span class="line">[1] <span class="string">"numeric"</span></span><br><span class="line">&gt; length(p)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; class(s)</span><br><span class="line">[1] <span class="string">"numeric"</span></span><br><span class="line">&gt; length(s)</span><br><span class="line">[1] 4863</span><br><span class="line">&gt; table(s)</span><br><span class="line">s</span><br><span class="line">   0    1 </span><br><span class="line">2245 2618 <span class="comment"># 大致各一半</span></span><br><span class="line"></span><br><span class="line">&gt; result_select_annot<span class="variable">$survP</span> &lt;- p</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863    9 <span class="comment"># 多出新的一列</span></span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol        survP</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR 9.088360e-01</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F 2.033993e-03</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99 3.377814e-01</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1 7.404867e-01</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A 7.017783e-01</span><br><span class="line">&gt; result_select_annot<span class="variable">$surv</span> &lt;- s</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863   10 <span class="comment"># 又多出一列</span></span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol        survP surv</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR 9.088360e-01    0</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F 2.033993e-03    0</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05    0</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99 3.377814e-01    1</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1 7.404867e-01    0</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A 7.017783e-01    0</span><br><span class="line">&gt; result_survP &lt;- result_select_annot[result_select_annot<span class="variable">$survP</span> &lt; 0.001,] <span class="comment"># 筛选survP&lt;0.001的基因，共922个 </span></span><br><span class="line">&gt; dim(result_survP)</span><br><span class="line">[1] 922   9</span><br><span class="line">&gt; head(result_survP)</span><br><span class="line">   ensembl_gene_id   baseMean log2FoldChange     lfcSE       <span class="built_in">stat</span></span><br><span class="line">3  ENSG00000001630   218.0296      -1.154463 0.1200534  -9.616248</span><br><span class="line">20 ENSG00000005108  2576.9645      -1.624881 0.1633055  -9.949951</span><br><span class="line">36 ENSG00000007314   397.9782       1.635177 0.1774570   9.214498</span><br><span class="line">47 ENSG00000008988 45747.5469       1.061020 0.0931570  11.389586</span><br><span class="line">49 ENSG00000009765   462.9210      -4.288686 0.2380812 -18.013543</span><br><span class="line">54 ENSG00000010319  2118.5841      -1.634110 0.1484228 -11.009836</span><br><span class="line">         pvalue         padj hgnc_symbol        survP surv</span><br><span class="line">3  6.827609e-22 2.563747e-21     CYP51A1 1.373636e-05    0</span><br><span class="line">20 2.523085e-23 1.004634e-22      THSD7A 2.232279e-04    0</span><br><span class="line">36 3.127375e-20 1.092412e-19       SCN4A 3.566491e-05    0</span><br><span class="line">47 4.712258e-30 2.505970e-29       RPS20 1.083688e-04    1</span><br><span class="line">49 1.525459e-72 3.707111e-71         IYD 2.896293e-04    0</span><br><span class="line">54 3.426265e-28 1.691118e-27      SEMA3G 4.535900e-08    0</span><br></pre></td></tr></table></figure><p>最终筛选出来的这922个基因，符合FoldChange &gt; 2 &amp;&amp; pvalue &lt; 0.001 &amp;&amp; survP &lt; 0.001，下面，我们给这些基因分个组，</p><p>1）HG，在肿瘤中表达上调，且高表达生存预期好；log2FoldChange &gt; 1 &amp;&amp; surv = 0<br>2）HB，在肿瘤中表达上调，且高表达生存预期坏，暂且认为是原癌基因；log2FoldChange &gt; 1 &amp;&amp; surv = 1<br>3）LG，在肿瘤中表达下调，且高表达生存预期好，暂且认为是抑癌基因；log2FoldChange &lt; -1 &amp;&amp; surv = 0<br>4）LB，在肿瘤中表达下调，且高表达生存预期坏；log2FoldChange &lt; -1 &amp;&amp; surv = 1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; result_survP_HG &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &gt; 1 &amp; result_survP<span class="variable">$surv</span> == 0,]</span><br><span class="line">&gt; result_survP_HB &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &gt; 1 &amp; result_survP<span class="variable">$surv</span> == 1,]</span><br><span class="line">&gt; result_survP_LG &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &lt; -1 &amp; result_survP<span class="variable">$surv</span> == 0,]</span><br><span class="line">&gt; result_survP_LB &lt;- result_survP[result_survP<span class="variable">$log2FoldChange</span> &lt; -1 &amp; result_survP<span class="variable">$surv</span> == 1,]</span><br><span class="line"></span><br><span class="line">&gt; dim(result_survP_HG)</span><br><span class="line">[1] 141  10</span><br><span class="line">&gt; dim(result_survP_HB)</span><br><span class="line">[1] 416  10</span><br><span class="line">&gt; dim(result_survP_LG)</span><br><span class="line">[1] 314  10</span><br><span class="line">&gt; dim(result_survP_LB)</span><br><span class="line">[1] 51 10</span><br></pre></td></tr></table></figure><p>看一下这四个集合的基因</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line">&gt; result_survP_HG<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"SCN4A"</span>       <span class="string">"NRXN3"</span>       <span class="string">"TLL1"</span>        <span class="string">"ATP11A"</span>     </span><br><span class="line">  [5] <span class="string">"VASH1"</span>       <span class="string">"ADCY2"</span>       <span class="string">"SCGN"</span>        <span class="string">"NRP1"</span>       </span><br><span class="line">  [9] <span class="string">"SLC5A1"</span>      <span class="string">"BMX"</span>         <span class="string">"FLT1"</span>        <span class="string">"RGCC"</span>       </span><br><span class="line"> [13] <span class="string">"GRB10"</span>       <span class="string">"PRUNE2"</span>      <span class="string">"DOCK8"</span>       <span class="string">"LIPA"</span>       </span><br><span class="line"> [17] <span class="string">"VWF"</span>         <span class="string">"SLC17A2"</span>     <span class="string">"HAVCR1"</span>      <span class="string">"HHLA2"</span>      </span><br><span class="line"> [21] <span class="string">"SLC1A4"</span>      <span class="string">"PCDH17"</span>      <span class="string">"TEX11"</span>       <span class="string">"IQSEC3"</span>     </span><br><span class="line"> [25] <span class="string">"TMEM131L"</span>    <span class="string">"PREX1"</span>       <span class="string">"COL21A1"</span>     <span class="string">"CD93"</span>       </span><br><span class="line"> [29] <span class="string">"MCF2L"</span>       <span class="string">"MASP1"</span>       <span class="string">"F2RL3"</span>       <span class="string">"FBXL16"</span>     </span><br><span class="line"> [33] <span class="string">"KDR"</span>         <span class="string">"ACLY"</span>        <span class="string">"PER2"</span>        <span class="string">"ETS1"</span>       </span><br><span class="line"> [37] <span class="string">"DYSF"</span>        <span class="string">"TM6SF1"</span>      <span class="string">"HECW2"</span>       <span class="string">"CLEC18B"</span>    </span><br><span class="line"> [41] <span class="string">"CDH13"</span>       <span class="string">"RGS5"</span>        <span class="string">"HMCN1"</span>       <span class="string">"RIT1"</span>       </span><br><span class="line"> [45] <span class="string">"MALL"</span>        <span class="string">"MARCHF4"</span>     <span class="string">"SLC10A6"</span>     <span class="string">"ARHGAP26"</span>   </span><br><span class="line"> [49] <span class="string">"GFOD1"</span>       <span class="string">"SLC17A4"</span>     <span class="string">"DIAPH2"</span>      <span class="string">"PLIN2"</span>      </span><br><span class="line"> [53] <span class="string">"CDKN2B"</span>      <span class="string">"ANO4"</span>        <span class="string">"PDK1"</span>        <span class="string">"PTPRR"</span>      </span><br><span class="line"> [57] <span class="string">"LURAP1L"</span>     <span class="string">"ENPP3"</span>       <span class="string">"PIEZO2"</span>      <span class="string">"SLC28A1"</span>    </span><br><span class="line"> [61] <span class="string">"FZD1"</span>        <span class="string">"TSPAN18"</span>     <span class="string">"GALNT14"</span>     <span class="string">"ABCG1"</span>      </span><br><span class="line"> [65] <span class="string">"ADGRL4"</span>      <span class="string">"SPATA18"</span>     <span class="string">"TGFA"</span>        <span class="string">"SPRY1"</span>      </span><br><span class="line"> [69] <span class="string">"TLR3"</span>        <span class="string">"TMEM200A"</span>    <span class="string">"SLC18A2"</span>     <span class="string">"BTNL9"</span>      </span><br><span class="line"> [73] <span class="string">"ARHGAP42"</span>    <span class="string">"GALR1"</span>       <span class="string">"KCNAB1"</span>      <span class="string">"DPY19L2P2"</span>  </span><br><span class="line"> [77] <span class="string">"PDGFD"</span>       <span class="string">"INSR"</span>        <span class="string">"CYSLTR1"</span>     <span class="string">"ARL10"</span>      </span><br><span class="line"> [81] <span class="string">"BNIP3"</span>       <span class="string">"CLEC14A"</span>     <span class="string">""</span>            <span class="string">"SCN4B"</span>      </span><br><span class="line"> [85] <span class="string">"RIMKLA"</span>      <span class="string">"DNAJC22"</span>     <span class="string">"APOLD1"</span>      <span class="string">"EXOC3L1"</span>    </span><br><span class="line"> [89] <span class="string">"CDH4"</span>        <span class="string">"CDH5"</span>        <span class="string">"NLRP11"</span>      <span class="string">"P2RY8"</span>      </span><br><span class="line"> [93] <span class="string">""</span>            <span class="string">"F8"</span>          <span class="string">"QRFPR"</span>       <span class="string">"ZNF395"</span>     </span><br><span class="line"> [97] <span class="string">"C3orf70"</span>     <span class="string">"SPRY4"</span>       <span class="string">"PEAK3"</span>       <span class="string">"LRRK2"</span>      </span><br><span class="line">[101] <span class="string">"CTSE"</span>        <span class="string">"GIMAP5"</span>      <span class="string">"SLC22A4"</span>     <span class="string">"BNIP3P1"</span>    </span><br><span class="line">[105] <span class="string">"AVPR1B"</span>      <span class="string">"TRIM15"</span>      <span class="string">"INSYN2B"</span>     <span class="string">"C17orf107"</span>  </span><br><span class="line">[109] <span class="string">""</span>            <span class="string">""</span>            <span class="string">"LDHAP4"</span>      <span class="string">"ZNF812P"</span>    </span><br><span class="line">[113] <span class="string">"NPY6R"</span>       <span class="string">"LINC01738"</span>   <span class="string">"UBTFL6"</span>      <span class="string">"PRKAR1B-AS2"</span></span><br><span class="line">[117] <span class="string">""</span>            <span class="string">"HS1BP3-IT1"</span>  <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[121] <span class="string">"LDHAP3"</span>      <span class="string">"GGT8P"</span>       <span class="string">"LILRA4"</span>      <span class="string">"ACAD11"</span>     </span><br><span class="line">[125] <span class="string">"VWFP1"</span>       <span class="string">""</span>            <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[129] <span class="string">""</span>            <span class="string">"LINC01843"</span>   <span class="string">"SHANK3"</span>      <span class="string">"PTP4A2P2"</span>   </span><br><span class="line">[133] <span class="string">"PABPC4L"</span>     <span class="string">"LINC02747"</span>   <span class="string">"SLC5A8"</span>      <span class="string">""</span>           </span><br><span class="line">[137] <span class="string">""</span>            <span class="string">"PECAM1"</span>      <span class="string">""</span>            <span class="string">""</span>           </span><br><span class="line">[141] <span class="string">""</span>           </span><br><span class="line">&gt; result_survP_HB<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"RPS20"</span>        <span class="string">"PLAUR"</span>        <span class="string">"DDX11"</span>        <span class="string">"TACC3"</span>       </span><br><span class="line">  [5] <span class="string">"SLC38A5"</span>      <span class="string">"SLC11A1"</span>      <span class="string">"DEF6"</span>         <span class="string">"TYMP"</span>        </span><br><span class="line">  [9] <span class="string">"RNASET2"</span>      <span class="string">"SH2D2A"</span>       <span class="string">"POU2F2"</span>       <span class="string">"RTN4R"</span>       </span><br><span class="line"> [13] <span class="string">"FOXP3"</span>        <span class="string">"CYBA"</span>         <span class="string">"YBX3"</span>         <span class="string">"COL11A1"</span>     </span><br><span class="line"> [17] <span class="string">"VMP1"</span>         <span class="string">"CHI3L2"</span>       <span class="string">"CACNB1"</span>       <span class="string">"CLEC2D"</span>      </span><br><span class="line"> [21] <span class="string">"TRIP13"</span>       <span class="string">"GSDMB"</span>        <span class="string">"PPP2R2C"</span>      <span class="string">"GTSE1"</span>       </span><br><span class="line"> [25] <span class="string">"ACTN2"</span>        <span class="string">"NDC80"</span>        <span class="string">"CXCL2"</span>        <span class="string">"RAD54L"</span>      </span><br><span class="line"> [29] <span class="string">"PPEF1"</span>        <span class="string">"ACHE"</span>         <span class="string">"TPX2"</span>         <span class="string">"BIRC5"</span>       </span><br><span class="line"> [33] <span class="string">"LAG3"</span>         <span class="string">"DTX2"</span>         <span class="string">"TF"</span>           <span class="string">"ORC6"</span>        </span><br><span class="line"> [37] <span class="string">"RGS17"</span>        <span class="string">"UNC13D"</span>       <span class="string">"HSD3B7"</span>       <span class="string">"DERL3"</span>       </span><br><span class="line"> [41] <span class="string">"OSM"</span>          <span class="string">"LGALS1"</span>       <span class="string">"CENPM"</span>        <span class="string">"HDAC10"</span>      </span><br><span class="line"> [45] <span class="string">"POLE2"</span>        <span class="string">"CDKN3"</span>        <span class="string">"MMP9"</span>         <span class="string">"MYBL2"</span>       </span><br><span class="line"> [49] <span class="string">"PABPC1L"</span>      <span class="string">"SLC17A9"</span>      <span class="string">"PTK6"</span>         <span class="string">"TRIB3"</span>       </span><br><span class="line"> [53] <span class="string">"PIM2"</span>         <span class="string">"TAZ"</span>          <span class="string">"TIMP1"</span>        <span class="string">"RRN3P2"</span>      </span><br><span class="line"> [57] <span class="string">"PYCARD"</span>       <span class="string">"AQP9"</span>         <span class="string">"IGDCC4"</span>       <span class="string">"PDGFRL"</span>      </span><br><span class="line"> [61] <span class="string">"KCNN4"</span>        <span class="string">"GRIN2D"</span>       <span class="string">"JAK3"</span>         <span class="string">"HAMP"</span>        </span><br><span class="line"> [65] <span class="string">"PBX4"</span>         <span class="string">"HOXA13"</span>       <span class="string">"NSUN5P2"</span>      <span class="string">"TFR2"</span>        </span><br><span class="line"> [69] <span class="string">"RAPGEFL1"</span>     <span class="string">"KAT2A"</span>        <span class="string">"CNTNAP1"</span>      <span class="string">"DLX4"</span>        </span><br><span class="line"> [73] <span class="string">"NEIL3"</span>        <span class="string">"HPX"</span>          <span class="string">"MDK"</span>          <span class="string">"TCIRG1"</span>      </span><br><span class="line"> [77] <span class="string">"CDCA3"</span>        <span class="string">"KIF20A"</span>       <span class="string">"STEAP3"</span>       <span class="string">"CENPA"</span>       </span><br><span class="line"> [81] <span class="string">"TPSG1"</span>        <span class="string">"KIAA1324"</span>     <span class="string">"OPRD1"</span>        <span class="string">"CDC20"</span>       </span><br><span class="line"> [85] <span class="string">"NEK2"</span>         <span class="string">"CCDC18"</span>       <span class="string">"DDX39A"</span>       <span class="string">"CENPK"</span>       </span><br><span class="line"> [89] <span class="string">"HJURP"</span>        <span class="string">"BATF3"</span>        <span class="string">"WFDC3"</span>        <span class="string">"TNFSF14"</span>     </span><br><span class="line"> [93] <span class="string">"RBCK1"</span>        <span class="string">"IGFLR1"</span>       <span class="string">"HCST"</span>         <span class="string">"IDUA"</span>        </span><br><span class="line"> [97] <span class="string">"PKMYT1"</span>       <span class="string">"CHTF18"</span>       <span class="string">"LRFN1"</span>        <span class="string">"CPA4"</span>        </span><br><span class="line">[101] <span class="string">"ATP8B3"</span>       <span class="string">"FCHO1"</span>        <span class="string">"C1QL1"</span>        <span class="string">"THOC6"</span>       </span><br><span class="line">[105] <span class="string">"PODNL1"</span>       <span class="string">"SERPINF1"</span>     <span class="string">"C1QTNF6"</span>      <span class="string">"FKBP11"</span>      </span><br><span class="line">[109] <span class="string">"IL15RA"</span>       <span class="string">"SPOCD1"</span>       <span class="string">"CDCA8"</span>        <span class="string">"SLC43A3"</span>     </span><br><span class="line">[113] <span class="string">"OASL"</span>         <span class="string">"TROAP"</span>        <span class="string">"SLC9A5"</span>       <span class="string">"CCM2"</span>        </span><br><span class="line">[117] <span class="string">"LIMD2"</span>        <span class="string">"CD72"</span>         <span class="string">"SLCO5A1"</span>      <span class="string">"ITPKA"</span>       </span><br><span class="line">[121] <span class="string">"CEP55"</span>        <span class="string">"ZNF365"</span>       <span class="string">"ADAMTS14"</span>     <span class="string">"INHBE"</span>       </span><br><span class="line">[125] <span class="string">"GPR84"</span>        <span class="string">"MAP3K12"</span>      <span class="string">"BCL2A1"</span>       <span class="string">"PIF1"</span>        </span><br><span class="line">[129] <span class="string">"TICRR"</span>        <span class="string">"PRELID3A"</span>     <span class="string">"ASGR1"</span>        <span class="string">"CARD14"</span>      </span><br><span class="line">[133] <span class="string">"FKBP10"</span>       <span class="string">"EMP3"</span>         <span class="string">"SH3BGRL3"</span>     <span class="string">"KIF2C"</span>       </span><br><span class="line">[137] <span class="string">"NUF2"</span>         <span class="string">"TMEM44"</span>       <span class="string">"DOK3"</span>         <span class="string">"NFKBIE"</span>      </span><br><span class="line">[141] <span class="string">"MTFR2"</span>        <span class="string">"SLC25A37"</span>     <span class="string">"PRSS53"</span>       <span class="string">"ADAM8"</span>       </span><br><span class="line">[145] <span class="string">"CCDC74B"</span>      <span class="string">"SPC25"</span>        <span class="string">"TRIM36"</span>       <span class="string">"SKA1"</span>        </span><br><span class="line">[149] <span class="string">"GOLGA7B"</span>      <span class="string">"BATF"</span>         <span class="string">"BUB1B"</span>        <span class="string">"ZFHX2-AS1"</span>   </span><br><span class="line">[153] <span class="string">"CDC25C"</span>       <span class="string">"DUSP23"</span>       <span class="string">"NBL1"</span>         <span class="string">"RUNX1"</span>       </span><br><span class="line">[157] <span class="string">"C1R"</span>          <span class="string">"PPP1R35"</span>      <span class="string">"HK3"</span>          <span class="string">"SYCE2"</span>       </span><br><span class="line">[161] <span class="string">"SPC24"</span>        <span class="string">"CCDC78"</span>       <span class="string">"TEDC2"</span>        <span class="string">"LBHD1"</span>       </span><br><span class="line">[165] <span class="string">"CCDC74A"</span>      <span class="string">"DCST2"</span>        <span class="string">"TRIM46"</span>       <span class="string">"RPL22L1"</span>     </span><br><span class="line">[169] <span class="string">"CXCL1"</span>        <span class="string">"UCN"</span>          <span class="string">"SPDYA"</span>        <span class="string">"PTTG1"</span>       </span><br><span class="line">[173] <span class="string">"AGBL2"</span>        <span class="string">"PLEKHF1"</span>      <span class="string">"MSS51"</span>        <span class="string">"PKD1L2"</span>      </span><br><span class="line">[177] <span class="string">"FAM86GP"</span>      <span class="string">"CATSPER2"</span>     <span class="string">"PCLAF"</span>        <span class="string">"PLK1"</span>        </span><br><span class="line">[181] <span class="string">"MEI1"</span>         <span class="string">"PRRX2"</span>        <span class="string">"ENGASE"</span>       <span class="string">"TEPSIN"</span>      </span><br><span class="line">[185] <span class="string">"VKORC1"</span>       <span class="string">"JSRP1"</span>        <span class="string">"CORO6"</span>        <span class="string">"TTYH1"</span>       </span><br><span class="line">[189] <span class="string">"TRPV3"</span>        <span class="string">"CCDC88B"</span>      <span class="string">"REEP4"</span>        <span class="string">"THBS3"</span>       </span><br><span class="line">[193] <span class="string">"NPIPB3"</span>       <span class="string">"RNASE2"</span>       <span class="string">"BUB1"</span>         <span class="string">"CHRNA5"</span>      </span><br><span class="line">[197] <span class="string">"MZB1"</span>         <span class="string">"OSCAR"</span>        <span class="string">"ZNF692"</span>       <span class="string">"RRM2"</span>        </span><br><span class="line">[201] <span class="string">"LRRC15"</span>       <span class="string">"CEBPB"</span>        <span class="string">"MZT2A"</span>        <span class="string">"SAA1"</span>        </span><br><span class="line">[205] <span class="string">"NABP1"</span>        <span class="string">"CD7"</span>          <span class="string">"C1QTNF1"</span>      <span class="string">"IL20RB"</span>      </span><br><span class="line">[209] <span class="string">"RIN1"</span>         <span class="string">"CNIH2"</span>        <span class="string">"UBE2C"</span>        <span class="string">"GOLGA8A"</span>     </span><br><span class="line">[213] <span class="string">"CATSPER1"</span>     <span class="string">"B3GNTL1"</span>      <span class="string">"SPHK1"</span>        <span class="string">"CLK2"</span>        </span><br><span class="line">[217] <span class="string">"C8G"</span>          <span class="string">"LRRN4CL"</span>      <span class="string">"CPNE7"</span>        <span class="string">"MSC"</span>         </span><br><span class="line">[221] <span class="string">"RFLNA"</span>        <span class="string">"AURKB"</span>        <span class="string">"LBX2"</span>         <span class="string">"DNHD1"</span>       </span><br><span class="line">[225] <span class="string">"TMEM86B"</span>      <span class="string">"MAP6D1"</span>       <span class="string">"ARL6IP4"</span>      <span class="string">"B4GALNT4"</span>    </span><br><span class="line">[229] <span class="string">"KCNJ14"</span>       <span class="string">"FBXL6"</span>        <span class="string">"C1S"</span>          <span class="string">"CCNYL2"</span>      </span><br><span class="line">[233] <span class="string">"PYCR1"</span>        <span class="string">"GPR19"</span>        <span class="string">"NPIPA1"</span>       <span class="string">"BMP8A"</span>       </span><br><span class="line">[237] <span class="string">"CHEK2"</span>        <span class="string">"IQGAP3"</span>       <span class="string">"DUSP5P1"</span>      <span class="string">"STAC3"</span>       </span><br><span class="line">[241] <span class="string">"IRF7"</span>         <span class="string">"PRAME"</span>        <span class="string">"KIF18B"</span>       <span class="string">"TNFRSF18"</span>    </span><br><span class="line">[245] <span class="string">"PLEKHN1"</span>      <span class="string">"ISG15"</span>        <span class="string">"FANCA"</span>        <span class="string">"EIF4EBP1"</span>    </span><br><span class="line">[249] <span class="string">"TPRG1"</span>        <span class="string">"RUFY4"</span>        <span class="string">"ZP3"</span>          <span class="string">"NPIPP1"</span>      </span><br><span class="line">[253] <span class="string">"SLC4A5"</span>       <span class="string">"FAM78B"</span>       <span class="string">"SNHG17"</span>       <span class="string">"PDLIM7"</span>      </span><br><span class="line">[257] <span class="string">"ADAM32"</span>       <span class="string">"RAD54B"</span>       <span class="string">"ELOVL2"</span>       <span class="string">"GOLGA6L9"</span>    </span><br><span class="line">[261] <span class="string">"FCGR1B"</span>       <span class="string">"MMP17"</span>        <span class="string">"RYR2"</span>         <span class="string">"PLXNB3"</span>      </span><br><span class="line">[265] <span class="string">""</span>             <span class="string">"AGAP6"</span>        <span class="string">"LILRB3"</span>       <span class="string">"GABBR1"</span>      </span><br><span class="line">[269] <span class="string">"SYCE1L"</span>       <span class="string">"MUC12"</span>        <span class="string">"DUXAP8"</span>       <span class="string">"IGKC"</span>        </span><br><span class="line">[273] <span class="string">"IGLV1-47"</span>     <span class="string">"IGLV1-44"</span>     <span class="string">"IGLV3-19"</span>     <span class="string">"IGLC2"</span>       </span><br><span class="line">[277] <span class="string">"IGLC3"</span>        <span class="string">"IGHG4"</span>        <span class="string">"IGHG2"</span>        <span class="string">"IGHA1"</span>       </span><br><span class="line">[281] <span class="string">"IGHG1"</span>        <span class="string">"IGHG3"</span>        <span class="string">"CRYGS"</span>        <span class="string">"ASIC3"</span>       </span><br><span class="line">[285] <span class="string">"MXD3"</span>         <span class="string">"RPLP1P6"</span>      <span class="string">"LAT"</span>          <span class="string">"RPL17P50"</span>    </span><br><span class="line">[289] <span class="string">"PPM1N"</span>        <span class="string">"LTB4R"</span>        <span class="string">"NPEPL1"</span>       <span class="string">"IFI30"</span>       </span><br><span class="line">[293] <span class="string">"PRELID1P1"</span>    <span class="string">"PAM16"</span>        <span class="string">""</span>             <span class="string">"ZGLP1"</span>       </span><br><span class="line">[297] <span class="string">"FADS3"</span>        <span class="string">"CYTOR"</span>        <span class="string">"TSSC2"</span>        <span class="string">""</span>            </span><br><span class="line">[301] <span class="string">"C5orf66"</span>      <span class="string">"ZMIZ1-AS1"</span>    <span class="string">"MIAT"</span>         <span class="string">"LINC00115"</span>   </span><br><span class="line">[305] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"SLC16A1-AS1"</span>  <span class="string">"LINC00511"</span>   </span><br><span class="line">[309] <span class="string">"LTB"</span>          <span class="string">""</span>             <span class="string">"MELTF-AS1"</span>    <span class="string">"DPY19L1P1"</span>   </span><br><span class="line">[313] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"CYP21A2"</span>      <span class="string">"SNHG15"</span>      </span><br><span class="line">[317] <span class="string">"LINC02609"</span>    <span class="string">"YEATS2-AS1"</span>   <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[321] <span class="string">"LINC01871"</span>    <span class="string">"KDM4A-AS1"</span>    <span class="string">"MAP3K2-DT"</span>    <span class="string">"PRKAR1B-AS1"</span> </span><br><span class="line">[325] <span class="string">"FOXD2-AS1"</span>    <span class="string">"PCDHGC5"</span>      <span class="string">"CFB"</span>          <span class="string">"NPIPB5"</span>      </span><br><span class="line">[329] <span class="string">"APOBEC3D"</span>     <span class="string">""</span>             <span class="string">"IGKV3-15"</span>     <span class="string">""</span>            </span><br><span class="line">[333] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"LINC00926"</span>    <span class="string">"TNXA"</span>        </span><br><span class="line">[337] <span class="string">"LUCAT1"</span>       <span class="string">""</span>             <span class="string">"SRD5A3-AS1"</span>   <span class="string">"PVT1"</span>        </span><br><span class="line">[341] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"IGHGP"</span>        <span class="string">""</span>            </span><br><span class="line">[345] <span class="string">"IGLL5"</span>        <span class="string">"AGAP2-AS1"</span>    <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[349] <span class="string">"KLRA1P"</span>       <span class="string">"PPP1R14B-AS1"</span> <span class="string">"HP"</span>           <span class="string">""</span>            </span><br><span class="line">[353] <span class="string">"IFITM3P6"</span>     <span class="string">"LINC02328"</span>    <span class="string">"MC1R"</span>         <span class="string">"ZHX1-C8orf76"</span></span><br><span class="line">[357] <span class="string">""</span>             <span class="string">""</span>             <span class="string">"LINC01355"</span>    <span class="string">"VPS9D1-AS1"</span>  </span><br><span class="line">[361] <span class="string">""</span>             <span class="string">"SMG1P7"</span>       <span class="string">"H2BC20P"</span>      <span class="string">""</span>            </span><br><span class="line">[365] <span class="string">"CORO7"</span>        <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[369] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[373] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[377] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[381] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[385] <span class="string">"GTF2IP20"</span>     <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[389] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[393] <span class="string">""</span>             <span class="string">"EPOP"</span>         <span class="string">""</span>             <span class="string">"NOL12"</span>       </span><br><span class="line">[397] <span class="string">"LINC01138"</span>    <span class="string">""</span>             <span class="string">"TBC1D3L"</span>      <span class="string">""</span>            </span><br><span class="line">[401] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[405] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[409] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>            </span><br><span class="line">[413] <span class="string">""</span>             <span class="string">""</span>             <span class="string">""</span>             <span class="string">"HELLPAR"</span>     </span><br><span class="line">&gt; result_survP_LG<span class="variable">$hgnc_symbol</span></span><br><span class="line">  [1] <span class="string">"CYP51A1"</span>    <span class="string">"THSD7A"</span>     <span class="string">"IYD"</span>        <span class="string">"SEMA3G"</span>     <span class="string">"CHDH"</span>      </span><br><span class="line">  [6] <span class="string">"SLC7A9"</span>     <span class="string">"NDUFS1"</span>     <span class="string">"USP2"</span>       <span class="string">"VPS13D"</span>     <span class="string">"KITLG"</span>     </span><br><span class="line"> [11] <span class="string">"NEDD4L"</span>     <span class="string">"FSTL4"</span>      <span class="string">"AP5M1"</span>      <span class="string">"SYNE2"</span>      <span class="string">"CYFIP2"</span>    </span><br><span class="line"> [16] <span class="string">"ZMYND12"</span>    <span class="string">"MPPED2"</span>     <span class="string">"FECH"</span>       <span class="string">"PTPN3"</span>      <span class="string">"RPS6KA6"</span>   </span><br><span class="line"> [21] <span class="string">"LNX1"</span>       <span class="string">"MPP5"</span>       <span class="string">"EVC"</span>        <span class="string">"FRY"</span>        <span class="string">"NTN4"</span>      </span><br><span class="line"> [26] <span class="string">"ACAT1"</span>      <span class="string">"FMO4"</span>       <span class="string">"NEBL"</span>       <span class="string">"CEACAM1"</span>    <span class="string">"FDFT1"</span>     </span><br><span class="line"> [31] <span class="string">"OPHN1"</span>      <span class="string">"MAGI3"</span>      <span class="string">"COL4A4"</span>     <span class="string">"CADPS2"</span>     <span class="string">"COBLL1"</span>    </span><br><span class="line"> [36] <span class="string">"TRPM3"</span>      <span class="string">"ABCB1"</span>      <span class="string">"L2HGDH"</span>     <span class="string">"PTPN4"</span>      <span class="string">"JPH4"</span>      </span><br><span class="line"> [41] <span class="string">"XYLB"</span>       <span class="string">"SMIM24"</span>     <span class="string">"ERMP1"</span>      <span class="string">"MIOX"</span>       <span class="string">"CDKL1"</span>     </span><br><span class="line"> [46] <span class="string">"DCAF11"</span>     <span class="string">"MCF2"</span>       <span class="string">"CAB39L"</span>     <span class="string">"VWA8"</span>       <span class="string">"TOX3"</span>      </span><br><span class="line"> [51] <span class="string">"CA2"</span>        <span class="string">"SH2D4A"</span>     <span class="string">"DHDH"</span>       <span class="string">"COBL"</span>       <span class="string">"TMEM245"</span>   </span><br><span class="line"> [56] <span class="string">"BAG1"</span>       <span class="string">"CPEB3"</span>      <span class="string">"PBLD"</span>       <span class="string">"TBC1D9"</span>     <span class="string">"TRIM2"</span>     </span><br><span class="line"> [61] <span class="string">"PPARGC1A"</span>   <span class="string">"AKAP3"</span>      <span class="string">"FRK"</span>        <span class="string">"NCOA7"</span>      <span class="string">"EPM2A"</span>     </span><br><span class="line"> [66] <span class="string">"SEMA5A"</span>     <span class="string">"NNT"</span>        <span class="string">"AGXT2"</span>      <span class="string">"CPEB4"</span>      <span class="string">"HYAL1"</span>     </span><br><span class="line"> [71] <span class="string">"ATP6V1A"</span>    <span class="string">"EPB41L5"</span>    <span class="string">"TACR1"</span>      <span class="string">"PLCL1"</span>      <span class="string">"PARD3B"</span>    </span><br><span class="line"> [76] <span class="string">"WLS"</span>        <span class="string">"AGMAT"</span>      <span class="string">"HAO2"</span>       <span class="string">"ACADM"</span>      <span class="string">"ABCD3"</span>     </span><br><span class="line"> [81] <span class="string">"IRF6"</span>       <span class="string">"TREH"</span>       <span class="string">"ECRG4"</span>      <span class="string">"BSPRY"</span>      <span class="string">"ALDH6A1"</span>   </span><br><span class="line"> [86] <span class="string">"GOT1"</span>       <span class="string">"TEK"</span>        <span class="string">"EPHX2"</span>      <span class="string">"PDZRN3"</span>     <span class="string">"CAT"</span>       </span><br><span class="line"> [91] <span class="string">"PLG"</span>        <span class="string">"PCK1"</span>       <span class="string">"SCGB1D2"</span>    <span class="string">"FLRT3"</span>      <span class="string">"PLEKHG3"</span>   </span><br><span class="line"> [96] <span class="string">"PODXL"</span>      <span class="string">"HOXD1"</span>      <span class="string">"HOXD3"</span>      <span class="string">"SYNE1"</span>      <span class="string">"SLC34A1"</span>   </span><br><span class="line">[101] <span class="string">"NAPSA"</span>      <span class="string">"G6PC"</span>       <span class="string">"FMO5"</span>       <span class="string">"ZNF132"</span>     <span class="string">"DDC"</span>       </span><br><span class="line">[106] <span class="string">"ENAM"</span>       <span class="string">"ANGPTL3"</span>    <span class="string">"MYH10"</span>      <span class="string">"KL"</span>         <span class="string">"BEX2"</span>      </span><br><span class="line">[111] <span class="string">"GSTM3"</span>      <span class="string">"VAV3"</span>       <span class="string">"HMGCS2"</span>     <span class="string">"MYCN"</span>       <span class="string">"CLDN10"</span>    </span><br><span class="line">[116] <span class="string">"FBXO21"</span>     <span class="string">"EDAR"</span>       <span class="string">"TBC1D4"</span>     <span class="string">"SUCLA2"</span>     <span class="string">"LMO7"</span>      </span><br><span class="line">[121] <span class="string">"ALDOB"</span>      <span class="string">"BPHL"</span>       <span class="string">"SORL1"</span>      <span class="string">"PAQR5"</span>      <span class="string">"SEMA6D"</span>    </span><br><span class="line">[126] <span class="string">"DBT"</span>        <span class="string">"ARHGAP24"</span>   <span class="string">"GPAT3"</span>      <span class="string">"FRAS1"</span>      <span class="string">"CDKL2"</span>     </span><br><span class="line">[131] <span class="string">"SHROOM3"</span>    <span class="string">"HADH"</span>       <span class="string">"PELI2"</span>      <span class="string">"SLC27A2"</span>    <span class="string">"SLC14A1"</span>   </span><br><span class="line">[136] <span class="string">"ERBB2"</span>      <span class="string">"CGN"</span>        <span class="string">"GDF7"</span>       <span class="string">"CTDSPL"</span>     <span class="string">"ALDH1L1"</span>   </span><br><span class="line">[141] <span class="string">"SCD5"</span>       <span class="string">"USP53"</span>      <span class="string">"UGT3A1"</span>     <span class="string">"BHMT"</span>       <span class="string">"IQGAP2"</span>    </span><br><span class="line">[146] <span class="string">"CRHBP"</span>      <span class="string">"SLC25A48"</span>   <span class="string">"MMUT"</span>       <span class="string">"CYP39A1"</span>    <span class="string">"MFHAS1"</span>    </span><br><span class="line">[151] <span class="string">"AK3"</span>        <span class="string">"AUH"</span>        <span class="string">"ALAD"</span>       <span class="string">"SLC25A25"</span>   <span class="string">"CNNM2"</span>     </span><br><span class="line">[156] <span class="string">"SLC5A12"</span>    <span class="string">"GLYAT"</span>      <span class="string">"SLC22A8"</span>    <span class="string">"TMEM25"</span>     <span class="string">"MPP7"</span>      </span><br><span class="line">[161] <span class="string">"DLG2"</span>       <span class="string">"FREM2"</span>      <span class="string">"THRB"</span>       <span class="string">"ANK3"</span>       <span class="string">"NR3C2"</span>     </span><br><span class="line">[166] <span class="string">"ASAP2"</span>      <span class="string">"SLC25A4"</span>    <span class="string">"GPD1L"</span>      <span class="string">"SLC16A12"</span>   <span class="string">"PANK1"</span>     </span><br><span class="line">[171] <span class="string">"MARVELD2"</span>   <span class="string">"FRMD1"</span>      <span class="string">"KCNJ16"</span>     <span class="string">"PGM5"</span>       <span class="string">"SFXN2"</span>     </span><br><span class="line">[176] <span class="string">"FUT6"</span>       <span class="string">"DHRS4"</span>      <span class="string">"KCNJ15"</span>     <span class="string">"PAFAH2"</span>     <span class="string">"WNT9B"</span>     </span><br><span class="line">[181] <span class="string">"CPAMD8"</span>     <span class="string">"PTH1R"</span>      <span class="string">"MYL3"</span>       <span class="string">"CYP3A7"</span>     <span class="string">"NAPEPLD"</span>   </span><br><span class="line">[186] <span class="string">"TMEM82"</span>     <span class="string">"AKR7A3"</span>     <span class="string">"CDS1"</span>       <span class="string">"PTPN13"</span>     <span class="string">"DNASE1L3"</span>  </span><br><span class="line">[191] <span class="string">"RBM47"</span>      <span class="string">"EMCN"</span>       <span class="string">"HPGD"</span>       <span class="string">"ADGRV1"</span>     <span class="string">"TMEM174"</span>   </span><br><span class="line">[196] <span class="string">"RAET1E"</span>     <span class="string">"FREM1"</span>      <span class="string">"MYORG"</span>      <span class="string">"FBP1"</span>       <span class="string">"SLC16A9"</span>   </span><br><span class="line">[201] <span class="string">"CRYL1"</span>      <span class="string">"EML5"</span>       <span class="string">"NDRG2"</span>      <span class="string">"CCDC186"</span>    <span class="string">"OTOGL"</span>     </span><br><span class="line">[206] <span class="string">"CLMN"</span>       <span class="string">"WDR72"</span>      <span class="string">"CDH16"</span>      <span class="string">"LDHD"</span>       <span class="string">"GLYATL1"</span>   </span><br><span class="line">[211] <span class="string">"MTMR10"</span>     <span class="string">"CA4"</span>        <span class="string">"ACOX2"</span>      <span class="string">"GJB1"</span>       <span class="string">"PKHD1"</span>     </span><br><span class="line">[216] <span class="string">"FUT3"</span>       <span class="string">"UGT2B7"</span>     <span class="string">"CLCN5"</span>      <span class="string">"GPHN"</span>       <span class="string">"GATM"</span>      </span><br><span class="line">[221] <span class="string">"TLN2"</span>       <span class="string">"SUCLG2"</span>     <span class="string">"SLC22A13"</span>   <span class="string">"NUDT4"</span>      <span class="string">"JUP"</span>       </span><br><span class="line">[226] <span class="string">"SLC25A30"</span>   <span class="string">"ZHX3"</span>       <span class="string">"SLC6A19"</span>    <span class="string">"MFSD4A"</span>     <span class="string">"PCCA"</span>      </span><br><span class="line">[231] <span class="string">"TOM1L2"</span>     <span class="string">"KDF1"</span>       <span class="string">"MSRA"</span>       <span class="string">"HSD11B2"</span>    <span class="string">"GNG7"</span>      </span><br><span class="line">[236] <span class="string">"RNF152"</span>     <span class="string">"GCNT4"</span>      <span class="string">"SHMT1"</span>      <span class="string">"GRAMD1C"</span>    <span class="string">""</span>          </span><br><span class="line">[241] <span class="string">"KLHDC7A"</span>    <span class="string">"TCAIM"</span>      <span class="string">"MTURN"</span>      <span class="string">"WDFY3-AS2"</span>  <span class="string">"PAQR7"</span>     </span><br><span class="line">[246] <span class="string">"C11orf54"</span>   <span class="string">"SLC8A1"</span>     <span class="string">"ZNRF3"</span>      <span class="string">"LRRC55"</span>     <span class="string">"ST6GALNAC3"</span></span><br><span class="line">[251] <span class="string">"PRKD1"</span>      <span class="string">"CCSER1"</span>     <span class="string">"LRRC19"</span>     <span class="string">"ROBO2"</span>      <span class="string">"HS6ST3"</span>    </span><br><span class="line">[256] <span class="string">"PBX1"</span>       <span class="string">"SYN3"</span>       <span class="string">"SOWAHB"</span>     <span class="string">"PPARA"</span>      <span class="string">"AKR1C1"</span>    </span><br><span class="line">[261] <span class="string">"TSPYL4"</span>     <span class="string">"TCL6"</span>       <span class="string">"MEIS3P2"</span>    <span class="string">"SHISA6"</span>     <span class="string">"TSPYL1"</span>    </span><br><span class="line">[266] <span class="string">"KAZN"</span>       <span class="string">"ACADSB"</span>     <span class="string">"AJAP1"</span>      <span class="string">"MYO6"</span>       <span class="string">"SMIM10L2B"</span> </span><br><span class="line">[271] <span class="string">"OGDHL"</span>      <span class="string">"OCLN"</span>       <span class="string">"SLC22A12"</span>   <span class="string">"KIF13B"</span>     <span class="string">"SLC22A6"</span>   </span><br><span class="line">[276] <span class="string">"HIBCH"</span>      <span class="string">"PEG3"</span>       <span class="string">"ARC"</span>        <span class="string">"LRBA"</span>       <span class="string">"ECI2"</span>      </span><br><span class="line">[281] <span class="string">"MTOR"</span>       <span class="string">"BHLHB9"</span>     <span class="string">"SLC44A4"</span>    <span class="string">"ZNF204P"</span>    <span class="string">"CYS1"</span>      </span><br><span class="line">[286] <span class="string">"SYNJ2BP"</span>    <span class="string">"B3GNT10"</span>    <span class="string">"TTC3P1"</span>     <span class="string">"ZNF844"</span>     <span class="string">"PSMG3-AS1"</span> </span><br><span class="line">[291] <span class="string">"LINC00271"</span>  <span class="string">""</span>           <span class="string">"RAP2C-AS1"</span>  <span class="string">""</span>           <span class="string">""</span>          </span><br><span class="line">[296] <span class="string">"RPL34-AS1"</span>  <span class="string">""</span>           <span class="string">"MKLN1-AS"</span>   <span class="string">"SUCLG2-AS1"</span> <span class="string">"LINC02027"</span> </span><br><span class="line">[301] <span class="string">"C1orf210"</span>   <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>          </span><br><span class="line">[306] <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">"DYNLL2"</span>     <span class="string">""</span>          </span><br><span class="line">[311] <span class="string">""</span>           <span class="string">""</span>           <span class="string">""</span>           <span class="string">"PWAR5"</span>     </span><br><span class="line">&gt; result_survP_LB<span class="variable">$hgnc_symbol</span></span><br><span class="line"> [1] <span class="string">"CLDN11"</span>   <span class="string">"GPRC5A"</span>   <span class="string">"GYG2"</span>     <span class="string">"STYK1"</span>    <span class="string">"BCAS1"</span>    <span class="string">"IGF2BP2"</span> </span><br><span class="line"> [7] <span class="string">"SULT2B1"</span>  <span class="string">"EPB41L4B"</span> <span class="string">"CAPS"</span>     <span class="string">"PTGDS"</span>    <span class="string">"DNAJC12"</span>  <span class="string">"VTN"</span>     </span><br><span class="line">[13] <span class="string">"SLPI"</span>     <span class="string">"CHAC1"</span>    <span class="string">"PSAT1"</span>    <span class="string">"PPP1R1A"</span>  <span class="string">"KCNH3"</span>    <span class="string">"WNT10A"</span>  </span><br><span class="line">[19] <span class="string">"TFAP2A"</span>   <span class="string">"CILP"</span>     <span class="string">"BMPR1B"</span>   <span class="string">"NECTIN4"</span>  <span class="string">"SUSD4"</span>    <span class="string">"ATP6V1C2"</span></span><br><span class="line">[25] <span class="string">"SSC4D"</span>    <span class="string">"PLEKHG4B"</span> <span class="string">"FAM167A"</span>  <span class="string">"PROM2"</span>    <span class="string">"PPM1J"</span>    <span class="string">"SIM2"</span>    </span><br><span class="line">[31] <span class="string">"TLCD1"</span>    <span class="string">"BNIPL"</span>    <span class="string">"LIPH"</span>     <span class="string">"MELTF"</span>    <span class="string">"SHOC1"</span>    <span class="string">"SCNN1B"</span>  </span><br><span class="line">[37] <span class="string">"PHYHIP"</span>   <span class="string">"LRRN2"</span>    <span class="string">"HOXB9"</span>    <span class="string">"CEL"</span>      <span class="string">"MUC13"</span>    <span class="string">"B3GNT8"</span>  </span><br><span class="line">[43] <span class="string">"SMCO3"</span>    <span class="string">"WT1"</span>      <span class="string">"CLCNKA"</span>   <span class="string">"DNER"</span>     <span class="string">"SERPINA5"</span> <span class="string">"L1CAM"</span>   </span><br><span class="line">[49] <span class="string">"GEMIN8P4"</span> <span class="string">"MRPS6"</span>    <span class="string">"TRNP1"</span></span><br></pre></td></tr></table></figure><p>有了这个基因列表，后续可以进行富集分析或者GSEA分析。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们以padj或FoldChange为依据筛选了TOP10基因，并进行了生存分析，但效果并不理想，原因很简单，因为不论是P值还是变化倍数，其实都与病例生存时间没有必然关联。这次，我们来对所有差异表达基因批量进行生存分析，看有多少基因影响病例生存，并且找找规律。&lt;/p&gt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记12-富集分析</title>
    <link href="http://uteric.github.io/TCGA/TCGA12Enrich/"/>
    <id>http://uteric.github.io/TCGA/TCGA12Enrich/</id>
    <published>2020-07-05T21:13:51.000Z</published>
    <updated>2020-07-05T21:13:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，差异分析得到了4913个基因，注释后剩下4863个基因，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(result_select)</span><br><span class="line">[1] 4913    7</span><br><span class="line">&gt; dim(result_select_annot)</span><br><span class="line">[1] 4863    8</span><br></pre></td></tr></table></figure><p>现在，我们对这4863个已知基因进行富集分析，看这些基因都集中在哪些信号通路或者生物过程当中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">library(clusterProfiler)</span><br><span class="line">library(topGO)</span><br><span class="line">library(Rgraphviz)</span><br><span class="line">library(pathview)</span><br><span class="line">library(org.Hs.eg.db)</span><br><span class="line"></span><br><span class="line">DEGs_entrez_id &lt;- mapIds(x=org.Hs.eg.db,column=<span class="string">"ENTREZID"</span>,</span><br><span class="line">                         keys=as.character(result_select_annot<span class="variable">$hgnc_symbol</span>),keytype = <span class="string">"SYMBOL"</span>)</span><br><span class="line">enrich_go_BP &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"BP"</span>,pvalueCutoff = 0.05) <span class="comment"># BP, Biological Process，生物学过程</span></span><br><span class="line">enrich_go_MF &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"MF"</span>,pvalueCutoff = 0.05) <span class="comment"># MF, Molecular Function，分子功能 </span></span><br><span class="line">enrich_go_CC &lt;- enrichGO(gene=DEGs_entrez_id,OrgDb = <span class="string">"org.Hs.eg.db"</span>,ont = <span class="string">"CC"</span>,pvalueCutoff = 0.05) <span class="comment"># CC, Celular Components，细胞组份</span></span><br><span class="line">enrich_go_KEGG &lt;- enrichKEGG(gene=DEGs_entrez_id,organism=<span class="string">"hsa"</span>,keyType=<span class="string">"kegg"</span>,pvalueCutoff=0.05)</span><br></pre></td></tr></table></figure><p>现在，准备工作完成了，开始绘图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_BP,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA18.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_MF,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA19.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_CC,showCategory=20)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA20.png" alt></p><p>由于肾脏是排泄器官，可以看到绝大多数基因都集中在细胞外或细胞膜，而功能方面多参与膜运输，而参与的生物学过程多与免疫相关。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot(enrich_go_KEGG)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA21.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，差异分析得到了4913个基因，注释后剩下4863个基因，如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记11-生存曲线</title>
    <link href="http://uteric.github.io/TCGA/TCGA11Survival/"/>
    <id>http://uteric.github.io/TCGA/TCGA11Survival/</id>
    <published>2020-07-05T19:51:30.000Z</published>
    <updated>2020-07-05T19:51:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们在差异表达结果中按照padj筛选出了TOP10基因，现在，我们对TOP10基因绘制生存曲线，看它们的表达是否与病例的生存时间相关。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(survival)</span><br><span class="line">&gt; kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>) <span class="comment"># 将id列中的"diagnosis"替换为01，以便保持样本名称一致</span></span><br><span class="line">&gt; dim(kidney_clinic)</span><br><span class="line">[1] 530  14</span><br><span class="line">&gt; head(kidney_clinic)</span><br><span class="line">                      id classification_of_tumor tumor_stage gender</span><br><span class="line">1 TCGA-CZ-5986_diagnosis            not reported     stage i   male</span><br><span class="line">2 TCGA-CZ-4858_diagnosis            not reported    stage ii   male</span><br><span class="line">3 TCGA-B8-5551_diagnosis            not reported     stage i female</span><br><span class="line">4 TCGA-B0-4817_diagnosis            not reported   stage iii   male</span><br><span class="line">5 TCGA-BP-4325_diagnosis            not reported     stage i female</span><br><span class="line">6 TCGA-B0-4698_diagnosis            not reported    stage iv   male</span><br><span class="line">  year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">1          1945  not reported              2006  not reported  61</span><br><span class="line">2          1966  not reported              2005          2105  39</span><br><span class="line">3          1945  not reported              2010  not reported  65</span><br><span class="line">4          1921          2004              2002          1019  81</span><br><span class="line">5          1937  not reported              2001  not reported  64</span><br><span class="line">6          1928          2003              2003            42  75</span><br><span class="line">  deadORlive                      race      alcohol years_smoked</span><br><span class="line">1      Alive                     white Not Reported not reported</span><br><span class="line">2       Dead                     white Not Reported not reported</span><br><span class="line">3      Alive black or african american Not Reported not reported</span><br><span class="line">4       Dead                     white Not Reported not reported</span><br><span class="line">5      Alive                     white Not Reported not reported</span><br><span class="line">6       Dead                     white Not Reported not reported</span><br><span class="line">            newID</span><br><span class="line">1 TCGA-CZ-5986-01</span><br><span class="line">2 TCGA-CZ-4858-01</span><br><span class="line">3 TCGA-B8-5551-01</span><br><span class="line">4 TCGA-B0-4817-01</span><br><span class="line">5 TCGA-BP-4325-01</span><br><span class="line">6 TCGA-B0-4698-01</span><br><span class="line">&gt; km_plot &lt;- apply(padj_top10,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;) <span class="comment"># 这里的1表示对行操作，即对每个基因判断表达高，注意，输入的是data.frame，返回的是matrix</span></span><br><span class="line">&gt; dim(km_plot)</span><br><span class="line">[1] 611  10</span><br><span class="line">&gt; head(km_plot)</span><br><span class="line">                ENSG00000174514 ENSG00000249859 ENSG00000224490</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000061656 ENSG00000213963 ENSG00000185633</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000014257 ENSG00000187730 ENSG00000129521</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">                ENSG00000135245</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5454-11 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span></span><br><span class="line">&gt; km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),] <span class="comment"># km_plot来源于padj_top10，后者包含611个样本，有对照有肿瘤，而在做生存分析时只需要肿瘤样本，因此匹配01是为了筛选所有肿瘤样本</span></span><br><span class="line">&gt; dim(km_plot_cancer)</span><br><span class="line">[1] 538  10 <span class="comment"># 611个样本中，538个是肿瘤，然而，CASE只有530个，可见有来源于同一个病例的多个样本</span></span><br><span class="line">&gt; class(km_plot_cancer)</span><br><span class="line">[1] <span class="string">"matrix"</span> <span class="comment"># matrix允许重复的行</span></span><br><span class="line">&gt; head(km_plot_cancer)</span><br><span class="line">                ENSG00000174514 ENSG00000249859 ENSG00000224490</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">                ENSG00000061656 ENSG00000213963 ENSG00000185633</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000014257 ENSG00000187730 ENSG00000129521</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>          <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"up"</span>            <span class="string">"up"</span>            <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"up"</span>            <span class="string">"down"</span>          <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"down"</span>          <span class="string">"down"</span>          <span class="string">"up"</span>           </span><br><span class="line">                ENSG00000135245</span><br><span class="line">TCGA-CZ-5465-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-BP-4355-01 <span class="string">"up"</span>           </span><br><span class="line">TCGA-CZ-5451-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5081-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-B0-5697-01 <span class="string">"down"</span>         </span><br><span class="line">TCGA-A3-A8OV-01 <span class="string">"up"</span>  </span><br><span class="line">&gt; kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">&gt; dim(kidney_clinic_km)</span><br><span class="line">[1] 538  14 <span class="comment"># 还是538行，有8行重复</span></span><br><span class="line">&gt; class(kidney_clinic_km)</span><br><span class="line">[1] <span class="string">"data.frame"</span> <span class="comment"># data.frame行名不能重复，但内容可以重复</span></span><br><span class="line">&gt; head(kidney_clinic_km)</span><br><span class="line">                        id classification_of_tumor tumor_stage gender</span><br><span class="line">274 TCGA-CZ-5465_diagnosis            not reported   stage iii female</span><br><span class="line">358 TCGA-BP-4355_diagnosis            not reported   stage iii female</span><br><span class="line">517 TCGA-CZ-5451_diagnosis            not reported    stage ii   male</span><br><span class="line">119 TCGA-B0-5081_diagnosis            not reported   stage iii female</span><br><span class="line">201 TCGA-B0-5697_diagnosis            not reported     stage i   male</span><br><span class="line">484 TCGA-A3-A8OV_diagnosis            not reported     stage i   male</span><br><span class="line">    year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">274          1931  not reported              2007          2564  76</span><br><span class="line">358          1949          2010              2008           953  59</span><br><span class="line">517          1932  not reported              2006  not reported  74</span><br><span class="line">119          1926          2005              2005           362  79</span><br><span class="line">201          1957  not reported              2007  not reported  50</span><br><span class="line">484          1936  not reported              2011  not reported  75</span><br><span class="line">    deadORlive                      race      alcohol years_smoked</span><br><span class="line">274       Dead              not reported Not Reported not reported</span><br><span class="line">358       Dead                     white Not Reported not reported</span><br><span class="line">517      Alive                     white Not Reported not reported</span><br><span class="line">119       Dead                     white Not Reported not reported</span><br><span class="line">201      Alive                     white Not Reported not reported</span><br><span class="line">484      Alive black or african american Not Reported           65</span><br><span class="line">              newID</span><br><span class="line">274 TCGA-CZ-5465-01</span><br><span class="line">358 TCGA-BP-4355-01</span><br><span class="line">517 TCGA-CZ-5451-01</span><br><span class="line">119 TCGA-B0-5081-01</span><br><span class="line">201 TCGA-B0-5697-01</span><br><span class="line">484 TCGA-A3-A8OV-01</span><br><span class="line"></span><br><span class="line">&gt; daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>)) <span class="comment"># 临床数据需要用到的是days_to_death</span></span><br><span class="line">Warning message:</span><br><span class="line">NAs introduced by coercion </span><br><span class="line">&gt; daysToDeath <span class="comment"># 有许多是NA</span></span><br><span class="line">  [1] 2564  953   NA  362   NA   NA   62 1493   51   NA   NA   NA 1588</span><br><span class="line"> [14]   NA  885 2227  137   NA   NA 1432   NA   NA   NA   NA   NA   NA</span><br><span class="line"> [27] 1657   NA   18   NA 1964   NA  109   NA 1661   NA   NA   NA   NA</span><br><span class="line"> [40]   NA   NA   NA   NA 1315 1404  562  445   NA   NA   NA   NA 1238</span><br><span class="line"> [53]  182 1912   NA   NA   NA   NA 2454  344   NA 1913 1111   NA 1980</span><br><span class="line"> [66]   NA  600 1003   NA   NA   NA   NA 2105 1371  334   NA 1337   NA</span><br><span class="line"> [79]   NA   NA   NA   NA   NA   NA  727   NA   NA 2256   NA   NA   NA</span><br><span class="line"> [92]  782   NA   NA   NA   NA   NA   NA   NA 1625   NA   NA   NA   NA</span><br><span class="line">[105]   NA   NA  768   NA   NA   NA   NA   NA  563   NA 2145   NA   NA</span><br><span class="line">[118]   NA  561   NA   NA   NA   NA   NA   NA   NA   NA 1200   NA   NA</span><br><span class="line">[131]   NA   NA   NA   NA   NA   NA 1317   NA   NA   NA   NA   NA   NA</span><br><span class="line">[144]  329   NA   NA   NA   NA  242   NA   NA  646   NA   NA   NA   NA</span><br><span class="line">[157]  683  587  952    0   NA  320 1092   NA   NA   68  510   NA   NA</span><br><span class="line">[170]  245    2   NA  793   NA   NA   NA 2601   NA   NA   NA 1714   NA</span><br><span class="line">[183]   NA   NA 1230 1170 2386   NA  571  883 1912   NA   NA   NA 1986</span><br><span class="line">[196]   NA 1091   NA   NA   NA   NA   NA 1417   NA   NA   65   NA   NA</span><br><span class="line">[209]   NA   NA   NA   NA 1378   NA   NA   NA   NA   NA   NA   NA   NA</span><br><span class="line">[222]   NA   NA  679  866   NA   NA   NA   NA   NA  330   NA   NA  885</span><br><span class="line">[235]   NA  946   NA   NA  375   NA   NA   NA 1133   NA   NA  561   NA</span><br><span class="line">[248]  431   NA 2764   NA   NA   NA   NA 1696   NA   42   NA   59    0</span><br><span class="line">[261]   NA   NA   NA   NA   NA 1034 1270 1200 2241  333   NA   NA   NA</span><br><span class="line">[274]   NA  342   NA  722   NA   NA 1075   NA   NA   NA   NA  709   NA</span><br><span class="line">[287]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  164</span><br><span class="line">[300]   NA   NA   NA   NA   NA  701   69   NA   NA  574  106   NA   NA</span><br><span class="line">[313]   NA   NA  475 1019   NA   NA   NA  162  845   NA   NA  552  139</span><br><span class="line">[326]   NA   NA   NA   NA 1589   NA 1045  735   NA   NA   NA   NA   NA</span><br><span class="line">[339]   NA   NA 1972  459   NA 2299   NA   NA   NA  819 1463   NA   NA</span><br><span class="line">[352] 1724   NA   NA  313   NA   NA   NA  183   NA   NA   NA   NA   NA</span><br><span class="line">[365]   NA   NA 1626  822   NA  206  932 1097   NA   NA   NA   NA   NA</span><br><span class="line">[378]   NA   NA   NA  166  478   NA 1584   NA   NA   NA   NA  480   NA</span><br><span class="line">[391]   NA  311   NA   NA   NA   NA  202   NA  927 1343 1590  454   NA</span><br><span class="line">[404]  834   NA   NA   NA 2090 1598   NA 1639  878  992   NA   NA   NA</span><br><span class="line">[417]   NA   43   NA 2419   NA   NA   NA   NA 1121   NA   NA   NA   NA</span><br><span class="line">[430] 2343  485  110   NA   NA  313  204   NA   NA   NA  238   NA   NA</span><br><span class="line">[443]   NA   NA   NA   NA  480   NA  168   NA   73   NA   NA  101   NA</span><br><span class="line">[456]   NA   NA   NA  446 3615   NA  645   NA 1567   NA 3554   NA   NA</span><br><span class="line">[469]   NA   NA   NA  139   NA   NA   NA  841   NA   NA  336   NA   NA</span><br><span class="line">[482]   NA   99   NA   NA   NA   NA  637   NA   NA   NA   NA 1111   NA</span><br><span class="line">[495]   NA   NA   77  770   NA   NA   NA   NA  222   NA   NA   NA   NA</span><br><span class="line">[508]   41   NA   NA   NA   NA   NA   NA   NA   NA 1610  224   NA 1191</span><br><span class="line">[521]   NA   93   NA   NA  307   NA  211   NA   NA 1625   NA  578   NA</span><br><span class="line">[534]   NA   NA   NA   NA   NA</span><br><span class="line"></span><br><span class="line">&gt; daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath) <span class="comment"># 没有报道死亡天数的，认为还活着，使用最大天数</span></span><br><span class="line">&gt; daysToDeathN</span><br><span class="line">  [1] 2564  953 3615  362 3615 3615   62 1493   51 3615 3615 3615 1588</span><br><span class="line"> [14] 3615  885 2227  137 3615 3615 1432 3615 3615 3615 3615 3615 3615</span><br><span class="line"> [27] 1657 3615   18 3615 1964 3615  109 3615 1661 3615 3615 3615 3615</span><br><span class="line"> [40] 3615 3615 3615 3615 1315 1404  562  445 3615 3615 3615 3615 1238</span><br><span class="line"> [53]  182 1912 3615 3615 3615 3615 2454  344 3615 1913 1111 3615 1980</span><br><span class="line"> [66] 3615  600 1003 3615 3615 3615 3615 2105 1371  334 3615 1337 3615</span><br><span class="line"> [79] 3615 3615 3615 3615 3615 3615  727 3615 3615 2256 3615 3615 3615</span><br><span class="line"> [92]  782 3615 3615 3615 3615 3615 3615 3615 1625 3615 3615 3615 3615</span><br><span class="line">[105] 3615 3615  768 3615 3615 3615 3615 3615  563 3615 2145 3615 3615</span><br><span class="line">[118] 3615  561 3615 3615 3615 3615 3615 3615 3615 3615 1200 3615 3615</span><br><span class="line">[131] 3615 3615 3615 3615 3615 3615 1317 3615 3615 3615 3615 3615 3615</span><br><span class="line">[144]  329 3615 3615 3615 3615  242 3615 3615  646 3615 3615 3615 3615</span><br><span class="line">[157]  683  587  952    0 3615  320 1092 3615 3615   68  510 3615 3615</span><br><span class="line">[170]  245    2 3615  793 3615 3615 3615 2601 3615 3615 3615 1714 3615</span><br><span class="line">[183] 3615 3615 1230 1170 2386 3615  571  883 1912 3615 3615 3615 1986</span><br><span class="line">[196] 3615 1091 3615 3615 3615 3615 3615 1417 3615 3615   65 3615 3615</span><br><span class="line">[209] 3615 3615 3615 3615 1378 3615 3615 3615 3615 3615 3615 3615 3615</span><br><span class="line">[222] 3615 3615  679  866 3615 3615 3615 3615 3615  330 3615 3615  885</span><br><span class="line">[235] 3615  946 3615 3615  375 3615 3615 3615 1133 3615 3615  561 3615</span><br><span class="line">[248]  431 3615 2764 3615 3615 3615 3615 1696 3615   42 3615   59    0</span><br><span class="line">[261] 3615 3615 3615 3615 3615 1034 1270 1200 2241  333 3615 3615 3615</span><br><span class="line">[274] 3615  342 3615  722 3615 3615 1075 3615 3615 3615 3615  709 3615</span><br><span class="line">[287] 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615 3615  164</span><br><span class="line">[300] 3615 3615 3615 3615 3615  701   69 3615 3615  574  106 3615 3615</span><br><span class="line">[313] 3615 3615  475 1019 3615 3615 3615  162  845 3615 3615  552  139</span><br><span class="line">[326] 3615 3615 3615 3615 1589 3615 1045  735 3615 3615 3615 3615 3615</span><br><span class="line">[339] 3615 3615 1972  459 3615 2299 3615 3615 3615  819 1463 3615 3615</span><br><span class="line">[352] 1724 3615 3615  313 3615 3615 3615  183 3615 3615 3615 3615 3615</span><br><span class="line">[365] 3615 3615 1626  822 3615  206  932 1097 3615 3615 3615 3615 3615</span><br><span class="line">[378] 3615 3615 3615  166  478 3615 1584 3615 3615 3615 3615  480 3615</span><br><span class="line">[391] 3615  311 3615 3615 3615 3615  202 3615  927 1343 1590  454 3615</span><br><span class="line">[404]  834 3615 3615 3615 2090 1598 3615 1639  878  992 3615 3615 3615</span><br><span class="line">[417] 3615   43 3615 2419 3615 3615 3615 3615 1121 3615 3615 3615 3615</span><br><span class="line">[430] 2343  485  110 3615 3615  313  204 3615 3615 3615  238 3615 3615</span><br><span class="line">[443] 3615 3615 3615 3615  480 3615  168 3615   73 3615 3615  101 3615</span><br><span class="line">[456] 3615 3615 3615  446 3615 3615  645 3615 1567 3615 3554 3615 3615</span><br><span class="line">[469] 3615 3615 3615  139 3615 3615 3615  841 3615 3615  336 3615 3615</span><br><span class="line">[482] 3615   99 3615 3615 3615 3615  637 3615 3615 3615 3615 1111 3615</span><br><span class="line">[495] 3615 3615   77  770 3615 3615 3615 3615  222 3615 3615 3615 3615</span><br><span class="line">[508]   41 3615 3615 3615 3615 3615 3615 3615 3615 1610  224 3615 1191</span><br><span class="line">[521] 3615   93 3615 3615  307 3615  211 3615 3615 1625 3615  578 3615</span><br><span class="line">[534] 3615 3615 3615 3615 3615</span><br><span class="line"></span><br><span class="line">&gt; fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">&gt; fit</span><br><span class="line">  [1] 2564   953  3615+  362  3615+ 3615+   62  1493    51  3615+</span><br><span class="line"> [11] 3615+ 3615+ 1588  3615+  885  2227   137  3615+ 3615+ 1432 </span><br><span class="line"> [21] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1657  3615+   18  3615+</span><br><span class="line"> [31] 1964  3615+  109  3615+ 1661  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line"> [41] 3615+ 3615+ 3615+ 1315  1404   562   445  3615+ 3615+ 3615+</span><br><span class="line"> [51] 3615+ 1238   182  1912  3615+ 3615+ 3615+ 3615+ 2454   344 </span><br><span class="line"> [61] 3615+ 1913  1111  3615+ 1980  3615+  600  1003  3615+ 3615+</span><br><span class="line"> [71] 3615+ 3615+ 2105  1371   334  3615+ 1337  3615+ 3615+ 3615+</span><br><span class="line"> [81] 3615+ 3615+ 3615+ 3615+  727  3615+ 3615+ 2256  3615+ 3615+</span><br><span class="line"> [91] 3615+  782  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1625 </span><br><span class="line">[101] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  768  3615+ 3615+ 3615+</span><br><span class="line">[111] 3615+ 3615+  563  3615+ 2145  3615+ 3615+ 3615+  561  3615+</span><br><span class="line">[121] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1200  3615+ 3615+</span><br><span class="line">[131] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1317  3615+ 3615+ 3615+</span><br><span class="line">[141] 3615+ 3615+ 3615+  329  3615+ 3615+ 3615+ 3615+  242  3615+</span><br><span class="line">[151] 3615+  646  3615+ 3615+ 3615+ 3615+  683   587   952     0 </span><br><span class="line">[161] 3615+  320  1092  3615+ 3615+   68   510  3615+ 3615+  245 </span><br><span class="line">[171]    2  3615+  793  3615+ 3615+ 3615+ 2601  3615+ 3615+ 3615+</span><br><span class="line">[181] 1714  3615+ 3615+ 3615+ 1230  1170  2386  3615+  571   883 </span><br><span class="line">[191] 1912  3615+ 3615+ 3615+ 1986  3615+ 1091  3615+ 3615+ 3615+</span><br><span class="line">[201] 3615+ 3615+ 1417  3615+ 3615+   65  3615+ 3615+ 3615+ 3615+</span><br><span class="line">[211] 3615+ 3615+ 1378  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[221] 3615+ 3615+ 3615+  679   866  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[231]  330  3615+ 3615+  885  3615+  946  3615+ 3615+  375  3615+</span><br><span class="line">[241] 3615+ 3615+ 1133  3615+ 3615+  561  3615+  431  3615+ 2764 </span><br><span class="line">[251] 3615+ 3615+ 3615+ 3615+ 1696  3615+   42  3615+   59     0 </span><br><span class="line">[261] 3615+ 3615+ 3615+ 3615+ 3615+ 1034  1270  1200  2241   333 </span><br><span class="line">[271] 3615+ 3615+ 3615+ 3615+  342  3615+  722  3615+ 3615+ 1075 </span><br><span class="line">[281] 3615+ 3615+ 3615+ 3615+  709  3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[291] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  164  3615+</span><br><span class="line">[301] 3615+ 3615+ 3615+ 3615+  701    69  3615+ 3615+  574   106 </span><br><span class="line">[311] 3615+ 3615+ 3615+ 3615+  475  1019  3615+ 3615+ 3615+  162 </span><br><span class="line">[321]  845  3615+ 3615+  552   139  3615+ 3615+ 3615+ 3615+ 1589 </span><br><span class="line">[331] 3615+ 1045   735  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[341] 1972   459  3615+ 2299  3615+ 3615+ 3615+  819  1463  3615+</span><br><span class="line">[351] 3615+ 1724  3615+ 3615+  313  3615+ 3615+ 3615+  183  3615+</span><br><span class="line">[361] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1626   822  3615+  206 </span><br><span class="line">[371]  932  1097  3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line">[381]  166   478  3615+ 1584  3615+ 3615+ 3615+ 3615+  480  3615+</span><br><span class="line">[391] 3615+  311  3615+ 3615+ 3615+ 3615+  202  3615+  927  1343 </span><br><span class="line">[401] 1590   454  3615+  834  3615+ 3615+ 3615+ 2090  1598  3615+</span><br><span class="line">[411] 1639   878   992  3615+ 3615+ 3615+ 3615+   43  3615+ 2419 </span><br><span class="line">[421] 3615+ 3615+ 3615+ 3615+ 1121  3615+ 3615+ 3615+ 3615+ 2343 </span><br><span class="line">[431]  485   110  3615+ 3615+  313   204  3615+ 3615+ 3615+  238 </span><br><span class="line">[441] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+  480  3615+  168  3615+</span><br><span class="line">[451]   73  3615+ 3615+  101  3615+ 3615+ 3615+ 3615+  446  3615 </span><br><span class="line">[461] 3615+  645  3615+ 1567  3615+ 3554  3615+ 3615+ 3615+ 3615+</span><br><span class="line">[471] 3615+  139  3615+ 3615+ 3615+  841  3615+ 3615+  336  3615+</span><br><span class="line">[481] 3615+ 3615+   99  3615+ 3615+ 3615+ 3615+  637  3615+ 3615+</span><br><span class="line">[491] 3615+ 3615+ 1111  3615+ 3615+ 3615+   77   770  3615+ 3615+</span><br><span class="line">[501] 3615+ 3615+  222  3615+ 3615+ 3615+ 3615+   41  3615+ 3615+</span><br><span class="line">[511] 3615+ 3615+ 3615+ 3615+ 3615+ 3615+ 1610   224  3615+ 1191 </span><br><span class="line">[521] 3615+   93  3615+ 3615+  307  3615+  211  3615+ 3615+ 1625 </span><br><span class="line">[531] 3615+  578  3615+ 3615+ 3615+ 3615+ 3615+ 3615+</span><br><span class="line"></span><br><span class="line">&gt; par(mfrow=c(2,5))</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(padj_top10_id))&#123;</span><br><span class="line">+   kmfit1 &lt;- survfit(fit~km_plot_cancer[,i])</span><br><span class="line">+   plot(kmfit1,lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),col=c(<span class="string">"blue"</span>,<span class="string">"red"</span>),lwd=c(2,2),cex.main=1.8,</span><br><span class="line">+        xlab=<span class="string">"survival time in days"</span>,ylab=<span class="string">"survival probabilities"</span>,cex.lab=1.6,</span><br><span class="line">+        cex.axis=1.8,main=padj_top10_symbol[i])</span><br><span class="line">+ m &lt;- survdiff(y~km_plot_cancer[,i])</span><br><span class="line">+ p_value &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">+ text(2000,0.95,paste(<span class="string">"P="</span>, round(p_value,digit=4)),cex=1.2)</span><br><span class="line">+ legend(<span class="string">"bottom"</span>,c(<span class="string">"High"</span>,<span class="string">"Low"</span>),lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),seg.len = 1, col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>),border=<span class="string">"white"</span>,bty=<span class="string">"n"</span>,cex=1.2,lwd=c(2,2))</span><br><span class="line">+ &#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA16.png" alt></p><p>这个结果并不理想，只有前两个基因的表达量与生存时间有关联，MFSD4A高表达生存时间长，而PVT1低表达生存时间长。</p><p>我们可以换个角度思考同一个问题，如果以FoldChange来挑选TOP10基因，结果如何？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&gt; annot_order_FC &lt;- result_select_annot[order(abs(result_select_annot<span class="variable">$log2FoldChange</span>),decreasing = T),]</span><br><span class="line">&gt; head(annot_order_FC)</span><br><span class="line">     ensembl_gene_id   baseMean log2FoldChange     lfcSE      <span class="built_in">stat</span></span><br><span class="line">3736 ENSG00000224490  1714.5650       8.442435 0.2386643  35.37369</span><br><span class="line">271  ENSG00000074803 22193.6542      -8.275817 0.3329828 -24.85359</span><br><span class="line">2856 ENSG00000178776   886.3988       7.706962 0.3261798  23.62795</span><br><span class="line">3468 ENSG00000204362   354.1751       7.570398 0.2945341  25.70296</span><br><span class="line">597  ENSG00000104327  2844.9568      -7.529189 0.2863865 -26.29031</span><br><span class="line">2280 ENSG00000164434 11701.5196       7.440639 0.3247560  22.91148</span><br><span class="line">            pvalue          padj hgnc_symbol</span><br><span class="line">3736 4.335266e-274 2.619801e-270  TTC21B-AS1</span><br><span class="line">271  2.364992e-136 4.660319e-134     SLC12A1</span><br><span class="line">2856 1.989551e-123 2.632742e-121     C5orf46</span><br><span class="line">3468 1.083083e-145 2.727112e-143   LINC02783</span><br><span class="line">597  2.474996e-152 8.309111e-150       CALB1</span><br><span class="line">2280 3.570399e-116 3.785249e-114       FABP7</span><br><span class="line">&gt; FC_top10_symbol &lt;- head(annot_order_FC<span class="variable">$hgnc_symbol</span>,10)</span><br><span class="line">&gt; FC_top10_id &lt;- head(annot_order_FC<span class="variable">$ensembl_gene_id</span>,10)</span><br><span class="line">&gt; FC_top10 &lt;- data_select[match(FC_top10_id,rownames(data_select)),]</span><br><span class="line">&gt; colnames(FC_top10) &lt;- substr(colnames(FC_top10),1,15)</span><br><span class="line">&gt; head(FC_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000224490            8222             864            3772</span><br><span class="line">ENSG00000074803           19360             100              10</span><br><span class="line">ENSG00000178776            1165              97             423</span><br><span class="line">ENSG00000204362             201             519              20</span><br><span class="line">ENSG00000104327              24              35               6</span><br><span class="line">ENSG00000164434           17120            6341           21755</span><br><span class="line">&gt; dim(FC_top10)</span><br><span class="line">[1]  10 611</span><br><span class="line"></span><br><span class="line">kidney_clinic<span class="variable">$newID</span> &lt;- gsub(<span class="string">"\\_diagnosis"</span>,<span class="string">"\\-01"</span>,kidney_clinic<span class="variable">$id</span>)</span><br><span class="line">dim(kidney_clinic)</span><br><span class="line">head(kidney_clinic)</span><br><span class="line">km_plot &lt;- apply(FC_top10,1,<span class="keyword">function</span>(x)&#123;ifelse(x&gt;median(x),<span class="string">"up"</span>,<span class="string">"down"</span>)&#125;)</span><br><span class="line">dim(km_plot)</span><br><span class="line">head(km_plot)</span><br><span class="line">km_plot_cancer &lt;- km_plot[grepl(<span class="string">"TCGA\\S&#123;9&#125;01"</span>,rownames(km_plot)),]</span><br><span class="line">dim(km_plot_cancer)</span><br><span class="line">head(km_plot_cancer)</span><br><span class="line">kidney_clinic_km &lt;- kidney_clinic[match(rownames(km_plot_cancer),kidney_clinic<span class="variable">$newID</span>),]</span><br><span class="line">dim(kidney_clinic_km)</span><br><span class="line">head(kidney_clinic_km)</span><br><span class="line">daysToDeath &lt;- as.numeric(as.character(kidney_clinic_km<span class="variable">$days_to_death</span>))</span><br><span class="line">daysToDeath</span><br><span class="line">daysToDeathN  &lt;- ifelse(is.na(daysToDeath),max(na.omit(daysToDeath)),daysToDeath)</span><br><span class="line">daysToDeathN</span><br><span class="line">fit &lt;- Surv(daysToDeathN,ifelse(kidney_clinic_km<span class="variable">$deadORlive</span>==<span class="string">"Dead"</span>,1,0)==1)</span><br><span class="line">par(mfrow=c(2,5))</span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(FC_top10_id))&#123;</span><br><span class="line">  kmfit1 &lt;- survfit(fit~km_plot_cancer[,i])</span><br><span class="line">  plot(kmfit1,lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),col=c(<span class="string">"blue"</span>,<span class="string">"red"</span>),lwd=c(2,2),cex.main=1.8,</span><br><span class="line">       xlab=<span class="string">"survival time in days"</span>,ylab=<span class="string">"survival probabilities"</span>,cex.lab=1.6,</span><br><span class="line">       cex.axis=1.8,main=FC_top10_symbol[i])</span><br><span class="line">  m &lt;- survdiff(y~km_plot_cancer[,i])</span><br><span class="line">  p_value &lt;- 1 - pchisq(m<span class="variable">$chisq</span>, length(m<span class="variable">$n</span>) -1)</span><br><span class="line">  text(2000,0.95,paste(<span class="string">"P="</span>, round(p_value,digit=4)),cex=1.2)</span><br><span class="line">  legend(<span class="string">"bottom"</span>,c(<span class="string">"High"</span>,<span class="string">"Low"</span>),lty=c(<span class="string">"solid"</span>,<span class="string">"solid"</span>),seg.len = 1, col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>),border=<span class="string">"white"</span>,bty=<span class="string">"n"</span>,cex=1.2,lwd=c(2,2))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA17.png" alt></p><p>结果还不如使用padj，可见，表达差异大的基因不一定与生存时间有关联。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们在差异表达结果中按照padj筛选出了TOP10基因，现在，我们对TOP10基因绘制生存曲线，看它们的表达是否与病例的生存时间相关。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记10-受试者工作曲线</title>
    <link href="http://uteric.github.io/TCGA/TCGA10Roc/"/>
    <id>http://uteric.github.io/TCGA/TCGA10Roc/</id>
    <published>2020-07-05T04:16:52.000Z</published>
    <updated>2020-07-05T04:16:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>得到差异表达结果之后，我们可以根据padj来挑选排名前10的基因，来绘制受试者工作曲线，评估这些基因是否能作为判断肿瘤的标志基因。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&gt; annot_order &lt;- result_select_annot[order(result_select_annot<span class="variable">$padj</span>),] <span class="comment"># 按padj由小到大排序</span></span><br><span class="line">&gt; head(annot_order)</span><br><span class="line">     ensembl_gene_id   baseMean log2FoldChange     lfcSE      <span class="built_in">stat</span></span><br><span class="line">2718 ENSG00000174514  3783.7694      -5.246630 0.1256629 -41.75163</span><br><span class="line">4214 ENSG00000249859   880.8528       4.645581 0.1208287  38.44768</span><br><span class="line">3736 ENSG00000224490  1714.5650       8.442435 0.2386643  35.37369</span><br><span class="line">190  ENSG00000061656  2539.8779       4.097458 0.1185899  34.55149</span><br><span class="line">3632 ENSG00000213963   495.6315      -3.594074 0.1061639 -33.85401</span><br><span class="line">3104 ENSG00000185633 84959.2141       5.793502 0.1737995  33.33440</span><br><span class="line">            pvalue          padj hgnc_symbol</span><br><span class="line">2718  0.000000e+00  0.000000e+00      MFSD4A</span><br><span class="line">4214  0.000000e+00  0.000000e+00        PVT1</span><br><span class="line">3736 4.335266e-274 2.619801e-270  TTC21B-AS1</span><br><span class="line">190  1.353764e-261 6.135596e-258       SPAG4</span><br><span class="line">3632 3.168412e-251 1.148803e-247             <span class="comment"># 这个基因注释后没有名字</span></span><br><span class="line">3104 1.226108e-243 3.704687e-240    NDUFA4L2</span><br><span class="line">&gt; padj_top10_symbol &lt;- head(annot_order<span class="variable">$hgnc_symbol</span>,10) <span class="comment"># TOP10基因名称</span></span><br><span class="line">&gt; padj_top10_symbol</span><br><span class="line"> [1] <span class="string">"MFSD4A"</span>     <span class="string">"PVT1"</span>       <span class="string">"TTC21B-AS1"</span> <span class="string">"SPAG4"</span>      <span class="string">""</span>          </span><br><span class="line"> [6] <span class="string">"NDUFA4L2"</span>   <span class="string">"ACP3"</span>       <span class="string">"GABRD"</span>      <span class="string">"EGLN3"</span>      <span class="string">"HILPDA"</span>    </span><br><span class="line">&gt; padj_top10_id &lt;- head(annot_order<span class="variable">$ensembl_gene_id</span>,10) <span class="comment"># TOP10基因ID</span></span><br><span class="line">&gt; padj_top10_id</span><br><span class="line"> [1] <span class="string">"ENSG00000174514"</span> <span class="string">"ENSG00000249859"</span> <span class="string">"ENSG00000224490"</span></span><br><span class="line"> [4] <span class="string">"ENSG00000061656"</span> <span class="string">"ENSG00000213963"</span> <span class="string">"ENSG00000185633"</span></span><br><span class="line"> [7] <span class="string">"ENSG00000014257"</span> <span class="string">"ENSG00000187730"</span> <span class="string">"ENSG00000129521"</span></span><br><span class="line">[10] <span class="string">"ENSG00000135245"</span></span><br><span class="line">&gt; padj_top10 &lt;- data_select[match(padj_top10_id,rownames(data_select)),] <span class="comment"># TOP10表达数据</span></span><br><span class="line">&gt; head(padj_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000174514                      1784                       295</span><br><span class="line">ENSG00000249859                      3335                      1050</span><br><span class="line">ENSG00000224490                      8222                       864</span><br><span class="line">ENSG00000061656                      3397                      2055</span><br><span class="line">ENSG00000213963                       346                       243</span><br><span class="line">ENSG00000185633                    153042                    114967</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000174514                       511</span><br><span class="line">ENSG00000249859                       415</span><br><span class="line">ENSG00000224490                      3772</span><br><span class="line">ENSG00000061656                      3020</span><br><span class="line">ENSG00000213963                       124</span><br><span class="line">ENSG00000185633                    114580</span><br><span class="line">&gt; dim(padj_top10)</span><br><span class="line">[1]  10 611</span><br><span class="line">&gt; colnames(padj_top10) &lt;- substr(colnames(padj_top10),1,15) <span class="comment"># 这里对列名作处理，为了后面与临床信息对应</span></span><br><span class="line">&gt; head(padj_top10)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01 TCGA-BP-4355-01 TCGA-CZ-5451-01</span><br><span class="line">ENSG00000174514            1784             295             511</span><br><span class="line">ENSG00000249859            3335            1050             415</span><br><span class="line">ENSG00000224490            8222             864            3772</span><br><span class="line">ENSG00000061656            3397            2055            3020</span><br><span class="line">ENSG00000213963             346             243             124</span><br><span class="line">ENSG00000185633          153042          114967          114580</span><br><span class="line"></span><br><span class="line">&gt; library(pROC) <span class="comment"># 加载ROC软件包</span></span><br><span class="line">&gt; par(mfrow=c(2,5)) <span class="comment"># 绘图区布局，2行5列</span></span><br><span class="line">&gt; group_number &lt;- as.factor(ifelse(group==<span class="string">"cancer"</span>,1,0))</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(padj_top10_id))&#123;</span><br><span class="line">+   plot.roc(group_number,as.numeric(padj_top10[i,]),main=padj_top10_symbol[i],</span><br><span class="line">+            print.auc=T, percent=T,cex.lab=1.5,print.auc.cex=1.5,col=i)</span><br><span class="line">+ &#125;</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &gt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br><span class="line">Setting levels: control = 0, <span class="keyword">case</span> = 1</span><br><span class="line">Setting direction: controls &lt; cases</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA14.png" alt></p><p>换个角度，如果以FoldChange筛选排名前10的基因，结果如何？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">annot_order_FC &lt;- result_select_annot[order(abs(result_select_annot<span class="variable">$log2FoldChange</span>),decreasing = T),]</span><br><span class="line">head(annot_order_FC)</span><br><span class="line">FC_top10_symbol &lt;- head(annot_order_FC<span class="variable">$hgnc_symbol</span>,10)</span><br><span class="line">FC_top10_id &lt;- head(annot_order_FC<span class="variable">$ensembl_gene_id</span>,10)</span><br><span class="line">FC_top10 &lt;- data_select[match(FC_top10_id,rownames(data_select)),]</span><br><span class="line">colnames(FC_top10) &lt;- substr(colnames(FC_top10),1,15)</span><br><span class="line">head(FC_top10)[,1:3]</span><br><span class="line">dim(FC_top10)</span><br><span class="line"></span><br><span class="line">par(mfrow=c(2,5))</span><br><span class="line">group_number &lt;- as.factor(ifelse(group==<span class="string">"cancer"</span>,1,0))</span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> 1:length(FC_top10_id))&#123;</span><br><span class="line">  plot.roc(group_number,as.numeric(FC_top10[i,]),main=FC_top10_symbol[i],</span><br><span class="line">           print.auc=T, percent=T,cex.lab=1.5,print.auc.cex=1.5,col=i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA15.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;得到差异表达结果之后，我们可以根据padj来挑选排名前10的基因，来绘制受试者工作曲线，评估这些基因是否能作为判断肿瘤的标志基因。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记9-基因注释</title>
    <link href="http://uteric.github.io/TCGA/TCGA9Annot/"/>
    <id>http://uteric.github.io/TCGA/TCGA9Annot/</id>
    <published>2020-07-04T22:15:27.000Z</published>
    <updated>2020-07-04T22:15:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>我们前面分析得到的4913个差异表达基因的名称使用的是ENSEMBL的ID，比如ENSG00000001630，这类ID是不易记忆的，需要转化成我们熟悉的基因名称，即SYMBOL。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(biomaRt)</span><br><span class="line">&gt; geneName_select &lt;- rownames(result_select) <span class="comment"># 提取差异表达基因的ENSEMBL ID，4913个</span></span><br><span class="line">&gt; length(geneName_select)</span><br><span class="line">[1] 4913</span><br><span class="line">&gt; ensemb &lt;- useDataset(<span class="string">"hsapiens_gene_ensembl"</span>,mart=useMart(<span class="string">"ensembl"</span>))</span><br><span class="line">&gt; ensemb</span><br><span class="line">Object of class <span class="string">'Mart'</span>:</span><br><span class="line">  Using the ENSEMBL_MART_ENSEMBL BioMart database</span><br><span class="line">  Using the hsapiens_gene_ensembl dataset</span><br><span class="line">&gt; annot &lt;- getBM(attributes = c(<span class="string">"ensembl_gene_id"</span>,<span class="string">"hgnc_symbol"</span>),</span><br><span class="line">+              filters = <span class="string">"ensembl_gene_id"</span>,values = geneName_select, mart=ensemb) <span class="comment"># 注释结果</span></span><br><span class="line">Cache found</span><br><span class="line">&gt; class(annot)</span><br><span class="line">[1] <span class="string">"data.frame"</span></span><br><span class="line">&gt; dim(annot) <span class="comment"># 注释后有4863行</span></span><br><span class="line">[1] 4863    2</span><br><span class="line">&gt; head(annot)</span><br><span class="line">  ensembl_gene_id hgnc_symbol</span><br><span class="line">1 ENSG00000000938         FGR</span><br><span class="line">2 ENSG00000001617      SEMA3F</span><br><span class="line">3 ENSG00000001630     CYP51A1</span><br><span class="line">4 ENSG00000002586        CD99</span><br><span class="line">5 ENSG00000002746       HECW1</span><br><span class="line">6 ENSG00000002933    TMEM176A</span><br><span class="line">&gt; dim(result_select) <span class="comment"># 原本有4913行，即50个基因无法注释</span></span><br><span class="line">[1] 4913    6</span><br><span class="line">&gt; result_select<span class="variable">$ensembl_gene_id</span> &lt;- rownames(result_select) <span class="comment"># 把ensembl_gene_id加进来，为合并提供锚点</span></span><br><span class="line">&gt; dim(result_select)</span><br><span class="line">[1] 4913    7</span><br><span class="line">&gt; head(result_select)</span><br><span class="line">log2 fold change (MLE): group cancer vs normal </span><br><span class="line">Wald <span class="built_in">test</span> p-value: group cancer vs normal </span><br><span class="line">DataFrame with 6 rows and 7 columns</span><br><span class="line">                        baseMean    log2FoldChange              lfcSE</span><br><span class="line">                       &lt;numeric&gt;         &lt;numeric&gt;          &lt;numeric&gt;</span><br><span class="line">ENSG00000000938 1056.54189255002  1.50798734334441 0.0999113699084657</span><br><span class="line">ENSG00000001617 6403.79587078303  1.13804574850297 0.0897072677370336</span><br><span class="line">ENSG00000001630 218.029634030269 -1.15446295077517  0.120053363145966</span><br><span class="line">ENSG00000002586 9712.04932748132  1.26513626330331 0.0853396109411807</span><br><span class="line">ENSG00000002746 240.436190572231 -3.72546669707377  0.224130353161834</span><br><span class="line">ENSG00000002933 29346.9573200702  1.27343989833302  0.125910512841406</span><br><span class="line">                             <span class="built_in">stat</span>               pvalue</span><br><span class="line">                        &lt;numeric&gt;            &lt;numeric&gt;</span><br><span class="line">ENSG00000000938  15.0932505952622 1.79382718013598e-51</span><br><span class="line">ENSG00000001617  12.6862157014861 7.05112262109708e-37</span><br><span class="line">ENSG00000001630 -9.61624831260688 6.82760868085803e-22</span><br><span class="line">ENSG00000002586  14.8247249940627 1.01394301829956e-49</span><br><span class="line">ENSG00000002746 -16.6218749246506 4.83951527252971e-62</span><br><span class="line">ENSG00000002933  10.1138488724688  4.7962181780376e-24</span><br><span class="line">                                padj ensembl_gene_id</span><br><span class="line">                           &lt;numeric&gt;     &lt;character&gt;</span><br><span class="line">ENSG00000000938 2.14797179317603e-50 ENSG00000000938</span><br><span class="line">ENSG00000001617 4.97005451002601e-36 ENSG00000001617</span><br><span class="line">ENSG00000001630 2.56374726129402e-21 ENSG00000001630</span><br><span class="line">ENSG00000002586 1.13889547575916e-48 ENSG00000002586</span><br><span class="line">ENSG00000002746 8.09368748853239e-61 ENSG00000002746</span><br><span class="line">ENSG00000002933 1.97615089431008e-23 ENSG00000002933</span><br><span class="line">&gt; class(result_select) <span class="comment"># 不是数据框，合并前要先转化</span></span><br><span class="line">[1] <span class="string">"DESeqResults"</span></span><br><span class="line">attr(,<span class="string">"package"</span>)</span><br><span class="line">[1] <span class="string">"DESeq2"</span></span><br><span class="line">&gt; result_select_annot &lt;- merge(as.data.frame(result_select),annot,by=<span class="string">"ensembl_gene_id"</span>)</span><br><span class="line">&gt; dim(result_select_annot) <span class="comment"># 合并后多出一列，即hgnc_symbol</span></span><br><span class="line">[1] 4863    8</span><br><span class="line">&gt; head(result_select_annot)</span><br><span class="line">  ensembl_gene_id   baseMean log2FoldChange      lfcSE       <span class="built_in">stat</span></span><br><span class="line">1 ENSG00000000938  1056.5419       1.507987 0.09991137  15.093251</span><br><span class="line">2 ENSG00000001617  6403.7959       1.138046 0.08970727  12.686216</span><br><span class="line">3 ENSG00000001630   218.0296      -1.154463 0.12005336  -9.616248</span><br><span class="line">4 ENSG00000002586  9712.0493       1.265136 0.08533961  14.824725</span><br><span class="line">5 ENSG00000002746   240.4362      -3.725467 0.22413035 -16.621875</span><br><span class="line">6 ENSG00000002933 29346.9573       1.273440 0.12591051  10.113849</span><br><span class="line">        pvalue         padj hgnc_symbol</span><br><span class="line">1 1.793827e-51 2.147972e-50         FGR</span><br><span class="line">2 7.051123e-37 4.970055e-36      SEMA3F</span><br><span class="line">3 6.827609e-22 2.563747e-21     CYP51A1</span><br><span class="line">4 1.013943e-49 1.138895e-48        CD99</span><br><span class="line">5 4.839515e-62 8.093687e-61       HECW1</span><br><span class="line">6 4.796218e-24 1.976151e-23    TMEM176A</span><br></pre></td></tr></table></figure><p>注意，在注释过程中，有少部分基因因无法注释而被丢弃，如果这些基因恰恰是表达差异较大的，则会对后面的分析产生重要影响。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;我们前面分析得到的4913个差异表达基因的名称使用的是ENSEMBL的ID，比如ENSG00000001630，这类ID是不易记忆的，需要转化成我们熟悉的基因名称，即SYMBOL。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记8-临床信息提取</title>
    <link href="http://uteric.github.io/TCGA/TCGA8Clinic/"/>
    <id>http://uteric.github.io/TCGA/TCGA8Clinic/</id>
    <published>2020-07-04T21:39:03.000Z</published>
    <updated>2020-07-04T21:39:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>上面，我们对KIRC的表达数据做了差异分析，并对有差异的基因做了主成份分析和聚类热图，在进行下一步分析之前，我们需要对临床数据进行提取。我们先回顾一下，在学习笔记1中，我们在TCGA上下载到的表达数据包含来自530个CASES的611个FILES，即数据来自530个病人，但由于从某些病人身上收集了不止一个样本，因此，样本数大于病例数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(rjson)</span><br><span class="line">&gt; clinical_trials &lt;- fromJSON(file=<span class="string">"clinical.cart.2020-06-25.json"</span>) <span class="comment"># 类型是列表</span></span><br><span class="line">&gt; n= length(clinical_trials)</span><br><span class="line">&gt; n</span><br><span class="line">[1] 530 <span class="comment"># 530个CASES，与预期一致</span></span><br><span class="line">&gt;id=classification_of_tumor=tumor_stage=gender=year_of_birth=year_of_death=year_of_diagnosis=days_to_death=age=deadORlive=race=alcohol=years_smoked=c(rep(0,n))</span><br><span class="line">(rep(0,n)) <span class="comment"># 定义变量</span></span><br><span class="line">&gt; age</span><br><span class="line">  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [33] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [65] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [97] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[129] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[161] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[193] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[225] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[257] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[289] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[321] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[353] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[385] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[417] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[449] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[481] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[513] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:n)&#123;</span><br><span class="line">+   id[i]=clinical_trials[[i]]<span class="variable">$diagnoses</span>[[1]]<span class="variable">$submitter_id</span></span><br><span class="line">+   classification_of_tumor[i]=clinical_trials[[i]]<span class="variable">$diagnoses</span>[[1]]<span class="variable">$classification_of_tumor</span></span><br><span class="line">+   tumor_stage[i]=clinical_trials[[i]]<span class="variable">$diagnoses</span>[[1]]<span class="variable">$tumor_stage</span></span><br><span class="line">+   gender[i]=clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$gender</span></span><br><span class="line">+   year_of_birth[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$year_of_birth</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$year_of_birth</span>)</span><br><span class="line">+   year_of_death[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$year_of_death</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$year_of_death</span>) <span class="comment"># 此处使用ifelse()，因为不一定有这个数据，比如有些CASE这里显示“Pairlist of length 0"，以下同</span></span><br><span class="line">+   year_of_diagnosis[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$diagnoses</span>[[1]]<span class="variable">$year_of_diagnosis</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$diagnoses</span>[[1]]<span class="variable">$year_of_diagnosis</span>)</span><br><span class="line">+   days_to_death[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$days_to_death</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$days_to_death</span>)</span><br><span class="line">+   age[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$age_at_index</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$age_at_index</span>)</span><br><span class="line">+   deadORlive[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$vital_status</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$vital_status</span>)</span><br><span class="line">+   race[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$race</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$demographic</span><span class="variable">$race</span>)</span><br><span class="line">+   alcohol[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$exposures</span>[[1]]<span class="variable">$alcohol_history</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$exposures</span>[[1]]<span class="variable">$alcohol_history</span>)</span><br><span class="line">+   years_smoked[i]=ifelse(is.null(clinical_trials[[i]]<span class="variable">$exposures</span>[[1]]<span class="variable">$years_smoked</span>),<span class="string">"not reported"</span>,clinical_trials[[i]]<span class="variable">$exposures</span>[[1]]<span class="variable">$years_smoked</span>)</span><br><span class="line">+ &#125;  </span><br><span class="line">&gt; kidney_clinic &lt;- data.frame(</span><br><span class="line">+   id,</span><br><span class="line">+   classification_of_tumor,</span><br><span class="line">+   tumor_stage,</span><br><span class="line">+   gender,</span><br><span class="line">+   year_of_birth,</span><br><span class="line">+   year_of_death,</span><br><span class="line">+   year_of_diagnosis,</span><br><span class="line">+   days_to_death,</span><br><span class="line">+   age,</span><br><span class="line">+   deadORlive,</span><br><span class="line">+   race,</span><br><span class="line">+   alcohol,</span><br><span class="line">+   years_smoked</span><br><span class="line">+ )</span><br><span class="line">&gt; dim(kidney_clinic)</span><br><span class="line">[1] 530  13</span><br><span class="line">&gt; head(kidney_clinic)</span><br><span class="line">                      id classification_of_tumor tumor_stage gender</span><br><span class="line">1 TCGA-CZ-5986_diagnosis            not reported     stage i   male</span><br><span class="line">2 TCGA-CZ-4858_diagnosis            not reported    stage ii   male</span><br><span class="line">3 TCGA-B8-5551_diagnosis            not reported     stage i female</span><br><span class="line">4 TCGA-B0-4817_diagnosis            not reported   stage iii   male</span><br><span class="line">5 TCGA-BP-4325_diagnosis            not reported     stage i female</span><br><span class="line">6 TCGA-B0-4698_diagnosis            not reported    stage iv   male</span><br><span class="line">  year_of_birth year_of_death year_of_diagnosis days_to_death age</span><br><span class="line">1          1945  not reported              2006  not reported  61</span><br><span class="line">2          1966  not reported              2005          2105  39</span><br><span class="line">3          1945  not reported              2010  not reported  65</span><br><span class="line">4          1921          2004              2002          1019  81</span><br><span class="line">5          1937  not reported              2001  not reported  64</span><br><span class="line">6          1928          2003              2003            42  75</span><br><span class="line">  deadORlive                      race      alcohol years_smoked</span><br><span class="line">1      Alive                     white Not Reported not reported</span><br><span class="line">2       Dead                     white Not Reported not reported</span><br><span class="line">3      Alive black or african american Not Reported not reported</span><br><span class="line">4       Dead                     white Not Reported not reported</span><br><span class="line">5      Alive                     white Not Reported not reported</span><br><span class="line">6       Dead                     white Not Reported not reported</span><br></pre></td></tr></table></figure><p>至此，临床分类信息就提取完成了，在后面的分析中，我们需要用到这个数据，比如绘制生存曲线。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;上面，我们对KIRC的表达数据做了差异分析，并对有差异的基因做了主成份分析和聚类热图，在进行下一步分析之前，我们需要对临床数据进行提取。我们先回顾一下，在学习笔记1中，我们在TCGA上下载到的表达数据包含来自530个CASES的611个FILES，即数据来自530个病人，但
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记7-绘制热图</title>
    <link href="http://uteric.github.io/TCGA/TCGA7Heatmap/"/>
    <id>http://uteric.github.io/TCGA/TCGA7Heatmap/</id>
    <published>2020-07-04T18:58:47.000Z</published>
    <updated>2020-07-04T18:58:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>上面，我们根据差异表达提取出来的4913个基因在611个样品中的表达数据进行了主成份分析，根据主成份成分的结果，正常与肿瘤样本能很好地分成两类，这对样本的预测是很好的辅助。下面，我们将根据差异表达的结果来绘制热图，看能否找出预示肿瘤组织的标志分子。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(gplots) <span class="comment"># 在R中，绘制热图的程序有很多，这里我们使用gplots::heatmap.2；</span></span><br><span class="line"><span class="comment"># 首先，我们使用TOP20 Genes来绘制热图</span></span><br><span class="line">&gt; result_select_FCOrder &lt;- result_select[order(abs(result_select<span class="variable">$log2FoldChange</span>),decreasing=T),] <span class="comment"># 差异表达基因，按FoldChange的绝对值从大到小排序</span></span><br><span class="line">&gt; result_select_top20 &lt;- result_select_FCOrder[1:20,] <span class="comment"># 选取表达差异最大的20个基因</span></span><br><span class="line">&gt; head(result_select_top20)[,1:3]</span><br><span class="line">log2 fold change (MLE): group cancer vs normal </span><br><span class="line"> </span><br><span class="line">DataFrame with 6 rows and 3 columns</span><br><span class="line">                        baseMean    log2FoldChange             lfcSE</span><br><span class="line">                       &lt;numeric&gt;         &lt;numeric&gt;         &lt;numeric&gt;</span><br><span class="line">ENSG00000224490 1714.56503681026   8.4424354795262 0.238664257501869</span><br><span class="line">ENSG00000074803  22193.654237283 -8.27581699230162 0.332982800750979</span><br><span class="line">ENSG00000178776 886.398761602384  7.70696160260639 0.326179843061095</span><br><span class="line">ENSG00000204362 354.175131758015  7.57039832393765 0.294534084998158</span><br><span class="line">ENSG00000104327 2844.95684727121 -7.52918926148832 0.286386451386388</span><br><span class="line">ENSG00000164434 11701.5196273703  7.44063941927556 0.324756004054849</span><br><span class="line">&gt; result_select_top20<span class="variable">$log2FoldChange</span> <span class="comment"># 看一下变化倍数，18个基因在cancer中高表达，2个基因在normal中高表达</span></span><br><span class="line"> [1]  8.442435 -8.275817  7.706962  7.570398 -7.529189  7.440639</span><br><span class="line"> [7]  7.330764  7.310661  7.228141  7.097977  7.050444  6.976768</span><br><span class="line">[13]  6.922567  6.909435  6.888393  6.851913  6.846070  6.616500</span><br><span class="line">[19]  6.581890  6.495955</span><br><span class="line">&gt; dataTop20 &lt;- data[rownames(result_select_top20),] <span class="comment"># 把reads数加进去</span></span><br><span class="line">&gt; dim(dataTop20) <span class="comment"># 20行,611列</span></span><br><span class="line">[1]  20 611</span><br><span class="line">&gt; head(dataTop20)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000224490                      8222                       864</span><br><span class="line">ENSG00000074803                     19360                       100</span><br><span class="line">ENSG00000178776                      1165                        97</span><br><span class="line">ENSG00000204362                       201                       519</span><br><span class="line">ENSG00000104327                        24                        35</span><br><span class="line">ENSG00000164434                     17120                      6341</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000224490                      3772</span><br><span class="line">ENSG00000074803                        10</span><br><span class="line">ENSG00000178776                       423</span><br><span class="line">ENSG00000204362                        20</span><br><span class="line">ENSG00000104327                         6</span><br><span class="line">ENSG00000164434                     21755</span><br><span class="line">&gt; heat &lt;- data.matrix(dataTop20) <span class="comment"># heatmap.2需要使用矩阵做输入，因此先转化为矩阵</span></span><br><span class="line">&gt; dim(heat)</span><br><span class="line">[1]  20 611</span><br><span class="line">&gt; heat_scaled_t &lt;- scale(t(heat)) <span class="comment"># 行列转置，并对每个基因的表达进行标准化</span></span><br><span class="line">&gt; heat_scaled &lt;- t(heat_scaled_t) <span class="comment"># 标准化后再行列转置回来</span></span><br><span class="line">&gt; head(heat_scaled)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000224490                2.62485660                -0.3517755</span><br><span class="line">ENSG00000074803               -0.07491003                -0.2754319</span><br><span class="line">ENSG00000178776                0.19061196                -0.4436383</span><br><span class="line">ENSG00000204362               -0.17801482                 0.2129373</span><br><span class="line">ENSG00000104327               -0.25582838                -0.2548436</span><br><span class="line">ENSG00000164434                0.21122299                -0.2379535</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000224490                 0.8246374</span><br><span class="line">ENSG00000074803                -0.2763689</span><br><span class="line">ENSG00000178776                -0.2500376</span><br><span class="line">ENSG00000204362                -0.4005379</span><br><span class="line">ENSG00000104327                -0.2574398</span><br><span class="line">ENSG00000164434                 0.4043701</span><br><span class="line">&gt; my_palette &lt;- colorRampPalette(c(<span class="string">"blue"</span>,<span class="string">"white"</span>,<span class="string">"red"</span>)) <span class="comment"># 从低到高</span></span><br><span class="line">&gt; heat_scaled_limit2 &lt;- ifelse(heat_scaled&gt;2,2,heat_scaled) <span class="comment"># 这里要做一个变换，即把标准化后大于2的值都等于2，是为了使图形色彩更加鲜明突出</span></span><br><span class="line">&gt; max(heat_scaled_limit2)</span><br><span class="line">[1] 2</span><br><span class="line">&gt; colnames(heat_scaled_limit2) &lt;- paste(group,1:length(group),sep=<span class="string">"_"</span>) <span class="comment"># 修改列名</span></span><br><span class="line">&gt; condition_colors &lt;- unlist(lapply(colnames(heat_scaled_limit2),<span class="keyword">function</span>(x)&#123;</span><br><span class="line">+   <span class="keyword">if</span>(grepl(<span class="string">"cancer"</span>,x)) <span class="string">"#FFC0CB"</span></span><br><span class="line">+   <span class="keyword">else</span> <span class="keyword">if</span>(grepl(<span class="string">"normal"</span>,x)) <span class="string">"#808080"</span></span><br><span class="line">+ &#125;)) <span class="comment"># 定义分组颜色</span></span><br><span class="line">&gt; heatmap.2(heat_scaled_limit2,</span><br><span class="line">+           trace=<span class="string">"none"</span>,</span><br><span class="line">+           density=<span class="string">"none"</span>,</span><br><span class="line">+           col=bluered(20),</span><br><span class="line">+           cexRow = 1,</span><br><span class="line">+           ColSideColors = condition_colors,</span><br><span class="line">+           hclust=<span class="keyword">function</span>(x) hclust(x,method=<span class="string">"average"</span>),</span><br><span class="line">+           labCol = NA,</span><br><span class="line">+           dendrogram = <span class="string">"none"</span>, <span class="comment"># 去除dendrogram，但保留clustering</span></span><br><span class="line">+           margins=c(2,10))</span><br><span class="line">&gt; legend(0,0.8,legend=c(<span class="string">"cancer"</span>,<span class="string">"normal"</span>),fill=c(<span class="string">"#FFC0CB"</span>,<span class="string">"#808080"</span>),cex=0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA10.png" alt></p><p>下面，我们使用TOP50再来绘制热图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&gt; result_select_top50 &lt;- result_select_FCOrder[1:50,]</span><br><span class="line">&gt; result_select_top50<span class="variable">$log2FoldChange</span></span><br><span class="line"> [1]  8.442435 -8.275817  7.706962  7.570398 -7.529189  7.440639</span><br><span class="line"> [7]  7.330764  7.310661  7.228141  7.097977  7.050444  6.976768</span><br><span class="line">[13]  6.922567  6.909435  6.888393  6.851913  6.846070  6.616500</span><br><span class="line">[19]  6.581890  6.495955  6.432374  6.425309  6.424296  6.394360</span><br><span class="line">[25]  6.388963  6.377904  6.356020 -6.275527  6.256749  6.229892</span><br><span class="line">[31]  6.196778  6.186268 -6.185622 -6.149709  6.116301  6.095080</span><br><span class="line">[37]  6.042014  6.007039 -5.927111 -5.869138  5.853670  5.793502</span><br><span class="line">[43]  5.756366  5.729011  5.714809  5.699259  5.695577 -5.694465</span><br><span class="line">[49]  5.681664  5.677330</span><br><span class="line">&gt; dataTop50 &lt;- data[rownames(result_select_top50),]</span><br><span class="line">&gt; heat &lt;- data.matrix(dataTop50)</span><br><span class="line">&gt; heat_scaled_t &lt;- scale(t(heat))</span><br><span class="line">&gt; heat_scaled &lt;- t(heat_scaled_t)</span><br><span class="line">&gt; my_palette &lt;- colorRampPalette(c(<span class="string">"blue"</span>,<span class="string">"white"</span>,<span class="string">"red"</span>)) <span class="comment"># from low to high</span></span><br><span class="line">&gt; heat_scaled_limit2 &lt;- ifelse(heat_scaled&gt;2,2,heat_scaled)</span><br><span class="line">&gt; condition_colors &lt;- unlist(lapply(colnames(heat_scaled_limit2),<span class="keyword">function</span>(x)&#123;</span><br><span class="line">+   <span class="keyword">if</span>(grepl(<span class="string">"cancer"</span>,x)) <span class="string">"#FFC0CB"</span></span><br><span class="line">+   <span class="keyword">else</span> <span class="keyword">if</span>(grepl(<span class="string">"normal"</span>,x)) <span class="string">"#808080"</span></span><br><span class="line">+ &#125;))</span><br><span class="line">&gt; heatmap.2(heat_scaled_limit2,</span><br><span class="line">+           trace=<span class="string">"none"</span>,</span><br><span class="line">+           density=<span class="string">"none"</span>,</span><br><span class="line">+           col=bluered(20),</span><br><span class="line">+           cexRow = 1,</span><br><span class="line">+           ColSideColors = condition_colors,</span><br><span class="line">+           hclust=<span class="keyword">function</span>(x) hclust(x,method=<span class="string">"average"</span>),</span><br><span class="line">+           labCol = NA,</span><br><span class="line">+           dendrogram = <span class="string">"none"</span>,</span><br><span class="line">+           margins=c(2,10))</span><br><span class="line">&gt; legend(0,0.8,legend=c(<span class="string">"cancer"</span>,<span class="string">"normal"</span>),fill=c(<span class="string">"#FFC0CB"</span>,<span class="string">"#808080"</span>),cex=0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA11.png" alt></p><p>如果将标准化后的值限定在3以内，看一下图像的变化，颜色会变淡一些</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">heat_scaled_limit3 &lt;- ifelse(heat_scaled&gt;3,3,heat_scaled)</span><br><span class="line">colnames(heat_scaled_limit3) &lt;- paste(group,1:length(group),sep=<span class="string">"_"</span>)</span><br><span class="line">condition_colors &lt;- unlist(lapply(colnames(heat_scaled_limit3),<span class="keyword">function</span>(x)&#123;</span><br><span class="line">  <span class="keyword">if</span>(grepl(<span class="string">"cancer"</span>,x)) <span class="string">"#FFC0CB"</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(grepl(<span class="string">"normal"</span>,x)) <span class="string">"#808080"</span></span><br><span class="line">&#125;))</span><br><span class="line">heatmap.2(heat_scaled_limit3,</span><br><span class="line">          trace=<span class="string">"none"</span>,</span><br><span class="line">          density=<span class="string">"none"</span>,</span><br><span class="line">          col=bluered(20),</span><br><span class="line">          cexRow = 0.4,</span><br><span class="line">          ColSideColors = condition_colors,</span><br><span class="line">          hclust=<span class="keyword">function</span>(x) hclust(x,method=<span class="string">"average"</span>),</span><br><span class="line">          labCol = NA,</span><br><span class="line">          dendrogram = <span class="string">"none"</span>,</span><br><span class="line">          margins=c(2,10))</span><br><span class="line">legend(0,0.8,legend=c(<span class="string">"cancer"</span>,<span class="string">"normal"</span>),fill=c(<span class="string">"#FFC0CB"</span>,<span class="string">"#808080"</span>),cex=0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA12.png" alt></p><p>若限定在4以内，颜色进一步变淡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">heat_scaled_limit4 &lt;- ifelse(heat_scaled&gt;4,4,heat_scaled)</span><br><span class="line">colnames(heat_scaled_limit4) &lt;- paste(group,1:length(group),sep=<span class="string">"_"</span>)</span><br><span class="line">condition_colors &lt;- unlist(lapply(colnames(heat_scaled_limit4),<span class="keyword">function</span>(x)&#123;</span><br><span class="line">  <span class="keyword">if</span>(grepl(<span class="string">"cancer"</span>,x)) <span class="string">"#FFC0CB"</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(grepl(<span class="string">"normal"</span>,x)) <span class="string">"#808080"</span></span><br><span class="line">&#125;))</span><br><span class="line">heatmap.2(heat_scaled_limit4,</span><br><span class="line">          trace=<span class="string">"none"</span>,</span><br><span class="line">          density=<span class="string">"none"</span>,</span><br><span class="line">          col=bluered(20),</span><br><span class="line">          cexRow = 0.4,</span><br><span class="line">          ColSideColors = condition_colors,</span><br><span class="line">          hclust=<span class="keyword">function</span>(x) hclust(x,method=<span class="string">"average"</span>),</span><br><span class="line">          labCol = NA,</span><br><span class="line">          dendrogram = <span class="string">"none"</span>,</span><br><span class="line">          margins=c(2,10))</span><br><span class="line">legend(0,0.8,legend=c(<span class="string">"cancer"</span>,<span class="string">"normal"</span>),fill=c(<span class="string">"#FFC0CB"</span>,<span class="string">"#808080"</span>),cex=0.8)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA13.png" alt></p><p>注意：对标准化后的值进行限定，基本不会对样本的聚类产生影响，但是会影响基因间的聚类，因此，产生的图像也会不同。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;上面，我们根据差异表达提取出来的4913个基因在611个样品中的表达数据进行了主成份分析，根据主成份成分的结果，正常与肿瘤样本能很好地分成两类，这对样本的预测是很好的辅助。下面，我们将根据差异表达的结果来绘制热图，看能否找出预示肿瘤组织的标志分子。&lt;/p&gt;
&lt;figure 
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记6-主成份分析PCA</title>
    <link href="http://uteric.github.io/TCGA/TCGA6PCA/"/>
    <id>http://uteric.github.io/TCGA/TCGA6PCA/</id>
    <published>2020-07-01T04:15:19.000Z</published>
    <updated>2020-07-01T04:15:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>上面，我们对RNA表达数据进行了差异分析，下面，我们将进行主成份分析（PCA），用于对数据进行区分和归类。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">&gt; pcaData &lt;- data[rownames(result_select),] <span class="comment"># 这里，首先使用差异表达数据，即筛选出来的4913个基因在611个样本中的表达水平</span></span><br><span class="line">&gt; class(pcaData)</span><br><span class="line">[1] <span class="string">"data.frame"</span></span><br><span class="line">&gt; dim(pcaData)</span><br><span class="line">[1] 4913  611</span><br><span class="line">&gt; head(pcaData)[,1:3]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000001617                     16862                     10888</span><br><span class="line">ENSG00000001630                       310                        77</span><br><span class="line">ENSG00000002586                     10729                      8611</span><br><span class="line">ENSG00000002746                         7                        37</span><br><span class="line">ENSG00000002933                     60355                     29448</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">ENSG00000000938                      1100</span><br><span class="line">ENSG00000001617                      9299</span><br><span class="line">ENSG00000001630                       305</span><br><span class="line">ENSG00000002586                      7618</span><br><span class="line">ENSG00000002746                         7</span><br><span class="line">ENSG00000002933                     47857</span><br><span class="line">&gt; pcaDataT &lt;- as.data.frame(t(pcaData)) <span class="comment"># 行列转置，每行一个样本，每列一个基因</span></span><br><span class="line">&gt; class(pcaDataT)</span><br><span class="line">[1] <span class="string">"data.frame"</span></span><br><span class="line">&gt; dim(pcaDataT)</span><br><span class="line">[1]  611 4913</span><br><span class="line">&gt; head(pcaDataT)[,1:3]</span><br><span class="line">                          ENSG00000000938 ENSG00000001617 ENSG00000001630</span><br><span class="line">TCGA-CZ-5465-01A-01R-1503             899           16862             310</span><br><span class="line">TCGA-BP-4355-01A-01R-1289            1211           10888              77</span><br><span class="line">TCGA-CZ-5451-01A-01R-1503            1100            9299             305</span><br><span class="line">TCGA-B0-5081-01A-01R-1334            2065            9886             103</span><br><span class="line">TCGA-CZ-5454-11A-01R-1503             783            7150             815</span><br><span class="line">TCGA-B0-5697-01A-11R-1541            1857            5288             146</span><br><span class="line">&gt; pcaDataTGroup &lt;- data.frame(pcaDataT,Group=group) <span class="comment"># 将分类信息加上，方便后面作图时颜色来区分</span></span><br><span class="line">&gt; dim(pcaDataTGroup)</span><br><span class="line">[1]  611 4914</span><br><span class="line">&gt; head(pcaDataTGroup)[,4912:4914]</span><br><span class="line">                          ENSG00000281404 ENSG00000281490  Group</span><br><span class="line">TCGA-CZ-5465-01A-01R-1503              73             446 cancer</span><br><span class="line">TCGA-BP-4355-01A-01R-1289             209            1208 cancer</span><br><span class="line">TCGA-CZ-5451-01A-01R-1503              17             126 cancer</span><br><span class="line">TCGA-B0-5081-01A-01R-1334             180             626 cancer</span><br><span class="line">TCGA-CZ-5454-11A-01R-1503              36             240 normal</span><br><span class="line">TCGA-B0-5697-01A-11R-1541              42             232 cancer</span><br><span class="line"></span><br><span class="line">&gt; pca &lt;- prcomp(pcaDataT,scale=TRUE) <span class="comment"># 使用R自带的prcomp()函数</span></span><br><span class="line">&gt; summary(pca)</span><br><span class="line">Importance of components:</span><br><span class="line">                           PC1      PC2      PC3      PC4      PC5      PC6      PC7</span><br><span class="line">Standard deviation     30.5406 21.06796 17.82409 15.56497 13.67455 11.96656 11.39468</span><br><span class="line">                            PC8     PC9    PC10    PC11    PC12    PC13    PC14    PC15</span><br><span class="line">Standard deviation     10.52719 9.12744 8.76353 7.25503 6.82239 6.62584 6.35338 6.16851</span><br><span class="line">                          PC16    PC17    PC18    PC19    PC20    PC21    PC22    PC23</span><br><span class="line">Standard deviation     6.10537 5.99082 5.87263 5.73438 5.61851 5.53551 5.40397 5.20705</span><br><span class="line">                          PC24    PC25    PC26    PC27    PC28    PC29    PC30    PC31</span><br><span class="line">Standard deviation     5.07502 4.94755 4.77045 4.73712 4.66466 4.60046 4.50403 4.48497</span><br><span class="line">                          PC32    PC33    PC34    PC35    PC36    PC37    PC38    PC39</span><br><span class="line">Standard deviation     4.41300 4.40078 4.24311 4.21938 4.11894 4.10427 4.03498 4.00425</span><br><span class="line">                          PC40    PC41    PC42    PC43    PC44    PC45    PC46    PC47</span><br><span class="line">Standard deviation     3.95901 3.92036 3.85311 3.81686 3.76335 3.72471 3.67439 3.65233</span><br><span class="line">                          PC48    PC49    PC50    PC51    PC52    PC53    PC54    PC55</span><br><span class="line">Standard deviation     3.62492 3.58215 3.53086 3.51850 3.49220 3.46807 3.40228 3.38611</span><br><span class="line">                          PC56    PC57    PC58   PC59    PC60    PC61    PC62    PC63</span><br><span class="line">Standard deviation     3.34341 3.33820 3.32907 3.2906 3.26280 3.23725 3.22031 3.19124</span><br><span class="line">                          PC64    PC65    PC66    PC67    PC68    PC69    PC70    PC71</span><br><span class="line">Standard deviation     3.14392 3.10767 3.09295 3.07358 3.02365 3.01153 2.99903 2.98530</span><br><span class="line">                          PC72    PC73    PC74    PC75    PC76   PC77    PC78    PC79</span><br><span class="line">Standard deviation     2.96770 2.95324 2.94226 2.92450 2.91141 2.8906 2.87615 2.84936</span><br><span class="line">                          PC80    PC81    PC82    PC83    PC84    PC85    PC86    PC87</span><br><span class="line">Standard deviation     2.82099 2.78651 2.78489 2.77050 2.76802 2.74951 2.73087 2.72602</span><br><span class="line">                          PC88    PC89    PC90    PC91    PC92   PC93    PC94    PC95</span><br><span class="line">Standard deviation     2.70287 2.69798 2.66500 2.65009 2.62908 2.6260 2.61238 2.59281</span><br><span class="line">                          PC96    PC97    PC98    PC99   PC100  PC101   PC102   PC103</span><br><span class="line">Standard deviation     2.59100 2.57340 2.55959 2.54633 2.53601 2.5261 2.50279 2.48348</span><br><span class="line">                         PC104   PC105   PC106  PC107   PC108   PC109   PC110   PC111</span><br><span class="line">Standard deviation     2.47543 2.45592 2.45236 2.4317 2.41468 2.41164 2.38742 2.37613</span><br><span class="line">                         PC112   PC113   PC114  PC115  PC116   PC117   PC118   PC119   PC120</span><br><span class="line">Standard deviation     2.35853 2.35056 2.33463 2.3295 2.3250 2.30730 2.30597 2.29750 2.29033</span><br><span class="line">                         PC121   PC122   PC123   PC124   PC125  PC126   PC127   PC128</span><br><span class="line">Standard deviation     2.26585 2.25312 2.24279 2.23134 2.22793 2.2158 2.20129 2.19728</span><br><span class="line">                         PC129   PC130   PC131   PC132   PC133   PC134   PC135  PC136  PC137</span><br><span class="line">Standard deviation     2.19296 2.17398 2.16039 2.14977 2.14574 2.13250 2.11185 2.1077 2.1031</span><br><span class="line">                         PC138   PC139   PC140   PC141   PC142   PC143   PC144   PC145</span><br><span class="line">Standard deviation     2.08261 2.07534 2.07042 2.05222 2.04793 2.04577 2.03694 2.02771</span><br><span class="line">                         PC146   PC147   PC148   PC149  PC150  PC151   PC152   PC153   PC154</span><br><span class="line">Standard deviation     2.01782 2.00092 1.99539 1.98983 1.9861 1.9781 1.96918 1.95985 1.95552</span><br><span class="line">                         PC155   PC156   PC157   PC158   PC159   PC160   PC161   PC162</span><br><span class="line">Standard deviation     1.94804 1.94291 1.93641 1.92242 1.92021 1.90568 1.89667 1.89451</span><br><span class="line">                         PC163   PC164   PC165   PC166   PC167  PC168  PC169   PC170   PC171</span><br><span class="line">Standard deviation     1.88673 1.88252 1.87848 1.87202 1.86426 1.8584 1.8548 1.84692 1.84509</span><br><span class="line">                         PC172   PC173   PC174   PC175   PC176   PC177   PC178   PC179</span><br><span class="line">Standard deviation     1.83931 1.83135 1.82669 1.82031 1.81080 1.80627 1.80070 1.79712</span><br><span class="line">                         PC180   PC181   PC182   PC183   PC184   PC185   PC186   PC187</span><br><span class="line">Standard deviation     1.78550 1.77936 1.77550 1.76623 1.75981 1.75181 1.74749 1.74488</span><br><span class="line">                         PC188   PC189  PC190   PC191   PC192   PC193   PC194   PC195</span><br><span class="line">Standard deviation     1.73577 1.73361 1.7181 1.70630 1.70290 1.69972 1.69536 1.68780</span><br><span class="line">                         PC196   PC197   PC198   PC199   PC200   PC201   PC202   PC203</span><br><span class="line">Standard deviation     1.67993 1.67835 1.67086 1.66480 1.66048 1.65500 1.65183 1.64799</span><br><span class="line">                         PC204   PC205   PC206   PC207   PC208   PC209   PC210   PC211</span><br><span class="line">Standard deviation     1.64225 1.64076 1.63780 1.63251 1.62520 1.61368 1.61132 1.60909</span><br><span class="line">                         PC212   PC213   PC214   PC215   PC216   PC217  PC218  PC219  PC220</span><br><span class="line">Standard deviation     1.60139 1.59764 1.59602 1.59042 1.58228 1.57580 1.5733 1.5654 1.5610</span><br><span class="line">                         PC221   PC222   PC223   PC224   PC225   PC226   PC227   PC228</span><br><span class="line">Standard deviation     1.55563 1.55465 1.54655 1.54196 1.53549 1.53234 1.52645 1.52422</span><br><span class="line">                         PC229   PC230   PC231   PC232   PC233   PC234   PC235   PC236</span><br><span class="line">Standard deviation     1.51790 1.51457 1.51286 1.50343 1.50315 1.49795 1.49454 1.48776</span><br><span class="line">                         PC237   PC238   PC239   PC240   PC241   PC242   PC243   PC244</span><br><span class="line">Standard deviation     1.48438 1.47875 1.47257 1.46959 1.46717 1.45983 1.45757 1.45308</span><br><span class="line">                         PC245   PC246   PC247   PC248   PC249   PC250   PC251   PC252</span><br><span class="line">Standard deviation     1.44916 1.44823 1.44553 1.44368 1.43596 1.42866 1.42567 1.42135</span><br><span class="line">                         PC253   PC254   PC255  PC256  PC257  PC258  PC259   PC260   PC261</span><br><span class="line">Standard deviation     1.41682 1.41351 1.41118 1.4086 1.4026 1.3972 1.3949 1.38863 1.38630</span><br><span class="line">                         PC262   PC263   PC264   PC265   PC266   PC267   PC268   PC269</span><br><span class="line">Standard deviation     1.38335 1.37999 1.37650 1.37295 1.36460 1.36280 1.35885 1.35620</span><br><span class="line">                         PC270   PC271   PC272   PC273   PC274   PC275   PC276   PC277</span><br><span class="line">Standard deviation     1.34918 1.34286 1.34120 1.33772 1.33425 1.32969 1.32843 1.32246</span><br><span class="line">                         PC278   PC279   PC280   PC281   PC282   PC283   PC284   PC285</span><br><span class="line">Standard deviation     1.32087 1.32038 1.31198 1.30642 1.30391 1.30088 1.29874 1.29487</span><br><span class="line">                         PC286   PC287   PC288   PC289   PC290   PC291   PC292   PC293</span><br><span class="line">Standard deviation     1.29066 1.28536 1.28144 1.27949 1.27251 1.27007 1.26710 1.26414</span><br><span class="line">                         PC294   PC295   PC296   PC297   PC298   PC299   PC300   PC301</span><br><span class="line">Standard deviation     1.26220 1.26014 1.25852 1.25420 1.25096 1.24993 1.24498 1.23962</span><br><span class="line">                         PC302   PC303   PC304  PC305  PC306  PC307  PC308  PC309  PC310</span><br><span class="line">Standard deviation     1.23400 1.23255 1.22667 1.2240 1.2231 1.2229 1.2214 1.2143 1.2102</span><br><span class="line">                        PC311  PC312   PC313   PC314   PC315   PC316   PC317   PC318   PC319</span><br><span class="line">Standard deviation     1.2100 1.2048 1.19990 1.19701 1.19515 1.18987 1.18491 1.18245 1.18014</span><br><span class="line">                         PC320   PC321   PC322   PC323   PC324   PC325   PC326   PC327</span><br><span class="line">Standard deviation     1.17643 1.17621 1.17231 1.16879 1.16163 1.16122 1.15969 1.15713</span><br><span class="line">                         PC328   PC329   PC330   PC331   PC332   PC333   PC334   PC335</span><br><span class="line">Standard deviation     1.15556 1.15240 1.14952 1.14577 1.14304 1.14126 1.13763 1.13693</span><br><span class="line">                         PC336   PC337   PC338   PC339   PC340   PC341   PC342   PC343</span><br><span class="line">Standard deviation     1.13375 1.13120 1.12788 1.12463 1.12139 1.11960 1.11934 1.11628</span><br><span class="line">                         PC344   PC345   PC346   PC347   PC348   PC349   PC350   PC351</span><br><span class="line">Standard deviation     1.11177 1.10918 1.10520 1.10440 1.10241 1.09819 1.09693 1.09243</span><br><span class="line">                         PC352   PC353   PC354   PC355   PC356   PC357   PC358   PC359</span><br><span class="line">Standard deviation     1.08730 1.08648 1.08409 1.08042 1.07850 1.07407 1.07129 1.06942</span><br><span class="line">                         PC360   PC361   PC362   PC363   PC364   PC365   PC366   PC367</span><br><span class="line">Standard deviation     1.06691 1.06346 1.06228 1.05964 1.05558 1.05401 1.05002 1.04714</span><br><span class="line">                         PC368   PC369   PC370   PC371   PC372   PC373   PC374   PC375</span><br><span class="line">Standard deviation     1.04667 1.04370 1.04314 1.03839 1.03722 1.03520 1.02846 1.02695</span><br><span class="line">                         PC376   PC377   PC378   PC379   PC380   PC381   PC382   PC383</span><br><span class="line">Standard deviation     1.02537 1.02305 1.02137 1.02052 1.01721 1.01152 1.01111 1.00876</span><br><span class="line">                         PC384   PC385  PC386  PC387  PC388  PC389  PC390  PC391  PC392</span><br><span class="line">Standard deviation     1.00659 1.00372 1.0015 1.0003 0.9959 0.9945 0.9933 0.9895 0.9853</span><br><span class="line">                        PC393  PC394   PC395   PC396   PC397   PC398   PC399   PC400   PC401</span><br><span class="line">Standard deviation     0.9813 0.9801 0.97715 0.97527 0.97116 0.96965 0.96598 0.96351 0.96042</span><br><span class="line">                         PC402   PC403   PC404   PC405   PC406   PC407   PC408   PC409</span><br><span class="line">Standard deviation     0.95959 0.95777 0.95501 0.95072 0.94820 0.94598 0.94302 0.94201</span><br><span class="line">                         PC410   PC411   PC412   PC413   PC414   PC415   PC416   PC417</span><br><span class="line">Standard deviation     0.93933 0.93682 0.93610 0.93316 0.93053 0.92868 0.92602 0.92544</span><br><span class="line">                         PC418   PC419   PC420   PC421   PC422   PC423   PC424   PC425</span><br><span class="line">Standard deviation     0.91855 0.91759 0.91581 0.91240 0.91112 0.91077 0.90678 0.90618</span><br><span class="line">                         PC426   PC427   PC428   PC429   PC430   PC431   PC432   PC433</span><br><span class="line">Standard deviation     0.90249 0.89949 0.89669 0.89384 0.89288 0.88850 0.88718 0.88584</span><br><span class="line">                         PC434   PC435   PC436   PC437   PC438   PC439   PC440   PC441</span><br><span class="line">Standard deviation     0.88341 0.87924 0.87845 0.87462 0.87209 0.86974 0.86603 0.86518</span><br><span class="line">                         PC442   PC443   PC444   PC445   PC446   PC447   PC448   PC449</span><br><span class="line">Standard deviation     0.86083 0.86061 0.85783 0.85555 0.85338 0.85200 0.85090 0.84969</span><br><span class="line">                         PC450   PC451   PC452   PC453   PC454   PC455   PC456   PC457</span><br><span class="line">Standard deviation     0.84627 0.84291 0.84245 0.83924 0.83537 0.83425 0.83233 0.82828</span><br><span class="line">                         PC458   PC459   PC460   PC461   PC462   PC463   PC464   PC465</span><br><span class="line">Standard deviation     0.82678 0.82414 0.82309 0.82012 0.81847 0.81767 0.81494 0.81351</span><br><span class="line">                         PC466   PC467   PC468   PC469   PC470   PC471   PC472   PC473</span><br><span class="line">Standard deviation     0.80988 0.80492 0.80108 0.80043 0.79918 0.79730 0.79388 0.79141</span><br><span class="line">                         PC474   PC475   PC476   PC477   PC478   PC479   PC480   PC481</span><br><span class="line">Standard deviation     0.78887 0.78738 0.78554 0.78497 0.78066 0.78024 0.77470 0.77313</span><br><span class="line">                         PC482   PC483   PC484   PC485   PC486   PC487   PC488   PC489</span><br><span class="line">Standard deviation     0.77203 0.77000 0.76624 0.76326 0.76087 0.75905 0.75893 0.75472</span><br><span class="line">                         PC490   PC491   PC492   PC493   PC494   PC495   PC496   PC497</span><br><span class="line">Standard deviation     0.75419 0.75251 0.74832 0.74672 0.74510 0.74337 0.74174 0.74037</span><br><span class="line">                         PC498   PC499   PC500   PC501   PC502   PC503   PC504   PC505</span><br><span class="line">Standard deviation     0.73802 0.73601 0.73324 0.73171 0.72897 0.72684 0.72589 0.72385</span><br><span class="line">                         PC506  PC507  PC508  PC509  PC510  PC511  PC512  PC513  PC514</span><br><span class="line">Standard deviation     0.72215 0.7172 0.7142 0.7132 0.7091 0.7087 0.7080 0.7049 0.7013</span><br><span class="line">                        PC515  PC516  PC517  PC518  PC519  PC520  PC521   PC522   PC523</span><br><span class="line">Standard deviation     0.6982 0.6953 0.6942 0.6924 0.6904 0.6880 0.6864 0.68305 0.68213</span><br><span class="line">                         PC524   PC525   PC526   PC527   PC528   PC529   PC530   PC531</span><br><span class="line">Standard deviation     0.67959 0.67589 0.67421 0.67178 0.66804 0.66633 0.66601 0.66377</span><br><span class="line">                         PC532   PC533   PC534   PC535   PC536   PC537   PC538   PC539</span><br><span class="line">Standard deviation     0.66191 0.65937 0.65725 0.65584 0.65419 0.65095 0.64724 0.64534</span><br><span class="line">                         PC540   PC541   PC542   PC543   PC544   PC545   PC546   PC547</span><br><span class="line">Standard deviation     0.64276 0.63951 0.63786 0.63523 0.63117 0.62784 0.62692 0.62319</span><br><span class="line">                         PC548   PC549   PC550   PC551   PC552   PC553   PC554   PC555</span><br><span class="line">Standard deviation     0.62051 0.61775 0.61483 0.61238 0.61000 0.60674 0.60389 0.60303</span><br><span class="line">                         PC556   PC557   PC558   PC559   PC560   PC561   PC562   PC563</span><br><span class="line">Standard deviation     0.60151 0.60121 0.59484 0.59220 0.58997 0.58819 0.58589 0.58175</span><br><span class="line">                         PC564   PC565   PC566   PC567   PC568   PC569   PC570   PC571</span><br><span class="line">Standard deviation     0.57990 0.57774 0.57318 0.57104 0.56929 0.56368 0.56112 0.55675</span><br><span class="line">                         PC572   PC573   PC574   PC575   PC576   PC577   PC578   PC579</span><br><span class="line">Standard deviation     0.55548 0.55188 0.55145 0.54780 0.54517 0.53832 0.53484 0.53255</span><br><span class="line">                         PC580   PC581   PC582   PC583   PC584   PC585   PC586   PC587</span><br><span class="line">Standard deviation     0.52787 0.52379 0.52309 0.51867 0.51252 0.51120 0.50921 0.50802</span><br><span class="line">                         PC588   PC589   PC590   PC591   PC592   PC593   PC594   PC595</span><br><span class="line">Standard deviation     0.50304 0.49706 0.49622 0.48912 0.48581 0.48163 0.48029 0.47163</span><br><span class="line">                         PC596   PC597   PC598   PC599   PC600   PC601   PC602   PC603</span><br><span class="line">Standard deviation     0.46913 0.46281 0.45966 0.45449 0.45346 0.44524 0.44136 0.43279</span><br><span class="line">                         PC604   PC605   PC606   PC607   PC608   PC609   PC610     PC611</span><br><span class="line">Standard deviation     0.41556 0.39920 0.39283 0.38120 0.37238 0.35365 0.31898 6.713e-15</span><br><span class="line"> [ reached getOption(<span class="string">"max.print"</span>) -- omitted 2 rows ]</span><br><span class="line"></span><br><span class="line">&gt; plot(pca,<span class="built_in">type</span>=<span class="string">"l"</span>) <span class="comment"># 作图，看一下各个PC的权重，可见，PC1和PC2占了绝大多数权重</span></span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA06.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; str(pca) <span class="comment"># 看一下数据结构</span></span><br><span class="line">List of 5</span><br><span class="line"> $ sdev    : num [1:611] 30.5 21.1 17.8 15.6 13.7 ...</span><br><span class="line"> $ rotation: num [1:4913, 1:611] -0.0177 -0.0113 0.0172 -0.0142 0.0154 ...</span><br><span class="line">  ..- attr(*, <span class="string">"dimnames"</span>)=List of 2</span><br><span class="line">  .. ..$ : chr [1:4913] <span class="string">"ENSG00000000938"</span> <span class="string">"ENSG00000001617"</span> <span class="string">"ENSG00000001630"</span> <span class="string">"ENSG00000002586"</span> ...</span><br><span class="line">  .. ..$ : chr [1:611] <span class="string">"PC1"</span> <span class="string">"PC2"</span> <span class="string">"PC3"</span> <span class="string">"PC4"</span> ...</span><br><span class="line"> $ center  : Named num [1:4913] 1086 6694 235 9934 241 ...</span><br><span class="line">  ..- attr(*, <span class="string">"names"</span>)= chr [1:4913] <span class="string">"ENSG00000000938"</span> <span class="string">"ENSG00000001617"</span> <span class="string">"ENSG00000001630"</span> <span class="string">"ENSG00000002586"</span> ...</span><br><span class="line"> $ scale   : Named num [1:4913] 743 3689 183 5885 619 ...</span><br><span class="line">  ..- attr(*, <span class="string">"names"</span>)= chr [1:4913] <span class="string">"ENSG00000000938"</span> <span class="string">"ENSG00000001617"</span> <span class="string">"ENSG00000001630"</span> <span class="string">"ENSG00000002586"</span> ...</span><br><span class="line"> $ x       : num [1:611, 1:611] -19.09 -35.24 9.44 -58.72 91.79 ...</span><br><span class="line">  ..- attr(*, <span class="string">"dimnames"</span>)=List of 2</span><br><span class="line">  .. ..$ : chr [1:611] <span class="string">"TCGA-CZ-5465-01A-01R-1503"</span> <span class="string">"TCGA-BP-4355-01A-01R-1289"</span> <span class="string">"TCGA-CZ-5451-01A-01R-1503"</span> <span class="string">"TCGA-B0-5081-01A-01R-1334"</span> ...</span><br><span class="line">  .. ..$ : chr [1:611] <span class="string">"PC1"</span> <span class="string">"PC2"</span> <span class="string">"PC3"</span> <span class="string">"PC4"</span> ...</span><br><span class="line"> - attr(*, <span class="string">"class"</span>)= chr <span class="string">"prcomp"</span></span><br><span class="line"></span><br><span class="line">&gt; data_pca &lt;- cbind(pcaDataTGroup,pca<span class="variable">$x</span>[,1:2]) <span class="comment"># 将PC1与PC2加进去</span></span><br><span class="line">&gt; dim(data_pca)</span><br><span class="line">[1]  611 4916</span><br><span class="line">&gt; head(data_pca)[,4913:4916]</span><br><span class="line">                          ENSG00000281490  Group        PC1        PC2</span><br><span class="line">TCGA-CZ-5465-01A-01R-1503             446 cancer -19.085520  10.325704</span><br><span class="line">TCGA-BP-4355-01A-01R-1289            1208 cancer -35.244522  34.570355</span><br><span class="line">TCGA-CZ-5451-01A-01R-1503             126 cancer   9.439234 -23.982777</span><br><span class="line">TCGA-B0-5081-01A-01R-1334             626 cancer -58.723514  23.949627</span><br><span class="line">TCGA-CZ-5454-11A-01R-1503             240 normal  91.788022  78.416490</span><br><span class="line">TCGA-B0-5697-01A-11R-1541             232 cancer  -1.465493  -2.567302</span><br><span class="line"></span><br><span class="line"><span class="comment"># PLOT WITH GGPLOT -----</span></span><br><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; ggplot(data_pca,aes(PC1,PC2,col=Group,fill=Group))+</span><br><span class="line">+   stat_ellipse(geom=<span class="string">"polygon"</span>,col=<span class="string">"black"</span>,alpha=0.5)+</span><br><span class="line">+   geom_point(shape=21,col=<span class="string">"black"</span>,size=1.2)+</span><br><span class="line">+   theme(panel.background = element_rect(fill=<span class="string">"transparent"</span>,color=<span class="string">"black"</span>),</span><br><span class="line">+         panel.grid.minor = element_blank(), </span><br><span class="line">+         panel.grid.major = element_blank())</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA07.png" alt></p><p>如图，肿瘤样本与正常样本被很好地分为两组，可以明确区分，这也可被用于预测一个未知样本是否是肿瘤样本或是正常样本。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;上面，我们对RNA表达数据进行了差异分析，下面，我们将进行主成份分析（PCA），用于对数据进行区分和归类。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记5-差异表达分析</title>
    <link href="http://uteric.github.io/TCGA/TCGA5Diff/"/>
    <id>http://uteric.github.io/TCGA/TCGA5Diff/</id>
    <published>2020-06-28T20:33:29.000Z</published>
    <updated>2020-06-28T20:33:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们已经对KIRC的611个CASE的表达数据进行了预处理，现在，我们可以开始进行基因的差异表达分析了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(DESeq2)</span><br><span class="line">&gt; d.des &lt;- DESeqDataSetFromMatrix(data_select,</span><br><span class="line">+                                 colData = colData,</span><br><span class="line">+                                 design = ~group)</span><br><span class="line">&gt; View(d.des)</span><br><span class="line">&gt; res &lt;- DESeq(d.des)</span><br><span class="line">estimating size factors</span><br><span class="line">estimating dispersions</span><br><span class="line">gene-wise dispersion estimates</span><br><span class="line">mean-dispersion relationship</span><br><span class="line">final dispersion estimates</span><br><span class="line">fitting model and testing</span><br><span class="line">-- replacing outliers and refitting <span class="keyword">for</span> 795 genes</span><br><span class="line">-- DESeq argument <span class="string">'minReplicatesForReplace'</span> = 7 </span><br><span class="line">-- original counts are preserved <span class="keyword">in</span> counts(dds)</span><br><span class="line">estimating dispersions</span><br><span class="line">fitting model and testing</span><br><span class="line"></span><br><span class="line">&gt; result &lt;- results(res)</span><br><span class="line">&gt; class(result)</span><br><span class="line">[1] <span class="string">"DESeqResults"</span></span><br><span class="line">attr(,<span class="string">"package"</span>)</span><br><span class="line">[1] <span class="string">"DESeq2"</span></span><br><span class="line">&gt; dim(result)</span><br><span class="line">[1] 18129     6</span><br><span class="line">&gt; head(result)</span><br><span class="line">log2 fold change (MLE): group cancer vs normal </span><br><span class="line">Wald <span class="built_in">test</span> p-value: group cancer vs normal </span><br><span class="line">DataFrame with 6 rows and 6 columns</span><br><span class="line">                        baseMean      log2FoldChange              lfcSE</span><br><span class="line">                       &lt;numeric&gt;           &lt;numeric&gt;          &lt;numeric&gt;</span><br><span class="line">ENSG00000000419 1451.58517917849 -0.0533634770734555 0.0523193279028319</span><br><span class="line">ENSG00000000457 758.009368176777  -0.360582717778673 0.0418677088475957</span><br><span class="line">ENSG00000000460 221.763750558644    0.61271651131726 0.0607242024231328</span><br><span class="line">ENSG00000000938 1056.54189255002    1.50798734334441 0.0999113699084657</span><br><span class="line">ENSG00000000971 5355.66857772629   0.701185856702199  0.172116557494952</span><br><span class="line">ENSG00000001036 4735.26426651376  0.0468730754150524 0.0584416346104715</span><br><span class="line">                             <span class="built_in">stat</span>               pvalue                 padj</span><br><span class="line">                        &lt;numeric&gt;            &lt;numeric&gt;            &lt;numeric&gt;</span><br><span class="line">ENSG00000000419 -1.01995723592938    0.307748742642885    0.339965691022659</span><br><span class="line">ENSG00000000457 -8.61243014494163  7.1527882737753e-18 2.24580704217652e-17</span><br><span class="line">ENSG00000000460  10.0901532974906 6.10740651462378e-24 2.50173271685147e-23</span><br><span class="line">ENSG00000000938  15.0932505952622 1.79382718013598e-51 2.14797179317603e-50</span><br><span class="line">ENSG00000000971  4.07390123825107 4.62320932058293e-05 7.25789416114027e-05</span><br><span class="line">ENSG00000001036 0.802049356207667    0.422524408432647     0.45690098422162</span><br><span class="line"><span class="comment"># 上面生成的result，就是这18129个基因的表达数据经差异分析后的结果，下面需要进一步的筛选</span></span><br><span class="line"></span><br><span class="line">&gt; result_select &lt;- result[result<span class="variable">$pvalue</span>&lt;0.05&amp;abs(result<span class="variable">$log2FoldChange</span>)&gt;1,] <span class="comment"># 筛选pvalue&lt;0.05且FoldChange&gt;2的基因</span></span><br><span class="line">&gt; class(result_select)</span><br><span class="line">[1] <span class="string">"DESeqResults"</span></span><br><span class="line">attr(,<span class="string">"package"</span>)</span><br><span class="line">[1] <span class="string">"DESeq2"</span></span><br><span class="line">&gt; dim(result_select)</span><br><span class="line">[1] 4913    6 <span class="comment"># 筛选之后，基因数目从18129个减少至4913个</span></span><br><span class="line">&gt; head(result_select)</span><br><span class="line">log2 fold change (MLE): group cancer vs normal </span><br><span class="line">Wald <span class="built_in">test</span> p-value: group cancer vs normal </span><br><span class="line">DataFrame with 6 rows and 6 columns</span><br><span class="line">                        baseMean    log2FoldChange              lfcSE              <span class="built_in">stat</span></span><br><span class="line">                       &lt;numeric&gt;         &lt;numeric&gt;          &lt;numeric&gt;         &lt;numeric&gt;</span><br><span class="line">ENSG00000000938 1056.54189255002  1.50798734334441 0.0999113699084657  15.0932505952622</span><br><span class="line">ENSG00000001617 6403.79587078303  1.13804574850297 0.0897072677370336  12.6862157014861</span><br><span class="line">ENSG00000001630 218.029634030269 -1.15446295077517  0.120053363145966 -9.61624831260688</span><br><span class="line">ENSG00000002586 9712.04932748132  1.26513626330331 0.0853396109411807  14.8247249940627</span><br><span class="line">ENSG00000002746 240.436190572231 -3.72546669707377  0.224130353161834 -16.6218749246506</span><br><span class="line">ENSG00000002933 29346.9573200702  1.27343989833302  0.125910512841406  10.1138488724688</span><br><span class="line">                              pvalue                 padj</span><br><span class="line">                           &lt;numeric&gt;            &lt;numeric&gt;</span><br><span class="line">ENSG00000000938 1.79382718013598e-51 2.14797179317603e-50</span><br><span class="line">ENSG00000001617 7.05112262109708e-37 4.97005451002601e-36</span><br><span class="line">ENSG00000001630 6.82760868085803e-22 2.56374726129402e-21</span><br><span class="line">ENSG00000002586 1.01394301829956e-49 1.13889547575916e-48</span><br><span class="line">ENSG00000002746 4.83951527252971e-62 8.09368748853239e-61</span><br><span class="line">ENSG00000002933  4.7962181780376e-24 1.97615089431008e-23</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了作图方便，可以进一步计算出上调与下调的基因</span></span><br><span class="line">&gt; result_up &lt;- result[result<span class="variable">$pvalue</span>&lt;0.05&amp;result<span class="variable">$log2FoldChange</span>&gt;1,]</span><br><span class="line">&gt; dim(result_up)</span><br><span class="line">[1] 3432    6 <span class="comment"># 上调的基因有3432个</span></span><br><span class="line">&gt; result_down &lt;- result[result<span class="variable">$pvalue</span>&lt;0.05&amp;result<span class="variable">$log2FoldChange</span>&lt; -1,]</span><br><span class="line">&gt; dim(result_down)</span><br><span class="line">[1] 1481    6 <span class="comment"># 下调的基因有1481个</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面开始作火山图</span></span><br><span class="line">plot(result<span class="variable">$log2FoldChange</span>,-log10(result<span class="variable">$pvalue</span>),xlab=<span class="string">"Log2FoldChange"</span>,ylab=<span class="string">"-Log10(pvalue)"</span>,pch=16,cex=0.6)</span><br><span class="line">points(result_up<span class="variable">$log2FoldChange</span>,-log10(result_up<span class="variable">$pvalue</span>),col=<span class="string">"red"</span>,pch=16,cex=0.6)</span><br><span class="line">points(result_down<span class="variable">$log2FoldChange</span>,-log10(result_down<span class="variable">$pvalue</span>),col=<span class="string">"blue"</span>,pch=16,cex=0.6)</span><br><span class="line">abline(v=c(-1,1),col=<span class="string">"#636363"</span>,lwd=2,lty=2)</span><br><span class="line">abline(h=1.3,col=<span class="string">"#636363"</span>,lwd=2,lty=2)</span><br><span class="line">text(-7.5,260,<span class="string">"n=1481"</span>)</span><br><span class="line">text(7.5,260,<span class="string">"n=3432"</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/TCGA/TCGA05.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们已经对KIRC的611个CASE的表达数据进行了预处理，现在，我们可以开始进行基因的差异表达分析了。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记4-样品分类</title>
    <link href="http://uteric.github.io/TCGA/TCGA4SampleGroup/"/>
    <id>http://uteric.github.io/TCGA/TCGA4SampleGroup/</id>
    <published>2020-06-28T00:09:36.000Z</published>
    <updated>2020-06-28T00:09:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>前面，我们从metadata中提取了样品的信息，并替换了表达数据中的列名，我们还需要根据列名来将样品分类，并且要对基因的编号进行处理</p><p>首先，处理基因的编号</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt; genename &lt;- rownames(data) <span class="comment"># 提取data中的60482个基因名，赋值给genename</span></span><br><span class="line">&gt; head(genename)</span><br><span class="line">[1] <span class="string">"ENSG00000000005.5"</span>  <span class="string">"ENSG00000000419.11"</span> <span class="string">"ENSG00000000457.12"</span> <span class="string">"ENSG00000000460.15"</span></span><br><span class="line">[5] <span class="string">"ENSG00000000938.11"</span> <span class="string">"ENSG00000000971.14"</span></span><br><span class="line">&gt; length(genename)</span><br><span class="line">[1] 60482</span><br><span class="line"></span><br><span class="line">&gt; gene_no_point &lt;- gsub(<span class="string">"\\.(\\.?\\d*)"</span>,<span class="string">""</span>,genename) <span class="comment"># 去除小数点后的内容，方便后面作注释</span></span><br><span class="line">&gt; head(gene_no_point)</span><br><span class="line">[1] <span class="string">"ENSG00000000005"</span> <span class="string">"ENSG00000000419"</span> <span class="string">"ENSG00000000457"</span> <span class="string">"ENSG00000000460"</span></span><br><span class="line">[5] <span class="string">"ENSG00000000938"</span> <span class="string">"ENSG00000000971"</span></span><br><span class="line">&gt; length(gene_no_point)</span><br><span class="line">[1] 60482</span><br><span class="line"></span><br><span class="line">&gt; rownames(data) &lt;- gene_no_point <span class="comment"># 将data的行名替换回来</span></span><br><span class="line">&gt; head(data)[1:4]</span><br><span class="line">                TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000005                        33                        29</span><br><span class="line">ENSG00000000419                      2501                      1427</span><br><span class="line">ENSG00000000457                      1167                      1081</span><br><span class="line">ENSG00000000460                       348                       247</span><br><span class="line">ENSG00000000938                       899                      1211</span><br><span class="line">ENSG00000000971                      1460                      4505</span><br><span class="line">                TCGA-CZ-5451-01A-01R-1503 TCGA-B0-5081-01A-01R-1334</span><br><span class="line">ENSG00000000005                        83                        77</span><br><span class="line">ENSG00000000419                       967                      1300</span><br><span class="line">ENSG00000000457                       574                       796</span><br><span class="line">ENSG00000000460                       162                       321</span><br><span class="line">ENSG00000000938                      1100                      2065</span><br><span class="line">ENSG00000000971                       936                      6501</span><br></pre></td></tr></table></figure><p>下面，对样本进行分类</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">&gt; sampleName &lt;- colnames(data) <span class="comment"># 提取data的列名，其实就是样本名，来源是metadata</span></span><br><span class="line">&gt; head(sampleName)</span><br><span class="line">[1] <span class="string">"TCGA-CZ-5465-01A-01R-1503"</span> <span class="string">"TCGA-BP-4355-01A-01R-1289"</span> <span class="string">"TCGA-CZ-5451-01A-01R-1503"</span></span><br><span class="line">[4] <span class="string">"TCGA-B0-5081-01A-01R-1334"</span> <span class="string">"TCGA-CZ-5454-11A-01R-1503"</span> <span class="string">"TCGA-B0-5697-01A-11R-1541"</span></span><br><span class="line">&gt; sampleGroup &lt;- substr(sampleName,14,15) <span class="comment"># 提取14-15字符</span></span><br><span class="line">&gt; table(sampleGroup) </span><br><span class="line">sampleGroup <span class="comment"># 看一下这个分类，538个01（Primary Solid Tumor），72个11（Solid Tissue Normal），1个05（Additional - New Primary）</span></span><br><span class="line"> 01  05  11 </span><br><span class="line">538   1  72</span><br><span class="line">&gt; sampleGroup</span><br><span class="line">  [1] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"> [17] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"> [33] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"> [49] <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"> [65] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"> [81] <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span></span><br><span class="line"> [97] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span></span><br><span class="line">[113] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span></span><br><span class="line">[129] <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[145] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span></span><br><span class="line">[161] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[177] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[193] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[209] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[225] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[241] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[257] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[273] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[289] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[305] <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[321] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span></span><br><span class="line">[337] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[353] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span></span><br><span class="line">[369] <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[385] <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"05"</span> <span class="string">"01"</span></span><br><span class="line">[401] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[417] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[433] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[449] <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[465] <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span></span><br><span class="line">[481] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[497] <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[513] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[529] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[545] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[561] <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"11"</span> <span class="string">"11"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[577] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[593] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line">[609] <span class="string">"01"</span> <span class="string">"01"</span> <span class="string">"01"</span></span><br><span class="line"></span><br><span class="line">&gt; group &lt;- ifelse(as.numeric(sampleGroup)&lt;10,1,0) <span class="comment"># 根据TCGA的说明，0-9代表肿瘤，因此，将小于10的样品定义为肿瘤</span></span><br><span class="line">&gt; table(group)</span><br><span class="line">group <span class="comment"># 0代表正常样本，72个；1代表肿瘤，539个</span></span><br><span class="line">  0   1 </span><br><span class="line"> 72 539 </span><br><span class="line">&gt; group</span><br><span class="line">  [1] 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1</span><br><span class="line"> [43] 1 0 0 0 1 1 1 0 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1</span><br><span class="line"> [85] 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1</span><br><span class="line">[127] 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1</span><br><span class="line">[169] 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line">[211] 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1</span><br><span class="line">[253] 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line">[295] 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 0 0 1 1 1 0 1 0 0 1 1 1 0</span><br><span class="line">[337] 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 1 1 1 1 1 1 1 1</span><br><span class="line">[379] 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 0 0 0 1 1 1 1 1 1 1 1</span><br><span class="line">[421] 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1</span><br><span class="line">[463] 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 1 1 1 1 0 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 0</span><br><span class="line">[505] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1</span><br><span class="line">[547] 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line">[589] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line"></span><br><span class="line">&gt; group &lt;- factor(group,levels=c(0,1),labels=c(<span class="string">"normal"</span>,<span class="string">"cancer"</span>)) <span class="comment"># 加上标签</span></span><br><span class="line">&gt; table(group)</span><br><span class="line">group</span><br><span class="line">normal cancer </span><br><span class="line">    72    539 </span><br><span class="line">&gt; group</span><br><span class="line">  [1] cancer cancer cancer cancer normal cancer cancer cancer cancer normal cancer cancer</span><br><span class="line"> [13] cancer cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer</span><br><span class="line"> [25] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line"> [37] cancer cancer cancer cancer normal cancer cancer normal normal normal cancer cancer</span><br><span class="line"> [49] cancer normal cancer cancer cancer cancer cancer cancer normal cancer cancer cancer</span><br><span class="line"> [61] normal cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal</span><br><span class="line"> [73] cancer cancer cancer cancer cancer cancer cancer cancer normal cancer normal cancer</span><br><span class="line"> [85] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal</span><br><span class="line"> [97] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[109] cancer cancer normal cancer cancer cancer cancer normal cancer cancer cancer cancer</span><br><span class="line">[121] cancer normal cancer cancer cancer cancer cancer normal cancer normal cancer cancer</span><br><span class="line">[133] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[145] cancer cancer cancer cancer cancer normal cancer cancer cancer cancer cancer cancer</span><br><span class="line">[157] cancer cancer normal cancer cancer cancer cancer normal cancer cancer cancer cancer</span><br><span class="line">[169] normal cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[181] cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer cancer</span><br><span class="line">[193] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[205] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal</span><br><span class="line">[217] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[229] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[241] cancer cancer cancer cancer cancer cancer normal cancer normal cancer cancer cancer</span><br><span class="line">[253] cancer cancer cancer cancer cancer cancer cancer cancer normal cancer cancer normal</span><br><span class="line">[265] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[277] cancer cancer cancer cancer cancer normal cancer cancer cancer cancer cancer cancer</span><br><span class="line">[289] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal cancer</span><br><span class="line">[301] cancer cancer cancer cancer normal cancer cancer cancer cancer normal cancer cancer</span><br><span class="line">[313] cancer normal cancer cancer cancer cancer cancer cancer cancer cancer cancer normal</span><br><span class="line">[325] normal cancer cancer cancer normal cancer normal normal cancer cancer cancer normal</span><br><span class="line">[337] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[349] cancer normal cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[361] cancer cancer cancer cancer cancer cancer normal cancer normal normal cancer cancer</span><br><span class="line">[373] cancer cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer</span><br><span class="line">[385] normal cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[397] cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer cancer</span><br><span class="line">[409] cancer normal normal normal cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[421] cancer cancer cancer cancer normal cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[433] cancer cancer cancer cancer cancer cancer cancer cancer normal cancer normal cancer</span><br><span class="line">[445] cancer cancer cancer cancer cancer normal cancer cancer cancer cancer cancer cancer</span><br><span class="line">[457] normal cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer</span><br><span class="line">[469] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal normal</span><br><span class="line">[481] cancer cancer cancer cancer cancer normal normal normal cancer cancer cancer cancer</span><br><span class="line">[493] cancer cancer cancer cancer cancer normal cancer cancer cancer cancer cancer normal</span><br><span class="line">[505] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[517] cancer cancer cancer cancer normal cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[529] cancer cancer cancer cancer cancer cancer cancer normal cancer cancer cancer normal</span><br><span class="line">[541] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer normal normal</span><br><span class="line">[553] cancer normal cancer cancer cancer cancer cancer cancer normal cancer cancer cancer</span><br><span class="line">[565] cancer cancer cancer cancer normal normal cancer cancer cancer cancer cancer cancer</span><br><span class="line">[577] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[589] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">[601] cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer cancer</span><br><span class="line">Levels: normal cancer</span><br><span class="line"></span><br><span class="line">&gt; colData &lt;- data.frame(group=group)</span><br><span class="line">&gt; head(colData)</span><br><span class="line">   group</span><br><span class="line">1 cancer</span><br><span class="line">2 cancer</span><br><span class="line">3 cancer</span><br><span class="line">4 cancer</span><br><span class="line">5 normal</span><br><span class="line">6 cancer</span><br><span class="line">&gt; nrow(colData)</span><br><span class="line">[1] 611</span><br><span class="line"></span><br><span class="line">&gt; rownames(colData) &lt;- colnames(data)</span><br><span class="line">&gt; head(colData)</span><br><span class="line">                           group</span><br><span class="line">TCGA-CZ-5465-01A-01R-1503 cancer</span><br><span class="line">TCGA-BP-4355-01A-01R-1289 cancer</span><br><span class="line">TCGA-CZ-5451-01A-01R-1503 cancer</span><br><span class="line">TCGA-B0-5081-01A-01R-1334 cancer</span><br><span class="line">TCGA-CZ-5454-11A-01R-1503 normal</span><br><span class="line">TCGA-B0-5697-01A-11R-1541 cancer</span><br><span class="line"></span><br><span class="line">&gt; data_select &lt;- data[rowSums(data&gt;20)&gt;ncol(data)/2,] <span class="comment"># 去掉表达太低的行，具体数值可自定义</span></span><br><span class="line">&gt; dim(data)</span><br><span class="line">[1] 60482   611</span><br><span class="line">&gt; dim(data_select)</span><br><span class="line">[1] 18129   611 <span class="comment"># 从开始的60482个基因，到最后的18129个基因</span></span><br></pre></td></tr></table></figure><p>至此，样本的分类及处理就完成了，下一步就可以分析基因的表达差异了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面，我们从metadata中提取了样品的信息，并替换了表达数据中的列名，我们还需要根据列名来将样品分类，并且要对基因的编号进行处理&lt;/p&gt;
&lt;p&gt;首先，处理基因的编号&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cl
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
  <entry>
    <title>TCGA学习笔记3-处理样品信息</title>
    <link href="http://uteric.github.io/TCGA/TCGA3metadata/"/>
    <id>http://uteric.github.io/TCGA/TCGA3metadata/</id>
    <published>2020-06-27T22:40:35.000Z</published>
    <updated>2020-06-27T22:40:35.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br></pre></td><td class="code"><pre><span class="line">&gt; setwd(<span class="string">"D:/TCGA/kirc"</span>) <span class="comment"># 切换工作目录 </span></span><br><span class="line">&gt; library(rjson) </span><br><span class="line">&gt; x &lt;- fromJSON(file=<span class="string">"metadata.cart.2020-06-25.json"</span>) <span class="comment"># 读取metadata信息</span></span><br><span class="line">&gt; n &lt;- ncol(data) </span><br><span class="line">&gt; n</span><br><span class="line">[1] 611</span><br><span class="line">&gt; id = sample_id = rep(0,n)</span><br><span class="line">&gt; id</span><br><span class="line">  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [43] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [85] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[127] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[169] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[211] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[253] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[295] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[337] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[379] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[421] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[463] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[505] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[547] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[589] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">&gt; sample_id</span><br><span class="line">  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [43] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line"> [85] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[127] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[169] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[211] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[253] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[295] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[337] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[379] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[421] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[463] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[505] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[547] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[589] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:n)&#123;</span><br><span class="line">+   id[i]=x[[i]]<span class="variable">$submitter_id</span> <span class="comment"># 将submitter_id赋值给id</span></span><br><span class="line">+   sample_id[i]=x[[i]]<span class="variable">$associated_entities</span>[[1]]<span class="variable">$entity_submitter_id</span> <span class="comment"># 将entity_submitter_id赋值给sample_id</span></span><br><span class="line">+ &#125;</span><br><span class="line">&gt; id <span class="comment"># id其实就是解压后的文件名</span></span><br><span class="line">  [1] <span class="string">"9d5c2ed8-443b-4c71-b5b2-d9fc98b322c0_count"</span></span><br><span class="line">  [2] <span class="string">"f426d6b8-5010-471c-aa9c-253269f6bc03_count"</span></span><br><span class="line">  [3] <span class="string">"f0532052-b496-4435-abc4-93e23c6a68a5_count"</span></span><br><span class="line">  [4] <span class="string">"6c2a30ae-9435-4d9c-99dd-59d8d77f3920_count"</span></span><br><span class="line">  [5] <span class="string">"586afb0b-e791-4efe-b5c9-eaac6ecce723_count"</span></span><br><span class="line">  [6] <span class="string">"cde6e107-8870-48c2-85b9-c0f1d71bfc0e_count"</span></span><br><span class="line">  [7] <span class="string">"bf321bbe-efdc-46d0-b93c-a410dfa3b179_count"</span></span><br><span class="line">  [8] <span class="string">"22b2ac9e-b6d4-415e-b7ab-7c3c85c8d215_count"</span></span><br><span class="line">  [9] <span class="string">"c5f1fac6-8b52-4a0d-b75c-fbb268b91fe6_count"</span></span><br><span class="line"> [10] <span class="string">"3b57505d-cea2-4f9c-8c85-862fefaa5c63_count"</span></span><br><span class="line"> [11] <span class="string">"991273f3-2fd9-4c40-b6b3-2d8676b210de_count"</span></span><br><span class="line"> [12] <span class="string">"bc2898e8-56c4-4e12-96ee-720ab9d4e958_count"</span></span><br><span class="line"> [13] <span class="string">"608afa9d-7bfd-44d3-9d73-1b027c185518_count"</span></span><br><span class="line"> [14] <span class="string">"1d619122-94f2-4ced-81a3-475b6a510c3c_count"</span></span><br><span class="line"> [15] <span class="string">"d842b357-df64-4896-89c7-aa62999b1933_count"</span></span><br><span class="line"> [16] <span class="string">"5d065eaa-e3a8-420e-b983-c1a80e713ac9_count"</span></span><br><span class="line"> [17] <span class="string">"601b2c2f-f51c-4055-90aa-53fc6380fb67_count"</span></span><br><span class="line"> [18] <span class="string">"8c811805-abba-4080-a703-8d6bef165520_count"</span></span><br><span class="line"> [19] <span class="string">"66827b45-d9f9-419e-b4d7-15504dd24b61_count"</span></span><br><span class="line"> [20] <span class="string">"208e8d62-0277-404e-9246-55d36eb3ec7d_count"</span></span><br><span class="line"> [21] <span class="string">"677bb05d-81de-4202-a17b-bc39fb1bfb5d_count"</span></span><br><span class="line"> [22] <span class="string">"cf6e46bc-d942-4863-9804-4409ba48099e_count"</span></span><br><span class="line"> [23] <span class="string">"c2efa14b-f441-4249-87b0-56d88d760a82_count"</span></span><br><span class="line"> [24] <span class="string">"1006434c-1c1b-47a3-bbf0-8d331d8e1722_count"</span></span><br><span class="line"> [25] <span class="string">"b2842754-010e-4f64-905d-89ef3eab3dc9_count"</span></span><br><span class="line"> [26] <span class="string">"c9c0f778-3b0c-44a2-b182-1959a79972c2_count"</span></span><br><span class="line"> [27] <span class="string">"298d4abf-31eb-4155-904a-1b8f4fea371d_count"</span></span><br><span class="line"> [28] <span class="string">"a85824a2-de8d-4c52-942f-d8af5fe92ea9_count"</span></span><br><span class="line"> [29] <span class="string">"495fe6cb-7649-4434-98cd-214f1b842907_count"</span></span><br><span class="line"> [30] <span class="string">"188c9f08-978b-4e15-bc70-b0c6e9563e3d_count"</span></span><br><span class="line"> [31] <span class="string">"f1af54f4-3006-4136-b0db-aec16e2075ec_count"</span></span><br><span class="line"> [32] <span class="string">"f7b97473-d095-419b-98ca-f9212f037893_count"</span></span><br><span class="line"> [33] <span class="string">"206653c0-7dd7-488e-8219-4abfa4279704_count"</span></span><br><span class="line"> [34] <span class="string">"227d9c16-4459-44ea-af9a-ca89d6e052e9_count"</span></span><br><span class="line"> [35] <span class="string">"61c7c0b0-d730-4d67-b1b7-c267124d4e1b_count"</span></span><br><span class="line"> [36] <span class="string">"df6c9ff4-db5f-42c9-a98e-91d2f4f14ee6_count"</span></span><br><span class="line"> [37] <span class="string">"d3823e63-64df-4a9a-920b-3323d3119db0_count"</span></span><br><span class="line"> [38] <span class="string">"776104e1-6a5b-4fda-8943-23edd5bcb462_count"</span></span><br><span class="line"> [39] <span class="string">"2f636668-f8a7-4aaa-a089-b65cd8f5809e_count"</span></span><br><span class="line"> [40] <span class="string">"08e381b6-7100-4628-8ae7-ecdf42827902_count"</span></span><br><span class="line"> [41] <span class="string">"cf8cc0b6-be04-4f59-9baa-7270aa0fba53_count"</span></span><br><span class="line"> [42] <span class="string">"00a9180b-4707-411f-9732-61fc49bfeb48_count"</span></span><br><span class="line"> [43] <span class="string">"d9c6f1ad-5c45-4831-b152-ad05648104eb_count"</span></span><br><span class="line"> [44] <span class="string">"0e88c1e6-6c1a-40e4-865e-b601621d33d1_count"</span></span><br><span class="line"> [45] <span class="string">"7ebd35ca-8fd1-4f22-a38d-122537b65bc2_count"</span></span><br><span class="line"> [46] <span class="string">"906d9c60-fdb6-469d-a42e-6bcab0a696f0_count"</span></span><br><span class="line"> [47] <span class="string">"29e88863-d1b0-4da0-be95-d0a82eb1d08b_count"</span></span><br><span class="line"> [48] <span class="string">"6ed3d60c-b0d5-4122-a8fb-712c6d2cf80a_count"</span></span><br><span class="line"> [49] <span class="string">"de3d2ca0-d59f-46b3-9b15-fad972cfa86e_count"</span></span><br><span class="line"> [50] <span class="string">"390a7a27-3687-44a4-8e4c-7b343e418475_count"</span></span><br><span class="line"> [51] <span class="string">"0b2cf05d-1d12-4fcf-898f-3e9e90b97dda_count"</span></span><br><span class="line"> [52] <span class="string">"fc5bd55f-cdb1-4c96-a91a-513b43e6a99a_count"</span></span><br><span class="line"> [53] <span class="string">"355f9f19-ed5e-4bf6-a8b5-d50f67d5d43c_count"</span></span><br><span class="line"> [54] <span class="string">"db4c135e-dae9-4c6d-b765-4a212cc3e13e_count"</span></span><br><span class="line"> [55] <span class="string">"45128466-9a14-4348-97f1-d08af79acbba_count"</span></span><br><span class="line"> [56] <span class="string">"5e879f5e-3253-48fb-906f-0c36c3abe5f0_count"</span></span><br><span class="line"> [57] <span class="string">"fe3596cb-7fed-41b9-ae30-caebcf717e6e_count"</span></span><br><span class="line"> [58] <span class="string">"a4bf8ad0-255e-41fc-92f1-bdbfb7001edb_count"</span></span><br><span class="line"> [59] <span class="string">"6fe662c3-c2c3-4c70-9f77-5061cea46203_count"</span></span><br><span class="line"> [60] <span class="string">"8789d75c-8207-44bf-a34e-985440406b34_count"</span></span><br><span class="line"> [61] <span class="string">"ab6f6f5b-f5b2-4da2-ab37-6b9bf6ea0b77_count"</span></span><br><span class="line"> [62] <span class="string">"aa90b957-b11b-473e-9280-1fbd2dbe5937_count"</span></span><br><span class="line"> [63] <span class="string">"78e7d9ea-de99-488a-a87e-c7ff3e3bd8cf_count"</span></span><br><span class="line"> [64] <span class="string">"984ea13e-adc6-48f7-830d-66ce450a2ea0_count"</span></span><br><span class="line"> [65] <span class="string">"1d5e8f90-0bfc-4a01-b988-925f3c0ec1cf_count"</span></span><br><span class="line"> [66] <span class="string">"b4f54395-e237-4b10-b688-433b138facff_count"</span></span><br><span class="line"> [67] <span class="string">"9a7c9e75-314d-49ab-9e31-5cb1fb1ebb38_count"</span></span><br><span class="line"> [68] <span class="string">"5dc059dd-6aa0-4d5b-b447-b5be0a9021ad_count"</span></span><br><span class="line"> [69] <span class="string">"a7ba8570-638d-4ec3-a02e-e861114ce097_count"</span></span><br><span class="line"> [70] <span class="string">"42fb1a46-4a61-4d2c-a89b-0492e4846d1b_count"</span></span><br><span class="line"> [71] <span class="string">"b197f3a7-4bb6-4e88-b1cf-9ad513873739_count"</span></span><br><span class="line"> [72] <span class="string">"c02e42b9-e4c1-4119-b287-97f74517aab5_count"</span></span><br><span class="line"> [73] <span class="string">"2c532e1a-19b7-4e75-881b-04036db8cc8c_count"</span></span><br><span class="line"> [74] <span class="string">"3add0a93-4d4a-44e6-a85a-f2f0915e03c0_count"</span></span><br><span class="line"> [75] <span class="string">"f577a186-ffc6-402d-9525-0aca8eee4de4_count"</span></span><br><span class="line"> [76] <span class="string">"dcfbb975-9b59-4afb-8735-84206200af7a_count"</span></span><br><span class="line"> [77] <span class="string">"8accded2-8915-4eda-9ee4-c6730c2474de_count"</span></span><br><span class="line"> [78] <span class="string">"6f141f5b-bf1e-4b4b-8a9e-b4edb0d5cbd9_count"</span></span><br><span class="line"> [79] <span class="string">"9af07569-4904-4354-8554-a53951d991d5_count"</span></span><br><span class="line"> [80] <span class="string">"6e264598-c25a-4d37-aa61-e3042c2265be_count"</span></span><br><span class="line"> [81] <span class="string">"20cdc1be-7412-4457-ab53-90dcfdf26f93_count"</span></span><br><span class="line"> [82] <span class="string">"43a95b01-4d9e-4205-9eda-f7cfcfabe0de_count"</span></span><br><span class="line"> [83] <span class="string">"a0b1fe2b-28f6-4e9d-bc06-67be4b47e523_count"</span></span><br><span class="line"> [84] <span class="string">"f0dd3f84-52af-4d84-b911-c12ce87070a5_count"</span></span><br><span class="line"> [85] <span class="string">"37759f54-5e74-48fd-87fe-630270219430_count"</span></span><br><span class="line"> [86] <span class="string">"5a1115b6-f0b9-4912-a493-7b239e3f674b_count"</span></span><br><span class="line"> [87] <span class="string">"ea52b9de-451a-480f-8e1a-ac520dcfdeff_count"</span></span><br><span class="line"> [88] <span class="string">"67a59704-20de-482b-b65d-57b7e0160535_count"</span></span><br><span class="line"> [89] <span class="string">"ef6b65f8-e67d-4584-9042-8ae5dbdc845a_count"</span></span><br><span class="line"> [90] <span class="string">"ff7a8aa0-f671-441d-adfb-e1139614a47a_count"</span></span><br><span class="line"> [91] <span class="string">"9e4f3e3a-842f-4ece-b70b-9e5e9bb12af0_count"</span></span><br><span class="line"> [92] <span class="string">"8d9fd739-49be-44aa-8620-806b18d561fb_count"</span></span><br><span class="line"> [93] <span class="string">"b25e8317-280f-4d1d-a65f-67bb2a20268d_count"</span></span><br><span class="line"> [94] <span class="string">"0ade05fe-5f98-477d-b7fa-c56ea93247cf_count"</span></span><br><span class="line"> [95] <span class="string">"d72fd13a-564a-4a11-9ced-8c891c91bfb8_count"</span></span><br><span class="line"> [96] <span class="string">"8c063b2e-61f1-40ef-9ec1-5146d1c1855c_count"</span></span><br><span class="line"> [97] <span class="string">"299d62a1-2235-411e-af1c-e9c32414d350_count"</span></span><br><span class="line"> [98] <span class="string">"71a24f55-17a7-4396-91fa-e6c7e03df518_count"</span></span><br><span class="line"> [99] <span class="string">"f66dd895-d78c-4b35-8583-1a2b8464fde2_count"</span></span><br><span class="line">[100] <span class="string">"1a2ef4d2-9a08-4b17-9c93-22c0b0456df1_count"</span></span><br><span class="line">[101] <span class="string">"58ff1a2a-76d0-4727-a749-7c9cf1bae05a_count"</span></span><br><span class="line">[102] <span class="string">"74c84a22-7165-41f7-a38f-ed2db790ca2f_count"</span></span><br><span class="line">[103] <span class="string">"801c2c60-5dc2-43f7-949f-18b5a35a4ca3_count"</span></span><br><span class="line">[104] <span class="string">"bceaa475-65e1-4362-91fa-22f68f90cbba_count"</span></span><br><span class="line">[105] <span class="string">"7c9774cf-1a6b-4c25-a280-8b632afdf8c5_count"</span></span><br><span class="line">[106] <span class="string">"e3819f03-64b9-4999-acd7-27af18dade35_count"</span></span><br><span class="line">[107] <span class="string">"dcc0b93e-257f-48ce-b052-4de18db8d3ff_count"</span></span><br><span class="line">[108] <span class="string">"40cc0bb9-64a0-4163-9244-1ab3ddfbfea0_count"</span></span><br><span class="line">[109] <span class="string">"3704029d-0bb1-40b5-b666-610174d521c2_count"</span></span><br><span class="line">[110] <span class="string">"591271df-af96-4915-9e17-e3362bb7f57d_count"</span></span><br><span class="line">[111] <span class="string">"87ae6f80-ff00-4b44-bcfe-ef3a3c1582cb_count"</span></span><br><span class="line">[112] <span class="string">"48eebb82-b27e-4e1a-b916-6d471d5869ee_count"</span></span><br><span class="line">[113] <span class="string">"53bbcddc-bbee-4a5c-ae1b-f68a5e7ef01c_count"</span></span><br><span class="line">[114] <span class="string">"521cf209-e415-4352-96d7-aef7c1d564c0_count"</span></span><br><span class="line">[115] <span class="string">"f71ca4cb-1677-41cd-aec1-cd2702fb840e_count"</span></span><br><span class="line">[116] <span class="string">"3ff465f0-6c58-41eb-bad1-15bd5cd80531_count"</span></span><br><span class="line">[117] <span class="string">"65393588-3484-4942-80d5-fb3a43cbc543_count"</span></span><br><span class="line">[118] <span class="string">"14a46052-6b89-4fb0-bc9c-08d232219ab7_count"</span></span><br><span class="line">[119] <span class="string">"5e34aa02-ef95-47e8-8dc1-7fdbbb9c883c_count"</span></span><br><span class="line">[120] <span class="string">"21afb538-3284-4897-ae1b-ea53a3209920_count"</span></span><br><span class="line">[121] <span class="string">"6a0f01a5-152a-494e-aef3-45e58c875a64_count"</span></span><br><span class="line">[122] <span class="string">"2fc73f79-d413-4797-887a-3c425ef247c4_count"</span></span><br><span class="line">[123] <span class="string">"956b383e-6fd2-492c-b907-cf7c09b06863_count"</span></span><br><span class="line">[124] <span class="string">"6528258a-b7eb-4919-8056-225229e1efa5_count"</span></span><br><span class="line">[125] <span class="string">"426b94fe-fcff-49f2-9d0b-c7cb49bb5559_count"</span></span><br><span class="line">[126] <span class="string">"26a6f9a8-7fb5-4a18-bebb-bdb9ad451116_count"</span></span><br><span class="line">[127] <span class="string">"92803010-f63c-4b2a-aa02-9914e66dd0c0_count"</span></span><br><span class="line">[128] <span class="string">"0fb0526a-42ca-48b8-bf58-f9b39cda341a_count"</span></span><br><span class="line">[129] <span class="string">"a73b7250-3437-4279-b3e1-1add31d7b3fc_count"</span></span><br><span class="line">[130] <span class="string">"10d26b59-35d5-4925-9f28-6d54125ad67a_count"</span></span><br><span class="line">[131] <span class="string">"aafeade1-c999-487f-9a76-582f33545eee_count"</span></span><br><span class="line">[132] <span class="string">"a7d05ea6-aa28-457f-a20b-57e812b614e1_count"</span></span><br><span class="line">[133] <span class="string">"ef700f61-d8b0-43d0-92d1-feec949adc72_count"</span></span><br><span class="line">[134] <span class="string">"f771854c-24cb-499a-b13c-b2fee71bcb39_count"</span></span><br><span class="line">[135] <span class="string">"151836ff-610c-49ac-a8c5-868e0bbf4eaa_count"</span></span><br><span class="line">[136] <span class="string">"2e5095b6-5f89-4b79-abfa-0afe326801ef_count"</span></span><br><span class="line">[137] <span class="string">"175e2233-28a0-47c7-b395-19dd033b79d8_count"</span></span><br><span class="line">[138] <span class="string">"4803ca9c-59c4-4330-b8f7-e3eb4a01ebb6_count"</span></span><br><span class="line">[139] <span class="string">"f3876e31-2267-458d-826f-769bcfb34e56_count"</span></span><br><span class="line">[140] <span class="string">"b1fc4b98-8e85-442e-9204-d4e5dd4e6bc5_count"</span></span><br><span class="line">[141] <span class="string">"6aa7ae56-0370-41a9-9286-d4795e06cf5a_count"</span></span><br><span class="line">[142] <span class="string">"8d39e856-f93f-4eab-90ef-1e924b059fee_count"</span></span><br><span class="line">[143] <span class="string">"6d221ee7-2444-464e-9782-e83df2e203fa_count"</span></span><br><span class="line">[144] <span class="string">"e52ea781-07b0-408d-92c0-c87f5725159d_count"</span></span><br><span class="line">[145] <span class="string">"20d85581-6c70-4c0c-bc9c-93c3e3a08bc3_count"</span></span><br><span class="line">[146] <span class="string">"401e568d-f69a-4b06-92f7-3441004b5438_count"</span></span><br><span class="line">[147] <span class="string">"61164db7-6b71-4a35-a799-8abcfb5ce4b0_count"</span></span><br><span class="line">[148] <span class="string">"b0b535b6-6600-4d7c-a22e-46b8478fe651_count"</span></span><br><span class="line">[149] <span class="string">"2087ef7f-0932-4a43-b402-d401de95f0d6_count"</span></span><br><span class="line">[150] <span class="string">"59fec480-f2bd-48d6-9c0e-a84ff19f916e_count"</span></span><br><span class="line">[151] <span class="string">"e28dfd98-3524-4910-8a3d-76cdd57987cf_count"</span></span><br><span class="line">[152] <span class="string">"476de4e4-7dfd-41a8-a3c5-3ae05987093e_count"</span></span><br><span class="line">[153] <span class="string">"17f1e25d-0177-4bf8-93c1-8d80a41b3164_count"</span></span><br><span class="line">[154] <span class="string">"2e1b2787-8e16-4622-a1e0-3b96e6381e87_count"</span></span><br><span class="line">[155] <span class="string">"38a90283-962c-482d-99f1-bcb8cfb568bc_count"</span></span><br><span class="line">[156] <span class="string">"d493f215-ef46-4631-8687-95bf16692e3c_count"</span></span><br><span class="line">[157] <span class="string">"2ac28765-d5c7-4361-afed-3adabd801ee1_count"</span></span><br><span class="line">[158] <span class="string">"ecbab673-6313-4396-86aa-b06c67513c3b_count"</span></span><br><span class="line">[159] <span class="string">"ef5f4ebe-6b9e-4cc7-985c-e54a286a1f06_count"</span></span><br><span class="line">[160] <span class="string">"405e401d-d3fc-468c-8c63-c8dddf9b3ee3_count"</span></span><br><span class="line">[161] <span class="string">"1e69236e-5526-4bf1-8de5-35d50a71f227_count"</span></span><br><span class="line">[162] <span class="string">"e9d0a954-7b2d-42c1-a2e1-799a289cc5af_count"</span></span><br><span class="line">[163] <span class="string">"32a5a64b-7150-461d-859c-c40c6e92ba4b_count"</span></span><br><span class="line">[164] <span class="string">"476bae8b-1fb6-4c6c-98ae-2a779a718e6f_count"</span></span><br><span class="line">[165] <span class="string">"6e2447ba-25fb-4c53-bf2f-4ee1e3642da2_count"</span></span><br><span class="line">[166] <span class="string">"a842f65f-8e47-4ddb-81aa-a4acff6b4963_count"</span></span><br><span class="line">[167] <span class="string">"130e22b9-5b91-437a-88be-aefaced5bb5e_count"</span></span><br><span class="line">[168] <span class="string">"be68c6d8-3f37-4080-8ac7-4032756d071d_count"</span></span><br><span class="line">[169] <span class="string">"e1c0a5ef-a95e-41c8-9c03-60cb6b767709_count"</span></span><br><span class="line">[170] <span class="string">"d99d874c-b050-466d-9475-48d8af5ad972_count"</span></span><br><span class="line">[171] <span class="string">"2a659746-7292-4590-add0-c5915e513a7a_count"</span></span><br><span class="line">[172] <span class="string">"df0b7118-2a68-420e-a1dd-236e05bc8fe8_count"</span></span><br><span class="line">[173] <span class="string">"21df2113-117e-429d-bf2f-5812800add68_count"</span></span><br><span class="line">[174] <span class="string">"be5d2862-2042-43f3-9469-9c8c599e21fc_count"</span></span><br><span class="line">[175] <span class="string">"46649617-64ad-4fdb-9266-150e2fc6a54d_count"</span></span><br><span class="line">[176] <span class="string">"ace931f9-743c-4699-9198-2a93bf20b6aa_count"</span></span><br><span class="line">[177] <span class="string">"91f4add6-50e3-48a0-b332-2946389309db_count"</span></span><br><span class="line">[178] <span class="string">"675bba8c-4d4e-4e8c-b9bb-bcdc13b606e4_count"</span></span><br><span class="line">[179] <span class="string">"bbc8e3e4-ff61-49ea-8624-e0b5b078562e_count"</span></span><br><span class="line">[180] <span class="string">"b7225be0-787a-410c-9a4b-cf8236a43c61_count"</span></span><br><span class="line">[181] <span class="string">"84d835ed-9e38-4fb0-8596-df882698107d_count"</span></span><br><span class="line">[182] <span class="string">"0afa874c-af86-47d8-8757-0679af6804a9_count"</span></span><br><span class="line">[183] <span class="string">"1d443e1f-794b-45bb-ae6f-91f57d5fca33_count"</span></span><br><span class="line">[184] <span class="string">"7223f19a-017e-465b-b81b-bed54252c6b0_count"</span></span><br><span class="line">[185] <span class="string">"29becab5-d444-4165-a8a0-35791c09a162_count"</span></span><br><span class="line">[186] <span class="string">"b8fb3d69-dcf2-4f8a-8960-8a1da00ed95b_count"</span></span><br><span class="line">[187] <span class="string">"8bc4505b-bcb8-470a-bc52-2b8f6a4cb4ae_count"</span></span><br><span class="line">[188] <span class="string">"92de83d1-ba60-413c-8d21-d066505fe306_count"</span></span><br><span class="line">[189] <span class="string">"c0e81984-36e8-4b4d-8ee9-3cef760ae6c2_count"</span></span><br><span class="line">[190] <span class="string">"9fa215ae-e9ce-4f87-9c8e-b3d9574925c8_count"</span></span><br><span class="line">[191] <span class="string">"454d2d51-19c4-4509-96ad-c400035a49f4_count"</span></span><br><span class="line">[192] <span class="string">"567d381b-f753-4975-bbc6-c8daa4ff4530_count"</span></span><br><span class="line">[193] <span class="string">"34119118-6feb-4641-9e6c-485981c7984b_count"</span></span><br><span class="line">[194] <span class="string">"ae2e66c6-a69c-45c6-8584-82b4da9899e0_count"</span></span><br><span class="line">[195] <span class="string">"1f578919-3fbb-4491-8381-46b097f5339c_count"</span></span><br><span class="line">[196] <span class="string">"4947a490-76f8-4cc9-b66f-f8ad69300179_count"</span></span><br><span class="line">[197] <span class="string">"769d968d-bf8e-4bb7-93ec-47a131d7f2d5_count"</span></span><br><span class="line">[198] <span class="string">"b242bb76-202f-415b-8710-14ffcaf61a4c_count"</span></span><br><span class="line">[199] <span class="string">"58536ca4-2793-4c2c-845c-cfd2bbdd470b_count"</span></span><br><span class="line">[200] <span class="string">"f6178fdc-41f7-458b-a905-4ea298e6b098_count"</span></span><br><span class="line">[201] <span class="string">"b393f2a6-56ad-4467-9051-98c0cfa0550c_count"</span></span><br><span class="line">[202] <span class="string">"666b1386-0778-4b3c-a736-dccdc041c80f_count"</span></span><br><span class="line">[203] <span class="string">"b125b3b0-aa59-4e92-9a19-47d5049f7737_count"</span></span><br><span class="line">[204] <span class="string">"bd557612-d93b-4524-9a53-f637c6f4c34c_count"</span></span><br><span class="line">[205] <span class="string">"267640d4-53b0-4a04-9a87-7ac779d35938_count"</span></span><br><span class="line">[206] <span class="string">"45ca61f5-eb78-4bd3-af3a-9847ac6e1a14_count"</span></span><br><span class="line">[207] <span class="string">"c50805c9-71f7-41bb-97f9-5ef389cbfb62_count"</span></span><br><span class="line">[208] <span class="string">"8a5ed889-bb3d-47a2-bd2a-0a1d139a3809_count"</span></span><br><span class="line">[209] <span class="string">"97ae61b2-1b02-4084-a949-8c7dc1073139_count"</span></span><br><span class="line">[210] <span class="string">"3a1ef3a4-f090-47dd-81ee-48469bc3f6ef_count"</span></span><br><span class="line">[211] <span class="string">"63554af4-f56a-49aa-9b10-710ed85ffa13_count"</span></span><br><span class="line">[212] <span class="string">"5a715f75-afcd-4255-bbdb-9eaf756a5944_count"</span></span><br><span class="line">[213] <span class="string">"eb70ccf2-f854-4d99-92a3-f02ba2b3c770_count"</span></span><br><span class="line">[214] <span class="string">"d8f882f6-d25a-42dc-9444-02e1d8cb7608_count"</span></span><br><span class="line">[215] <span class="string">"f29a555a-3fb8-47a0-ac54-01811b6ad192_count"</span></span><br><span class="line">[216] <span class="string">"996fa724-fa06-4f69-abd7-910a1a74e276_count"</span></span><br><span class="line">[217] <span class="string">"d1e05707-3af4-469b-88ee-b37a7b91173f_count"</span></span><br><span class="line">[218] <span class="string">"a44076d3-e44f-4668-b088-80a55f1d5ec8_count"</span></span><br><span class="line">[219] <span class="string">"a86ebddd-ebf1-4e14-89ec-de8b0dac02ff_count"</span></span><br><span class="line">[220] <span class="string">"a4bf31ea-aae7-45d1-9728-cf40d4c4b7da_count"</span></span><br><span class="line">[221] <span class="string">"d7e7ad52-ecde-4744-b4e7-28dea4d186da_count"</span></span><br><span class="line">[222] <span class="string">"ec240723-a6d1-484c-9103-92a709dd86f1_count"</span></span><br><span class="line">[223] <span class="string">"890031a1-4dae-4f7a-ad43-beacc11f4d90_count"</span></span><br><span class="line">[224] <span class="string">"60547e35-d42f-44bd-a9e8-21d57da93ee8_count"</span></span><br><span class="line">[225] <span class="string">"39edcb3c-c9f4-4b00-8b16-17f1909fef15_count"</span></span><br><span class="line">[226] <span class="string">"8d2f4be9-4885-4a75-991e-286a2f9223c2_count"</span></span><br><span class="line">[227] <span class="string">"8e8191bf-78b4-4d5d-ac02-153528aee2f5_count"</span></span><br><span class="line">[228] <span class="string">"de01576d-54fd-453b-8e13-735d8936b171_count"</span></span><br><span class="line">[229] <span class="string">"42509e89-b487-4ab3-b70a-d3d2fa5f07d1_count"</span></span><br><span class="line">[230] <span class="string">"c5c166cc-9a61-4340-901b-d198cb522289_count"</span></span><br><span class="line">[231] <span class="string">"cfe84822-f9a6-4fe0-bed5-ee2f44fdecf7_count"</span></span><br><span class="line">[232] <span class="string">"21ec2ebe-dd2e-45bc-9702-cfc75f27dbbe_count"</span></span><br><span class="line">[233] <span class="string">"5b28b53d-0d5e-4359-be3d-23bcb185fc00_count"</span></span><br><span class="line">[234] <span class="string">"1954f30d-9c55-4493-ba44-3350107a644b_count"</span></span><br><span class="line">[235] <span class="string">"59374379-2da1-4265-b1eb-884a11cff8ba_count"</span></span><br><span class="line">[236] <span class="string">"ec2e0f42-85e7-48be-ba3c-1afcee0e7e1b_count"</span></span><br><span class="line">[237] <span class="string">"ae08d16e-0df4-46d5-a837-1c22d41ec11e_count"</span></span><br><span class="line">[238] <span class="string">"4760aebd-9599-4cfa-9b56-50bd7ffb87cd_count"</span></span><br><span class="line">[239] <span class="string">"402c906c-8229-4169-b324-b990caf0d8c0_count"</span></span><br><span class="line">[240] <span class="string">"bef7c254-c614-4472-929a-e765e3014180_count"</span></span><br><span class="line">[241] <span class="string">"679e7bab-b24d-415e-a341-da3955e8d47a_count"</span></span><br><span class="line">[242] <span class="string">"a8165949-f924-4c32-8ccf-4109d2899e66_count"</span></span><br><span class="line">[243] <span class="string">"3645a77a-a0da-4385-b02d-4e52fbe33df0_count"</span></span><br><span class="line">[244] <span class="string">"c0585219-4f92-423a-94bc-249d4f8c3b35_count"</span></span><br><span class="line">[245] <span class="string">"4ad49961-f26f-4c78-9ea1-7c13f1a36f2e_count"</span></span><br><span class="line">[246] <span class="string">"73461d68-f3c8-4a5f-86e1-44f6f4218ba2_count"</span></span><br><span class="line">[247] <span class="string">"0ae0a2cb-0845-459e-b673-98ee0dea3968_count"</span></span><br><span class="line">[248] <span class="string">"7ac46b6d-5042-4aa9-946d-b75a13d3747f_count"</span></span><br><span class="line">[249] <span class="string">"fddf0083-59bd-4352-8e3d-7e5715f6d5b0_count"</span></span><br><span class="line">[250] <span class="string">"3e124db2-ed81-4d69-a673-a23095919d1b_count"</span></span><br><span class="line">[251] <span class="string">"7a790ece-2c1a-4895-a475-9fabbc0622a3_count"</span></span><br><span class="line">[252] <span class="string">"a8ecb5d8-ece5-43cc-843c-da81dc031ced_count"</span></span><br><span class="line">[253] <span class="string">"13b5e39d-2163-4d59-9013-a1813c6a548e_count"</span></span><br><span class="line">[254] <span class="string">"b0f16882-207d-4334-8d7e-a338e03ad30b_count"</span></span><br><span class="line">[255] <span class="string">"677529b6-20ca-4cf9-8c71-fb7bebedbd2f_count"</span></span><br><span class="line">[256] <span class="string">"4d813387-15db-4d2f-bf85-1c79874aa179_count"</span></span><br><span class="line">[257] <span class="string">"2fcd467f-4ea2-4712-ad16-217e05b135b1_count"</span></span><br><span class="line">[258] <span class="string">"f2d9774f-f42b-4c02-9dc2-0d91a577d0f4_count"</span></span><br><span class="line">[259] <span class="string">"a6786f3b-caf0-4e1f-9711-1479b1ae0fdf_count"</span></span><br><span class="line">[260] <span class="string">"16009a5d-2149-4fa5-8e66-faac0f9f0309_count"</span></span><br><span class="line">[261] <span class="string">"064910fa-3648-4324-b958-47a3b89fe4b5_count"</span></span><br><span class="line">[262] <span class="string">"56ac46a4-f422-43e3-b117-39c8c835c4c1_count"</span></span><br><span class="line">[263] <span class="string">"7f8961db-237b-44d5-b9f8-eb3980896b98_count"</span></span><br><span class="line">[264] <span class="string">"6c4b3467-bf5a-4241-a580-44eea16df109_count"</span></span><br><span class="line">[265] <span class="string">"8170404a-1f5b-49b4-9d68-a196c57da6b2_count"</span></span><br><span class="line">[266] <span class="string">"c54adb79-67e1-4dc2-bf30-a947b688460f_count"</span></span><br><span class="line">[267] <span class="string">"d20be26f-6289-4b94-8724-e63e3f0bca1f_count"</span></span><br><span class="line">[268] <span class="string">"309c2415-06e2-405d-801f-1d8ddb89c0ba_count"</span></span><br><span class="line">[269] <span class="string">"5012c1cb-2153-4013-99d7-c8678f6db126_count"</span></span><br><span class="line">[270] <span class="string">"6bfb01db-5e92-4fad-9b21-39e1e911716b_count"</span></span><br><span class="line">[271] <span class="string">"030a2cdd-9b0c-486f-935d-6049f41a85e6_count"</span></span><br><span class="line">[272] <span class="string">"f00b69a3-c3d2-4499-b337-abbce3e48f9b_count"</span></span><br><span class="line">[273] <span class="string">"6993764a-2359-4e76-a325-b040e97648d3_count"</span></span><br><span class="line">[274] <span class="string">"dba87d20-a3ed-4ca3-93f7-0fe979f7923a_count"</span></span><br><span class="line">[275] <span class="string">"0b490510-ec4d-4e10-ad98-c378e9332a6d_count"</span></span><br><span class="line">[276] <span class="string">"884aa7fa-58c7-4ec1-bb3a-5fd7141dff0a_count"</span></span><br><span class="line">[277] <span class="string">"5a8f462d-a749-4542-bf02-f1350fb73599_count"</span></span><br><span class="line">[278] <span class="string">"27348a04-4203-4990-ba27-4bde0422932b_count"</span></span><br><span class="line">[279] <span class="string">"3fdbd440-98a0-4ea0-ad84-d38667e176d0_count"</span></span><br><span class="line">[280] <span class="string">"a87961f7-7a05-4248-a683-7047af4ea194_count"</span></span><br><span class="line">[281] <span class="string">"04ebd1b2-5cc6-448d-a351-58cc73a8d094_count"</span></span><br><span class="line">[282] <span class="string">"bbd8991a-fb0b-48c2-868c-7efc4872dcfb_count"</span></span><br><span class="line">[283] <span class="string">"8236e9a3-ea00-4a0f-923e-40d55c300a83_count"</span></span><br><span class="line">[284] <span class="string">"ab461441-1f45-4ae5-b5da-ebb58817f75c_count"</span></span><br><span class="line">[285] <span class="string">"cca451f8-573f-4f4d-b551-32493218d16c_count"</span></span><br><span class="line">[286] <span class="string">"640ccf3e-487f-49ca-8df6-67e10d852c9e_count"</span></span><br><span class="line">[287] <span class="string">"677fb228-6830-4402-9eda-c4a0e975c189_count"</span></span><br><span class="line">[288] <span class="string">"84400ad5-cd37-4a94-a143-5c470599d1ce_count"</span></span><br><span class="line">[289] <span class="string">"345d3200-a399-4eca-b48f-2beeb1689a8a_count"</span></span><br><span class="line">[290] <span class="string">"d3f73c0f-d518-4e91-b038-a4360495ee27_count"</span></span><br><span class="line">[291] <span class="string">"03fe25f9-ec83-49d0-9f50-e113b6678fdc_count"</span></span><br><span class="line">[292] <span class="string">"ca8a081c-43f9-4f6b-8736-64eb61cd72aa_count"</span></span><br><span class="line">[293] <span class="string">"09246213-2ca8-461d-8cb9-2de1da038b7f_count"</span></span><br><span class="line">[294] <span class="string">"b1dc114e-a2f2-4da7-8fda-ef83339eaaea_count"</span></span><br><span class="line">[295] <span class="string">"2147de22-3a52-490d-a4f6-32f6637ca24f_count"</span></span><br><span class="line">[296] <span class="string">"0ca1e770-a584-4090-95fa-9c0a3ad4bc16_count"</span></span><br><span class="line">[297] <span class="string">"9f374133-fe7d-4fe3-8c34-c8048125562f_count"</span></span><br><span class="line">[298] <span class="string">"4e30632f-e8ad-4a99-97ba-94d89a08bc19_count"</span></span><br><span class="line">[299] <span class="string">"9f2932d6-bb5c-4ce0-9ea7-281a459fb64a_count"</span></span><br><span class="line">[300] <span class="string">"d1c88616-a6ba-4865-9cf7-deebbafa4924_count"</span></span><br><span class="line">[301] <span class="string">"5c389a62-c076-421d-9b55-03a6a44a7f32_count"</span></span><br><span class="line">[302] <span class="string">"7a43da66-e219-4bc3-bddb-ef014247039f_count"</span></span><br><span class="line">[303] <span class="string">"372456ca-f3d1-4134-8a9b-78cae87897fc_count"</span></span><br><span class="line">[304] <span class="string">"31dd0805-728c-4e1e-8ef9-eaf304f91852_count"</span></span><br><span class="line">[305] <span class="string">"faeef296-5731-4095-b617-18a19e419b3f_count"</span></span><br><span class="line">[306] <span class="string">"c5d97e4a-8a34-4d99-8fae-70dd5bb12234_count"</span></span><br><span class="line">[307] <span class="string">"c4fbad39-af28-4011-86d8-ac700e3af78d_count"</span></span><br><span class="line">[308] <span class="string">"8dec6cce-17fe-4d01-8ad3-f8baa1156356_count"</span></span><br><span class="line">[309] <span class="string">"302a0272-01f3-41de-9107-554800d6a0c7_count"</span></span><br><span class="line">[310] <span class="string">"692302e6-386a-43ff-8792-cb84a07896ce_count"</span></span><br><span class="line">[311] <span class="string">"f9e98164-b7e5-4d58-a4ba-d6947d832088_count"</span></span><br><span class="line">[312] <span class="string">"7e0c2d63-6b93-4164-b9c6-72ad669eb0c7_count"</span></span><br><span class="line">[313] <span class="string">"063e88ae-7e21-4504-9c1e-45d7d371b276_count"</span></span><br><span class="line">[314] <span class="string">"e3f9e542-aeb1-48f7-ad1d-929262441454_count"</span></span><br><span class="line">[315] <span class="string">"14ce8586-4131-4f56-b516-f640986ba95d_count"</span></span><br><span class="line">[316] <span class="string">"3dce2e68-bcf1-42b6-9374-b2724a0f5242_count"</span></span><br><span class="line">[317] <span class="string">"631a4c93-c41d-4ca3-84c7-6f6ad226397a_count"</span></span><br><span class="line">[318] <span class="string">"3cd45be6-69d7-41c2-897a-44f8a70a451f_count"</span></span><br><span class="line">[319] <span class="string">"3ac10a9b-801d-4e87-8b8d-33f1c7eed2bd_count"</span></span><br><span class="line">[320] <span class="string">"536f6749-4430-4c7e-93e3-c60e629c502c_count"</span></span><br><span class="line">[321] <span class="string">"2950c137-45e0-458f-987f-31de7f7befc4_count"</span></span><br><span class="line">[322] <span class="string">"58f96018-2cf5-4e6b-bec0-b8c79da62bce_count"</span></span><br><span class="line">[323] <span class="string">"8f16590f-2437-4c68-a2bd-8406b08198ef_count"</span></span><br><span class="line">[324] <span class="string">"2b316653-ead7-4cf4-8b6c-e637d86f054c_count"</span></span><br><span class="line">[325] <span class="string">"5c9f1a05-1dc7-4e83-8dc2-3e5071796c07_count"</span></span><br><span class="line">[326] <span class="string">"200f078d-025a-4d6a-9e45-709313357760_count"</span></span><br><span class="line">[327] <span class="string">"6fd37782-98d7-4704-b046-b18574b65be4_count"</span></span><br><span class="line">[328] <span class="string">"e1c82878-ac01-45bd-83b0-4bc606039670_count"</span></span><br><span class="line">[329] <span class="string">"e85334ba-9c09-4725-953d-8b149837ecd9_count"</span></span><br><span class="line">[330] <span class="string">"e7f07f98-8dbf-4884-8d45-318671c15c98_count"</span></span><br><span class="line">[331] <span class="string">"34e77fac-9e4b-481c-9a6c-a1b5f0916f06_count"</span></span><br><span class="line">[332] <span class="string">"8f6d3839-330b-45c7-86e5-1b9051a2c9f0_count"</span></span><br><span class="line">[333] <span class="string">"862ee0a5-794a-4bad-974e-84b341fa7d50_count"</span></span><br><span class="line">[334] <span class="string">"777d1602-66be-4673-b69d-d651abf7bb35_count"</span></span><br><span class="line">[335] <span class="string">"3d118af2-5f3e-4b03-90bc-ec9df6792742_count"</span></span><br><span class="line">[336] <span class="string">"d1c52e51-385b-44d4-b119-6ee3883017f8_count"</span></span><br><span class="line">[337] <span class="string">"f3931125-95ce-4c67-be63-edc11068cffe_count"</span></span><br><span class="line">[338] <span class="string">"cc36843b-e6af-4a45-a525-0dd34dd115fb_count"</span></span><br><span class="line">[339] <span class="string">"8c4af45c-5747-4cf1-942d-0a7352b369f3_count"</span></span><br><span class="line">[340] <span class="string">"a3f0e2f2-fca0-4562-812e-31921c9f482f_count"</span></span><br><span class="line">[341] <span class="string">"6b8fbd86-ffe4-463b-bd1e-5fe3249f9dc9_count"</span></span><br><span class="line">[342] <span class="string">"d8d4c3ae-74b5-4069-bac3-2722f224ffe8_count"</span></span><br><span class="line">[343] <span class="string">"891d5512-0e8d-4dac-9f76-71aeae3937a6_count"</span></span><br><span class="line">[344] <span class="string">"7951757a-ae69-49be-a6d4-fd0b123c7665_count"</span></span><br><span class="line">[345] <span class="string">"382f821a-dcac-4f3f-a180-0af6468e9ebc_count"</span></span><br><span class="line">[346] <span class="string">"f091a9a1-1645-4a21-b5a2-2f7cae2bdbfe_count"</span></span><br><span class="line">[347] <span class="string">"a2225f76-3b17-494d-81b6-5c68b73150ff_count"</span></span><br><span class="line">[348] <span class="string">"99a601eb-cbb0-4460-b9dc-6e151f4ff225_count"</span></span><br><span class="line">[349] <span class="string">"bf10b66f-f192-44fe-9580-16599fb7904b_count"</span></span><br><span class="line">[350] <span class="string">"156b326a-3fa5-4394-af29-7db1c2f3463b_count"</span></span><br><span class="line">[351] <span class="string">"03bab812-d67c-4dae-93e0-55346525fc99_count"</span></span><br><span class="line">[352] <span class="string">"bed7e30b-bf94-41d1-80f6-0595ff21bd3e_count"</span></span><br><span class="line">[353] <span class="string">"b1f1481f-9572-4460-bc2e-7646b454f488_count"</span></span><br><span class="line">[354] <span class="string">"9cb330c1-982f-42e8-9779-ac4377259162_count"</span></span><br><span class="line">[355] <span class="string">"eff473b1-657a-4004-bbf8-c48f948e4e7d_count"</span></span><br><span class="line">[356] <span class="string">"db87c217-8596-41d8-b4d7-1b6b1f289e5a_count"</span></span><br><span class="line">[357] <span class="string">"5dddcbc8-e340-4c24-96eb-6fa7ff9d757a_count"</span></span><br><span class="line">[358] <span class="string">"978e6eae-88e0-4886-8523-baabc7b0764d_count"</span></span><br><span class="line">[359] <span class="string">"07ef65b6-3ad2-4e51-809f-738283978aba_count"</span></span><br><span class="line">[360] <span class="string">"e68b0db1-da01-475f-aa4e-6f7f87bbc135_count"</span></span><br><span class="line">[361] <span class="string">"fde994b4-f247-4bc9-81f2-dd9d39008c31_count"</span></span><br><span class="line">[362] <span class="string">"ba514dbb-42e6-44fd-9c72-73839e1226e6_count"</span></span><br><span class="line">[363] <span class="string">"020a0264-e1d5-4957-9abf-df6983845b8a_count"</span></span><br><span class="line">[364] <span class="string">"091dc352-d8e6-484e-989b-4bc571051130_count"</span></span><br><span class="line">[365] <span class="string">"531bdb39-8e5d-4817-b5fa-a60ba31296a0_count"</span></span><br><span class="line">[366] <span class="string">"2723b8fe-33ae-477f-ab0d-f5685f26b17f_count"</span></span><br><span class="line">[367] <span class="string">"590ef909-d0a1-4e19-a728-d6a8b34c9837_count"</span></span><br><span class="line">[368] <span class="string">"c6dbc122-4220-4c6c-bf36-69ff371c5549_count"</span></span><br><span class="line">[369] <span class="string">"38712765-2ae2-438a-92e0-ca9e326a875d_count"</span></span><br><span class="line">[370] <span class="string">"b7567499-0820-49d6-9c72-7148d6628172_count"</span></span><br><span class="line">[371] <span class="string">"26dcc91b-b7d5-47c1-8135-e5ab4f4e4be5_count"</span></span><br><span class="line">[372] <span class="string">"875c4c80-bbe2-4ab7-b276-adc8ecaa987c_count"</span></span><br><span class="line">[373] <span class="string">"844b8466-6848-4dd7-b620-1a84103f63c8_count"</span></span><br><span class="line">[374] <span class="string">"45db4b6d-e0d3-430f-b88e-cda7a388c2af_count"</span></span><br><span class="line">[375] <span class="string">"a094f020-375a-4f15-8f64-7d2272304acd_count"</span></span><br><span class="line">[376] <span class="string">"596e3dbd-9928-4800-8026-6d1cfb9f5a57_count"</span></span><br><span class="line">[377] <span class="string">"08c5dec2-1521-4c5b-90fc-1d17306a6da0_count"</span></span><br><span class="line">[378] <span class="string">"2eb359c8-470a-47b4-a448-eb45df341862_count"</span></span><br><span class="line">[379] <span class="string">"891f9d70-e716-4fc9-b53e-f120da74eea3_count"</span></span><br><span class="line">[380] <span class="string">"f59733cc-e2d4-497c-84a0-5ab4fdc47a4e_count"</span></span><br><span class="line">[381] <span class="string">"7563ddfe-268f-4df2-a502-dc2284d8a02b_count"</span></span><br><span class="line">[382] <span class="string">"24eae743-7c15-40f5-82ef-8284c704a6f3_count"</span></span><br><span class="line">[383] <span class="string">"16a68a25-25ca-4382-aa32-14f1428ac05c_count"</span></span><br><span class="line">[384] <span class="string">"cdab322b-66c0-4c06-970c-5042afc1a706_count"</span></span><br><span class="line">[385] <span class="string">"a6d0f911-5137-4a56-a772-51da9d23f253_count"</span></span><br><span class="line">[386] <span class="string">"13fe6d54-192b-4e93-92a8-02ab20e589ed_count"</span></span><br><span class="line">[387] <span class="string">"f83b0459-e485-4988-bdce-5a217b454d8b_count"</span></span><br><span class="line">[388] <span class="string">"543ed507-fee0-40b6-9a99-e59310620d63_count"</span></span><br><span class="line">[389] <span class="string">"590db39a-029c-4f4b-9bcd-aec5d18580db_count"</span></span><br><span class="line">[390] <span class="string">"4245d642-56a7-4b27-b74d-ba3e3535b4d8_count"</span></span><br><span class="line">[391] <span class="string">"a60560b3-962b-4155-8aa5-46c8a5aaf9fa_count"</span></span><br><span class="line">[392] <span class="string">"f8089187-0d81-4e94-92ae-3f0178ce1790_count"</span></span><br><span class="line">[393] <span class="string">"9fbf27fa-c33d-443c-a50e-74c731cdeccd_count"</span></span><br><span class="line">[394] <span class="string">"d3b586fc-3d45-40f1-bbfa-53e85e005e4c_count"</span></span><br><span class="line">[395] <span class="string">"61162647-173a-458b-a387-967a2fd77630_count"</span></span><br><span class="line">[396] <span class="string">"621e2d96-fac9-42d3-9357-a7733a494cb3_count"</span></span><br><span class="line">[397] <span class="string">"ffcebcae-607d-4a4c-bb0e-6eda3ec5ac25_count"</span></span><br><span class="line">[398] <span class="string">"5a32f784-3eb3-4b15-9ce6-1cba8164e812_count"</span></span><br><span class="line">[399] <span class="string">"d03e50bd-6a01-4df5-835d-443bc87b8520_count"</span></span><br><span class="line">[400] <span class="string">"98d62da5-20c1-412a-a75b-9e004574b7ee_count"</span></span><br><span class="line">[401] <span class="string">"baec18f7-38ab-469f-bdb9-8ff04883679f_count"</span></span><br><span class="line">[402] <span class="string">"789c658e-b98a-4e1f-b808-5579dee94abe_count"</span></span><br><span class="line">[403] <span class="string">"2879c545-184a-4e1e-b476-b824e2121389_count"</span></span><br><span class="line">[404] <span class="string">"5ed6a576-0353-4e3e-9df8-a1a177e4672f_count"</span></span><br><span class="line">[405] <span class="string">"1ef78255-1b5c-42af-aa81-128c1b009114_count"</span></span><br><span class="line">[406] <span class="string">"b36ee0d0-f9d9-41fa-a260-15c1e6d7a1c1_count"</span></span><br><span class="line">[407] <span class="string">"1d683af7-3492-4250-8347-8e285676c83d_count"</span></span><br><span class="line">[408] <span class="string">"764dfff6-4ae1-4dcf-a505-867b6f6845d2_count"</span></span><br><span class="line">[409] <span class="string">"15ab4d09-8a85-4d6b-91b4-a87dcb7a5919_count"</span></span><br><span class="line">[410] <span class="string">"fcd37843-e471-4fc3-a4fd-da8d161d36e4_count"</span></span><br><span class="line">[411] <span class="string">"f25e85e5-e84e-4b42-bcf0-d493d8bffba4_count"</span></span><br><span class="line">[412] <span class="string">"0048d446-301b-4d04-97d2-1348b6889692_count"</span></span><br><span class="line">[413] <span class="string">"0a8119d4-31b0-4c02-8fc8-318077456790_count"</span></span><br><span class="line">[414] <span class="string">"4cab26a0-d914-4b92-8c97-522c07edd284_count"</span></span><br><span class="line">[415] <span class="string">"22a4a58f-b03a-49f7-bcc0-e387be0e651c_count"</span></span><br><span class="line">[416] <span class="string">"9a9ad966-3448-4ac4-81c2-df59121204f0_count"</span></span><br><span class="line">[417] <span class="string">"0fef447c-5f07-4299-b602-2b6b8450c6e6_count"</span></span><br><span class="line">[418] <span class="string">"76b4e454-8b75-449b-98cc-3c41c5e063a3_count"</span></span><br><span class="line">[419] <span class="string">"f6dcf5aa-b9d3-4959-8dc9-ad67dbc3c9d0_count"</span></span><br><span class="line">[420] <span class="string">"b32f0495-0e52-4bed-b795-5f7270960561_count"</span></span><br><span class="line">[421] <span class="string">"6fd0c5f2-a086-4fa6-900a-909cf67ef8be_count"</span></span><br><span class="line">[422] <span class="string">"0062bf7b-fcfd-4448-be8b-8c6b1bc643a6_count"</span></span><br><span class="line">[423] <span class="string">"c2e72857-11fb-4663-bf9a-bd2089d070fe_count"</span></span><br><span class="line">[424] <span class="string">"89528cea-b21b-4ea8-a271-3d3f3ff142c9_count"</span></span><br><span class="line">[425] <span class="string">"1958cf80-bec7-4b92-9338-7a2da94dfb68_count"</span></span><br><span class="line">[426] <span class="string">"0e269501-0237-4891-aa6b-5f5f0c3cbafb_count"</span></span><br><span class="line">[427] <span class="string">"a0c716d7-ab86-4381-9f1c-11f5e4d386ca_count"</span></span><br><span class="line">[428] <span class="string">"44925f20-dad5-40de-99b6-e8164abe94ed_count"</span></span><br><span class="line">[429] <span class="string">"2c16cd9b-3898-4808-b88f-d22a1bea6e8e_count"</span></span><br><span class="line">[430] <span class="string">"e23540e1-f329-4908-a42e-269dd9a87947_count"</span></span><br><span class="line">[431] <span class="string">"06ef2a8d-3ab3-4e88-b72c-a4317d5e8a52_count"</span></span><br><span class="line">[432] <span class="string">"d73728cb-58d3-4d95-a13a-37baa003609f_count"</span></span><br><span class="line">[433] <span class="string">"35f271be-6fd4-411a-afbc-c370665c363a_count"</span></span><br><span class="line">[434] <span class="string">"11ad89e5-bfa7-42bc-8dd4-13a5f745df1a_count"</span></span><br><span class="line">[435] <span class="string">"22d2db8e-f923-4006-baa6-249bccebd08e_count"</span></span><br><span class="line">[436] <span class="string">"1d5e00c4-5c82-4035-8304-841ba81c61fd_count"</span></span><br><span class="line">[437] <span class="string">"ee63ce5d-eeb2-4249-b1d5-2d0b677f77e6_count"</span></span><br><span class="line">[438] <span class="string">"b5bfeece-9757-4bfc-8067-1a342175298d_count"</span></span><br><span class="line">[439] <span class="string">"b421429a-e4fa-4894-9cdb-6f343cf4fabd_count"</span></span><br><span class="line">[440] <span class="string">"b9ab3494-7186-4df1-9aac-75777ce3a8ed_count"</span></span><br><span class="line">[441] <span class="string">"f00661fe-0081-435b-afea-27e1f1b39f33_count"</span></span><br><span class="line">[442] <span class="string">"5aebac9e-80ba-48bb-aedf-752196a1861a_count"</span></span><br><span class="line">[443] <span class="string">"7386bdff-7f78-46b5-afd3-d75a19f1a0ce_count"</span></span><br><span class="line">[444] <span class="string">"baed5b2d-e928-4f5f-be13-4c592b027c29_count"</span></span><br><span class="line">[445] <span class="string">"a51644b5-14b7-4764-b1c6-946613cd0215_count"</span></span><br><span class="line">[446] <span class="string">"ee688178-c5d2-445d-a4ce-69a17640e43d_count"</span></span><br><span class="line">[447] <span class="string">"3251fab1-8a05-4a78-98f5-0771528310bf_count"</span></span><br><span class="line">[448] <span class="string">"6a97d5c5-4178-4ced-b279-a2d5044f1fdb_count"</span></span><br><span class="line">[449] <span class="string">"bd77428f-6994-415d-ad14-a6e7676b343a_count"</span></span><br><span class="line">[450] <span class="string">"3f4c303e-97a4-4171-b389-0d8dfce24aa7_count"</span></span><br><span class="line">[451] <span class="string">"98386c9e-712a-4a16-ae18-736d6ff54973_count"</span></span><br><span class="line">[452] <span class="string">"bb5f9300-48c1-4155-9691-c9780bfa883f_count"</span></span><br><span class="line">[453] <span class="string">"13352bd8-ba40-4ea5-a23e-9aa538291ba8_count"</span></span><br><span class="line">[454] <span class="string">"f0ce3674-e566-474f-8b8e-96c467e3d7f5_count"</span></span><br><span class="line">[455] <span class="string">"b74e2e42-94b8-48fa-9691-936d606bb845_count"</span></span><br><span class="line">[456] <span class="string">"37a2db43-317f-475b-8379-960202fba684_count"</span></span><br><span class="line">[457] <span class="string">"c2bbbb93-eb63-4e5e-bea6-202311071937_count"</span></span><br><span class="line">[458] <span class="string">"f78e0f6e-6a64-4725-bab0-9b13ad036332_count"</span></span><br><span class="line">[459] <span class="string">"3e8ab945-629e-4a63-ac39-c1b78392e5b7_count"</span></span><br><span class="line">[460] <span class="string">"6f899334-8741-4d1d-a8e2-3bf17a25c968_count"</span></span><br><span class="line">[461] <span class="string">"67de4131-2f71-415f-bac1-33bc14f6438e_count"</span></span><br><span class="line">[462] <span class="string">"d56f943d-74a6-4a8a-85df-85fd737b0eab_count"</span></span><br><span class="line">[463] <span class="string">"7dd92b6c-ed0f-4f93-8a03-0fb8eb318d83_count"</span></span><br><span class="line">[464] <span class="string">"ff975b13-1717-4c41-a653-3a57d702cb2f_count"</span></span><br><span class="line">[465] <span class="string">"0af9ed7c-6508-4988-a2d2-66806cf14c95_count"</span></span><br><span class="line">[466] <span class="string">"78fd362c-5ca6-4190-bdc2-8c695b2ed304_count"</span></span><br><span class="line">[467] <span class="string">"66777578-091c-48f6-a0af-81353b58304e_count"</span></span><br><span class="line">[468] <span class="string">"7f6e7f9e-1ec3-4109-b4fd-1786aad9942f_count"</span></span><br><span class="line">[469] <span class="string">"1595b26f-d684-4962-b7ee-1f64addc4390_count"</span></span><br><span class="line">[470] <span class="string">"a7cbe257-b699-4363-94ce-a65ec0b5b85f_count"</span></span><br><span class="line">[471] <span class="string">"2692d2ae-3785-49ac-9431-37d36bd5dd21_count"</span></span><br><span class="line">[472] <span class="string">"a348da5e-e399-41da-bf2d-79369769246f_count"</span></span><br><span class="line">[473] <span class="string">"fb7bdba2-fc02-4d20-804c-704310642bdc_count"</span></span><br><span class="line">[474] <span class="string">"22ec8ef1-957b-468e-b101-a9e088f86338_count"</span></span><br><span class="line">[475] <span class="string">"b05e09d9-71f6-4f2d-a7de-83bc7f5131a4_count"</span></span><br><span class="line">[476] <span class="string">"62be7dc8-d879-4626-8168-25ccccf341f5_count"</span></span><br><span class="line">[477] <span class="string">"a2ce478c-032f-4e23-a011-4d67f16befee_count"</span></span><br><span class="line">[478] <span class="string">"a8d90f96-19e8-4b2c-a9c8-904a4063d235_count"</span></span><br><span class="line">[479] <span class="string">"9792f7ee-3295-43d7-b2f9-46cfa2dd2167_count"</span></span><br><span class="line">[480] <span class="string">"2113ee53-ea3a-47a9-bc6f-0844158f6b72_count"</span></span><br><span class="line">[481] <span class="string">"1a13663e-9015-4eeb-ab6a-8f40a8bbf403_count"</span></span><br><span class="line">[482] <span class="string">"38096336-4257-481c-b653-91804af5b2a1_count"</span></span><br><span class="line">[483] <span class="string">"9c38ed5a-076d-4ef9-ab1f-39814bf665b3_count"</span></span><br><span class="line">[484] <span class="string">"bfd8c6e2-15cc-48ae-a4a3-722ab3527fb9_count"</span></span><br><span class="line">[485] <span class="string">"b65910eb-d898-4c43-8cdf-300c94f168a3_count"</span></span><br><span class="line">[486] <span class="string">"ce4e2cee-4331-44bb-af7d-69fa303a8776_count"</span></span><br><span class="line">[487] <span class="string">"725c494c-5cc8-4825-a992-b98d61f57046_count"</span></span><br><span class="line">[488] <span class="string">"ed167176-8e4c-464e-b18e-ce6f1af4428a_count"</span></span><br><span class="line">[489] <span class="string">"cf503a9b-6af6-461a-8833-a6d26c99bdb7_count"</span></span><br><span class="line">[490] <span class="string">"bf4b7a95-244c-44c1-b5bb-49bc3b6fba68_count"</span></span><br><span class="line">[491] <span class="string">"ca5b59a6-b523-4f32-a542-8a467b591f67_count"</span></span><br><span class="line">[492] <span class="string">"bcc63e30-8c08-4767-85a0-69433319bd21_count"</span></span><br><span class="line">[493] <span class="string">"57be3f81-6dbb-4257-a4b5-f823e30d76bf_count"</span></span><br><span class="line">[494] <span class="string">"8a4021d0-bdee-4287-9266-d33e8d0a7407_count"</span></span><br><span class="line">[495] <span class="string">"aa0e4550-bfd3-4258-b5cb-9abe2de4a3e7_count"</span></span><br><span class="line">[496] <span class="string">"45b50712-c8b3-4f01-9802-a4f30d233d19_count"</span></span><br><span class="line">[497] <span class="string">"577b8ba8-29d6-4687-ad78-bb2d21ce6d40_count"</span></span><br><span class="line">[498] <span class="string">"4020fb48-41a6-40be-bf52-0e45fa2c1799_count"</span></span><br><span class="line">[499] <span class="string">"d9c7a1f7-f303-4617-b46c-2003e871095b_count"</span></span><br><span class="line">[500] <span class="string">"c649047a-3991-4eb0-847d-07cee766fcc2_count"</span></span><br><span class="line">[501] <span class="string">"acbe8040-a94b-4c8f-9a45-8f05182d9aed_count"</span></span><br><span class="line">[502] <span class="string">"3b832dcb-860c-4137-8406-d338bd421bcd_count"</span></span><br><span class="line">[503] <span class="string">"246d0372-763c-475f-8e19-d39a264a8d08_count"</span></span><br><span class="line">[504] <span class="string">"e69a2070-7766-4e4a-89f5-5728e2c9590f_count"</span></span><br><span class="line">[505] <span class="string">"80b47148-4783-43bb-9f61-570cb5f0202a_count"</span></span><br><span class="line">[506] <span class="string">"28d619c4-0511-4db1-bc3a-7a1c9ceec662_count"</span></span><br><span class="line">[507] <span class="string">"432bfb40-6587-4393-89b8-456e639152e8_count"</span></span><br><span class="line">[508] <span class="string">"6e2123ba-f414-492b-b3ea-76cdb8b49da7_count"</span></span><br><span class="line">[509] <span class="string">"10a93ff8-e2cd-4f1d-acb8-ae4ccd5fecdb_count"</span></span><br><span class="line">[510] <span class="string">"011ee3e1-37bd-47c1-9092-a24dffd3d5f5_count"</span></span><br><span class="line">[511] <span class="string">"93e77514-c77b-4346-ae63-3e0d10512cff_count"</span></span><br><span class="line">[512] <span class="string">"e26db93d-c41d-4048-9cab-196ec70c5676_count"</span></span><br><span class="line">[513] <span class="string">"bb216d3b-cacc-46df-89d6-455a5831a8f0_count"</span></span><br><span class="line">[514] <span class="string">"d9ec289e-7cca-4741-846f-0b972e31155a_count"</span></span><br><span class="line">[515] <span class="string">"1bf6cbe5-03bc-442f-9290-33c3722240bd_count"</span></span><br><span class="line">[516] <span class="string">"3a8bb200-5964-4ae2-a656-c1dc40c29d71_count"</span></span><br><span class="line">[517] <span class="string">"8e2e6b91-b5d6-4d21-a2c9-4ce9d48307ed_count"</span></span><br><span class="line">[518] <span class="string">"2f3f4579-6282-43a1-9f75-bac712f1f0d6_count"</span></span><br><span class="line">[519] <span class="string">"6a058f09-eac6-40d3-a24f-da1cb0371a2b_count"</span></span><br><span class="line">[520] <span class="string">"3f525b6f-e66f-455f-90ad-8adc27da7045_count"</span></span><br><span class="line">[521] <span class="string">"f9b34a21-993b-4eb7-a383-5cd41cd56ab9_count"</span></span><br><span class="line">[522] <span class="string">"3ee5534e-db4b-46b4-8d4d-111685eab0c9_count"</span></span><br><span class="line">[523] <span class="string">"023ce468-15ef-4077-af4d-4a723d133132_count"</span></span><br><span class="line">[524] <span class="string">"345cff8d-f361-4f8e-8221-9e310ffb1956_count"</span></span><br><span class="line">[525] <span class="string">"73516997-7254-47d2-84b5-6d81bc84c077_count"</span></span><br><span class="line">[526] <span class="string">"00c12b3c-61c9-4d02-bd7e-2067f9a5f5c0_count"</span></span><br><span class="line">[527] <span class="string">"0e303e50-9b5f-4ac5-9428-cc9979667d48_count"</span></span><br><span class="line">[528] <span class="string">"40365cdf-f04d-4214-a753-e15c64d57b7f_count"</span></span><br><span class="line">[529] <span class="string">"d88996bb-af00-4040-b251-29807506ac1f_count"</span></span><br><span class="line">[530] <span class="string">"e8bb4231-35af-462f-accf-a07a1aa9d5a6_count"</span></span><br><span class="line">[531] <span class="string">"63404d01-9685-4a55-9319-202e5f5abf79_count"</span></span><br><span class="line">[532] <span class="string">"02b3ab24-8d8e-40b4-b0a5-d69aa69e0a6f_count"</span></span><br><span class="line">[533] <span class="string">"ce8ba3ad-630f-4bc7-b8a1-cf8cc5f45839_count"</span></span><br><span class="line">[534] <span class="string">"5623b263-9d28-40bd-a177-024fc8c0e605_count"</span></span><br><span class="line">[535] <span class="string">"df573c90-44cf-4409-b92f-f6c8aaf01737_count"</span></span><br><span class="line">[536] <span class="string">"6ede5224-9a84-4ec5-9db2-99fbaf3419b1_count"</span></span><br><span class="line">[537] <span class="string">"c08817f0-fc05-44ea-8a92-8b7538ac49d8_count"</span></span><br><span class="line">[538] <span class="string">"10f64bfb-e4ca-4426-b936-36e4c1c2cc2a_count"</span></span><br><span class="line">[539] <span class="string">"015b7fde-e571-4f7d-9574-eacfa8107a4c_count"</span></span><br><span class="line">[540] <span class="string">"aaffdeee-dffd-41a6-ab52-caac8e05bb27_count"</span></span><br><span class="line">[541] <span class="string">"9f7c8176-5349-4bbc-bf0b-96b2e01e09fc_count"</span></span><br><span class="line">[542] <span class="string">"a7f415b8-fd54-40fd-a143-785dca873d3c_count"</span></span><br><span class="line">[543] <span class="string">"bf6ab33e-d822-470a-8c4d-9f7a8781eb90_count"</span></span><br><span class="line">[544] <span class="string">"286f0725-a1d9-4745-aa33-c7a0d35e0481_count"</span></span><br><span class="line">[545] <span class="string">"810d7c7d-1e04-4eae-8ae1-049dc111e255_count"</span></span><br><span class="line">[546] <span class="string">"b7170fda-1e88-457d-9fa6-44a92ec64505_count"</span></span><br><span class="line">[547] <span class="string">"57e55f20-f2a6-4d40-88cd-8aab747791b7_count"</span></span><br><span class="line">[548] <span class="string">"956e52f2-475c-4aa3-9e99-0912e4612314_count"</span></span><br><span class="line">[549] <span class="string">"3d01269f-7b74-4f80-8a08-abb448913492_count"</span></span><br><span class="line">[550] <span class="string">"9cb91836-3ed3-47e9-8f86-eb15937fd537_count"</span></span><br><span class="line">[551] <span class="string">"e9aa9cb2-b87f-4d1f-8627-11a1c1d900c7_count"</span></span><br><span class="line">[552] <span class="string">"149c3888-04c2-4701-9217-746e05c7b346_count"</span></span><br><span class="line">[553] <span class="string">"135ce95c-79ae-43d0-83d9-a435c2974267_count"</span></span><br><span class="line">[554] <span class="string">"10ebec51-fa4a-4d65-9c5f-07eb6e399e8f_count"</span></span><br><span class="line">[555] <span class="string">"b60bae63-d05c-44f5-9551-bb6cc40c1011_count"</span></span><br><span class="line">[556] <span class="string">"01ae4201-f15c-4790-a7ea-41290808c5fa_count"</span></span><br><span class="line">[557] <span class="string">"8397b99f-3ab3-4e85-a6d2-4377689aface_count"</span></span><br><span class="line">[558] <span class="string">"6134c694-922d-4559-8f55-e03cc58d66dc_count"</span></span><br><span class="line">[559] <span class="string">"fe1e1f62-8e18-4400-9b25-2c439fa25b6f_count"</span></span><br><span class="line">[560] <span class="string">"20c7b2e7-5c7d-412b-af35-915629730b9f_count"</span></span><br><span class="line">[561] <span class="string">"4d83267c-3fe7-4cfb-8d3b-c63370e725c8_count"</span></span><br><span class="line">[562] <span class="string">"2ab0b465-ab62-4ef5-82b4-1aea2063292a_count"</span></span><br><span class="line">[563] <span class="string">"ecc2be0d-e700-4598-9e83-44e0b1a12e01_count"</span></span><br><span class="line">[564] <span class="string">"4dbc0492-036f-470c-800d-03b82a81d10d_count"</span></span><br><span class="line">[565] <span class="string">"04e92e8a-7016-453b-addb-a3cc7e88d867_count"</span></span><br><span class="line">[566] <span class="string">"d0948978-3724-49dd-b7f7-5a28ca9a8571_count"</span></span><br><span class="line">[567] <span class="string">"b96fb7a6-9e5c-48ce-9ef8-aaef675cdfdd_count"</span></span><br><span class="line">[568] <span class="string">"8cb43c50-4ce9-4707-9dfa-cc5ed66a6b61_count"</span></span><br><span class="line">[569] <span class="string">"e4b1ed66-ee93-4b3f-922f-f386412247ec_count"</span></span><br><span class="line">[570] <span class="string">"1f443134-5a5e-492f-9f82-843280eeaa7f_count"</span></span><br><span class="line">[571] <span class="string">"55cca3e8-899a-4fba-941a-8789f5d1d206_count"</span></span><br><span class="line">[572] <span class="string">"7939e5e9-8920-4db9-9ab1-a34432830f52_count"</span></span><br><span class="line">[573] <span class="string">"baec09c9-c1e3-4504-97f2-41e4bf9cb628_count"</span></span><br><span class="line">[574] <span class="string">"bdc00e8a-cff2-4281-8762-12c4470fc23d_count"</span></span><br><span class="line">[575] <span class="string">"4e368418-06a0-4795-a216-59f16353b590_count"</span></span><br><span class="line">[576] <span class="string">"543d90e4-9064-47c2-a68d-fb123f627977_count"</span></span><br><span class="line">[577] <span class="string">"47c200a9-4a86-452c-a6f8-12aa45d322a1_count"</span></span><br><span class="line">[578] <span class="string">"e50711df-fe6b-480f-97c0-e150cb5d3a5b_count"</span></span><br><span class="line">[579] <span class="string">"2a3c3b16-84bb-4193-b637-c9e140c720b5_count"</span></span><br><span class="line">[580] <span class="string">"cc53db99-d81a-490d-b6f2-748a286c9567_count"</span></span><br><span class="line">[581] <span class="string">"d7984046-2ea2-4b2e-ba78-2909ed46f649_count"</span></span><br><span class="line">[582] <span class="string">"275f4377-31b7-436f-bded-1928c2b4f8e1_count"</span></span><br><span class="line">[583] <span class="string">"0cbf5cd6-30b6-4121-9f51-e85229b54fe5_count"</span></span><br><span class="line">[584] <span class="string">"a4b9a319-8f66-494e-8ada-530a1e8145d7_count"</span></span><br><span class="line">[585] <span class="string">"3582b129-85dc-49f5-bcfb-bc409ab90080_count"</span></span><br><span class="line">[586] <span class="string">"576dfeab-3d42-4c3d-be8f-10279e800cfb_count"</span></span><br><span class="line">[587] <span class="string">"bf688e5b-c62b-424c-b974-5c8b24e46764_count"</span></span><br><span class="line">[588] <span class="string">"1699471a-4d01-4ad5-aa25-e898ab468cde_count"</span></span><br><span class="line">[589] <span class="string">"3e5cd7b6-1f38-4ca3-a391-414b817a2203_count"</span></span><br><span class="line">[590] <span class="string">"68ef4372-517a-443f-91fe-668feb24beee_count"</span></span><br><span class="line">[591] <span class="string">"9e7b7456-e255-4f73-bb17-4bb981d5cd21_count"</span></span><br><span class="line">[592] <span class="string">"d07bfce9-a69c-4124-9264-95582e2d7cb6_count"</span></span><br><span class="line">[593] <span class="string">"bed41d1f-443b-4abe-917c-e79f03bf2ae3_count"</span></span><br><span class="line">[594] <span class="string">"6641ecad-6707-4f4d-ba99-d28b3817bd98_count"</span></span><br><span class="line">[595] <span class="string">"7db35b39-8d3e-4f93-8450-7e494ba9e0f8_count"</span></span><br><span class="line">[596] <span class="string">"df1d818d-1204-434a-8597-9cc864d5cc36_count"</span></span><br><span class="line">[597] <span class="string">"c111fbd6-cfcb-4372-b630-f3688e26427f_count"</span></span><br><span class="line">[598] <span class="string">"73e6cc52-f4fe-4168-9dd0-d6d28879cc95_count"</span></span><br><span class="line">[599] <span class="string">"fabbefc8-53b5-42e4-9a54-39280d18f419_count"</span></span><br><span class="line">[600] <span class="string">"b42d8f67-8e05-4302-ae87-783dfb38a58a_count"</span></span><br><span class="line">[601] <span class="string">"137d53ea-eb81-427d-ba2a-c346b904bf4d_count"</span></span><br><span class="line">[602] <span class="string">"60ab519a-f3c5-422d-9c2c-6876c2cd9687_count"</span></span><br><span class="line">[603] <span class="string">"87750eaf-0823-4f5c-9bf7-577471f4ca68_count"</span></span><br><span class="line">[604] <span class="string">"6073b31e-7ce7-423e-a9b2-a85e3e9bc62e_count"</span></span><br><span class="line">[605] <span class="string">"3c5c3b14-62d4-431a-ba60-cf2eb96d7e8a_count"</span></span><br><span class="line">[606] <span class="string">"68e11add-9274-45d8-a789-1f475e781cd2_count"</span></span><br><span class="line">[607] <span class="string">"44c147cc-537b-41f4-bff7-9ccef7d5d7a9_count"</span></span><br><span class="line">[608] <span class="string">"4e9f8a0e-5266-486d-91b3-a4701340b095_count"</span></span><br><span class="line">[609] <span class="string">"e4177e00-8ca5-4ee0-92e2-f358e7037c6c_count"</span></span><br><span class="line">[610] <span class="string">"374fe62c-139c-472d-8fa3-b34d22173a6e_count"</span></span><br><span class="line">[611] <span class="string">"74820fcd-2e21-4de7-aabf-bdea4842046a_count"</span></span><br><span class="line">&gt; sample_id <span class="comment"># 样品名包含项目名称，组织来源，患者编号，组织类型，处理方式等</span></span><br><span class="line">  [1] <span class="string">"TCGA-CZ-5457-11A-01R-1503-07"</span> <span class="string">"TCGA-CJ-5686-01A-11R-1672-07"</span></span><br><span class="line">  [3] <span class="string">"TCGA-B0-5084-01A-01R-1334-07"</span> <span class="string">"TCGA-BP-5201-01A-01R-1426-07"</span></span><br><span class="line">  [5] <span class="string">"TCGA-B0-4845-01A-01R-1277-07"</span> <span class="string">"TCGA-B0-5812-01A-11R-1672-07"</span></span><br><span class="line">  [7] <span class="string">"TCGA-B4-5378-01A-01R-1503-07"</span> <span class="string">"TCGA-CJ-4912-01A-01R-1426-07"</span></span><br><span class="line">  [9] <span class="string">"TCGA-B2-5635-01B-04R-A277-07"</span> <span class="string">"TCGA-BP-5198-01A-01R-1426-07"</span></span><br><span class="line"> [11] <span class="string">"TCGA-BP-4758-01A-01R-1289-07"</span> <span class="string">"TCGA-CZ-4853-01A-01R-1426-07"</span></span><br><span class="line"> [13] <span class="string">"TCGA-B0-5115-01A-01R-1420-07"</span> <span class="string">"TCGA-B8-A54G-01A-11R-A266-07"</span></span><br><span class="line"> [15] <span class="string">"TCGA-CZ-4861-01A-01R-1305-07"</span> <span class="string">"TCGA-B8-5545-01A-01R-1672-07"</span></span><br><span class="line"> [17] <span class="string">"TCGA-CJ-4892-01A-01R-1305-07"</span> <span class="string">"TCGA-CJ-5678-01A-11R-1541-07"</span></span><br><span class="line"> [19] <span class="string">"TCGA-AK-3433-01A-02R-1277-07"</span> <span class="string">"TCGA-B8-4621-01A-01R-1503-07"</span></span><br><span class="line"> [21] <span class="string">"TCGA-CZ-5470-01A-01R-1503-07"</span> <span class="string">"TCGA-BP-4349-01A-01R-1289-07"</span></span><br><span class="line"> [23] <span class="string">"TCGA-A3-3307-01A-01R-0864-07"</span> <span class="string">"TCGA-CJ-4641-01A-02R-1325-07"</span></span><br><span class="line"> [25] <span class="string">"TCGA-B0-5098-01A-01R-1420-07"</span> <span class="string">"TCGA-B0-4699-01A-01R-1277-07"</span></span><br><span class="line"> [27] <span class="string">"TCGA-BP-5199-01A-01R-1426-07"</span> <span class="string">"TCGA-CZ-5987-11A-01R-1672-07"</span></span><br><span class="line"> [29] <span class="string">"TCGA-BP-4337-01A-01R-1289-07"</span> <span class="string">"TCGA-B0-4836-01A-01R-1305-07"</span></span><br><span class="line"> [31] <span class="string">"TCGA-BP-4968-01A-01R-1334-07"</span> <span class="string">"TCGA-CJ-4918-01A-01R-1426-07"</span></span><br><span class="line"> [33] <span class="string">"TCGA-B0-4707-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-5006-01A-01R-1334-07"</span></span><br><span class="line"> [35] <span class="string">"TCGA-CJ-5679-01A-11R-1541-07"</span> <span class="string">"TCGA-BP-5186-01A-01R-1426-07"</span></span><br><span class="line"> [37] <span class="string">"TCGA-CZ-5467-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-5080-01A-01R-1503-07"</span></span><br><span class="line"> [39] <span class="string">"TCGA-CZ-5453-11A-01R-1503-07"</span> <span class="string">"TCGA-B0-5701-11A-01R-1541-07"</span></span><br><span class="line"> [41] <span class="string">"TCGA-BP-4995-01A-01R-1334-07"</span> <span class="string">"TCGA-CZ-5451-01A-01R-1503-07"</span></span><br><span class="line"> [43] <span class="string">"TCGA-CJ-4888-01A-01R-1305-07"</span> <span class="string">"TCGA-B2-3923-01A-02R-1325-07"</span></span><br><span class="line"> [45] <span class="string">"TCGA-BP-4351-01A-01R-1289-07"</span> <span class="string">"TCGA-B2-4099-01A-02R-1188-07"</span></span><br><span class="line"> [47] <span class="string">"TCGA-B8-A7U6-01A-12R-A37O-07"</span> <span class="string">"TCGA-B0-4698-01A-01R-1503-07"</span></span><br><span class="line"> [49] <span class="string">"TCGA-B0-4691-01A-01R-1277-07"</span> <span class="string">"TCGA-CJ-4895-01A-01R-1305-07"</span></span><br><span class="line"> [51] <span class="string">"TCGA-AK-3458-01A-01R-1503-07"</span> <span class="string">"TCGA-BP-4326-01A-01R-1289-07"</span></span><br><span class="line"> [53] <span class="string">"TCGA-B0-4945-01A-01R-1420-07"</span> <span class="string">"TCGA-A3-3323-01A-02R-1325-07"</span></span><br><span class="line"> [55] <span class="string">"TCGA-BP-4985-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5711-01A-11R-1672-07"</span></span><br><span class="line"> [57] <span class="string">"TCGA-GK-A6C7-01A-11R-A33J-07"</span> <span class="string">"TCGA-DV-A4W0-05A-11R-A266-07"</span></span><br><span class="line"> [59] <span class="string">"TCGA-BP-5192-01A-01R-1426-07"</span> <span class="string">"TCGA-B0-5694-11A-01R-1541-07"</span></span><br><span class="line"> [61] <span class="string">"TCGA-CZ-4860-01A-01R-1305-07"</span> <span class="string">"TCGA-A3-3351-01A-02R-1325-07"</span></span><br><span class="line"> [63] <span class="string">"TCGA-CW-5581-11A-01R-1541-07"</span> <span class="string">"TCGA-CJ-5677-11A-01R-1541-07"</span></span><br><span class="line"> [65] <span class="string">"TCGA-BP-4352-01A-01R-1289-07"</span> <span class="string">"TCGA-BP-4787-01A-01R-1305-07"</span></span><br><span class="line"> [67] <span class="string">"TCGA-CZ-5459-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-4837-01A-01R-1305-07"</span></span><br><span class="line"> [69] <span class="string">"TCGA-BP-4970-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5700-01A-11R-1541-07"</span></span><br><span class="line"> [71] <span class="string">"TCGA-AK-3425-01A-02R-1277-07"</span> <span class="string">"TCGA-B2-5633-01A-01R-1541-07"</span></span><br><span class="line"> [73] <span class="string">"TCGA-B0-5117-01A-01R-1420-07"</span> <span class="string">"TCGA-B0-5121-01A-02R-1420-07"</span></span><br><span class="line"> [75] <span class="string">"TCGA-B0-5702-01A-11R-1541-07"</span> <span class="string">"TCGA-CW-6090-11A-01R-1672-07"</span></span><br><span class="line"> [77] <span class="string">"TCGA-BP-4169-01A-02R-1289-07"</span> <span class="string">"TCGA-CZ-5468-01A-01R-1503-07"</span></span><br><span class="line"> [79] <span class="string">"TCGA-A3-3313-01A-02R-1325-07"</span> <span class="string">"TCGA-A3-A6NN-01A-12R-A33J-07"</span></span><br><span class="line"> [81] <span class="string">"TCGA-T7-A92I-01A-11R-A37O-07"</span> <span class="string">"TCGA-B0-5696-01A-11R-1541-07"</span></span><br><span class="line"> [83] <span class="string">"TCGA-CJ-6030-01A-11R-1672-07"</span> <span class="string">"TCGA-A3-3316-01A-01R-0864-07"</span></span><br><span class="line"> [85] <span class="string">"TCGA-A3-3331-01A-02R-1325-07"</span> <span class="string">"TCGA-BP-5181-01A-01R-1426-07"</span></span><br><span class="line"> [87] <span class="string">"TCGA-CW-5585-11A-01R-1541-07"</span> <span class="string">"TCGA-BP-4777-01A-01R-1289-07"</span></span><br><span class="line"> [89] <span class="string">"TCGA-B0-5085-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5113-01A-01R-1420-07"</span></span><br><span class="line"> [91] <span class="string">"TCGA-CW-5581-01A-02R-1541-07"</span> <span class="string">"TCGA-AK-3454-01A-02R-1277-07"</span></span><br><span class="line"> [93] <span class="string">"TCGA-BP-4989-01A-01R-1334-07"</span> <span class="string">"TCGA-AK-3456-01A-02R-1325-07"</span></span><br><span class="line"> [95] <span class="string">"TCGA-A3-3370-01A-02R-1420-07"</span> <span class="string">"TCGA-DV-5565-01A-01R-1541-07"</span></span><br><span class="line"> [97] <span class="string">"TCGA-BP-4795-01A-02R-1420-07"</span> <span class="string">"TCGA-BP-4801-01A-02R-1420-07"</span></span><br><span class="line"> [99] <span class="string">"TCGA-A3-3347-01A-02R-1325-07"</span> <span class="string">"TCGA-B2-3924-01B-03R-A277-07"</span></span><br><span class="line">[101] <span class="string">"TCGA-G6-A8L8-01A-21R-A37O-07"</span> <span class="string">"TCGA-MM-A564-01A-11R-A266-07"</span></span><br><span class="line">[103] <span class="string">"TCGA-CZ-5989-11A-01R-1672-07"</span> <span class="string">"TCGA-BP-4775-01A-01R-1289-07"</span></span><br><span class="line">[105] <span class="string">"TCGA-B0-5703-01A-11R-1541-07"</span> <span class="string">"TCGA-CZ-5463-01A-01R-1503-07"</span></span><br><span class="line">[107] <span class="string">"TCGA-B4-5844-01A-11R-1672-07"</span> <span class="string">"TCGA-BP-4963-01A-01R-1334-07"</span></span><br><span class="line">[109] <span class="string">"TCGA-CZ-5455-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-5116-01A-02R-1420-07"</span></span><br><span class="line">[111] <span class="string">"TCGA-CJ-4902-01A-01R-1426-07"</span> <span class="string">"TCGA-B0-5690-01A-11R-1541-07"</span></span><br><span class="line">[113] <span class="string">"TCGA-A3-3378-01A-02R-1325-07"</span> <span class="string">"TCGA-CJ-4900-01A-01R-1334-07"</span></span><br><span class="line">[115] <span class="string">"TCGA-DV-5574-01A-01R-1541-07"</span> <span class="string">"TCGA-BP-4962-01A-01R-1334-07"</span></span><br><span class="line">[117] <span class="string">"TCGA-BP-4961-01A-01R-1334-07"</span> <span class="string">"TCGA-CJ-5676-01A-11R-1541-07"</span></span><br><span class="line">[119] <span class="string">"TCGA-B0-5097-01A-01R-1420-07"</span> <span class="string">"TCGA-CZ-4858-01A-01R-1305-07"</span></span><br><span class="line">[121] <span class="string">"TCGA-BP-4768-01A-01R-1289-07"</span> <span class="string">"TCGA-A3-3329-01A-01R-0864-07"</span></span><br><span class="line">[123] <span class="string">"TCGA-B2-4101-01A-02R-1277-07"</span> <span class="string">"TCGA-CZ-5461-01A-01R-1503-07"</span></span><br><span class="line">[125] <span class="string">"TCGA-A3-3385-01A-02R-1420-07"</span> <span class="string">"TCGA-B0-5709-01A-11R-1541-07"</span></span><br><span class="line">[127] <span class="string">"TCGA-BP-4771-01A-01R-1289-07"</span> <span class="string">"TCGA-BP-4327-01A-01R-1289-07"</span></span><br><span class="line">[129] <span class="string">"TCGA-CJ-5680-11A-01R-1541-07"</span> <span class="string">"TCGA-B0-5710-01A-11R-1672-07"</span></span><br><span class="line">[131] <span class="string">"TCGA-DV-A4VX-01A-11R-A266-07"</span> <span class="string">"TCGA-B0-4819-01A-01R-1277-07"</span></span><br><span class="line">[133] <span class="string">"TCGA-B8-A54K-01A-11R-A33J-07"</span> <span class="string">"TCGA-A3-3311-01A-02R-1325-07"</span></span><br><span class="line">[135] <span class="string">"TCGA-CZ-4854-01A-01R-1305-07"</span> <span class="string">"TCGA-B8-4153-01B-11R-1672-07"</span></span><br><span class="line">[137] <span class="string">"TCGA-B2-A4SR-01A-11R-A266-07"</span> <span class="string">"TCGA-CZ-5989-01A-11R-1672-07"</span></span><br><span class="line">[139] <span class="string">"TCGA-CJ-4639-01A-02R-1325-07"</span> <span class="string">"TCGA-CZ-4865-01A-02R-1503-07"</span></span><br><span class="line">[141] <span class="string">"TCGA-BP-5180-01A-01R-1426-07"</span> <span class="string">"TCGA-DV-5567-01A-01R-1541-07"</span></span><br><span class="line">[143] <span class="string">"TCGA-BP-4992-01A-01R-1334-07"</span> <span class="string">"TCGA-B2-5633-01A-01R-A277-07"</span></span><br><span class="line">[145] <span class="string">"TCGA-B2-5641-11A-01R-1541-07"</span> <span class="string">"TCGA-AS-3778-01A-01R-A32Z-07"</span></span><br><span class="line">[147] <span class="string">"TCGA-B8-4622-11A-01R-1758-07"</span> <span class="string">"TCGA-CZ-5457-01A-01R-1503-07"</span></span><br><span class="line">[149] <span class="string">"TCGA-B2-5639-01A-01R-1541-07"</span> <span class="string">"TCGA-B0-4811-01A-01R-1503-07"</span></span><br><span class="line">[151] <span class="string">"TCGA-CJ-4899-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5096-01A-01R-1420-07"</span></span><br><span class="line">[153] <span class="string">"TCGA-CW-6088-11A-01R-1672-07"</span> <span class="string">"TCGA-B8-A54J-01A-11R-A33J-07"</span></span><br><span class="line">[155] <span class="string">"TCGA-CZ-5456-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-4688-01A-01R-1277-07"</span></span><br><span class="line">[157] <span class="string">"TCGA-A3-3317-01A-02R-1325-07"</span> <span class="string">"TCGA-B0-5400-01A-01R-1503-07"</span></span><br><span class="line">[159] <span class="string">"TCGA-B8-4619-11A-01R-1758-07"</span> <span class="string">"TCGA-G6-A5PC-01A-11R-A33J-07"</span></span><br><span class="line">[161] <span class="string">"TCGA-B0-5100-01A-01R-1420-07"</span> <span class="string">"TCGA-CW-5585-01A-01R-1541-07"</span></span><br><span class="line">[163] <span class="string">"TCGA-BP-4167-01A-02R-1325-07"</span> <span class="string">"TCGA-B8-5164-01A-01R-1420-07"</span></span><br><span class="line">[165] <span class="string">"TCGA-A3-3376-01A-02R-1420-07"</span> <span class="string">"TCGA-B8-5549-11A-01R-1541-07"</span></span><br><span class="line">[167] <span class="string">"TCGA-B0-5703-11A-01R-1541-07"</span> <span class="string">"TCGA-B0-4839-01A-01R-1305-07"</span></span><br><span class="line">[169] <span class="string">"TCGA-CJ-4894-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-5187-01A-01R-1426-07"</span></span><br><span class="line">[171] <span class="string">"TCGA-B0-5110-01A-01R-1420-07"</span> <span class="string">"TCGA-BP-4972-01A-01R-1334-07"</span></span><br><span class="line">[173] <span class="string">"TCGA-B0-4816-01A-01R-1503-07"</span> <span class="string">"TCGA-CJ-4889-01A-01R-1305-07"</span></span><br><span class="line">[175] <span class="string">"TCGA-BP-4165-01A-02R-1289-07"</span> <span class="string">"TCGA-BP-4981-01A-01R-1334-07"</span></span><br><span class="line">[177] <span class="string">"TCGA-B2-3923-01B-10R-A277-07"</span> <span class="string">"TCGA-CZ-4865-11A-01R-1503-07"</span></span><br><span class="line">[179] <span class="string">"TCGA-AS-3777-01A-01R-0864-07"</span> <span class="string">"TCGA-BP-4176-01A-02R-1289-07"</span></span><br><span class="line">[181] <span class="string">"TCGA-CZ-5461-11A-01R-1503-07"</span> <span class="string">"TCGA-B0-5120-01A-01R-1420-07"</span></span><br><span class="line">[183] <span class="string">"TCGA-BP-4782-01A-02R-1420-07"</span> <span class="string">"TCGA-3Z-A93Z-01A-11R-A37O-07"</span></span><br><span class="line">[185] <span class="string">"TCGA-BP-4987-01A-01R-1334-07"</span> <span class="string">"TCGA-CZ-5469-11A-01R-1503-07"</span></span><br><span class="line">[187] <span class="string">"TCGA-B0-4849-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-4329-01A-02R-1289-07"</span></span><br><span class="line">[189] <span class="string">"TCGA-A3-3328-01A-01R-0864-07"</span> <span class="string">"TCGA-CJ-5672-01A-11R-1541-07"</span></span><br><span class="line">[191] <span class="string">"TCGA-B0-5104-01A-01R-1420-07"</span> <span class="string">"TCGA-CW-6097-01A-11R-1672-07"</span></span><br><span class="line">[193] <span class="string">"TCGA-B0-5696-11A-01R-1541-07"</span> <span class="string">"TCGA-CZ-5466-11A-01R-1503-07"</span></span><br><span class="line">[195] <span class="string">"TCGA-B0-4700-01A-02R-1541-07"</span> <span class="string">"TCGA-B0-5095-01A-01R-1420-07"</span></span><br><span class="line">[197] <span class="string">"TCGA-A3-3358-11A-01R-1541-07"</span> <span class="string">"TCGA-B0-4810-01A-01R-1503-07"</span></span><br><span class="line">[199] <span class="string">"TCGA-CJ-4901-01A-01R-1426-07"</span> <span class="string">"TCGA-CJ-4643-01A-02R-1325-07"</span></span><br><span class="line">[201] <span class="string">"TCGA-B8-A54H-01A-11R-A33J-07"</span> <span class="string">"TCGA-CZ-4863-11A-01R-1503-07"</span></span><br><span class="line">[203] <span class="string">"TCGA-AK-3429-01A-02R-1325-07"</span> <span class="string">"TCGA-B0-4834-01A-01R-1305-07"</span></span><br><span class="line">[205] <span class="string">"TCGA-CZ-5467-11A-01R-1503-07"</span> <span class="string">"TCGA-B0-4843-01A-01R-1277-07"</span></span><br><span class="line">[207] <span class="string">"TCGA-CJ-5678-11A-01R-1541-07"</span> <span class="string">"TCGA-A3-3382-01A-02R-1325-07"</span></span><br><span class="line">[209] <span class="string">"TCGA-BP-4338-01A-01R-1289-07"</span> <span class="string">"TCGA-B4-5832-01A-11R-1672-07"</span></span><br><span class="line">[211] <span class="string">"TCGA-BP-4161-01A-02R-1325-07"</span> <span class="string">"TCGA-B0-4706-01A-01R-1503-07"</span></span><br><span class="line">[213] <span class="string">"TCGA-CW-6090-01A-11R-1672-07"</span> <span class="string">"TCGA-BP-4334-01A-01R-1289-07"</span></span><br><span class="line">[215] <span class="string">"TCGA-CJ-4897-01A-03R-1426-07"</span> <span class="string">"TCGA-CZ-5982-01A-11R-1672-07"</span></span><br><span class="line">[217] <span class="string">"TCGA-B0-4814-01A-01R-1277-07"</span> <span class="string">"TCGA-B2-5636-01A-02R-1541-07"</span></span><br><span class="line">[219] <span class="string">"TCGA-B0-4700-11A-01R-1541-07"</span> <span class="string">"TCGA-B0-4842-01A-02R-1420-07"</span></span><br><span class="line">[221] <span class="string">"TCGA-CW-5583-01A-02R-1541-07"</span> <span class="string">"TCGA-B8-4154-01A-01R-1188-07"</span></span><br><span class="line">[223] <span class="string">"TCGA-CW-5584-01A-01R-1541-07"</span> <span class="string">"TCGA-BP-5001-01A-01R-1334-07"</span></span><br><span class="line">[225] <span class="string">"TCGA-BP-5183-01A-01R-1426-07"</span> <span class="string">"TCGA-B0-4694-01A-01R-1277-07"</span></span><br><span class="line">[227] <span class="string">"TCGA-BP-4335-01A-01R-1289-07"</span> <span class="string">"TCGA-B0-5695-01A-11R-1541-07"</span></span><br><span class="line">[229] <span class="string">"TCGA-CJ-4868-01A-01R-1305-07"</span> <span class="string">"TCGA-A3-3324-01A-02R-1325-07"</span></span><br><span class="line">[231] <span class="string">"TCGA-CJ-4878-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-4798-01A-01R-1305-07"</span></span><br><span class="line">[233] <span class="string">"TCGA-EU-5907-01A-11R-1672-07"</span> <span class="string">"TCGA-B0-4703-01A-01R-1277-07"</span></span><br><span class="line">[235] <span class="string">"TCGA-B0-5119-01A-02R-1420-07"</span> <span class="string">"TCGA-B0-4822-01A-01R-1277-07"</span></span><br><span class="line">[237] <span class="string">"TCGA-B4-5835-01A-11R-1672-07"</span> <span class="string">"TCGA-CW-5589-11A-01R-1541-07"</span></span><br><span class="line">[239] <span class="string">"TCGA-BP-4998-01A-01R-1334-07"</span> <span class="string">"TCGA-A3-3383-01A-02R-1325-07"</span></span><br><span class="line">[241] <span class="string">"TCGA-BP-4353-01A-02R-1289-07"</span> <span class="string">"TCGA-B4-5834-01A-11R-1672-07"</span></span><br><span class="line">[243] <span class="string">"TCGA-BP-5175-01A-01R-1426-07"</span> <span class="string">"TCGA-CJ-5676-11A-01R-1541-07"</span></span><br><span class="line">[245] <span class="string">"TCGA-BP-5191-01A-01R-1426-07"</span> <span class="string">"TCGA-BP-4763-01A-01R-1289-07"</span></span><br><span class="line">[247] <span class="string">"TCGA-BP-4803-01A-01R-1305-07"</span> <span class="string">"TCGA-B0-5402-01A-01R-1503-07"</span></span><br><span class="line">[249] <span class="string">"TCGA-B0-4697-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-4769-01A-01R-1289-07"</span></span><br><span class="line">[251] <span class="string">"TCGA-BP-4774-01A-01R-1289-07"</span> <span class="string">"TCGA-B8-A54F-01A-11R-A266-07"</span></span><br><span class="line">[253] <span class="string">"TCGA-CJ-4874-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-4991-01A-01R-1334-07"</span></span><br><span class="line">[255] <span class="string">"TCGA-CZ-5469-01A-01R-1503-07"</span> <span class="string">"TCGA-CZ-5464-01A-01R-1503-07"</span></span><br><span class="line">[257] <span class="string">"TCGA-CJ-5680-01A-11R-1541-07"</span> <span class="string">"TCGA-CJ-4871-01A-01R-1305-07"</span></span><br><span class="line">[259] <span class="string">"TCGA-G6-A8L6-01A-11R-A37O-07"</span> <span class="string">"TCGA-CJ-5679-11A-01R-1541-07"</span></span><br><span class="line">[261] <span class="string">"TCGA-B0-4827-01A-02R-1420-07"</span> <span class="string">"TCGA-B0-4848-01A-01R-1277-07"</span></span><br><span class="line">[263] <span class="string">"TCGA-CZ-5985-01A-11R-1672-07"</span> <span class="string">"TCGA-CJ-6030-11A-01R-1672-07"</span></span><br><span class="line">[265] <span class="string">"TCGA-B8-5549-01A-01R-1541-07"</span> <span class="string">"TCGA-CZ-5462-11A-01R-1503-07"</span></span><br><span class="line">[267] <span class="string">"TCGA-CJ-4886-01A-01R-1305-07"</span> <span class="string">"TCGA-CJ-6032-01A-11R-1672-07"</span></span><br><span class="line">[269] <span class="string">"TCGA-A3-3320-01A-02R-1325-07"</span> <span class="string">"TCGA-B8-A54D-01A-21R-A266-07"</span></span><br><span class="line">[271] <span class="string">"TCGA-B2-4098-01A-02R-1325-07"</span> <span class="string">"TCGA-A3-3374-01A-02R-1325-07"</span></span><br><span class="line">[273] <span class="string">"TCGA-BP-5000-01A-01R-1334-07"</span> <span class="string">"TCGA-A3-A6NI-01A-11R-A33J-07"</span></span><br><span class="line">[275] <span class="string">"TCGA-B0-4824-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-4975-01A-01R-1334-07"</span></span><br><span class="line">[277] <span class="string">"TCGA-AK-3440-01A-02R-1277-07"</span> <span class="string">"TCGA-BP-5169-01A-01R-1426-07"</span></span><br><span class="line">[279] <span class="string">"TCGA-BP-4770-01A-01R-1503-07"</span> <span class="string">"TCGA-B4-5838-01A-11R-1672-07"</span></span><br><span class="line">[281] <span class="string">"TCGA-B0-4815-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-4838-01A-01R-1305-07"</span></span><br><span class="line">[283] <span class="string">"TCGA-BP-5177-01A-01R-1426-07"</span> <span class="string">"TCGA-BP-4330-01A-01R-1289-07"</span></span><br><span class="line">[285] <span class="string">"TCGA-B0-4841-01A-01R-1277-07"</span> <span class="string">"TCGA-B8-5551-01A-01R-1541-07"</span></span><br><span class="line">[287] <span class="string">"TCGA-CW-6088-01A-11R-1672-07"</span> <span class="string">"TCGA-A3-A6NJ-01A-12R-A33J-07"</span></span><br><span class="line">[289] <span class="string">"TCGA-B0-5088-01A-01R-1334-07"</span> <span class="string">"TCGA-A3-3308-01A-02R-1325-07"</span></span><br><span class="line">[291] <span class="string">"TCGA-CW-5589-01A-01R-1541-07"</span> <span class="string">"TCGA-BP-4982-01A-01R-1334-07"</span></span><br><span class="line">[293] <span class="string">"TCGA-CZ-4857-01A-01R-1305-07"</span> <span class="string">"TCGA-A3-3349-01A-01R-1188-07"</span></span><br><span class="line">[295] <span class="string">"TCGA-A3-A8CQ-01A-11R-A37O-07"</span> <span class="string">"TCGA-AK-3447-01A-01R-1766-07"</span></span><br><span class="line">[297] <span class="string">"TCGA-CZ-5463-11A-01R-1503-07"</span> <span class="string">"TCGA-BP-4159-01A-02R-1289-07"</span></span><br><span class="line">[299] <span class="string">"TCGA-B0-5698-01A-11R-1672-07"</span> <span class="string">"TCGA-A3-A8OU-01A-11R-A37O-07"</span></span><br><span class="line">[301] <span class="string">"TCGA-A3-3380-01A-01R-0864-07"</span> <span class="string">"TCGA-CZ-5986-11A-01R-1672-07"</span></span><br><span class="line">[303] <span class="string">"TCGA-B8-4146-01B-11R-1672-07"</span> <span class="string">"TCGA-BP-5174-01A-01R-1426-07"</span></span><br><span class="line">[305] <span class="string">"TCGA-BP-4977-01A-01R-1334-07"</span> <span class="string">"TCGA-BP-5007-01A-01R-1334-07"</span></span><br><span class="line">[307] <span class="string">"TCGA-B0-5402-11A-01R-1503-07"</span> <span class="string">"TCGA-BP-4166-01A-02R-1289-07"</span></span><br><span class="line">[309] <span class="string">"TCGA-CJ-5682-01A-11R-1541-07"</span> <span class="string">"TCGA-BP-4965-01A-01R-1334-07"</span></span><br><span class="line">[311] <span class="string">"TCGA-CZ-5988-01A-11R-1672-07"</span> <span class="string">"TCGA-B0-4718-01A-01R-1277-07"</span></span><br><span class="line">[313] <span class="string">"TCGA-BP-4969-01A-01R-1334-07"</span> <span class="string">"TCGA-CW-5588-01A-01R-1541-07"</span></span><br><span class="line">[315] <span class="string">"TCGA-CZ-4864-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-5690-11A-01R-1541-07"</span></span><br><span class="line">[317] <span class="string">"TCGA-B8-A54E-01A-11R-A266-07"</span> <span class="string">"TCGA-DV-5568-01A-01R-1541-07"</span></span><br><span class="line">[319] <span class="string">"TCGA-B8-5162-01A-01R-1420-07"</span> <span class="string">"TCGA-AK-3460-01A-02R-1277-07"</span></span><br><span class="line">[321] <span class="string">"TCGA-CJ-5677-01A-11R-1541-07"</span> <span class="string">"TCGA-CZ-4866-01A-01R-1503-07"</span></span><br><span class="line">[323] <span class="string">"TCGA-B0-4817-01A-01R-1277-07"</span> <span class="string">"TCGA-CJ-6028-01A-11R-1672-07"</span></span><br><span class="line">[325] <span class="string">"TCGA-CJ-4904-01A-02R-1426-07"</span> <span class="string">"TCGA-CZ-5460-01A-01R-1503-07"</span></span><br><span class="line">[327] <span class="string">"TCGA-B2-3924-01A-02R-1325-07"</span> <span class="string">"TCGA-CJ-4870-01A-01R-1305-07"</span></span><br><span class="line">[329] <span class="string">"TCGA-B8-4619-01A-02R-1325-07"</span> <span class="string">"TCGA-BP-4761-01A-01R-1289-07"</span></span><br><span class="line">[331] <span class="string">"TCGA-EU-5904-01A-11R-1672-07"</span> <span class="string">"TCGA-B0-5706-01A-11R-1541-07"</span></span><br><span class="line">[333] <span class="string">"TCGA-BP-4973-01A-01R-1334-07"</span> <span class="string">"TCGA-DV-5573-01A-01R-1541-07"</span></span><br><span class="line">[335] <span class="string">"TCGA-BP-4960-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5694-01A-11R-1541-07"</span></span><br><span class="line">[337] <span class="string">"TCGA-B2-4102-01A-02R-1325-07"</span> <span class="string">"TCGA-B0-4844-01A-01R-1277-07"</span></span><br><span class="line">[339] <span class="string">"TCGA-BP-5184-01A-01R-1426-07"</span> <span class="string">"TCGA-BP-5168-01A-01R-1420-07"</span></span><br><span class="line">[341] <span class="string">"TCGA-B0-5102-01A-01R-1420-07"</span> <span class="string">"TCGA-BP-5185-01A-01R-1426-07"</span></span><br><span class="line">[343] <span class="string">"TCGA-CZ-5986-01A-11R-1672-07"</span> <span class="string">"TCGA-CW-5590-01A-01R-1541-07"</span></span><br><span class="line">[345] <span class="string">"TCGA-A3-3359-01A-01R-0864-07"</span> <span class="string">"TCGA-CZ-5984-01A-11R-1672-07"</span></span><br><span class="line">[347] <span class="string">"TCGA-B0-5713-01A-11R-1672-07"</span> <span class="string">"TCGA-BP-4341-01A-01R-1289-07"</span></span><br><span class="line">[349] <span class="string">"TCGA-CJ-4876-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-4340-01A-01R-1289-07"</span></span><br><span class="line">[351] <span class="string">"TCGA-CJ-5671-01A-11R-1541-07"</span> <span class="string">"TCGA-BP-4164-01A-02R-1325-07"</span></span><br><span class="line">[353] <span class="string">"TCGA-MW-A4EC-01A-11R-A266-07"</span> <span class="string">"TCGA-B8-4622-01A-02R-1277-07"</span></span><br><span class="line">[355] <span class="string">"TCGA-B0-5108-01A-01R-1420-07"</span> <span class="string">"TCGA-AK-3445-01A-02R-1277-07"</span></span><br><span class="line">[357] <span class="string">"TCGA-A3-3363-01A-01R-0864-07"</span> <span class="string">"TCGA-CJ-4920-01A-01R-1426-07"</span></span><br><span class="line">[359] <span class="string">"TCGA-A3-3346-01A-01R-1766-07"</span> <span class="string">"TCGA-CZ-5451-11A-01R-1503-07"</span></span><br><span class="line">[361] <span class="string">"TCGA-BP-5200-01A-01R-1426-07"</span> <span class="string">"TCGA-BP-4158-01A-02R-1289-07"</span></span><br><span class="line">[363] <span class="string">"TCGA-BP-5173-01A-01R-1426-07"</span> <span class="string">"TCGA-B0-4710-01A-01R-1503-07"</span></span><br><span class="line">[365] <span class="string">"TCGA-A3-3367-01A-02R-1420-07"</span> <span class="string">"TCGA-BP-4344-01A-01R-1289-07"</span></span><br><span class="line">[367] <span class="string">"TCGA-A3-3335-01A-01R-0864-07"</span> <span class="string">"TCGA-B0-5099-01A-01R-1420-07"</span></span><br><span class="line">[369] <span class="string">"TCGA-AK-3427-01A-01R-0864-07"</span> <span class="string">"TCGA-DV-A4W0-01A-11R-A266-07"</span></span><br><span class="line">[371] <span class="string">"TCGA-DV-5576-01A-01R-1541-07"</span> <span class="string">"TCGA-AK-3443-01A-02R-1325-07"</span></span><br><span class="line">[373] <span class="string">"TCGA-CZ-5468-11A-01R-1503-07"</span> <span class="string">"TCGA-BP-5009-01A-01R-1334-07"</span></span><br><span class="line">[375] <span class="string">"TCGA-BP-4173-01A-02R-1289-07"</span> <span class="string">"TCGA-B8-5546-01A-01R-1541-07"</span></span><br><span class="line">[377] <span class="string">"TCGA-B8-5165-01A-01R-1420-07"</span> <span class="string">"TCGA-CW-5587-01A-01R-1541-07"</span></span><br><span class="line">[379] <span class="string">"TCGA-CJ-4882-01A-02R-1426-07"</span> <span class="string">"TCGA-BP-4347-01A-01R-1289-07"</span></span><br><span class="line">[381] <span class="string">"TCGA-B0-5707-01A-11R-1541-07"</span> <span class="string">"TCGA-CJ-4872-01A-01R-1305-07"</span></span><br><span class="line">[383] <span class="string">"TCGA-CJ-4881-01A-01R-1305-07"</span> <span class="string">"TCGA-AK-3436-01A-02R-1325-07"</span></span><br><span class="line">[385] <span class="string">"TCGA-BP-4964-01A-01R-1334-07"</span> <span class="string">"TCGA-BP-4760-01A-02R-1420-07"</span></span><br><span class="line">[387] <span class="string">"TCGA-B2-5635-01A-01R-1541-07"</span> <span class="string">"TCGA-A3-3325-01A-01R-0864-07"</span></span><br><span class="line">[389] <span class="string">"TCGA-B8-5159-01A-01R-1420-07"</span> <span class="string">"TCGA-MM-A563-01A-11R-A266-07"</span></span><br><span class="line">[391] <span class="string">"TCGA-A3-3343-01A-01R-0864-07"</span> <span class="string">"TCGA-BP-4163-01A-02R-1325-07"</span></span><br><span class="line">[393] <span class="string">"TCGA-B0-5092-01A-01R-1420-07"</span> <span class="string">"TCGA-BP-4174-01A-02R-1289-07"</span></span><br><span class="line">[395] <span class="string">"TCGA-BP-4986-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-4696-01A-01R-1277-07"</span></span><br><span class="line">[397] <span class="string">"TCGA-CZ-4856-01A-02R-1426-07"</span> <span class="string">"TCGA-CJ-4873-01A-01R-1305-07"</span></span><br><span class="line">[399] <span class="string">"TCGA-B0-5693-01A-11R-1541-07"</span> <span class="string">"TCGA-AK-3451-01A-02R-1188-07"</span></span><br><span class="line">[401] <span class="string">"TCGA-BP-4762-01A-02R-1289-07"</span> <span class="string">"TCGA-CZ-5454-01A-01R-1503-07"</span></span><br><span class="line">[403] <span class="string">"TCGA-A3-3358-01A-01R-1541-07"</span> <span class="string">"TCGA-CJ-6031-01A-11R-1672-07"</span></span><br><span class="line">[405] <span class="string">"TCGA-BP-4790-01A-01R-1305-07"</span> <span class="string">"TCGA-B0-5699-01A-11R-1541-07"</span></span><br><span class="line">[407] <span class="string">"TCGA-B8-4620-11A-01R-1758-07"</span> <span class="string">"TCGA-CJ-4635-01A-02R-1305-07"</span></span><br><span class="line">[409] <span class="string">"TCGA-BP-4160-01A-02R-1289-07"</span> <span class="string">"TCGA-BP-5190-01A-01R-1426-07"</span></span><br><span class="line">[411] <span class="string">"TCGA-CW-6087-01A-11R-1672-07"</span> <span class="string">"TCGA-CZ-5465-01A-01R-1503-07"</span></span><br><span class="line">[413] <span class="string">"TCGA-BP-5202-01A-02R-1426-07"</span> <span class="string">"TCGA-B0-4847-01A-01R-1277-07"</span></span><br><span class="line">[415] <span class="string">"TCGA-B0-4712-01A-01R-1503-07"</span> <span class="string">"TCGA-B0-5083-01A-02R-1420-07"</span></span><br><span class="line">[417] <span class="string">"TCGA-BP-4789-01A-01R-1305-07"</span> <span class="string">"TCGA-B8-5163-01A-01R-1420-07"</span></span><br><span class="line">[419] <span class="string">"TCGA-CJ-6033-01A-11R-1672-07"</span> <span class="string">"TCGA-BP-4756-01A-01R-1289-07"</span></span><br><span class="line">[421] <span class="string">"TCGA-A3-3362-01A-02R-1325-07"</span> <span class="string">"TCGA-BP-4355-01A-01R-1289-07"</span></span><br><span class="line">[423] <span class="string">"TCGA-B0-4852-01A-01R-1503-07"</span> <span class="string">"TCGA-A3-A6NL-01A-11R-A33J-07"</span></span><br><span class="line">[425] <span class="string">"TCGA-BP-4343-01A-02R-1289-07"</span> <span class="string">"TCGA-CJ-5683-01A-11R-1541-07"</span></span><br><span class="line">[427] <span class="string">"TCGA-CJ-5684-01A-11R-1541-07"</span> <span class="string">"TCGA-AK-3455-01A-01R-0864-07"</span></span><br><span class="line">[429] <span class="string">"TCGA-CZ-5456-11A-02R-1503-07"</span> <span class="string">"TCGA-B0-5399-01A-01R-1503-07"</span></span><br><span class="line">[431] <span class="string">"TCGA-CJ-4637-01A-02R-1325-07"</span> <span class="string">"TCGA-CW-5591-11A-01R-1541-07"</span></span><br><span class="line">[433] <span class="string">"TCGA-CJ-4916-01A-01R-1426-07"</span> <span class="string">"TCGA-CW-5591-01A-01R-1541-07"</span></span><br><span class="line">[435] <span class="string">"TCGA-BP-5008-01A-01R-1334-07"</span> <span class="string">"TCGA-BP-4331-01A-01R-1289-07"</span></span><br><span class="line">[437] <span class="string">"TCGA-B0-4693-01A-01R-1277-07"</span> <span class="string">"TCGA-CW-5584-11A-01R-1541-07"</span></span><br><span class="line">[439] <span class="string">"TCGA-B2-5641-01A-01R-1541-07"</span> <span class="string">"TCGA-B0-4713-01A-01R-1277-07"</span></span><br><span class="line">[441] <span class="string">"TCGA-BP-5182-01A-01R-1426-07"</span> <span class="string">"TCGA-CJ-4634-01A-02R-1325-07"</span></span><br><span class="line">[443] <span class="string">"TCGA-B0-5712-11A-01R-1672-07"</span> <span class="string">"TCGA-BP-5176-01A-01R-1426-07"</span></span><br><span class="line">[445] <span class="string">"TCGA-BP-5170-01A-01R-1426-07"</span> <span class="string">"TCGA-CZ-5988-11A-01R-1672-07"</span></span><br><span class="line">[447] <span class="string">"TCGA-B0-4712-11A-02R-1503-07"</span> <span class="string">"TCGA-CJ-4638-01A-02R-1325-07"</span></span><br><span class="line">[449] <span class="string">"TCGA-CJ-5689-11A-01R-1541-07"</span> <span class="string">"TCGA-B0-5709-11A-01R-1541-07"</span></span><br><span class="line">[451] <span class="string">"TCGA-CZ-5465-11A-01R-1503-07"</span> <span class="string">"TCGA-B0-4823-01A-02R-1420-07"</span></span><br><span class="line">[453] <span class="string">"TCGA-CZ-4864-11A-01R-1503-07"</span> <span class="string">"TCGA-6D-AA2E-01A-11R-A37O-07"</span></span><br><span class="line">[455] <span class="string">"TCGA-AK-3453-01A-02R-1277-07"</span> <span class="string">"TCGA-B0-5692-01A-11R-1541-07"</span></span><br><span class="line">[457] <span class="string">"TCGA-BP-5194-01A-02R-1426-07"</span> <span class="string">"TCGA-A3-3357-01A-02R-1420-07"</span></span><br><span class="line">[459] <span class="string">"TCGA-BP-4797-01A-01R-1305-07"</span> <span class="string">"TCGA-CJ-5689-01A-11R-1541-07"</span></span><br><span class="line">[461] <span class="string">"TCGA-BP-4765-01A-01R-1289-07"</span> <span class="string">"TCGA-B8-4620-01A-02R-1325-07"</span></span><br><span class="line">[463] <span class="string">"TCGA-B8-4143-01A-01R-1188-07"</span> <span class="string">"TCGA-CJ-4893-01A-01R-1305-07"</span></span><br><span class="line">[465] <span class="string">"TCGA-BP-5195-01A-02R-1426-07"</span> <span class="string">"TCGA-B0-5712-01A-11R-1672-07"</span></span><br><span class="line">[467] <span class="string">"TCGA-AK-3426-01A-02R-1325-07"</span> <span class="string">"TCGA-B2-5635-01A-01R-A277-07"</span></span><br><span class="line">[469] <span class="string">"TCGA-CZ-5987-01A-11R-1672-07"</span> <span class="string">"TCGA-A3-3319-01A-02R-1325-07"</span></span><br><span class="line">[471] <span class="string">"TCGA-BP-4804-01A-02R-1305-07"</span> <span class="string">"TCGA-CJ-4891-01A-01R-1305-07"</span></span><br><span class="line">[473] <span class="string">"TCGA-A3-3326-01A-01R-0864-07"</span> <span class="string">"TCGA-BP-4959-01A-01R-1334-07"</span></span><br><span class="line">[475] <span class="string">"TCGA-BP-4332-01A-01R-1289-07"</span> <span class="string">"TCGA-BP-4177-01A-02R-1420-07"</span></span><br><span class="line">[477] <span class="string">"TCGA-B8-4151-01A-01R-1188-07"</span> <span class="string">"TCGA-MM-A84U-01A-11R-A37O-07"</span></span><br><span class="line">[479] <span class="string">"TCGA-CZ-5984-11A-01R-1672-07"</span> <span class="string">"TCGA-A3-3365-01A-01R-0864-07"</span></span><br><span class="line">[481] <span class="string">"TCGA-BP-4807-01A-01R-1305-07"</span> <span class="string">"TCGA-A3-A8OW-01A-11R-A37O-07"</span></span><br><span class="line">[483] <span class="string">"TCGA-CZ-4859-01A-02R-1426-07"</span> <span class="string">"TCGA-CZ-5453-01A-01R-1503-07"</span></span><br><span class="line">[485] <span class="string">"TCGA-B2-5633-01B-04R-A277-07"</span> <span class="string">"TCGA-CZ-5458-01A-01R-1503-07"</span></span><br><span class="line">[487] <span class="string">"TCGA-BP-4354-01A-02R-1289-07"</span> <span class="string">"TCGA-CJ-4640-01A-02R-1325-07"</span></span><br><span class="line">[489] <span class="string">"TCGA-CW-6087-11A-01R-1672-07"</span> <span class="string">"TCGA-DV-5566-01A-01R-1541-07"</span></span><br><span class="line">[491] <span class="string">"TCGA-A3-3387-01A-01R-1541-07"</span> <span class="string">"TCGA-B8-5552-01B-11R-1672-07"</span></span><br><span class="line">[493] <span class="string">"TCGA-BP-4162-01A-02R-1325-07"</span> <span class="string">"TCGA-A3-3306-01A-01R-0864-07"</span></span><br><span class="line">[495] <span class="string">"TCGA-AK-3450-01A-02R-1277-07"</span> <span class="string">"TCGA-DV-5575-01A-01R-1541-07"</span></span><br><span class="line">[497] <span class="string">"TCGA-CZ-5458-11A-01R-1503-07"</span> <span class="string">"TCGA-CJ-5672-11A-01R-1541-07"</span></span><br><span class="line">[499] <span class="string">"TCGA-CJ-4642-01B-01R-1305-07"</span> <span class="string">"TCGA-BP-4170-01A-02R-1289-07"</span></span><br><span class="line">[501] <span class="string">"TCGA-CJ-4887-01A-01R-1305-07"</span> <span class="string">"TCGA-AK-3465-01A-02R-1325-07"</span></span><br><span class="line">[503] <span class="string">"TCGA-CZ-5466-01A-01R-1503-07"</span> <span class="string">"TCGA-BP-5004-01A-01R-1334-07"</span></span><br><span class="line">[505] <span class="string">"TCGA-B8-5552-11A-01R-1672-07"</span> <span class="string">"TCGA-EU-5906-01A-11R-1672-07"</span></span><br><span class="line">[507] <span class="string">"TCGA-BP-5196-01A-01R-1426-07"</span> <span class="string">"TCGA-BP-4994-01A-01R-1334-07"</span></span><br><span class="line">[509] <span class="string">"TCGA-AK-3434-01A-02R-1277-07"</span> <span class="string">"TCGA-CZ-5454-11A-01R-1503-07"</span></span><br><span class="line">[511] <span class="string">"TCGA-B8-A8YJ-01A-13R-A39I-07"</span> <span class="string">"TCGA-CJ-4644-01A-02R-1325-07"</span></span><br><span class="line">[513] <span class="string">"TCGA-B0-5705-11A-01R-1541-07"</span> <span class="string">"TCGA-CJ-4875-01A-01R-1305-07"</span></span><br><span class="line">[515] <span class="string">"TCGA-BP-4983-01A-01R-1334-07"</span> <span class="string">"TCGA-CZ-5452-11A-01R-1503-07"</span></span><br><span class="line">[517] <span class="string">"TCGA-B0-5701-01A-11R-1541-07"</span> <span class="string">"TCGA-BP-4766-01A-01R-1289-07"</span></span><br><span class="line">[519] <span class="string">"TCGA-A3-3352-01A-01R-0864-07"</span> <span class="string">"TCGA-G6-A8L7-01A-11R-A37O-07"</span></span><br><span class="line">[521] <span class="string">"TCGA-B0-4828-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-4759-01A-01R-1289-07"</span></span><br><span class="line">[523] <span class="string">"TCGA-BP-4346-01A-01R-1289-07"</span> <span class="string">"TCGA-BP-4971-01A-01R-1334-07"</span></span><br><span class="line">[525] <span class="string">"TCGA-B0-4846-01A-01R-1277-07"</span> <span class="string">"TCGA-B0-5081-01A-01R-1334-07"</span></span><br><span class="line">[527] <span class="string">"TCGA-CW-5580-01A-01R-1672-07"</span> <span class="string">"TCGA-B2-3924-01A-02R-A277-07"</span></span><br><span class="line">[529] <span class="string">"TCGA-CJ-6027-01A-11R-1672-07"</span> <span class="string">"TCGA-B0-5075-01A-01R-1334-07"</span></span><br><span class="line">[531] <span class="string">"TCGA-CJ-5675-01A-11R-1541-07"</span> <span class="string">"TCGA-B0-5691-11A-01R-1541-07"</span></span><br><span class="line">[533] <span class="string">"TCGA-B0-4701-01A-01R-1277-07"</span> <span class="string">"TCGA-BP-4784-01A-01R-1305-07"</span></span><br><span class="line">[535] <span class="string">"TCGA-B4-5843-01A-11R-1672-07"</span> <span class="string">"TCGA-B0-5705-01A-11R-1541-07"</span></span><br><span class="line">[537] <span class="string">"TCGA-B0-5711-11A-01R-1672-07"</span> <span class="string">"TCGA-CJ-4636-01A-02R-1325-07"</span></span><br><span class="line">[539] <span class="string">"TCGA-B0-5697-01A-11R-1541-07"</span> <span class="string">"TCGA-BP-5189-01A-02R-1426-07"</span></span><br><span class="line">[541] <span class="string">"TCGA-B0-5691-01A-11R-1541-07"</span> <span class="string">"TCGA-DV-5569-01A-01R-1541-07"</span></span><br><span class="line">[543] <span class="string">"TCGA-B8-5553-01A-01R-1541-07"</span> <span class="string">"TCGA-B4-5836-01A-11R-1672-07"</span></span><br><span class="line">[545] <span class="string">"TCGA-A3-3372-01A-02R-1325-07"</span> <span class="string">"TCGA-CZ-5462-01A-01R-1503-07"</span></span><br><span class="line">[547] <span class="string">"TCGA-CJ-4905-01A-02R-1426-07"</span> <span class="string">"TCGA-CJ-5681-01A-11R-1541-07"</span></span><br><span class="line">[549] <span class="string">"TCGA-B0-5077-01A-01R-1334-07"</span> <span class="string">"TCGA-AK-3428-01A-02R-1277-07"</span></span><br><span class="line">[551] <span class="string">"TCGA-A3-3373-01A-02R-1420-07"</span> <span class="string">"TCGA-CW-5580-11A-02R-1672-07"</span></span><br><span class="line">[553] <span class="string">"TCGA-CZ-5985-11A-01R-1672-07"</span> <span class="string">"TCGA-B2-5636-11A-01R-1541-07"</span></span><br><span class="line">[555] <span class="string">"TCGA-CJ-4908-01A-01R-1426-07"</span> <span class="string">"TCGA-A3-A8OV-01A-11R-A37O-07"</span></span><br><span class="line">[557] <span class="string">"TCGA-B0-5697-11A-01R-1541-07"</span> <span class="string">"TCGA-CJ-4869-01A-02R-1426-07"</span></span><br><span class="line">[559] <span class="string">"TCGA-BP-4999-01A-01R-1334-07"</span> <span class="string">"TCGA-CJ-5681-11A-01R-1541-07"</span></span><br><span class="line">[561] <span class="string">"TCGA-CJ-4907-01A-01R-1426-07"</span> <span class="string">"TCGA-A3-3322-01A-02R-1325-07"</span></span><br><span class="line">[563] <span class="string">"TCGA-CJ-4890-01A-01R-1305-07"</span> <span class="string">"TCGA-AK-3461-01A-02R-1277-07"</span></span><br><span class="line">[565] <span class="string">"TCGA-B2-3923-01A-02R-A277-07"</span> <span class="string">"TCGA-CW-6093-01A-11R-1672-07"</span></span><br><span class="line">[567] <span class="string">"TCGA-DV-A4VZ-01A-11R-A266-07"</span> <span class="string">"TCGA-CZ-5470-11A-01R-1503-07"</span></span><br><span class="line">[569] <span class="string">"TCGA-CZ-5982-11A-01R-1672-07"</span> <span class="string">"TCGA-BP-4993-01A-02R-1420-07"</span></span><br><span class="line">[571] <span class="string">"TCGA-B0-4833-01A-01R-1305-07"</span> <span class="string">"TCGA-CJ-4884-01A-01R-1305-07"</span></span><br><span class="line">[573] <span class="string">"TCGA-B0-5107-01A-01R-1420-07"</span> <span class="string">"TCGA-B0-5106-01A-01R-1420-07"</span></span><br><span class="line">[575] <span class="string">"TCGA-BP-4781-01A-01R-1305-07"</span> <span class="string">"TCGA-B0-4821-01A-01R-1503-07"</span></span><br><span class="line">[577] <span class="string">"TCGA-B0-4818-01A-01R-1503-07"</span> <span class="string">"TCGA-CW-5587-11A-01R-1541-07"</span></span><br><span class="line">[579] <span class="string">"TCGA-B0-5699-11A-01R-1541-07"</span> <span class="string">"TCGA-CJ-6033-11A-01R-1858-07"</span></span><br><span class="line">[581] <span class="string">"TCGA-CJ-4885-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-4342-01A-01R-1289-07"</span></span><br><span class="line">[583] <span class="string">"TCGA-B0-4813-01A-01R-1277-07"</span> <span class="string">"TCGA-EU-5905-01A-11R-1672-07"</span></span><br><span class="line">[585] <span class="string">"TCGA-B4-5377-01A-01R-1503-07"</span> <span class="string">"TCGA-BP-5178-01A-01R-1426-07"</span></span><br><span class="line">[587] <span class="string">"TCGA-B0-4690-01A-01R-1277-07"</span> <span class="string">"TCGA-B8-5158-01A-01R-1420-07"</span></span><br><span class="line">[589] <span class="string">"TCGA-CZ-4862-01A-01R-1305-07"</span> <span class="string">"TCGA-BP-4799-01A-01R-1305-07"</span></span><br><span class="line">[591] <span class="string">"TCGA-B8-4148-01A-02R-1325-07"</span> <span class="string">"TCGA-BP-4345-01A-01R-1289-07"</span></span><br><span class="line">[593] <span class="string">"TCGA-BP-5010-01A-02R-1420-07"</span> <span class="string">"TCGA-BP-4325-01A-02R-1289-07"</span></span><br><span class="line">[595] <span class="string">"TCGA-BP-4967-01A-01R-1334-07"</span> <span class="string">"TCGA-B0-5706-11A-01R-1541-07"</span></span><br><span class="line">[597] <span class="string">"TCGA-BP-4776-01A-01R-1289-07"</span> <span class="string">"TCGA-AK-3431-01A-02R-1277-07"</span></span><br><span class="line">[599] <span class="string">"TCGA-BP-4974-01A-01R-1334-07"</span> <span class="string">"TCGA-CZ-5455-11A-01R-1503-07"</span></span><br><span class="line">[601] <span class="string">"TCGA-BP-4976-01A-01R-1334-07"</span> <span class="string">"TCGA-A3-3387-11A-01R-1541-07"</span></span><br><span class="line">[603] <span class="string">"TCGA-CZ-5452-01A-01R-1503-07"</span> <span class="string">"TCGA-CZ-4863-01A-01R-1503-07"</span></span><br><span class="line">[605] <span class="string">"TCGA-B8-A54I-01A-21R-A33J-07"</span> <span class="string">"TCGA-A3-A8OX-01A-11R-A37O-07"</span></span><br><span class="line">[607] <span class="string">"TCGA-B0-5109-01A-02R-1420-07"</span> <span class="string">"TCGA-CJ-4903-01A-01R-1426-07"</span></span><br><span class="line">[609] <span class="string">"TCGA-B0-4714-01A-01R-1277-07"</span> <span class="string">"TCGA-B8-5550-01A-01R-1541-07"</span></span><br><span class="line">[611] <span class="string">"TCGA-B0-5094-01A-01R-1420-07"</span></span><br><span class="line"></span><br><span class="line">&gt; dim(sample_matrix)</span><br><span class="line">[1] 611   2 <span class="comment"># 611行，2列</span></span><br><span class="line"></span><br><span class="line">&gt; head(sample_matrix)</span><br><span class="line">                                          id                    sample_id</span><br><span class="line">1 9d5c2ed8-443b-4c71-b5b2-d9fc98b322c0_count TCGA-CZ-5457-11A-01R-1503-07</span><br><span class="line">2 f426d6b8-5010-471c-aa9c-253269f6bc03_count TCGA-CJ-5686-01A-11R-1672-07</span><br><span class="line">3 f0532052-b496-4435-abc4-93e23c6a68a5_count TCGA-B0-5084-01A-01R-1334-07</span><br><span class="line">4 6c2a30ae-9435-4d9c-99dd-59d8d77f3920_count TCGA-BP-5201-01A-01R-1426-07</span><br><span class="line">5 586afb0b-e791-4efe-b5c9-eaac6ecce723_count TCGA-B0-4845-01A-01R-1277-07</span><br><span class="line">6 cde6e107-8870-48c2-85b9-c0f1d71bfc0e_count TCGA-B0-5812-01A-11R-1672-07</span><br><span class="line"></span><br><span class="line">&gt; sample_info &lt;- data.frame(id=substr(id,1,9),sample_id=substr(sample_id,1,25))</span><br><span class="line">&gt; head(sample_info)</span><br><span class="line">         id                 sample_id</span><br><span class="line">1 9d5c2ed8- TCGA-CZ-5457-11A-01R-1503</span><br><span class="line">2 f426d6b8- TCGA-CJ-5686-01A-11R-1672</span><br><span class="line">3 f0532052- TCGA-B0-5084-01A-01R-1334</span><br><span class="line">4 6c2a30ae- TCGA-BP-5201-01A-01R-1426</span><br><span class="line">5 586afb0b- TCGA-B0-4845-01A-01R-1277</span><br><span class="line">6 cde6e107- TCGA-B0-5812-01A-11R-1672</span><br><span class="line"></span><br><span class="line">&gt; sample_info &lt;- sample_info[order(sample_info<span class="variable">$id</span>),] <span class="comment"># 观察一下data中的列名，是从小到大排列过的，因此，这里也要从小到大排序，否则会无法对应</span></span><br><span class="line">&gt; head(sample_info)</span><br><span class="line">           id                 sample_id</span><br><span class="line">412 0048d446- TCGA-CZ-5465-01A-01R-1503</span><br><span class="line">422 0062bf7b- TCGA-BP-4355-01A-01R-1289</span><br><span class="line">42  00a9180b- TCGA-CZ-5451-01A-01R-1503</span><br><span class="line">526 00c12b3c- TCGA-B0-5081-01A-01R-1334</span><br><span class="line">510 011ee3e1- TCGA-CZ-5454-11A-01R-1503</span><br><span class="line">539 015b7fde- TCGA-B0-5697-01A-11R-1541</span><br><span class="line"></span><br><span class="line">&gt; head(data)[1:4]</span><br><span class="line">                   X0048d446. X0062bf7b. X00a9180b. X00c12b3c.</span><br><span class="line">ENSG00000000005.5          33         29         83         77</span><br><span class="line">ENSG00000000419.11       2501       1427        967       1300</span><br><span class="line">ENSG00000000457.12       1167       1081        574        796</span><br><span class="line">ENSG00000000460.15        348        247        162        321</span><br><span class="line">ENSG00000000938.11        899       1211       1100       2065</span><br><span class="line">ENSG00000000971.14       1460       4505        936       6501</span><br><span class="line"></span><br><span class="line">&gt; colnames(data) &lt;- sample_info<span class="variable">$sample_id</span> <span class="comment"># 将data的列名替换成sample_id，因为后者包含样品是肿瘤还是正常这些信息，方便分类</span></span><br><span class="line">&gt; head(data)[1:4]</span><br><span class="line">                   TCGA-CZ-5465-01A-01R-1503 TCGA-BP-4355-01A-01R-1289</span><br><span class="line">ENSG00000000005.5                         33                        29</span><br><span class="line">ENSG00000000419.11                      2501                      1427</span><br><span class="line">ENSG00000000457.12                      1167                      1081</span><br><span class="line">ENSG00000000460.15                       348                       247</span><br><span class="line">ENSG00000000938.11                       899                      1211</span><br><span class="line">ENSG00000000971.14                      1460                      4505</span><br><span class="line">                   TCGA-CZ-5451-01A-01R-1503 TCGA-B0-5081-01A-01R-1334</span><br><span class="line">ENSG00000000005.5                         83                        77</span><br><span class="line">ENSG00000000419.11                       967                      1300</span><br><span class="line">ENSG00000000457.12                       574                       796</span><br><span class="line">ENSG00000000460.15                       162                       321</span><br><span class="line">ENSG00000000938.11                      1100                      2065</span><br><span class="line">ENSG00000000971.14                       936                      6501</span><br><span class="line"></span><br><span class="line">&gt; dim(data)</span><br><span class="line">[1] 60482   611 <span class="comment"># data中的行列都不改变，但是新的列名中包含样品信息，下面就可以分类了</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=
      
    
    </summary>
    
      <category term="生物信息" scheme="http://uteric.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/"/>
    
    
      <category term="TCGA" scheme="http://uteric.github.io/tags/TCGA/"/>
    
  </entry>
  
</feed>
